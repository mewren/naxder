/*!
 * jQuery JavaScript Library v1.8.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: Tue Nov 13 2012 08:20:33 GMT-0500 (Eastern Standard Time)
 */
function $A(e){if(!e)return[];if("toArray"in Object(e))return e.toArray();for(var t=e.length||0,n=new Array(t);t--;)n[t]=e[t];return n}function $w(e){return Object.isString(e)?(e=e.strip(),e?e.split(/\s+/):[]):[]}function $H(e){return new Hash(e)}function $R(e,t,n){return new ObjectRange(e,t,n)}function $(e){if(arguments.length>1){for(var t=0,n=[],i=arguments.length;i>t;t++)n.push($(arguments[t]));return n}return Object.isString(e)&&(e=document.getElementById(e)),Element.extend(e)}function hex_md5(e){return binl2hex(core_md5(str2binl(e),e.length*chrsz))}function b64_md5(e){return binl2b64(core_md5(str2binl(e),e.length*chrsz))}function str_md5(e){return binl2str(core_md5(str2binl(e),e.length*chrsz))}function hex_hmac_md5(e,t){return binl2hex(core_hmac_md5(e,t))}function b64_hmac_md5(e,t){return binl2b64(core_hmac_md5(e,t))}function str_hmac_md5(e,t){return binl2str(core_hmac_md5(e,t))}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc")}function core_md5(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,i=-271733879,o=-1732584194,r=271733878,s=0;s<e.length;s+=16){var a=n,l=i,c=o,u=r;n=md5_ff(n,i,o,r,e[s+0],7,-680876936),r=md5_ff(r,n,i,o,e[s+1],12,-389564586),o=md5_ff(o,r,n,i,e[s+2],17,606105819),i=md5_ff(i,o,r,n,e[s+3],22,-1044525330),n=md5_ff(n,i,o,r,e[s+4],7,-176418897),r=md5_ff(r,n,i,o,e[s+5],12,1200080426),o=md5_ff(o,r,n,i,e[s+6],17,-1473231341),i=md5_ff(i,o,r,n,e[s+7],22,-45705983),n=md5_ff(n,i,o,r,e[s+8],7,1770035416),r=md5_ff(r,n,i,o,e[s+9],12,-1958414417),o=md5_ff(o,r,n,i,e[s+10],17,-42063),i=md5_ff(i,o,r,n,e[s+11],22,-1990404162),n=md5_ff(n,i,o,r,e[s+12],7,1804603682),r=md5_ff(r,n,i,o,e[s+13],12,-40341101),o=md5_ff(o,r,n,i,e[s+14],17,-1502002290),i=md5_ff(i,o,r,n,e[s+15],22,1236535329),n=md5_gg(n,i,o,r,e[s+1],5,-165796510),r=md5_gg(r,n,i,o,e[s+6],9,-1069501632),o=md5_gg(o,r,n,i,e[s+11],14,643717713),i=md5_gg(i,o,r,n,e[s+0],20,-373897302),n=md5_gg(n,i,o,r,e[s+5],5,-701558691),r=md5_gg(r,n,i,o,e[s+10],9,38016083),o=md5_gg(o,r,n,i,e[s+15],14,-660478335),i=md5_gg(i,o,r,n,e[s+4],20,-405537848),n=md5_gg(n,i,o,r,e[s+9],5,568446438),r=md5_gg(r,n,i,o,e[s+14],9,-1019803690),o=md5_gg(o,r,n,i,e[s+3],14,-187363961),i=md5_gg(i,o,r,n,e[s+8],20,1163531501),n=md5_gg(n,i,o,r,e[s+13],5,-1444681467),r=md5_gg(r,n,i,o,e[s+2],9,-51403784),o=md5_gg(o,r,n,i,e[s+7],14,1735328473),i=md5_gg(i,o,r,n,e[s+12],20,-1926607734),n=md5_hh(n,i,o,r,e[s+5],4,-378558),r=md5_hh(r,n,i,o,e[s+8],11,-2022574463),o=md5_hh(o,r,n,i,e[s+11],16,1839030562),i=md5_hh(i,o,r,n,e[s+14],23,-35309556),n=md5_hh(n,i,o,r,e[s+1],4,-1530992060),r=md5_hh(r,n,i,o,e[s+4],11,1272893353),o=md5_hh(o,r,n,i,e[s+7],16,-155497632),i=md5_hh(i,o,r,n,e[s+10],23,-1094730640),n=md5_hh(n,i,o,r,e[s+13],4,681279174),r=md5_hh(r,n,i,o,e[s+0],11,-358537222),o=md5_hh(o,r,n,i,e[s+3],16,-722521979),i=md5_hh(i,o,r,n,e[s+6],23,76029189),n=md5_hh(n,i,o,r,e[s+9],4,-640364487),r=md5_hh(r,n,i,o,e[s+12],11,-421815835),o=md5_hh(o,r,n,i,e[s+15],16,530742520),i=md5_hh(i,o,r,n,e[s+2],23,-995338651),n=md5_ii(n,i,o,r,e[s+0],6,-198630844),r=md5_ii(r,n,i,o,e[s+7],10,1126891415),o=md5_ii(o,r,n,i,e[s+14],15,-1416354905),i=md5_ii(i,o,r,n,e[s+5],21,-57434055),n=md5_ii(n,i,o,r,e[s+12],6,1700485571),r=md5_ii(r,n,i,o,e[s+3],10,-1894986606),o=md5_ii(o,r,n,i,e[s+10],15,-1051523),i=md5_ii(i,o,r,n,e[s+1],21,-2054922799),n=md5_ii(n,i,o,r,e[s+8],6,1873313359),r=md5_ii(r,n,i,o,e[s+15],10,-30611744),o=md5_ii(o,r,n,i,e[s+6],15,-1560198380),i=md5_ii(i,o,r,n,e[s+13],21,1309151649),n=md5_ii(n,i,o,r,e[s+4],6,-145523070),r=md5_ii(r,n,i,o,e[s+11],10,-1120210379),o=md5_ii(o,r,n,i,e[s+2],15,718787259),i=md5_ii(i,o,r,n,e[s+9],21,-343485551),n=safe_add(n,a),i=safe_add(i,l),o=safe_add(o,c),r=safe_add(r,u)}return Array(n,i,o,r)}function md5_cmn(e,t,n,i,o,r){return safe_add(bit_rol(safe_add(safe_add(t,e),safe_add(i,r)),o),n)}function md5_ff(e,t,n,i,o,r,s){return md5_cmn(t&n|~t&i,e,t,o,r,s)}function md5_gg(e,t,n,i,o,r,s){return md5_cmn(t&i|n&~i,e,t,o,r,s)}function md5_hh(e,t,n,i,o,r,s){return md5_cmn(t^n^i,e,t,o,r,s)}function md5_ii(e,t,n,i,o,r,s){return md5_cmn(n^(t|~i),e,t,o,r,s)}function core_hmac_md5(e,t){var n=str2binl(e);n.length>16&&(n=core_md5(n,e.length*chrsz));for(var i=Array(16),o=Array(16),r=0;16>r;r++)i[r]=909522486^n[r],o[r]=1549556828^n[r];var s=core_md5(i.concat(str2binl(t)),512+t.length*chrsz);return core_md5(o.concat(s),640)}function safe_add(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}function bit_rol(e,t){return e<<t|e>>>32-t}function str2binl(e){for(var t=Array(),n=(1<<chrsz)-1,i=0;i<e.length*chrsz;i+=chrsz)t[i>>5]|=(e.charCodeAt(i/chrsz)&n)<<i%32;return t}function binl2str(e){for(var t="",n=(1<<chrsz)-1,i=0;i<32*e.length;i+=chrsz)t+=String.fromCharCode(e[i>>5]>>>i%32&n);return t}function binl2hex(e){for(var t=hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<4*e.length;i++)n+=t.charAt(e[i>>2]>>i%4*8+4&15)+t.charAt(e[i>>2]>>i%4*8&15);return n}function binl2b64(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",i=0;i<4*e.length;i+=3)for(var o=(e[i>>2]>>8*(i%4)&255)<<16|(e[i+1>>2]>>8*((i+1)%4)&255)<<8|e[i+2>>2]>>8*((i+2)%4)&255,r=0;4>r;r++)n+=8*i+6*r>32*e.length?b64pad:t.charAt(o>>6*(3-r)&63);return n}function closePrototips(){$$(".prototip").each(function(e){e.hide()})}function commentFormSubmitting(e){e&&($j("#comment_form_error").hide(),$j("#errorExplanation").hide()),$j("#comment_form_saving").toggle(e),$j("#comment_form_saving2").toggle(e)}function commentFormSaveError(e){var t=e.responseText?e.responseText:"";commentFormSubmitting(!1),$j("#comment_form_error_detail").text(t),$j("#comment_form_error").show()}function shareOnTwitter(e){Lightbox.showBoxByID("publishTwitterReview_"+e)}function submitShelfButton(e,t,n,i,o,r){var s=new SubmitShelfButtonHandler(e,t,n,i,o,r);s.sendRequest()}function onVote(e,t){document.getElementById("yes_link"+e).style.color=1==t?"#d7d7d7":"#006699"}function checkAll(form,uncheck){for(form=eval("document."+form),i=0;i<form.length;i++)"checkbox"==form[i].type&&(form[i].checked=uncheck?"":"checked")}function onInviteChooseSubmit(e){var t=countChecked("scraperInvites",!0),n=countChecked("scraperInvites",!1);if(t>e||0==n){try{Element.show("inviteConfirm"),Element.update("inviteConfirmCount",t+" ")}catch(i){return confirm("Are you sure you would like to invite all the checked contacts?")}return!1}return!0}function countChecked(form,countChecked){null==countChecked&&(countChecked=!0);var count=0;for(form=eval("document."+form),i=0;i<form.length;i++)"checkbox"==form[i].type&&(form[i].checked&&countChecked||!form[i].checked&&!countChecked)&&count++;return count}function isYahooEmail(e){try{return e?/yahoo.com$/.test(e):!1}catch(t){return!1}}function hideScraperPasswordField(e,t,n,i,o,r){var s=isYahooEmail(t.value)&&r,a=n.up("tr");s?(e.down("form").onsubmit=function(){return YahooOauthPopup.open()},"yahoo_scraper"!=o.value&&(o.oldValue=o.value,o.value="yahoo_scraper"),a.hide(),a.next().down("input").value="find friends"):(e.down("form").onsubmit=null,o.oldValue&&(o.value=o.oldValue),a.show(),a.next().down("input").value="next"),i.value=s}function setScraper(e,t){var n=e.replace("_scraper",""),i=$(e).innerHTML,o=$("display_scraper");o.innerHTML=i;var n=$("service");n.value=e;var r=$("scraper_email"),s=$("scraper_password"),a=$("use_service");if(null!=r){try{r.focus()}catch(l){}r.observe("keyup",function(){hideScraperPasswordField(o,r,s,a,n,t)})}if(hideScraperPasswordField(o,r,s,a,n,t),""!=$("scraper_email").value)try{s.focus()}catch(c){}}function updateMoreLink(e){var t=$j("#freeText"+e),n=$j("#freeTextContainer"+e),i=t.parents("#other_reviews").length>0,o=t.parents(".review").eq(-1),r=null,s=$j("#bookReviewControls").data("book-reviews-page");o.length&&(r=o.attr("id").replace(/review_/g,"")),t.show(),n.hide(),t.has("a.showMoreReviewText")&&i&&$j.post("/track_conversion_action",{event:"expanded_review",options:{experiments:"review_interaction_tracking",multiple:!0,review_page:s,review_id:r}})}function countChars(e,t){var n=Event.element(e),i=parseInt(n.getAttribute("maxlength"))-n.value.length;t=t||"characterCount";var o=t.match(/^[#\.]/)?$$(t)[0]:$(t);o.innerHTML=i+" characters left"}function chopChars(e){var t=Event.element(e),n=parseInt(t.getAttribute("maxlength"));return 0>=n?void alert("maxlength was not defined!"):(t.value=t.value.slice(0,n-1),!0)}function onTableRowClick(checkbox_name,row_id){element=eval(checkbox_name),element.checked=element.checked?"":"checked",row=document.getElementById(row_id);for(var i=0;i<row.cells.length;i++)row.cells[i].style.backgroundColor=element.checked?"#EBE8D5":"white"}function onTableRowHover(checkbox_name,row_id,over){if(element=eval(checkbox_name),!element.checked){row=document.getElementById(row_id);for(var i=0;i<row.cells.length;i++)row.cells[i].style.backgroundColor=over?"#EBE8D5":"white"}}function setReadAt(e){var e=e||{};if(e.field_id_prefix=e.field_id_prefix||"review_read_at",!e.parent&&e.link&&(e.parent=$(e.link).up(".formField")||$(e.link).up("form")),e.parent)var t=$(e.parent).down("#"+e.field_id_prefix+"_1i"),n=$(e.parent).down("#"+e.field_id_prefix+"_2i"),i=$(e.parent).down("#"+e.field_id_prefix+"_3i");else var t=$(e.field_id_prefix+"_1i"),n=$(e.field_id_prefix+"_2i"),i=$(e.field_id_prefix+"_3i");if(e.clear)t.setValue(0),n.setValue(0),i.setValue(0);else{if(e.date&&"string"==typeof e.date){var o=e.date.match(/(\d+)-(\d+)-(\d+)/);if(o){var r=parseInt(o[1]),s=parseInt(o[2].replace(/^0+/,""))-1,a=parseInt(o[3].replace(/^0+/,""));e.date=new Date(r,s,a)}else e.date=new Date(e.date)}var l=e.date?e.date:new Date;t.setValue(l.getYear()+(l.getYear()<1900?1900:0)),n.setValue(l.getMonth()+1),i.setValue(l.getDate())}t.down(t.selectedIndex).setAttribute("selected","selected"),n.down(n.selectedIndex).setAttribute("selected","selected"),i.down(i.selectedIndex).setAttribute("selected","selected")}function readingProgressChanged(){var e=document.user_status_form,t=e.user_status_book_id;e.user_status_body.value="",e.user_status_body.className="",e.user_status_page.value="",e.user_status_percent.value="",t&&"0"==t.value?(Element.hide("user_status_page_container"),Element.hide("user_status_percent_container")):(Element.show("user_status_page_container"),Element.hide("user_status_percent_container"))}function keyPressWithoutSubmit(e,t,n){var i;return window.event?i=t.keyCode:t.which&&(i=t.which),i==Event.KEY_RETURN?("function"==typeof n&&n(e,t),!1):!0}function addSortable(e,t){Event.observe(window,"load",function(){Sortable.create(e,{onUpdate:function(){new Ajax.Request(t,{parameters:Sortable.serialize(e),onLoading:function(){$$(".sortable_controls input").invoke("hide"),$$(".sortable_controls .position_loading").invoke("show")},onComplete:function(){$$(".sortable_controls input").invoke("show"),$$(".sortable_controls .position_loading").invoke("hide")}})}}),window.originalSequence=Sortable.sequence(e)})}function commaFormatted(e){e=e.toString();var t=",",n=e.split(".",2),i=n[1],o=parseInt(n[0]);if(isNaN(o))return"";var r="";0>o&&(r="-"),o=Math.abs(o);for(var s=new String(o),n=[];s.length>3;){var a=s.substr(s.length-3);n.unshift(a),s=s.substr(0,s.length-3)}return s.length>0&&n.unshift(s),s=n.join(t),e=!i||i.length<1?s:s+"."+i,e=r+e}function luhn_check(e){var e=e.replace(/\D/g,""),t=e.length,n=t%2,o=0;for(i=0;t>i;i++){var r=e.charAt(i);i%2==n&&(r=2*r,r>9&&(r-=9)),o+=parseInt(r)}return o%10==0?!0:!1}function toggleRadioExtras(e,t,n){if("undefined"==typeof t)var t="radioExtra";"undefined"==typeof n?$$("."+t).invoke("hide"):n.descendants().each(function(e){e.match("."+t)&&e.hide()});var i=$(e).next("."+t);"undefined"!=typeof i&&i.show()}function toShelfName(e){var t=e.toLowerCase().replace(/\W/g,"-");return t=t.replace(/\-+$/,"").slice(0,35)}function saveShelfPosition(e){var t=$("positions_"+e).value;new Ajax.Request("/shelf/move_to_position/",{parameters:{id:e,position:t},onLoading:function(){$("position_loading_"+e).show(),$("positions_"+e).hide(),Tips.hideAll()},onComplete:function(){$("moveToPosEdit"+e).hide(),Tips.hideAll()},onFailure:function(){alert("Something went wrong re-ordering those shelves.")}})}function googleSigninComplete(e){window.location="/user/google_sign_in"+e}function renderRatingGraph(e){if(Prototype.Browser.IE)return null;var t=16,n=15,i=$A(e).max(),o=(new pv.Panel).width(t).height(n);return o.add(pv.Bar).data(e).top(function(){return 3*this.index}).width(function(e){return t*e/i}).height(2).left(0).fillStyle("#215625"),o.render(),o}function checkOpenSelects(e){if(null!=openSelectId){var t=e&&e.target||event&&event.srcElement,n=checkParent(t,openSelectId,openContainerId);n&&(Element.hide(openSelectId),openSelectId=null)}}function checkParent(e,t,n){for(;e.parentNode;){if(e==$(t)||e==$(n))return!1;e=e.parentNode}return!0}function toggleSelect(e,t){Element.toggle(e),$(e).visible()?(openSelectId=e,openContainerId=t):(openSelectId=null,openContainerId=null)}function afterShelfSave(e,t,n,i){document.getElementById(e);Element.update(t,i),Element.hide("add_button_"+n),Element.show("added_message_"+n),"function"==typeof afterShelfSaveCallback&&afterShelfSaveCallback.apply(this,arguments)}function refreshGroupBoxComplete(e,t){Element.update("addGroupBooks"+t,e.responseText)}function addShelfRequest(e,t){var n="/shelf/add_to_shelf/?book_id="+t;return _shelfRequest(n,"name",t,e)}function newShelfRequest(e,t,n){var i="/user_shelf"+e;return _shelfRequest(i,"user_shelf[name]",t,n||e)}function ignoreSuggestion(e){var t,n="/friend/ignore_ajax";return null!=$("maxSuggestionId")&&(t=$("maxSuggestionId").value),new Ajax.Request(n,{method:"get",asynchronous:!0,parameters:{id:e,max_id:t},onLoading:function(){$("add_link_"+e).hide(),$("loading_"+e).show()}}),!1}function _shelfRequest(e,t,n,i){var o=$("addShelfAjaxForm"+n);return o||(o=$("addShelfForm"+i)),new Ajax.Request(e,{asynchronous:!0,evalScripts:!0,onComplete:function(){o&&o.update("refreshing shelves..."),updateShelfSelect(i,n)},onLoading:function(){o&&o.update("saving...")},parameters:t+"="+$("newShelfField"+i).value}),!1}function select_all_suspicious_users(){alert("Careful. You are about to select every suspicious user on this page."),$$("#usersCreatedRecently .userDeleteCheckbox.suspicious").each(function(e){e.writeAttribute("checked",!0),e.up("tr").highlight()})}function deselect_all_users(){$$("#usersCreatedRecently .userDeleteCheckbox").each(function(e){e.writeAttribute("checked",!1),e.up("tr").highlight()})}function updateSpamResultItemStyling(){$j(".spamResultItemCheckbox").each(function(){this.checked?$j(this).closest("li").first().addClass("selectedItem"):$j(this).closest("li").first().removeClass("selectedItem")})}function disable_subcategories(){$j("#subcategories").hide(),$j("#subcategories select").hide().attr("disabled","disabled")}function set_subcategory_for_category(e){var t=e.replace(/[^a-z0-9]/gi,""),n=$j("#book_blog_subcategory_"+t);disable_subcategories(),""!=n.html().strip()&&(n.removeAttr("disabled").show(),$j("#subcategories").show())}function update_page_after_vote(e,t){var n=$j(e),i=n.attr("data-category"),o=$j('img[data-category="'+i+'"]');if(n.next("img").hide(),t){n.html("Vote").removeClass("changeVote").addClass("castVote"),n.attr("href",n.attr("href").gsub("/unvote","/vote")),n.prev(".voted").remove(),o.hide();var r=1}else{n.html("Change Your Vote").removeClass("castVote").addClass("changeVote"),n.attr("href",n.attr("href").gsub("/vote","/unvote")),$j("<p>").addClass("voted").html("You voted for this "+i.replace(/&/g,"&amp;")+" blog.").insertBefore(n),o.show();var r=-1}var s=$j('a.castVote[data-category="'+i+'"]');t?s.removeClass("disabled"):s.addClass("disabled");var a=$j("#voteCount"),l=parseInt(a.html())+r;a.html(String(l)+" vote"+(1==l?"":"s"))}function handle_vote_click(e,t){e.preventDefault();var n=e.target;$j(n).hasClass("disabled")||($j(n).next("img").show(),$j.post("/book_blogger_award/"+(t?"un":"")+"vote",{entry_id:$j(n).attr("data-id")},function(){update_page_after_vote(n,t)},"script"))}function enableAll(e){$$(e).each(function(e){e.enableButtons()})}function toggleChecks(e,t){$j.each($j(e).find(".fbFriendSelectorBox"),function(){"false"==$j(this).attr("added")&&("uncheck"==t?($j(this).is(":checked")&&($j(this).parent().parent().removeClass("selected"),$j(this).attr("checked",!1)),$j(e+"_checkAll").show(),$j(e+"_uncheckAll").hide()):(0==$j(this).is(":checked")&&($j(this).parent().parent().addClass("selected"),$j(this).attr("checked",!0)),$j(e+"_checkAll").hide(),$j(e+"_uncheckAll").show()))})}function inviteGroup(e,t){Lightbox.hideBox();var n=[];if("true"==t?$j.each($j(e).find('.fb_friend_box[added="false"]'),function(e,t){n.push($j(t).attr("id"))}):$j.each($j(e).find(".fb_friend_box:checked"),function(e,t){n.push($j(t).attr("id"))}),n.length>0){window._user_groups=[];for(var i=50,o=Math.ceil(n.length/i),r=0;o>r;){var s=r*i,a=(r+1)*i;window._user_groups.push(n.slice(s,a)),r++}requestDialog(window._user_groups,window._message,e)}}function requestDialog(e,t){user_ids=window._user_groups[0],$grfb.init.done(function(){FB.ui({method:"apprequests",message:t,display:"dialog",to:user_ids},function(t){if(t&&t.request){var n=!1;$j.ajax({url:"/facebook_users/record_send",type:"POST",data:{number_sent:user_ids.length,number_sent_confirmed:t.to.length,request_id:t.request,channel:window._channel,variation:window._variation,parent_user_id:window._parent_user_id}}),$j("#requestCount").html(user_ids.length+" friend "+(user_ids.length>1?"requests ":"request ")),$j(".mainContentContainer").prepend($j("#requestConfirmation")),$j("#requestConfirmation").show().delay(4e3).fadeOut(400),window._user_groups.splice(0,1)}else var n=!0;e.length>0&&postAgain(n),n?($j("#includeLoading").hide(),$j("#includeButton").show()):("undefined"==typeof window.friends_requested&&(window.friends_requested=[]),$j.each(user_ids,function(e,t){window.friends_requested.push(t)}),disableFriends(),checkBoxes())})})}function disableFriends(){window.friends_requested=$j.unique(window.friends_requested),$j.each(window.friends_requested,function(e,t){disableFriend(t)})}function postAgain(e){$j("#box").addClass("extraLightboxClass"),1==e?Lightbox.showBoxByID("lightboxPauseCanceled",null,null,!0):Lightbox.showBoxByID("lightboxPause",null,null,!0),$j("#close").remove()}function continueRequests(){Lightbox.hideBox(),requestDialog(window._user_groups,window._message)}function cancelRequests(){Lightbox.hideBox(),$j("#includeLoading").hide(),$j("#includeButton").show()}function disableFriend(e){$j(".fbFriend[fb_uid="+e+"]").removeClass("selected"),$j(".fbFriend[fb_uid="+e+"]").find(".fbFriendSelectorBox").attr("checked",!1).attr("added","true").hide(),$j(".fbFriend[fb_uid="+e+"]").find(".alreadyAdded").show(),$j(".fbFriend[fb_uid="+e+"]").find(".status").hide()}function makeAllFriends(e){makeGoodreadsFriends(e),inviteGroup("#"+e,"false")}function makeGoodreadsFriends(e){var t="#"+e+"_add",n="#"+e+"_loading",i="#"+e;$j(t).hide(),$j(n).show();var o=0,r=new Object;r.format="json",r.requests2="true",$j.each($j(i).find(".gr_friend_box:checked"),function(e,t){if($j(t).attr("gr_id")){var n=new Object;n.name=$j(t).attr("name"),n.user_id=$j(t).attr("gr_id"),n[$j(t).attr("email")]="on";var i="contact"+e;r[i]=n,o++}}),o>0?$j.ajax({url:"/friend/send_invites",format:"json",type:"POST",data:r,complete:function(){$j.each($j(i).find(".gr_friend_box:checked"),function(e,t){disableFriend($j(t).attr("id"))}),$j(n).hide(),Lightbox.hideBox(),$j(t).show()}}):($j(n).hide(),Lightbox.hideBox(),$j(t).show())}function checkBoxes(){$j.each($j(".queued_genre"),function(e,t){var n="#"+$j(t).attr("lightbox_id"),i="#"+$j(t).attr("lightbox_id")+"_box";$j(n).find('.fbFriendSelectorBox[added="true"]').length==$j(n).find(".fbFriendSelectorBox").length&&$j(i).removeClass("queued_genre")}),$j.each($j(".active_genre"),function(e,t){var n="#"+$j(t).attr("lightbox_id"),i="#"+$j(t).attr("lightbox_id")+"_box";if($j(n).find('.fbFriendSelectorBox[added="true"]').length==$j(n).find(".fbFriendSelectorBox").length){$j(i).removeClass("queued_genre");var o=$j(".queued_genre").first().html();$j(".queued_genre").first().remove(),o?$j(i).fadeOut("medium",function(){$j(i).html(o).fadeIn()}):($j(i).removeClass("active_genre").removeClass("queued_genre").addClass("inactive_genre"),$j(i).find(".addGenreButton").hide(),$j(i).find(".already_added").show(),$j(i).find(".friend_count_link").hide(),$j(i).find(".friend_count_text").show())}})}function changePhrase(e){setTimeout(function(){var t=loading_phrases[e];if($j("#loadingMessages").html(t),e+1>=loading_phrases.size())var n=0;else var n=e+1;changePhrase(n)},3500)}function changeQuote(){var e=$("quotes");if(null!=e){var t=e.childElements();null!=t&&(t[selected_quote].fade(),selected_quote=(selected_quote+1)%t.size(),setTimeout(function(){t[selected_quote].appear()},900))}}function submitMetadataAnswer(e,t){link_text=$("submit_"+e).innerHTML,iVote=parseInt(link_text),new Ajax.Request(t,{parameters:{wm:e},onSuccess:function(t){acText=$("answer_counter_"+e).innerHTML,newText=(parseInt(acText)+iVote).toString(),$("answer_counter_"+e).innerHTML=newText,"0"==newText&&$("answer_line_"+e).hide(),newLink=-1==iVote?"+1":"-1",$("submit_"+e).innerHTML=newLink,t.responseText.length>0&&(old_id=parseInt(t.responseText),oldLink=-1==iVote?"-1":"+1",$("submit_"+old_id).innerHTML=oldLink,oldText=(parseInt($("answer_counter_"+old_id).innerHTML)+-1*iVote).toString(),$("answer_counter_"+old_id).innerHTML=oldText,"0"==oldText&&$("answer_line_"+old_id).hide())}})}function quizFriendInviteSuccess(e){e.replaceWith("<span class=friendInviteSuccess>invite sent</span>")}function getGenre(){var e=location.hash.replace("#","");return""==e?null:e}function setGenre(e){location.hash=e}function activateRateBooksMoreGenreLnk(){var e=$("rateBooksMoreGenreLnk");null!=e&&e.observe("click",function(t){e.hide(),$("moreGenreLoading").show(),new Ajax.Request(e.href,{method:"GET"}),t.stop()})}function rateBooksToGenre(e,t){new Ajax.Request(t,{method:"GET",onLoading:function(){setGenre(e),window.scroll(0,0),$("rateBooksList").update("<div class='loadingPageImage'></div>"),$$(".navRow a").each(function(e){e.removeClassName("selected")}),$("nav_to_"+e).addClassName("selected")},onComplete:function(){activateRateBooksMoreGenreLnk(),"amazon_purchase_import"===e&&updateAmazonPurchaseImportUI(),WantToRead.resetShelfMenuStored()}})}function swapContent(e){var t=$j(e).data("text-id"),n=$j(e).siblings("#freeTextContainer"+t),i=$j(e).siblings("#freeText"+t);"none"==n.css("display")?swapElements(n,i,e):"none"==i.css("display")&&swapElements(i,n,e)}function swapElements(e,t,n){e.show(),t.hide(),$j(n).text("...more"==$j(n).text()?"(less)":"...more")}function activateUndoNoRecsLink(e){e.observe("click",function(t){e.hide(),e.up("div").down("img.loading").show(),e.up("form").request(),t.stop()})}function showRenameForm(e){var t=e.closest(".displayShelfName"),n=t.parent(),i=n.find(".renameUserShelf");t.hide(),i.show()}function hideRenameForm(e){var t=e.closest(".renameUserShelf"),n=t.parent(),i=n.find(".displayShelfName");t.hide(),i.show()}function submitRenameShelf(e){var t=e.find(".renameUserShelfTxt"),n=t.val();null!=n&&""!=n&&jQuery.post(e.attr("action"),e.serialize(),function(){hideRenameForm(e)})}function activateExpandDetailsLinks(){$$(".workEditions .detailsLink").each(function(e){e.observe("click",function(t){return editionDataElem=e.up(".editionData"),moreDetailsElem=editionDataElem.down(".moreDetails"),moreDetailsElem.hasClassName("hideDetails")?(moreDetailsElem.removeClassName("hideDetails"),e.update("less detail")):(moreDetailsElem.addClassName("hideDetails"),e.update("more detail")),t.stop(),!1})})}!function(e,t){function n(e){var t=ft[e]={};return X.each(e.split(tt),function(e,n){t[n]=!0}),t}function i(e,n,i){if(i===t&&1===e.nodeType){var o="data-"+n.replace(gt,"-$1").toLowerCase();if(i=e.getAttribute(o),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:mt.test(i)?X.parseJSON(i):i}catch(r){}X.data(e,n,i)}else i=t}return i}function o(e){var t;for(t in e)if(("data"!==t||!X.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function r(){return!1}function s(){return!0}function a(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function l(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function c(e,t,n){if(t=t||0,X.isFunction(t))return X.grep(e,function(e,i){var o=!!t.call(e,i,e);return o===n});if(t.nodeType)return X.grep(e,function(e){return e===t===n});if("string"==typeof t){var i=X.grep(e,function(e){return 1===e.nodeType});if(It.test(t))return X.filter(t,i,!n);t=X.filter(t,i)}return X.grep(e,function(e){return X.inArray(e,t)>=0===n})}function u(e){var t=Lt.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function h(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function d(e,t){if(1===t.nodeType&&X.hasData(e)){var n,i,o,r=X._data(e),s=X._data(t,r),a=r.events;if(a){delete s.handle,s.events={};for(n in a)for(i=0,o=a[n].length;o>i;i++)X.event.add(t,n,a[n][i])}s.data&&(s.data=X.extend({},s.data))}}function p(e,t){var n;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),X.support.html5Clone&&e.innerHTML&&!X.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Kt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.selected=e.defaultSelected:"input"===n||"textarea"===n?t.defaultValue=e.defaultValue:"script"===n&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(X.expando))}function f(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function m(e){Kt.test(e.type)&&(e.defaultChecked=e.checked)}function g(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,o=yn.length;o--;)if(t=yn[o]+n,t in e)return t;return i}function v(e,t){return e=t||e,"none"===X.css(e,"display")||!X.contains(e.ownerDocument,e)}function y(e,t){for(var n,i,o=[],r=0,s=e.length;s>r;r++)n=e[r],n.style&&(o[r]=X._data(n,"olddisplay"),t?(o[r]||"none"!==n.style.display||(n.style.display=""),""===n.style.display&&v(n)&&(o[r]=X._data(n,"olddisplay",C(n.nodeName)))):(i=nn(n,"display"),o[r]||"none"===i||X._data(n,"olddisplay",i)));for(r=0;s>r;r++)n=e[r],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[r]||"":"none"));return e}function b(e,t,n){var i=hn.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function w(e,t,n,i){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,r=0;4>o;o+=2)"margin"===n&&(r+=X.css(e,n+vn[o],!0)),i?("content"===n&&(r-=parseFloat(nn(e,"padding"+vn[o]))||0),"margin"!==n&&(r-=parseFloat(nn(e,"border"+vn[o]+"Width"))||0)):(r+=parseFloat(nn(e,"padding"+vn[o]))||0,"padding"!==n&&(r+=parseFloat(nn(e,"border"+vn[o]+"Width"))||0));return r}function _(e,t,n){var i="width"===t?e.offsetWidth:e.offsetHeight,o=!0,r=X.support.boxSizing&&"border-box"===X.css(e,"boxSizing");if(0>=i||null==i){if(i=nn(e,t),(0>i||null==i)&&(i=e.style[t]),dn.test(i))return i;o=r&&(X.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+w(e,t,n||(r?"border":"content"),o)+"px"}function C(e){if(fn[e])return fn[e];var t=X("<"+e+">").appendTo(H.body),n=t.css("display");return t.remove(),("none"===n||""===n)&&(on=H.body.appendChild(on||X.extend(H.createElement("iframe"),{frameBorder:0,width:0,height:0})),rn&&on.createElement||(rn=(on.contentWindow||on.contentDocument).document,rn.write("<!doctype html><html><body>"),rn.close()),t=rn.body.appendChild(rn.createElement(e)),n=nn(t,"display"),H.body.removeChild(on)),fn[e]=n,n}function S(e,t,n,i){var o;if(X.isArray(t))X.each(t,function(t,o){n||_n.test(e)?i(e,o):S(e+"["+("object"==typeof o?t:"")+"]",o,n,i)});else if(n||"object"!==X.type(t))i(e,t);else for(o in t)S(e+"["+o+"]",t[o],n,i)}function x(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,o,r,s=t.toLowerCase().split(tt),a=0,l=s.length;if(X.isFunction(n))for(;l>a;a++)i=s[a],r=/^\+/.test(i),r&&(i=i.substr(1)||"*"),o=e[i]=e[i]||[],o[r?"unshift":"push"](n)}}function E(e,n,i,o,r,s){r=r||n.dataTypes[0],s=s||{},s[r]=!0;for(var a,l=e[r],c=0,u=l?l.length:0,h=e===On;u>c&&(h||!a);c++)a=l[c](n,i,o),"string"==typeof a&&(!h||s[a]?a=t:(n.dataTypes.unshift(a),a=E(e,n,i,o,a,s)));return!h&&a||s["*"]||(a=E(e,n,i,o,"*",s)),a}function k(e,n){var i,o,r=X.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((r[i]?e:o||(o={}))[i]=n[i]);o&&X.extend(!0,e,o)}function T(e,n,i){var o,r,s,a,l=e.contents,c=e.dataTypes,u=e.responseFields;for(r in u)r in i&&(n[u[r]]=i[r]);for(;"*"===c[0];)c.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("content-type"));if(o)for(r in l)if(l[r]&&l[r].test(o)){c.unshift(r);break}if(c[0]in i)s=c[0];else{for(r in i){if(!c[0]||e.converters[r+" "+c[0]]){s=r;break}a||(a=r)}s=s||a}return s?(s!==c[0]&&c.unshift(s),i[s]):void 0}function D(e,t){var n,i,o,r,s=e.dataTypes.slice(),a=s[0],l={},c=0;if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),s[1])for(n in e.converters)l[n.toLowerCase()]=e.converters[n];for(;o=s[++c];)if("*"!==o){if("*"!==a&&a!==o){if(n=l[a+" "+o]||l["* "+o],!n)for(i in l)if(r=i.split(" "),r[1]===o&&(n=l[a+" "+r[0]]||l["* "+r[0]])){n===!0?n=l[i]:l[i]!==!0&&(o=r[0],s.splice(c--,0,o));break}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(u){return{state:"parsererror",error:n?u:"No conversion from "+a+" to "+o}}}a=o}return{state:"success",data:t}}function M(){try{return new e.XMLHttpRequest}catch(t){}}function j(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function R(){return setTimeout(function(){Gn=t},0),Gn=X.now()}function A(e,t){X.each(t,function(t,n){for(var i=(ei[t]||[]).concat(ei["*"]),o=0,r=i.length;r>o;o++)if(i[o].call(e,t,n))return})}function N(e,t,n){var i,o=0,r=Zn.length,s=X.Deferred().always(function(){delete a.elem}),a=function(){for(var t=Gn||R(),n=Math.max(0,l.startTime+l.duration-t),i=n/l.duration||0,o=1-i,r=0,a=l.tweens.length;a>r;r++)l.tweens[r].run(o);return s.notifyWith(e,[l,o,n]),1>o&&a?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:X.extend({},t),opts:X.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Gn||R(),duration:n.duration,tweens:[],createTween:function(t,n){var i=X.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(i),i},stop:function(t){for(var n=0,i=t?l.tweens.length:0;i>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(P(c,l.opts.specialEasing);r>o;o++)if(i=Zn[o].call(l,e,c,l.opts))return i;return A(l,c),X.isFunction(l.opts.start)&&l.opts.start.call(e,l),X.fx.timer(X.extend(a,{anim:l,queue:l.opts.queue,elem:e})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function P(e,t){var n,i,o,r,s;for(n in e)if(i=X.camelCase(n),o=t[i],r=e[n],X.isArray(r)&&(o=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),s=X.cssHooks[i],s&&"expand"in s){r=s.expand(r),delete e[i];for(n in r)n in e||(e[n]=r[n],t[n]=o)}else t[i]=o}function $(e,t,n){var i,o,r,s,a,l,c,u,h,d=this,p=e.style,f={},m=[],g=e.nodeType&&v(e);n.queue||(u=X._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,h=u.empty.fire,u.empty.fire=function(){u.unqueued||h()}),u.unqueued++,d.always(function(){d.always(function(){u.unqueued--,X.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===X.css(e,"display")&&"none"===X.css(e,"float")&&(X.support.inlineBlockNeedsLayout&&"inline"!==C(e.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",X.support.shrinkWrapBlocks||d.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(i in t)if(r=t[i],Qn.exec(r)){if(delete t[i],l=l||"toggle"===r,r===(g?"hide":"show"))continue;m.push(i)}if(s=m.length){a=X._data(e,"fxshow")||X._data(e,"fxshow",{}),"hidden"in a&&(g=a.hidden),l&&(a.hidden=!g),g?X(e).show():d.done(function(){X(e).hide()}),d.done(function(){var t;X.removeData(e,"fxshow",!0);for(t in f)X.style(e,t,f[t])});for(i=0;s>i;i++)o=m[i],c=d.createTween(o,g?a[o]:0),f[o]=a[o]||X.style(e,o),o in a||(a[o]=c.start,g&&(c.end=c.start,c.start="width"===o||"height"===o?1:0))}}function I(e,t,n,i,o){return new I.prototype.init(e,t,n,i,o)}function O(e,t){var n,i={height:e},o=0;for(t=t?1:0;4>o;o+=2-t)n=vn[o],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function F(e){return X.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var L,B,H=e.document,U=e.location,W=e.navigator,z=e.jQuery,q=e.$,V=Array.prototype.push,Y=Array.prototype.slice,G=Array.prototype.indexOf,K=Object.prototype.toString,Q=Object.prototype.hasOwnProperty,J=String.prototype.trim,X=function(e,t){return new X.fn.init(e,t,L)
},Z=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,et=/\S/,tt=/\s+/,nt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,it=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,ot=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rt=/^[\],:{}\s]*$/,st=/(?:^|:|,)(?:\s*\[)+/g,at=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,lt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,ct=/^-ms-/,ut=/-([\da-z])/gi,ht=function(e,t){return(t+"").toUpperCase()},dt=function(){H.addEventListener?(H.removeEventListener("DOMContentLoaded",dt,!1),X.ready()):"complete"===H.readyState&&(H.detachEvent("onreadystatechange",dt),X.ready())},pt={};X.fn=X.prototype={constructor:X,init:function(e,n,i){var o,r,s;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("string"==typeof e){if(o="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:it.exec(e),!o||!o[1]&&n)return!n||n.jquery?(n||i).find(e):this.constructor(n).find(e);if(o[1])return n=n instanceof X?n[0]:n,s=n&&n.nodeType?n.ownerDocument||n:H,e=X.parseHTML(o[1],s,!0),ot.test(o[1])&&X.isPlainObject(n)&&this.attr.call(e,n,!0),X.merge(this,e);if(r=H.getElementById(o[2]),r&&r.parentNode){if(r.id!==o[2])return i.find(e);this.length=1,this[0]=r}return this.context=H,this.selector=e,this}return X.isFunction(e)?i.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),X.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return Y.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e,t,n){var i=X.merge(this.constructor(),e);return i.prevObject=this,i.context=this.context,"find"===t?i.selector=this.selector+(this.selector?" ":"")+n:t&&(i.selector=this.selector+"."+t+"("+n+")"),i},each:function(e,t){return X.each(this,e,t)},ready:function(e){return X.ready.promise().done(e),this},eq:function(e){return e=+e,-1===e?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(Y.apply(this,arguments),"slice",Y.call(arguments).join(","))},map:function(e){return this.pushStack(X.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:[].sort,splice:[].splice},X.fn.init.prototype=X.fn,X.extend=X.fn.extend=function(){var e,n,i,o,r,s,a=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},l=2),"object"==typeof a||X.isFunction(a)||(a={}),c===l&&(a=this,--l);c>l;l++)if(null!=(e=arguments[l]))for(n in e)i=a[n],o=e[n],a!==o&&(u&&o&&(X.isPlainObject(o)||(r=X.isArray(o)))?(r?(r=!1,s=i&&X.isArray(i)?i:[]):s=i&&X.isPlainObject(i)?i:{},a[n]=X.extend(u,s,o)):o!==t&&(a[n]=o));return a},X.extend({noConflict:function(t){return e.$===X&&(e.$=q),t&&e.jQuery===X&&(e.jQuery=z),X},isReady:!1,readyWait:1,holdReady:function(e){e?X.readyWait++:X.ready(!0)},ready:function(e){if(e===!0?!--X.readyWait:!X.isReady){if(!H.body)return setTimeout(X.ready,1);X.isReady=!0,e!==!0&&--X.readyWait>0||(B.resolveWith(H,[X]),X.fn.trigger&&X(H).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===X.type(e)},isArray:Array.isArray||function(e){return"array"===X.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):pt[K.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==X.type(e)||e.nodeType||X.isWindow(e))return!1;try{if(e.constructor&&!Q.call(e,"constructor")&&!Q.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var i;for(i in e);return i===t||Q.call(e,i)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var i;return e&&"string"==typeof e?("boolean"==typeof t&&(n=t,t=0),t=t||H,(i=ot.exec(e))?[t.createElement(i[1])]:(i=X.buildFragment([e],t,n?null:[]),X.merge([],(i.cacheable?X.clone(i.fragment):i.fragment).childNodes))):null},parseJSON:function(t){return t&&"string"==typeof t?(t=X.trim(t),e.JSON&&e.JSON.parse?e.JSON.parse(t):rt.test(t.replace(at,"@").replace(lt,"]").replace(st,""))?new Function("return "+t)():void X.error("Invalid JSON: "+t)):null},parseXML:function(n){var i,o;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(o=new DOMParser,i=o.parseFromString(n,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(n))}catch(r){i=t}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||X.error("Invalid XML: "+n),i},noop:function(){},globalEval:function(t){t&&et.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ct,"ms-").replace(ut,ht)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,i){var o,r=0,s=e.length,a=s===t||X.isFunction(e);if(i)if(a){for(o in e)if(n.apply(e[o],i)===!1)break}else for(;s>r&&n.apply(e[r++],i)!==!1;);else if(a){for(o in e)if(n.call(e[o],o,e[o])===!1)break}else for(;s>r&&n.call(e[r],r,e[r++])!==!1;);return e},trim:J&&!J.call("\ufeff\xa0")?function(e){return null==e?"":J.call(e)}:function(e){return null==e?"":(e+"").replace(nt,"")},makeArray:function(e,t){var n,i=t||[];return null!=e&&(n=X.type(e),null==e.length||"string"===n||"function"===n||"regexp"===n||X.isWindow(e)?V.call(i,e):X.merge(i,e)),i},inArray:function(e,t,n){var i;if(t){if(G)return G.call(t,e,n);for(i=t.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var i=n.length,o=e.length,r=0;if("number"==typeof i)for(;i>r;r++)e[o++]=n[r];else for(;n[r]!==t;)e[o++]=n[r++];return e.length=o,e},grep:function(e,t,n){var i,o=[],r=0,s=e.length;for(n=!!n;s>r;r++)i=!!t(e[r],r),n!==i&&o.push(e[r]);return o},map:function(e,n,i){var o,r,s=[],a=0,l=e.length,c=e instanceof X||l!==t&&"number"==typeof l&&(l>0&&e[0]&&e[l-1]||0===l||X.isArray(e));if(c)for(;l>a;a++)o=n(e[a],a,i),null!=o&&(s[s.length]=o);else for(r in e)o=n(e[r],r,i),null!=o&&(s[s.length]=o);return s.concat.apply([],s)},guid:1,proxy:function(e,n){var i,o,r;return"string"==typeof n&&(i=e[n],n=e,e=i),X.isFunction(e)?(o=Y.call(arguments,2),r=function(){return e.apply(n,o.concat(Y.call(arguments)))},r.guid=e.guid=e.guid||X.guid++,r):t},access:function(e,n,i,o,r,s,a){var l,c=null==i,u=0,h=e.length;if(i&&"object"==typeof i){for(u in i)X.access(e,n,u,i[u],1,s,o);r=1}else if(o!==t){if(l=a===t&&X.isFunction(o),c&&(l?(l=n,n=function(e,t,n){return l.call(X(e),n)}):(n.call(e,o),n=null)),n)for(;h>u;u++)n(e[u],i,l?o.call(e[u],u,n(e[u],i)):o,a);r=1}return r?e:c?n.call(e):h?n(e[0],i):s},now:function(){return(new Date).getTime()}}),X.ready.promise=function(t){if(!B)if(B=X.Deferred(),"complete"===H.readyState)setTimeout(X.ready,1);else if(H.addEventListener)H.addEventListener("DOMContentLoaded",dt,!1),e.addEventListener("load",X.ready,!1);else{H.attachEvent("onreadystatechange",dt),e.attachEvent("onload",X.ready);var n=!1;try{n=null==e.frameElement&&H.documentElement}catch(i){}n&&n.doScroll&&!function o(){if(!X.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}X.ready()}}()}return B.promise(t)},X.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){pt["[object "+t+"]"]=t.toLowerCase()}),L=X(H);var ft={};X.Callbacks=function(e){e="string"==typeof e?ft[e]||n(e):X.extend({},e);var i,o,r,s,a,l,c=[],u=!e.once&&[],h=function(t){for(i=e.memory&&t,o=!0,l=s||0,s=0,a=c.length,r=!0;c&&a>l;l++)if(c[l].apply(t[0],t[1])===!1&&e.stopOnFalse){i=!1;break}r=!1,c&&(u?u.length&&h(u.shift()):i?c=[]:d.disable())},d={add:function(){if(c){var t=c.length;!function n(t){X.each(t,function(t,i){var o=X.type(i);"function"===o?e.unique&&d.has(i)||c.push(i):i&&i.length&&"string"!==o&&n(i)})}(arguments),r?a=c.length:i&&(s=t,h(i))}return this},remove:function(){return c&&X.each(arguments,function(e,t){for(var n;(n=X.inArray(t,c,n))>-1;)c.splice(n,1),r&&(a>=n&&a--,l>=n&&l--)}),this},has:function(e){return X.inArray(e,c)>-1},empty:function(){return c=[],this},disable:function(){return c=u=i=t,this},disabled:function(){return!c},lock:function(){return u=t,i||d.disable(),this},locked:function(){return!u},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!c||o&&!u||(r?u.push(t):h(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!o}};return d},X.extend({Deferred:function(e){var t=[["resolve","done",X.Callbacks("once memory"),"resolved"],["reject","fail",X.Callbacks("once memory"),"rejected"],["notify","progress",X.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return X.Deferred(function(n){X.each(t,function(t,i){var r=i[0],s=e[t];o[i[1]](X.isFunction(s)?function(){var e=s.apply(this,arguments);e&&X.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[r+"With"](this===o?n:this,[e])}:n[r])}),e=null}).promise()},promise:function(e){return null!=e?X.extend(e,i):i}},o={};return i.pipe=i.then,X.each(t,function(e,r){var s=r[2],a=r[3];i[r[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),o[r[0]]=s.fire,o[r[0]+"With"]=s.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(e){var t,n,i,o=0,r=Y.call(arguments),s=r.length,a=1!==s||e&&X.isFunction(e.promise)?s:0,l=1===a?e:X.Deferred(),c=function(e,n,i){return function(o){n[e]=this,i[e]=arguments.length>1?Y.call(arguments):o,i===t?l.notifyWith(n,i):--a||l.resolveWith(n,i)}};if(s>1)for(t=new Array(s),n=new Array(s),i=new Array(s);s>o;o++)r[o]&&X.isFunction(r[o].promise)?r[o].promise().done(c(o,i,r)).fail(l.reject).progress(c(o,n,t)):--a;return a||l.resolveWith(i,r),l.promise()}}),X.support=function(){var t,n,i,o,r,s,a,l,c,u,h,d=H.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*"),i=d.getElementsByTagName("a")[0],!n||!i||!n.length)return{};o=H.createElement("select"),r=o.appendChild(H.createElement("option")),s=d.getElementsByTagName("input")[0],i.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:3===d.firstChild.nodeType,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:"/a"===i.getAttribute("href"),opacity:/^0.5/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:"on"===s.value,optSelected:r.selected,getSetAttribute:"t"!==d.className,enctype:!!H.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==H.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===H.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},s.checked=!0,t.noCloneChecked=s.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!r.disabled;try{delete d.test}catch(p){t.deleteExpando=!1}if(!d.addEventListener&&d.attachEvent&&d.fireEvent&&(d.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),d.cloneNode(!0).fireEvent("onclick"),d.detachEvent("onclick",h)),s=H.createElement("input"),s.value="t",s.setAttribute("type","radio"),t.radioValue="t"===s.value,s.setAttribute("checked","checked"),s.setAttribute("name","t"),d.appendChild(s),a=H.createDocumentFragment(),a.appendChild(d.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=s.checked,a.removeChild(s),a.appendChild(d),d.attachEvent)for(c in{submit:!0,change:!0,focusin:!0})l="on"+c,u=l in d,u||(d.setAttribute(l,"return;"),u="function"==typeof d[l]),t[c+"Bubbles"]=u;return X(function(){var n,i,o,r,s="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=H.getElementsByTagName("body")[0];a&&(n=H.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),i=H.createElement("div"),n.appendChild(i),i.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=i.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",u=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=u&&0===o[0].offsetHeight,i.innerHTML="",i.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===i.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==a.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=H.createElement("div"),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",i.appendChild(r),t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),"undefined"!=typeof i.style.zoom&&(i.innerHTML="",i.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===i.offsetWidth,i.style.display="block",i.style.overflow="visible",i.innerHTML="<div></div>",i.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==i.offsetWidth,n.style.zoom=1),a.removeChild(n),n=i=o=r=null)}),a.removeChild(d),n=i=o=r=s=a=d=null,t}();var mt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,gt=/([A-Z])/g;X.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(X.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?X.cache[e[X.expando]]:e[X.expando],!!e&&!o(e)},data:function(e,n,i,o){if(X.acceptData(e)){var r,s,a=X.expando,l="string"==typeof n,c=e.nodeType,u=c?X.cache:e,h=c?e[a]:e[a]&&a;if(h&&u[h]&&(o||u[h].data)||!l||i!==t)return h||(c?e[a]=h=X.deletedIds.pop()||X.guid++:h=a),u[h]||(u[h]={},c||(u[h].toJSON=X.noop)),("object"==typeof n||"function"==typeof n)&&(o?u[h]=X.extend(u[h],n):u[h].data=X.extend(u[h].data,n)),r=u[h],o||(r.data||(r.data={}),r=r.data),i!==t&&(r[X.camelCase(n)]=i),l?(s=r[n],null==s&&(s=r[X.camelCase(n)])):s=r,s}},removeData:function(e,t,n){if(X.acceptData(e)){var i,r,s,a=e.nodeType,l=a?X.cache:e,c=a?e[X.expando]:X.expando;if(l[c]){if(t&&(i=n?l[c]:l[c].data)){X.isArray(t)||(t in i?t=[t]:(t=X.camelCase(t),t=t in i?[t]:t.split(" ")));for(r=0,s=t.length;s>r;r++)delete i[t[r]];if(!(n?o:X.isEmptyObject)(i))return}(n||(delete l[c].data,o(l[c])))&&(a?X.cleanData([e],!0):X.support.deleteExpando||l!=l.window?delete l[c]:l[c]=null)}}},_data:function(e,t,n){return X.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&X.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),X.fn.extend({data:function(e,n){var o,r,s,a,l,c=this[0],u=0,h=null;if(e===t){if(this.length&&(h=X.data(c),1===c.nodeType&&!X._data(c,"parsedAttrs"))){for(s=c.attributes,l=s.length;l>u;u++)a=s[u].name,a.indexOf("data-")||(a=X.camelCase(a.substring(5)),i(c,a,h[a]));X._data(c,"parsedAttrs",!0)}return h}return"object"==typeof e?this.each(function(){X.data(this,e)}):(o=e.split(".",2),o[1]=o[1]?"."+o[1]:"",r=o[1]+"!",X.access(this,function(n){return n===t?(h=this.triggerHandler("getData"+r,[o[0]]),h===t&&c&&(h=X.data(c,e),h=i(c,e,h)),h===t&&o[1]?this.data(o[0]):h):(o[1]=n,void this.each(function(){var t=X(this);t.triggerHandler("setData"+r,o),X.data(this,e,n),t.triggerHandler("changeData"+r,o)}))},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){X.removeData(this,e)})}}),X.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=X._data(e,t),n&&(!i||X.isArray(n)?i=X._data(e,t,X.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=X.queue(e,t),i=n.length,o=n.shift(),r=X._queueHooks(e,t),s=function(){X.dequeue(e,t)};"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===t&&n.unshift("inprogress"),delete r.stop,o.call(e,s,r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return X._data(e,n)||X._data(e,n,{empty:X.Callbacks("once memory").add(function(){X.removeData(e,t+"queue",!0),X.removeData(e,n,!0)})})}}),X.fn.extend({queue:function(e,n){var i=2;return"string"!=typeof e&&(n=e,e="fx",i--),arguments.length<i?X.queue(this[0],e):n===t?this:this.each(function(){var t=X.queue(this,e,n);X._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&X.dequeue(this,e)})},dequeue:function(e){return this.each(function(){X.dequeue(this,e)})},delay:function(e,t){return e=X.fx?X.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var i,o=1,r=X.Deferred(),s=this,a=this.length,l=function(){--o||r.resolveWith(s,[s])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";a--;)i=X._data(s[a],e+"queueHooks"),i&&i.empty&&(o++,i.empty.add(l));return l(),r.promise(n)}});var vt,yt,bt,wt=/[\t\r\n]/g,_t=/\r/g,Ct=/^(?:button|input)$/i,St=/^(?:button|input|object|select|textarea)$/i,xt=/^a(?:rea|)$/i,Et=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,kt=X.support.getSetAttribute;X.fn.extend({attr:function(e,t){return X.access(this,X.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){X.removeAttr(this,e)})},prop:function(e,t){return X.access(this,X.prop,e,t,arguments.length>1)},removeProp:function(e){return e=X.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,i,o,r,s,a;if(X.isFunction(e))return this.each(function(t){X(this).addClass(e.call(this,t,this.className))});if(e&&"string"==typeof e)for(t=e.split(tt),n=0,i=this.length;i>n;n++)if(o=this[n],1===o.nodeType)if(o.className||1!==t.length){for(r=" "+o.className+" ",s=0,a=t.length;a>s;s++)r.indexOf(" "+t[s]+" ")<0&&(r+=t[s]+" ");o.className=X.trim(r)}else o.className=e;return this},removeClass:function(e){var n,i,o,r,s,a,l;if(X.isFunction(e))return this.each(function(t){X(this).removeClass(e.call(this,t,this.className))});if(e&&"string"==typeof e||e===t)for(n=(e||"").split(tt),a=0,l=this.length;l>a;a++)if(o=this[a],1===o.nodeType&&o.className){for(i=(" "+o.className+" ").replace(wt," "),r=0,s=n.length;s>r;r++)for(;i.indexOf(" "+n[r]+" ")>=0;)i=i.replace(" "+n[r]+" "," ");o.className=e?X.trim(i):""}return this},toggleClass:function(e,t){var n=typeof e,i="boolean"==typeof t;return this.each(X.isFunction(e)?function(n){X(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var o,r=0,s=X(this),a=t,l=e.split(tt);o=l[r++];)a=i?a:!s.hasClass(o),s[a?"addClass":"removeClass"](o);else("undefined"===n||"boolean"===n)&&(this.className&&X._data(this,"__className__",this.className),this.className=this.className||e===!1?"":X._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(wt," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,i,o,r=this[0];{if(arguments.length)return o=X.isFunction(e),this.each(function(i){var r,s=X(this);1===this.nodeType&&(r=o?e.call(this,i,s.val()):e,null==r?r="":"number"==typeof r?r+="":X.isArray(r)&&(r=X.map(r,function(e){return null==e?"":e+""})),n=X.valHooks[this.type]||X.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,r,"value")!==t||(this.value=r))});if(r)return n=X.valHooks[r.type]||X.valHooks[r.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(r,"value"))!==t?i:(i=r.value,"string"==typeof i?i.replace(_t,""):null==i?"":i)}}}),X.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,n,i=e.options,o=e.selectedIndex,r="select-one"===e.type||0>o,s=r?null:[],a=r?o+1:i.length,l=0>o?a:r?o:0;a>l;l++)if(n=i[l],!(!n.selected&&l!==o||(X.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&X.nodeName(n.parentNode,"optgroup"))){if(t=X(n).val(),r)return t;s.push(t)}return s},set:function(e,t){var n=X.makeArray(t);return X(e).find("option").each(function(){this.selected=X.inArray(X(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,i,o){var r,s,a,l=e.nodeType;if(e&&3!==l&&8!==l&&2!==l)return o&&X.isFunction(X.fn[n])?X(e)[n](i):"undefined"==typeof e.getAttribute?X.prop(e,n,i):(a=1!==l||!X.isXMLDoc(e),a&&(n=n.toLowerCase(),s=X.attrHooks[n]||(Et.test(n)?yt:vt)),i!==t?null===i?void X.removeAttr(e,n):s&&"set"in s&&a&&(r=s.set(e,i,n))!==t?r:(e.setAttribute(n,i+""),i):s&&"get"in s&&a&&null!==(r=s.get(e,n))?r:(r=e.getAttribute(n),null===r?t:r))},removeAttr:function(e,t){var n,i,o,r,s=0;if(t&&1===e.nodeType)for(i=t.split(tt);s<i.length;s++)o=i[s],o&&(n=X.propFix[o]||o,r=Et.test(o),r||X.attr(e,o,""),e.removeAttribute(kt?o:n),r&&n in e&&(e[n]=!1))},attrHooks:{type:{set:function(e,t){if(Ct.test(e.nodeName)&&e.parentNode)X.error("type property can't be changed");else if(!X.support.radioValue&&"radio"===t&&X.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return vt&&X.nodeName(e,"button")?vt.get(e,t):t in e?e.value:null},set:function(e,t,n){return vt&&X.nodeName(e,"button")?vt.set(e,t,n):void(e.value=t)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,i){var o,r,s,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return s=1!==a||!X.isXMLDoc(e),s&&(n=X.propFix[n]||n,r=X.propHooks[n]),i!==t?r&&"set"in r&&(o=r.set(e,i,n))!==t?o:e[n]=i:r&&"get"in r&&null!==(o=r.get(e,n))?o:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):St.test(e.nodeName)||xt.test(e.nodeName)&&e.href?0:t}}}}),yt={get:function(e,n){var i,o=X.prop(e,n);return o===!0||"boolean"!=typeof o&&(i=e.getAttributeNode(n))&&i.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var i;return t===!1?X.removeAttr(e,n):(i=X.propFix[n]||n,i in e&&(e[i]=!0),e.setAttribute(n,n.toLowerCase())),n}},kt||(bt={name:!0,id:!0,coords:!0},vt=X.valHooks.button={get:function(e,n){var i;return i=e.getAttributeNode(n),i&&(bt[n]?""!==i.value:i.specified)?i.value:t},set:function(e,t,n){var i=e.getAttributeNode(n);return i||(i=H.createAttribute(n),e.setAttributeNode(i)),i.value=t+""}},X.each(["width","height"],function(e,t){X.attrHooks[t]=X.extend(X.attrHooks[t],{set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}})}),X.attrHooks.contenteditable={get:vt.get,set:function(e,t,n){""===t&&(t="false"),vt.set(e,t,n)}}),X.support.hrefNormalized||X.each(["href","src","width","height"],function(e,n){X.attrHooks[n]=X.extend(X.attrHooks[n],{get:function(e){var i=e.getAttribute(n,2);return null===i?t:i}})}),X.support.style||(X.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),X.support.optSelected||(X.propHooks.selected=X.extend(X.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),X.support.enctype||(X.propFix.enctype="encoding"),X.support.checkOn||X.each(["radio","checkbox"],function(){X.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),X.each(["radio","checkbox"],function(){X.valHooks[this]=X.extend(X.valHooks[this],{set:function(e,t){return X.isArray(t)?e.checked=X.inArray(X(e).val(),t)>=0:void 0}})});var Tt=/^(?:textarea|input|select)$/i,Dt=/^([^\.]*|)(?:\.(.+)|)$/,Mt=/(?:^|\s)hover(\.\S+|)\b/,jt=/^key/,Rt=/^(?:mouse|contextmenu)|click/,At=/^(?:focusinfocus|focusoutblur)$/,Nt=function(e){return X.event.special.hover?e:e.replace(Mt,"mouseenter$1 mouseleave$1")};X.event={add:function(e,n,i,o,r){var s,a,l,c,u,h,d,p,f,m,g;if(3!==e.nodeType&&8!==e.nodeType&&n&&i&&(s=X._data(e))){for(i.handler&&(f=i,i=f.handler,r=f.selector),i.guid||(i.guid=X.guid++),l=s.events,l||(s.events=l={}),a=s.handle,a||(s.handle=a=function(e){return"undefined"==typeof X||e&&X.event.triggered===e.type?t:X.event.dispatch.apply(a.elem,arguments)},a.elem=e),n=X.trim(Nt(n)).split(" "),c=0;c<n.length;c++)u=Dt.exec(n[c])||[],h=u[1],d=(u[2]||"").split(".").sort(),g=X.event.special[h]||{},h=(r?g.delegateType:g.bindType)||h,g=X.event.special[h]||{},p=X.extend({type:h,origType:u[1],data:o,handler:i,guid:i.guid,selector:r,needsContext:r&&X.expr.match.needsContext.test(r),namespace:d.join(".")},f),m=l[h],m||(m=l[h]=[],m.delegateCount=0,g.setup&&g.setup.call(e,o,d,a)!==!1||(e.addEventListener?e.addEventListener(h,a,!1):e.attachEvent&&e.attachEvent("on"+h,a))),g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=i.guid)),r?m.splice(m.delegateCount++,0,p):m.push(p),X.event.global[h]=!0;e=null}},global:{},remove:function(e,t,n,i,o){var r,s,a,l,c,u,h,d,p,f,m,g=X.hasData(e)&&X._data(e);if(g&&(d=g.events)){for(t=X.trim(Nt(t||"")).split(" "),r=0;r<t.length;r++)if(s=Dt.exec(t[r])||[],a=l=s[1],c=s[2],a){for(p=X.event.special[a]||{},a=(i?p.delegateType:p.bindType)||a,f=d[a]||[],u=f.length,c=c?new RegExp("(^|\\.)"+c.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=0;h<f.length;h++)m=f[h],!o&&l!==m.origType||n&&n.guid!==m.guid||c&&!c.test(m.namespace)||i&&i!==m.selector&&("**"!==i||!m.selector)||(f.splice(h--,1),m.selector&&f.delegateCount--,p.remove&&p.remove.call(e,m));0===f.length&&u!==f.length&&(p.teardown&&p.teardown.call(e,c,g.handle)!==!1||X.removeEvent(e,a,g.handle),delete d[a])}else for(a in d)X.event.remove(e,a+t[r],n,i,!0);X.isEmptyObject(d)&&(delete g.handle,X.removeData(e,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,i,o,r){if(!o||3!==o.nodeType&&8!==o.nodeType){var s,a,l,c,u,h,d,p,f,m,g=n.type||n,v=[];if(!At.test(g+X.event.triggered)&&(g.indexOf("!")>=0&&(g=g.slice(0,-1),a=!0),g.indexOf(".")>=0&&(v=g.split("."),g=v.shift(),v.sort()),o&&!X.event.customEvent[g]||X.event.global[g]))if(n="object"==typeof n?n[X.expando]?n:new X.Event(g,n):new X.Event(g),n.type=g,n.isTrigger=!0,n.exclusive=a,n.namespace=v.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=g.indexOf(":")<0?"on"+g:"",o){if(n.result=t,n.target||(n.target=o),i=null!=i?X.makeArray(i):[],i.unshift(n),d=X.event.special[g]||{},!d.trigger||d.trigger.apply(o,i)!==!1){if(f=[[o,d.bindType||g]],!r&&!d.noBubble&&!X.isWindow(o)){for(m=d.delegateType||g,c=At.test(m+g)?o:o.parentNode,u=o;c;c=c.parentNode)f.push([c,m]),u=c;u===(o.ownerDocument||H)&&f.push([u.defaultView||u.parentWindow||e,m])}for(l=0;l<f.length&&!n.isPropagationStopped();l++)c=f[l][0],n.type=f[l][1],p=(X._data(c,"events")||{})[n.type]&&X._data(c,"handle"),p&&p.apply(c,i),p=h&&c[h],p&&X.acceptData(c)&&p.apply&&p.apply(c,i)===!1&&n.preventDefault();return n.type=g,r||n.isDefaultPrevented()||d._default&&d._default.apply(o.ownerDocument,i)!==!1||"click"===g&&X.nodeName(o,"a")||!X.acceptData(o)||h&&o[g]&&("focus"!==g&&"blur"!==g||0!==n.target.offsetWidth)&&!X.isWindow(o)&&(u=o[h],u&&(o[h]=null),X.event.triggered=g,o[g](),X.event.triggered=t,u&&(o[h]=u)),n.result}}else{s=X.cache;for(l in s)s[l].events&&s[l].events[g]&&X.event.trigger(n,i,s[l].handle.elem,!0)}}},dispatch:function(n){n=X.event.fix(n||e.event);var i,o,r,s,a,l,c,u,h,d=(X._data(this,"events")||{})[n.type]||[],p=d.delegateCount,f=Y.call(arguments),m=!n.exclusive&&!n.namespace,g=X.event.special[n.type]||{},v=[];if(f[0]=n,n.delegateTarget=this,!g.preDispatch||g.preDispatch.call(this,n)!==!1){if(p&&(!n.button||"click"!==n.type))for(r=n.target;r!=this;r=r.parentNode||this)if(r.disabled!==!0||"click"!==n.type){for(a={},c=[],i=0;p>i;i++)u=d[i],h=u.selector,a[h]===t&&(a[h]=u.needsContext?X(h,this).index(r)>=0:X.find(h,this,null,[r]).length),a[h]&&c.push(u);c.length&&v.push({elem:r,matches:c})}for(d.length>p&&v.push({elem:this,matches:d.slice(p)}),i=0;i<v.length&&!n.isPropagationStopped();i++)for(l=v[i],n.currentTarget=l.elem,o=0;o<l.matches.length&&!n.isImmediatePropagationStopped();o++)u=l.matches[o],(m||!n.namespace&&!u.namespace||n.namespace_re&&n.namespace_re.test(u.namespace))&&(n.data=u.data,n.handleObj=u,s=((X.event.special[u.origType]||{}).handle||u.handler).apply(l.elem,f),s!==t&&(n.result=s,s===!1&&(n.preventDefault(),n.stopPropagation())));return g.postDispatch&&g.postDispatch.call(this,n),n.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var i,o,r,s=n.button,a=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||H,o=i.documentElement,r=i.body,e.pageX=n.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[X.expando])return e;var t,n,i=e,o=X.event.fixHooks[e.type]||{},r=o.props?this.props.concat(o.props):this.props;for(e=X.Event(i),t=r.length;t;)n=r[--t],e[n]=i[n];return e.target||(e.target=i.srcElement||H),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,i):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){X.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,i){var o=X.extend(new X.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?X.event.trigger(o,null,t):X.event.dispatch.call(t,o),o.isDefaultPrevented()&&n.preventDefault()}},X.event.handle=X.event.dispatch,X.removeEvent=H.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var i="on"+t;e.detachEvent&&("undefined"==typeof e[i]&&(e[i]=null),e.detachEvent(i,n))},X.Event=function(e,t){return this instanceof X.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?s:r):this.type=e,t&&X.extend(this,t),this.timeStamp=e&&e.timeStamp||X.now(),void(this[X.expando]=!0)):new X.Event(e,t)},X.Event.prototype={preventDefault:function(){this.isDefaultPrevented=s;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=s;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=s,this.stopPropagation()},isDefaultPrevented:r,isPropagationStopped:r,isImmediatePropagationStopped:r},X.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){X.event.special[e]={delegateType:t,bindType:t,handle:function(e){{var n,i=this,o=e.relatedTarget,r=e.handleObj;r.selector}return(!o||o!==i&&!X.contains(i,o))&&(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),X.support.submitBubbles||(X.event.special.submit={setup:function(){return X.nodeName(this,"form")?!1:void X.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,i=X.nodeName(n,"input")||X.nodeName(n,"button")?n.form:t;i&&!X._data(i,"_submit_attached")&&(X.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),X._data(i,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&X.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return X.nodeName(this,"form")?!1:void X.event.remove(this,"._submit")}}),X.support.changeBubbles||(X.event.special.change={setup:function(){return Tt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(X.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),X.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),X.event.simulate("change",this,e,!0)})),!1):void X.event.add(this,"beforeactivate._change",function(e){var t=e.target;Tt.test(t.nodeName)&&!X._data(t,"_change_attached")&&(X.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||X.event.simulate("change",this.parentNode,e,!0)
}),X._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return X.event.remove(this,"._change"),!Tt.test(this.nodeName)}}),X.support.focusinBubbles||X.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,i=function(e){X.event.simulate(t,e.target,X.event.fix(e),!0)};X.event.special[t]={setup:function(){0===n++&&H.addEventListener(e,i,!0)},teardown:function(){0===--n&&H.removeEventListener(e,i,!0)}}}),X.fn.extend({on:function(e,n,i,o,s){var a,l;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=t);for(l in e)this.on(l,n,i,e[l],s);return this}if(null==i&&null==o?(o=n,i=n=t):null==o&&("string"==typeof n?(o=i,i=t):(o=i,i=n,n=t)),o===!1)o=r;else if(!o)return this;return 1===s&&(a=o,o=function(e){return X().off(e),a.apply(this,arguments)},o.guid=a.guid||(a.guid=X.guid++)),this.each(function(){X.event.add(this,e,o,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,n,i){var o,s;if(e&&e.preventDefault&&e.handleObj)return o=e.handleObj,X(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof e){for(s in e)this.off(s,n,e[s]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=t),i===!1&&(i=r),this.each(function(){X.event.remove(this,e,i,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return X(this.context).on(e,this.selector,t,n),this},die:function(e,t){return X(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){X.event.trigger(e,t,this)})},triggerHandler:function(e,t){return this[0]?X.event.trigger(e,t,this[0],!0):void 0},toggle:function(e){var t=arguments,n=e.guid||X.guid++,i=0,o=function(n){var o=(X._data(this,"lastToggle"+e.guid)||0)%i;return X._data(this,"lastToggle"+e.guid,o+1),n.preventDefault(),t[o].apply(this,arguments)||!1};for(o.guid=n;i<t.length;)t[i++].guid=n;return this.click(o)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),X.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){X.fn[t]=function(e,n){return null==n&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},jt.test(t)&&(X.event.fixHooks[t]=X.event.keyHooks),Rt.test(t)&&(X.event.fixHooks[t]=X.event.mouseHooks)}),/*!
 * Sizzle CSS Selector Engine
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://sizzlejs.com/
 */
function(e,t){function n(e,t,n,i){n=n||[],t=t||R;var o,r,s,a,l=t.nodeType;if(!e||"string"!=typeof e)return n;if(1!==l&&9!==l)return[];if(s=_(t),!s&&!i&&(o=nt.exec(e)))if(a=o[1]){if(9===l){if(r=t.getElementById(a),!r||!r.parentNode)return n;if(r.id===a)return n.push(r),n}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&C(t,r)&&r.id===a)return n.push(r),n}else{if(o[2])return I.apply(n,O.call(t.getElementsByTagName(e),0)),n;if((a=o[3])&&dt&&t.getElementsByClassName)return I.apply(n,O.call(t.getElementsByClassName(a),0)),n}return m(e.replace(J,"$1"),t,n,i,s)}function i(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function o(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function r(e){return L(function(t){return t=+t,L(function(n,i){for(var o,r=e([],n.length,t),s=r.length;s--;)n[o=r[s]]&&(n[o]=!(i[o]=n[o]))})})}function s(e,t,n){if(e===t)return n;for(var i=e.nextSibling;i;){if(i===t)return-1;i=i.nextSibling}return 1}function a(e,t){var i,o,r,s,a,l,c,u=U[M][e+" "];if(u)return t?0:u.slice(0);for(a=e,l=[],c=b.preFilter;a;){(!i||(o=Z.exec(a)))&&(o&&(a=a.slice(o[0].length)||a),l.push(r=[])),i=!1,(o=et.exec(a))&&(r.push(i=new j(o.shift())),a=a.slice(i.length),i.type=o[0].replace(J," "));for(s in b.filter)!(o=at[s].exec(a))||c[s]&&!(o=c[s](o))||(r.push(i=new j(o.shift())),a=a.slice(i.length),i.type=s,i.matches=o);if(!i)break}return t?a.length:a?n.error(e):U(e,l).slice(0)}function l(e,t,n){var i=t.dir,o=n&&"parentNode"===t.dir,r=P++;return t.first?function(t,n,r){for(;t=t[i];)if(o||1===t.nodeType)return e(t,n,r)}:function(t,n,s){if(s){for(;t=t[i];)if((o||1===t.nodeType)&&e(t,n,s))return t}else for(var a,l=N+" "+r+" ",c=l+v;t=t[i];)if(o||1===t.nodeType){if((a=t[M])===c)return t.sizset;if("string"==typeof a&&0===a.indexOf(l)){if(t.sizset)return t}else{if(t[M]=c,e(t,n,s))return t.sizset=!0,t;t.sizset=!1}}}}function c(e){return e.length>1?function(t,n,i){for(var o=e.length;o--;)if(!e[o](t,n,i))return!1;return!0}:e[0]}function u(e,t,n,i,o){for(var r,s=[],a=0,l=e.length,c=null!=t;l>a;a++)(r=e[a])&&(!n||n(r,i,o))&&(s.push(r),c&&t.push(a));return s}function h(e,t,n,i,o,r){return i&&!i[M]&&(i=h(i)),o&&!o[M]&&(o=h(o,r)),L(function(r,s,a,l){var c,h,d,p=[],m=[],g=s.length,v=r||f(t||"*",a.nodeType?[a]:a,[]),y=!e||!r&&t?v:u(v,p,e,a,l),b=n?o||(r?e:g||i)?[]:s:y;if(n&&n(y,b,a,l),i)for(c=u(b,m),i(c,[],a,l),h=c.length;h--;)(d=c[h])&&(b[m[h]]=!(y[m[h]]=d));if(r){if(o||e){if(o){for(c=[],h=b.length;h--;)(d=b[h])&&c.push(y[h]=d);o(null,b=[],c,l)}for(h=b.length;h--;)(d=b[h])&&(c=o?F.call(r,d):p[h])>-1&&(r[c]=!(s[c]=d))}}else b=u(b===s?b.splice(g,b.length):b),o?o(null,s,b,l):I.apply(s,b)})}function d(e){for(var t,n,i,o=e.length,r=b.relative[e[0].type],s=r||b.relative[" "],a=r?1:0,u=l(function(e){return e===t},s,!0),p=l(function(e){return F.call(t,e)>-1},s,!0),f=[function(e,n,i){return!r&&(i||n!==k)||((t=n).nodeType?u(e,n,i):p(e,n,i))}];o>a;a++)if(n=b.relative[e[a].type])f=[l(c(f),n)];else{if(n=b.filter[e[a].type].apply(null,e[a].matches),n[M]){for(i=++a;o>i&&!b.relative[e[i].type];i++);return h(a>1&&c(f),a>1&&e.slice(0,a-1).join("").replace(J,"$1"),n,i>a&&d(e.slice(a,i)),o>i&&d(e=e.slice(i)),o>i&&e.join(""))}f.push(n)}return c(f)}function p(e,t){var i=t.length>0,o=e.length>0,r=function(s,a,l,c,h){var d,p,f,m=[],g=0,y="0",w=s&&[],_=null!=h,C=k,S=s||o&&b.find.TAG("*",h&&a.parentNode||a),x=N+=null==C?1:Math.E;for(_&&(k=a!==R&&a,v=r.el);null!=(d=S[y]);y++){if(o&&d){for(p=0;f=e[p];p++)if(f(d,a,l)){c.push(d);break}_&&(N=x,v=++r.el)}i&&((d=!f&&d)&&g--,s&&w.push(d))}if(g+=y,i&&y!==g){for(p=0;f=t[p];p++)f(w,m,a,l);if(s){if(g>0)for(;y--;)w[y]||m[y]||(m[y]=$.call(c));m=u(m)}I.apply(c,m),_&&!s&&m.length>0&&g+t.length>1&&n.uniqueSort(c)}return _&&(N=x,k=C),w};return r.el=0,i?L(r):r}function f(e,t,i){for(var o=0,r=t.length;r>o;o++)n(e,t[o],i);return i}function m(e,t,n,i,o){{var r,s,l,c,u,h=a(e);h.length}if(!i&&1===h.length){if(s=h[0]=h[0].slice(0),s.length>2&&"ID"===(l=s[0]).type&&9===t.nodeType&&!o&&b.relative[s[1].type]){if(t=b.find.ID(l.matches[0].replace(st,""),t,o)[0],!t)return n;e=e.slice(s.shift().length)}for(r=at.POS.test(e)?-1:s.length-1;r>=0&&(l=s[r],!b.relative[c=l.type]);r--)if((u=b.find[c])&&(i=u(l.matches[0].replace(st,""),it.test(s[0].type)&&t.parentNode||t,o))){if(s.splice(r,1),e=i.length&&s.join(""),!e)return I.apply(n,O.call(i,0)),n;break}}return S(e,h)(i,t,o,n,it.test(e)),n}function g(){}var v,y,b,w,_,C,S,x,E,k,T=!0,D="undefined",M=("sizcache"+Math.random()).replace(".",""),j=String,R=e.document,A=R.documentElement,N=0,P=0,$=[].pop,I=[].push,O=[].slice,F=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},L=function(e,t){return e[M]=null==t||t,e},B=function(){var e={},t=[];return L(function(n,i){return t.push(n)>b.cacheLength&&delete e[t.shift()],e[n+" "]=i},e)},H=B(),U=B(),W=B(),z="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",V=q.replace("w","w#"),Y="([*^$|!~]?=)",G="\\["+z+"*("+q+")"+z+"*(?:"+Y+z+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+V+")|)|)"+z+"*\\]",K=":("+q+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+G+")|[^:]|\\\\.)*|.*))\\)|)",Q=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+z+"*((?:-\\d)?\\d*)"+z+"*\\)|)(?=[^-]|$)",J=new RegExp("^"+z+"+|((?:^|[^\\\\])(?:\\\\.)*)"+z+"+$","g"),Z=new RegExp("^"+z+"*,"+z+"*"),et=new RegExp("^"+z+"*([\\x20\\t\\r\\n\\f>+~])"+z+"*"),tt=new RegExp(K),nt=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,it=/[\x20\t\r\n\f]*[+~]/,ot=/h\d/i,rt=/input|select|textarea|button/i,st=/\\(?!\\)/g,at={ID:new RegExp("^#("+q+")"),CLASS:new RegExp("^\\.("+q+")"),NAME:new RegExp("^\\[name=['\"]?("+q+")['\"]?\\]"),TAG:new RegExp("^("+q.replace("w","w*")+")"),ATTR:new RegExp("^"+G),PSEUDO:new RegExp("^"+K),POS:new RegExp(Q,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+z+"*(even|odd|(([+-]|)(\\d*)n|)"+z+"*(?:([+-]|)"+z+"*(\\d+)|))"+z+"*\\)|)","i"),needsContext:new RegExp("^"+z+"*[>+~]|"+Q,"i")},lt=function(e){var t=R.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},ct=lt(function(e){return e.appendChild(R.createComment("")),!e.getElementsByTagName("*").length}),ut=lt(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==D&&"#"===e.firstChild.getAttribute("href")}),ht=lt(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),dt=lt(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),pt=lt(function(e){e.id=M+0,e.innerHTML="<a name='"+M+"'></a><div name='"+M+"'></div>",A.insertBefore(e,A.firstChild);var t=R.getElementsByName&&R.getElementsByName(M).length===2+R.getElementsByName(M+0).length;return y=!R.getElementById(M),A.removeChild(e),t});try{O.call(A.childNodes,0)[0].nodeType}catch(ft){O=function(e){for(var t,n=[];t=this[e];e++)n.push(t);return n}}n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){return n(t,null,null,[e]).length>0},w=n.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=w(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i];i++)n+=w(t);return n},_=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},C=n.contains=A.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!!(i&&1===i.nodeType&&n.contains&&n.contains(i))}:A.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},n.attr=function(e,t){var n,i=_(e);return i||(t=t.toLowerCase()),(n=b.attrHandle[t])?n(e):i||ht?e.getAttribute(t):(n=e.getAttributeNode(t),n?"boolean"==typeof e[t]?e[t]?t:null:n.specified?n.value:null:null)},b=n.selectors={cacheLength:50,createPseudo:L,match:at,attrHandle:ut?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:y?function(e,t,n){if(typeof t.getElementById!==D&&!n){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}}:function(e,n,i){if(typeof n.getElementById!==D&&!i){var o=n.getElementById(e);return o?o.id===e||typeof o.getAttributeNode!==D&&o.getAttributeNode("id").value===e?[o]:t:[]}},TAG:ct?function(e,t){return typeof t.getElementsByTagName!==D?t.getElementsByTagName(e):void 0}:function(e,t){var n=t.getElementsByTagName(e);if("*"===e){for(var i,o=[],r=0;i=n[r];r++)1===i.nodeType&&o.push(i);return o}return n},NAME:pt&&function(e,t){return typeof t.getElementsByName!==D?t.getElementsByName(name):void 0},CLASS:dt&&function(e,t,n){return typeof t.getElementsByClassName===D||n?void 0:t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(st,""),e[3]=(e[4]||e[5]||"").replace(st,""),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1]?(e[2]||n.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*("even"===e[2]||"odd"===e[2])),e[4]=+(e[6]+e[7]||"odd"===e[2])):e[2]&&n.error(e[0]),e},PSEUDO:function(e){var t,n;return at.CHILD.test(e[0])?null:(e[3]?e[2]=e[3]:(t=e[4])&&(tt.test(t)&&(n=a(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t),e.slice(0,3))}},filter:{ID:y?function(e){return e=e.replace(st,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace(st,""),function(t){var n=typeof t.getAttributeNode!==D&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(st,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=H[M][e+" "];return t||(t=new RegExp("(^|"+z+")"+e+"("+z+"|$)"))&&H(e,function(e){return t.test(e.className||typeof e.getAttribute!==D&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(o){var r=n.attr(o,e);return null==r?"!="===t:t?(r+="","="===t?r===i:"!="===t?r!==i:"^="===t?i&&0===r.indexOf(i):"*="===t?i&&r.indexOf(i)>-1:"$="===t?i&&r.substr(r.length-i.length)===i:"~="===t?(" "+r+" ").indexOf(i)>-1:"|="===t?r===i||r.substr(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i){return"nth"===e?function(e){var t,o,r=e.parentNode;if(1===n&&0===i)return!0;if(r)for(o=0,t=r.firstChild;t&&(1!==t.nodeType||(o++,e!==t));t=t.nextSibling);return o-=i,o===n||o%n===0&&o/n>=0}:function(t){var n=t;switch(e){case"only":case"first":for(;n=n.previousSibling;)if(1===n.nodeType)return!1;if("first"===e)return!0;n=t;case"last":for(;n=n.nextSibling;)if(1===n.nodeType)return!1;return!0}}},PSEUDO:function(e,t){var i,o=b.pseudos[e]||b.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return o[M]?o(t):o.length>1?(i=[e,e,"",t],b.setFilters.hasOwnProperty(e.toLowerCase())?L(function(e,n){for(var i,r=o(e,t),s=r.length;s--;)i=F.call(e,r[s]),e[i]=!(n[i]=r[s])}):function(e){return o(e,0,i)}):o}},pseudos:{not:L(function(e){var t=[],n=[],i=S(e.replace(J,"$1"));return i[M]?L(function(e,t,n,o){for(var r,s=i(e,null,o,[]),a=e.length;a--;)(r=s[a])&&(e[a]=!(t[a]=r))}):function(e,o,r){return t[0]=e,i(t,null,r,n),!n.pop()}}),has:L(function(e){return function(t){return n(e,t).length>0}}),contains:L(function(e){return function(t){return(t.textContent||t.innerText||w(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!b.pseudos.empty(e)},empty:function(e){var t;for(e=e.firstChild;e;){if(e.nodeName>"@"||3===(t=e.nodeType)||4===t)return!1;e=e.nextSibling}return!0},header:function(e){return ot.test(e.nodeName)},text:function(e){var t,n;return"input"===e.nodeName.toLowerCase()&&"text"===(t=e.type)&&(null==(n=e.getAttribute("type"))||n.toLowerCase()===t)},radio:i("radio"),checkbox:i("checkbox"),file:i("file"),password:i("password"),image:i("image"),submit:o("submit"),reset:o("reset"),button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return rt.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:r(function(){return[0]}),last:r(function(e,t){return[t-1]}),eq:r(function(e,t,n){return[0>n?n+t:n]}),even:r(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:r(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:r(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:r(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},x=A.compareDocumentPosition?function(e,t){return e===t?(E=!0,0):(e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t):e.compareDocumentPosition)?-1:1}:function(e,t){if(e===t)return E=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,i,o=[],r=[],a=e.parentNode,l=t.parentNode,c=a;if(a===l)return s(e,t);if(!a)return-1;if(!l)return 1;for(;c;)o.unshift(c),c=c.parentNode;for(c=l;c;)r.unshift(c),c=c.parentNode;n=o.length,i=r.length;for(var u=0;n>u&&i>u;u++)if(o[u]!==r[u])return s(o[u],r[u]);return u===n?s(e,r[u],-1):s(o[u],t,1)},[0,0].sort(x),T=!E,n.uniqueSort=function(e){var t,n=[],i=1,o=0;if(E=T,e.sort(x),E){for(;t=e[i];i++)t===e[i-1]&&(o=n.push(i));for(;o--;)e.splice(n[o],1)}return e},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},S=n.compile=function(e,t){var n,i=[],o=[],r=W[M][e+" "];if(!r){for(t||(t=a(e)),n=t.length;n--;)r=d(t[n]),r[M]?i.push(r):o.push(r);r=W(e,p(o,i))}return r},R.querySelectorAll&&!function(){var e,t=m,i=/'|\\/g,o=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,r=[":focus"],s=[":active"],l=A.matchesSelector||A.mozMatchesSelector||A.webkitMatchesSelector||A.oMatchesSelector||A.msMatchesSelector;lt(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||r.push("\\["+z+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||r.push(":checked")}),lt(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&r.push("[*^$]="+z+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||r.push(":enabled",":disabled")}),r=new RegExp(r.join("|")),m=function(e,n,o,s,l){if(!s&&!l&&!r.test(e)){var c,u,h=!0,d=M,p=n,f=9===n.nodeType&&e;if(1===n.nodeType&&"object"!==n.nodeName.toLowerCase()){for(c=a(e),(h=n.getAttribute("id"))?d=h.replace(i,"\\$&"):n.setAttribute("id",d),d="[id='"+d+"'] ",u=c.length;u--;)c[u]=d+c[u].join("");p=it.test(e)&&n.parentNode||n,f=c.join(",")}if(f)try{return I.apply(o,O.call(p.querySelectorAll(f),0)),o}catch(m){}finally{h||n.removeAttribute("id")}}return t(e,n,o,s,l)},l&&(lt(function(t){e=l.call(t,"div");try{l.call(t,"[test!='']:sizzle"),s.push("!=",K)}catch(n){}}),s=new RegExp(s.join("|")),n.matchesSelector=function(t,i){if(i=i.replace(o,"='$1']"),!_(t)&&!s.test(i)&&!r.test(i))try{var a=l.call(t,i);if(a||e||t.document&&11!==t.document.nodeType)return a}catch(c){}return n(i,null,null,[t]).length>0})}(),b.pseudos.nth=b.pseudos.eq,b.filters=g.prototype=b.pseudos,b.setFilters=new g,n.attr=X.attr,X.find=n,X.expr=n.selectors,X.expr[":"]=X.expr.pseudos,X.unique=n.uniqueSort,X.text=n.getText,X.isXMLDoc=n.isXML,X.contains=n.contains}(e);var Pt=/Until$/,$t=/^(?:parents|prev(?:Until|All))/,It=/^.[^:#\[\.,]*$/,Ot=X.expr.match.needsContext,Ft={children:!0,contents:!0,next:!0,prev:!0};X.fn.extend({find:function(e){var t,n,i,o,r,s,a=this;if("string"!=typeof e)return X(e).filter(function(){for(t=0,n=a.length;n>t;t++)if(X.contains(a[t],this))return!0});for(s=this.pushStack("","find",e),t=0,n=this.length;n>t;t++)if(i=s.length,X.find(e,this[t],s),t>0)for(o=i;o<s.length;o++)for(r=0;i>r;r++)if(s[r]===s[o]){s.splice(o--,1);break}return s},has:function(e){var t,n=X(e,this),i=n.length;return this.filter(function(){for(t=0;i>t;t++)if(X.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(c(this,e,!1),"not",e)},filter:function(e){return this.pushStack(c(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"==typeof e?Ot.test(e)?X(e,this.context).index(this[0])>=0:X.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var n,i=0,o=this.length,r=[],s=Ot.test(e)||"string"!=typeof e?X(e,t||this.context):0;o>i;i++)for(n=this[i];n&&n.ownerDocument&&n!==t&&11!==n.nodeType;){if(s?s.index(n)>-1:X.find.matchesSelector(n,e)){r.push(n);break}n=n.parentNode}return r=r.length>1?X.unique(r):r,this.pushStack(r,"closest",e)},index:function(e){return e?"string"==typeof e?X.inArray(this[0],X(e)):X.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n="string"==typeof e?X(e,t):X.makeArray(e&&e.nodeType?[e]:e),i=X.merge(this.get(),n);return this.pushStack(a(n[0])||a(i[0])?i:X.unique(i))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),X.fn.andSelf=X.fn.addBack,X.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return X.dir(e,"parentNode")},parentsUntil:function(e,t,n){return X.dir(e,"parentNode",n)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return X.dir(e,"nextSibling")},prevAll:function(e){return X.dir(e,"previousSibling")},nextUntil:function(e,t,n){return X.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return X.dir(e,"previousSibling",n)},siblings:function(e){return X.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return X.sibling(e.firstChild)},contents:function(e){return X.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:X.merge([],e.childNodes)}},function(e,t){X.fn[e]=function(n,i){var o=X.map(this,t,n);return Pt.test(e)||(i=n),i&&"string"==typeof i&&(o=X.filter(i,o)),o=this.length>1&&!Ft[e]?X.unique(o):o,this.length>1&&$t.test(e)&&(o=o.reverse()),this.pushStack(o,e,Y.call(arguments).join(","))}}),X.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?X.find.matchesSelector(t[0],e)?[t[0]]:[]:X.find.matches(e,t)},dir:function(e,n,i){for(var o=[],r=e[n];r&&9!==r.nodeType&&(i===t||1!==r.nodeType||!X(r).is(i));)1===r.nodeType&&o.push(r),r=r[n];return o},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Lt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Bt=/ jQuery\d+="(?:null|\d+)"/g,Ht=/^\s+/,Ut=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Wt=/<([\w:]+)/,zt=/<tbody/i,qt=/<|&#?\w+;/,Vt=/<(?:script|style|link)/i,Yt=/<(?:script|object|embed|option|style)/i,Gt=new RegExp("<(?:"+Lt+")[\\s/>]","i"),Kt=/^(?:checkbox|radio)$/,Qt=/checked\s*(?:[^=]|=\s*.checked.)/i,Jt=/\/(java|ecma)script/i,Xt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Zt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},en=u(H),tn=en.appendChild(H.createElement("div"));Zt.optgroup=Zt.option,Zt.tbody=Zt.tfoot=Zt.colgroup=Zt.caption=Zt.thead,Zt.th=Zt.td,X.support.htmlSerialize||(Zt._default=[1,"X<div>","</div>"]),X.fn.extend({text:function(e){return X.access(this,function(e){return e===t?X.text(this):this.empty().append((this[0]&&this[0].ownerDocument||H).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(X.isFunction(e))return this.each(function(t){X(this).wrapAll(e.call(this,t))});if(this[0]){var t=X(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(X.isFunction(e)?function(t){X(this).wrapInner(e.call(this,t))}:function(){var t=X(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=X.isFunction(e);return this.each(function(n){X(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){X.nodeName(this,"body")||X(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!a(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=X.clean(arguments);return this.pushStack(X.merge(e,this),"before",this.selector)}},after:function(){if(!a(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=X.clean(arguments);return this.pushStack(X.merge(this,e),"after",this.selector)}},remove:function(e,t){for(var n,i=0;null!=(n=this[i]);i++)(!e||X.filter(e,[n]).length)&&(t||1!==n.nodeType||(X.cleanData(n.getElementsByTagName("*")),X.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&X.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return X.clone(this,e,t)})},html:function(e){return X.access(this,function(e){var n=this[0]||{},i=0,o=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(Bt,""):t;if(!("string"!=typeof e||Vt.test(e)||!X.support.htmlSerialize&&Gt.test(e)||!X.support.leadingWhitespace&&Ht.test(e)||Zt[(Wt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Ut,"<$1></$2>");try{for(;o>i;i++)n=this[i]||{},1===n.nodeType&&(X.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(r){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return a(this[0])?this.length?this.pushStack(X(X.isFunction(e)?e():e),"replaceWith",e):this:X.isFunction(e)?this.each(function(t){var n=X(this),i=n.html();n.replaceWith(e.call(this,t,i))}):("string"!=typeof e&&(e=X(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;X(this).remove(),t?X(t).before(e):X(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,i){e=[].concat.apply([],e);var o,r,s,a,l=0,c=e[0],u=[],d=this.length;if(!X.support.checkClone&&d>1&&"string"==typeof c&&Qt.test(c))return this.each(function(){X(this).domManip(e,n,i)});if(X.isFunction(c))return this.each(function(o){var r=X(this);e[0]=c.call(this,o,n?r.html():t),r.domManip(e,n,i)});if(this[0]){if(o=X.buildFragment(e,this,u),s=o.fragment,r=s.firstChild,1===s.childNodes.length&&(s=r),r)for(n=n&&X.nodeName(r,"tr"),a=o.cacheable||d-1;d>l;l++)i.call(n&&X.nodeName(this[l],"table")?h(this[l],"tbody"):this[l],l===a?s:X.clone(s,!0,!0));s=r=null,u.length&&X.each(u,function(e,t){t.src?X.ajax?X.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):X.error("no ajax"):X.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Xt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),X.buildFragment=function(e,n,i){var o,r,s,a=e[0];return n=n||H,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,!(1===e.length&&"string"==typeof a&&a.length<512&&n===H&&"<"===a.charAt(0))||Yt.test(a)||!X.support.checkClone&&Qt.test(a)||!X.support.html5Clone&&Gt.test(a)||(r=!0,o=X.fragments[a],s=o!==t),o||(o=n.createDocumentFragment(),X.clean(e,n,o,i),r&&(X.fragments[a]=s&&o)),{fragment:o,cacheable:r}},X.fragments={},X.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){X.fn[e]=function(n){var i,o=0,r=[],s=X(n),a=s.length,l=1===this.length&&this[0].parentNode;if((null==l||l&&11===l.nodeType&&1===l.childNodes.length)&&1===a)return s[t](this[0]),this;for(;a>o;o++)i=(o>0?this.clone(!0):this).get(),X(s[o])[t](i),r=r.concat(i);return this.pushStack(r,e,s.selector)}}),X.extend({clone:function(e,t,n){var i,o,r,s;if(X.support.html5Clone||X.isXMLDoc(e)||!Gt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(tn.innerHTML=e.outerHTML,tn.removeChild(s=tn.firstChild)),!(X.support.noCloneEvent&&X.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||X.isXMLDoc(e)))for(p(e,s),i=f(e),o=f(s),r=0;i[r];++r)o[r]&&p(i[r],o[r]);if(t&&(d(e,s),n))for(i=f(e),o=f(s),r=0;i[r];++r)d(i[r],o[r]);return i=o=null,s},clean:function(e,t,n,i){var o,r,s,a,l,c,h,d,p,f,g,v=t===H&&en,y=[];for(t&&"undefined"!=typeof t.createDocumentFragment||(t=H),o=0;null!=(s=e[o]);o++)if("number"==typeof s&&(s+=""),s){if("string"==typeof s)if(qt.test(s)){for(v=v||u(t),h=t.createElement("div"),v.appendChild(h),s=s.replace(Ut,"<$1></$2>"),a=(Wt.exec(s)||["",""])[1].toLowerCase(),l=Zt[a]||Zt._default,c=l[0],h.innerHTML=l[1]+s+l[2];c--;)h=h.lastChild;if(!X.support.tbody)for(d=zt.test(s),p="table"!==a||d?"<table>"!==l[1]||d?[]:h.childNodes:h.firstChild&&h.firstChild.childNodes,r=p.length-1;r>=0;--r)X.nodeName(p[r],"tbody")&&!p[r].childNodes.length&&p[r].parentNode.removeChild(p[r]);!X.support.leadingWhitespace&&Ht.test(s)&&h.insertBefore(t.createTextNode(Ht.exec(s)[0]),h.firstChild),s=h.childNodes,h.parentNode.removeChild(h)}else s=t.createTextNode(s);s.nodeType?y.push(s):X.merge(y,s)}if(h&&(s=h=v=null),!X.support.appendChecked)for(o=0;null!=(s=y[o]);o++)X.nodeName(s,"input")?m(s):"undefined"!=typeof s.getElementsByTagName&&X.grep(s.getElementsByTagName("input"),m);if(n)for(f=function(e){return!e.type||Jt.test(e.type)?i?i.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e):void 0},o=0;null!=(s=y[o]);o++)X.nodeName(s,"script")&&f(s)||(n.appendChild(s),"undefined"!=typeof s.getElementsByTagName&&(g=X.grep(X.merge([],s.getElementsByTagName("script")),f),y.splice.apply(y,[o+1,0].concat(g)),o+=g.length));return y},cleanData:function(e,t){for(var n,i,o,r,s=0,a=X.expando,l=X.cache,c=X.support.deleteExpando,u=X.event.special;null!=(o=e[s]);s++)if((t||X.acceptData(o))&&(i=o[a],n=i&&l[i])){if(n.events)for(r in n.events)u[r]?X.event.remove(o,r):X.removeEvent(o,r,n.handle);l[i]&&(delete l[i],c?delete o[a]:o.removeAttribute?o.removeAttribute(a):o[a]=null,X.deletedIds.push(i))}}}),function(){var e,t;X.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=X.uaMatch(W.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),X.browser=t,X.sub=function(){function e(t,n){return new e.fn.init(t,n)}X.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(n,i){return i&&i instanceof X&&!(i instanceof e)&&(i=e(i)),X.fn.init.call(this,n,i,t)},e.fn.init.prototype=e.fn;var t=e(H);return e}}();var nn,on,rn,sn=/alpha\([^)]*\)/i,an=/opacity=([^)]*)/,ln=/^(top|right|bottom|left)$/,cn=/^(none|table(?!-c[ea]).+)/,un=/^margin/,hn=new RegExp("^("+Z+")(.*)$","i"),dn=new RegExp("^("+Z+")(?!px)[a-z%]+$","i"),pn=new RegExp("^([-+])=("+Z+")","i"),fn={BODY:"block"},mn={position:"absolute",visibility:"hidden",display:"block"},gn={letterSpacing:0,fontWeight:400},vn=["Top","Right","Bottom","Left"],yn=["Webkit","O","Moz","ms"],bn=X.fn.toggle;X.fn.extend({css:function(e,n){return X.access(this,function(e,n,i){return i!==t?X.style(e,n,i):X.css(e,n)},e,n,arguments.length>1)},show:function(){return y(this,!0)},hide:function(){return y(this)},toggle:function(e,t){var n="boolean"==typeof e;return X.isFunction(e)&&X.isFunction(t)?bn.apply(this,arguments):this.each(function(){(n?e:v(this))?X(this).show():X(this).hide()})}}),X.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=nn(e,"opacity");return""===n?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":X.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,i,o){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,s,a,l=X.camelCase(n),c=e.style;if(n=X.cssProps[l]||(X.cssProps[l]=g(c,l)),a=X.cssHooks[n]||X.cssHooks[l],i===t)return a&&"get"in a&&(r=a.get(e,!1,o))!==t?r:c[n];if(s=typeof i,"string"===s&&(r=pn.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(X.css(e,n)),s="number"),!(null==i||"number"===s&&isNaN(i)||("number"!==s||X.cssNumber[l]||(i+="px"),a&&"set"in a&&(i=a.set(e,i,o))===t)))try{c[n]=i}catch(u){}}},css:function(e,n,i,o){var r,s,a,l=X.camelCase(n);return n=X.cssProps[l]||(X.cssProps[l]=g(e.style,l)),a=X.cssHooks[n]||X.cssHooks[l],a&&"get"in a&&(r=a.get(e,!0,o)),r===t&&(r=nn(e,n)),"normal"===r&&n in gn&&(r=gn[n]),i||o!==t?(s=parseFloat(r),i||X.isNumeric(s)?s||0:r):r},swap:function(e,t,n){var i,o,r={};for(o in t)r[o]=e.style[o],e.style[o]=t[o];i=n.call(e);for(o in t)e.style[o]=r[o];return i}}),e.getComputedStyle?nn=function(t,n){var i,o,r,s,a=e.getComputedStyle(t,null),l=t.style;return a&&(i=a.getPropertyValue(n)||a[n],""!==i||X.contains(t.ownerDocument,t)||(i=X.style(t,n)),dn.test(i)&&un.test(n)&&(o=l.width,r=l.minWidth,s=l.maxWidth,l.minWidth=l.maxWidth=l.width=i,i=a.width,l.width=o,l.minWidth=r,l.maxWidth=s)),i}:H.documentElement.currentStyle&&(nn=function(e,t){var n,i,o=e.currentStyle&&e.currentStyle[t],r=e.style;return null==o&&r&&r[t]&&(o=r[t]),dn.test(o)&&!ln.test(t)&&(n=r.left,i=e.runtimeStyle&&e.runtimeStyle.left,i&&(e.runtimeStyle.left=e.currentStyle.left),r.left="fontSize"===t?"1em":o,o=r.pixelLeft+"px",r.left=n,i&&(e.runtimeStyle.left=i)),""===o?"auto":o}),X.each(["height","width"],function(e,t){X.cssHooks[t]={get:function(e,n,i){return n?0===e.offsetWidth&&cn.test(nn(e,"display"))?X.swap(e,mn,function(){return _(e,t,i)}):_(e,t,i):void 0},set:function(e,n,i){return b(e,n,i?w(e,t,i,X.support.boxSizing&&"border-box"===X.css(e,"boxSizing")):0)}}}),X.support.opacity||(X.cssHooks.opacity={get:function(e,t){return an.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,o=X.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=i&&i.filter||n.filter||"";n.zoom=1,t>=1&&""===X.trim(r.replace(sn,""))&&n.removeAttribute&&(n.removeAttribute("filter"),i&&!i.filter)||(n.filter=sn.test(r)?r.replace(sn,o):r+" "+o)}}),X(function(){X.support.reliableMarginRight||(X.cssHooks.marginRight={get:function(e,t){return X.swap(e,{display:"inline-block"},function(){return t?nn(e,"marginRight"):void 0})}}),!X.support.pixelPosition&&X.fn.position&&X.each(["top","left"],function(e,t){X.cssHooks[t]={get:function(e,n){if(n){var i=nn(e,t);return dn.test(i)?X(e).position()[t]+"px":i}}}})}),X.expr&&X.expr.filters&&(X.expr.filters.hidden=function(e){return 0===e.offsetWidth&&0===e.offsetHeight||!X.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||nn(e,"display"))},X.expr.filters.visible=function(e){return!X.expr.filters.hidden(e)}),X.each({margin:"",padding:"",border:"Width"},function(e,t){X.cssHooks[e+t]={expand:function(n){var i,o="string"==typeof n?n.split(" "):[n],r={};for(i=0;4>i;i++)r[e+vn[i]+t]=o[i]||o[i-2]||o[0];return r}},un.test(e)||(X.cssHooks[e+t].set=b)});var wn=/%20/g,_n=/\[\]$/,Cn=/\r?\n/g,Sn=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,xn=/^(?:select|textarea)/i;X.fn.extend({serialize:function(){return X.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?X.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||xn.test(this.nodeName)||Sn.test(this.type))}).map(function(e,t){var n=X(this).val();return null==n?null:X.isArray(n)?X.map(n,function(e){return{name:t.name,value:e.replace(Cn,"\r\n")}}):{name:t.name,value:n.replace(Cn,"\r\n")}}).get()}}),X.param=function(e,n){var i,o=[],r=function(e,t){t=X.isFunction(t)?t():null==t?"":t,o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)
};if(n===t&&(n=X.ajaxSettings&&X.ajaxSettings.traditional),X.isArray(e)||e.jquery&&!X.isPlainObject(e))X.each(e,function(){r(this.name,this.value)});else for(i in e)S(i,e[i],n,r);return o.join("&").replace(wn,"+")};var En,kn,Tn=/#.*$/,Dn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Mn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,jn=/^(?:GET|HEAD)$/,Rn=/^\/\//,An=/\?/,Nn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Pn=/([?&])_=[^&]*/,$n=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,In=X.fn.load,On={},Fn={},Ln=["*/"]+["*"];try{kn=U.href}catch(Bn){kn=H.createElement("a"),kn.href="",kn=kn.href}En=$n.exec(kn.toLowerCase())||[],X.fn.load=function(e,n,i){if("string"!=typeof e&&In)return In.apply(this,arguments);if(!this.length)return this;var o,r,s,a=this,l=e.indexOf(" ");return l>=0&&(o=e.slice(l,e.length),e=e.slice(0,l)),X.isFunction(n)?(i=n,n=t):n&&"object"==typeof n&&(r="POST"),X.ajax({url:e,type:r,dataType:"html",data:n,complete:function(e,t){i&&a.each(i,s||[e.responseText,t,e])}}).done(function(e){s=arguments,a.html(o?X("<div>").append(e.replace(Nn,"")).find(o):e)}),this},X.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){X.fn[t]=function(e){return this.on(t,e)}}),X.each(["get","post"],function(e,n){X[n]=function(e,i,o,r){return X.isFunction(i)&&(r=r||o,o=i,i=t),X.ajax({type:n,url:e,data:i,success:o,dataType:r})}}),X.extend({getScript:function(e,n){return X.get(e,t,n,"script")},getJSON:function(e,t,n){return X.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?k(e,X.ajaxSettings):(t=e,e=X.ajaxSettings),k(e,t),e},ajaxSettings:{url:kn,isLocal:Mn.test(En[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Ln},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":X.parseJSON,"text xml":X.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:x(On),ajaxTransport:x(Fn),ajax:function(e,n){function i(e,n,i,s){var c,h,y,b,_,S=n;2!==w&&(w=2,l&&clearTimeout(l),a=t,r=s||"",C.readyState=e>0?4:0,i&&(b=T(d,C,i)),e>=200&&300>e||304===e?(d.ifModified&&(_=C.getResponseHeader("Last-Modified"),_&&(X.lastModified[o]=_),_=C.getResponseHeader("Etag"),_&&(X.etag[o]=_)),304===e?(S="notmodified",c=!0):(c=D(d,b),S=c.state,h=c.data,y=c.error,c=!y)):(y=S,(!S||e)&&(S="error",0>e&&(e=0))),C.status=e,C.statusText=(n||S)+"",c?m.resolveWith(p,[h,S,C]):m.rejectWith(p,[C,S,y]),C.statusCode(v),v=t,u&&f.trigger("ajax"+(c?"Success":"Error"),[C,d,c?h:y]),g.fireWith(p,[C,S]),u&&(f.trigger("ajaxComplete",[C,d]),--X.active||X.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var o,r,s,a,l,c,u,h,d=X.ajaxSetup({},n),p=d.context||d,f=p!==d&&(p.nodeType||p instanceof X)?X(p):X.event,m=X.Deferred(),g=X.Callbacks("once memory"),v=d.statusCode||{},y={},b={},w=0,_="canceled",C={readyState:0,setRequestHeader:function(e,t){if(!w){var n=e.toLowerCase();e=b[n]=b[n]||e,y[e]=t}return this},getAllResponseHeaders:function(){return 2===w?r:null},getResponseHeader:function(e){var n;if(2===w){if(!s)for(s={};n=Dn.exec(r);)s[n[1].toLowerCase()]=n[2];n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return w||(d.mimeType=e),this},abort:function(e){return e=e||_,a&&a.abort(e),i(0,e),this}};if(m.promise(C),C.success=C.done,C.error=C.fail,C.complete=g.add,C.statusCode=function(e){if(e){var t;if(2>w)for(t in e)v[t]=[v[t],e[t]];else t=e[C.status],C.always(t)}return this},d.url=((e||d.url)+"").replace(Tn,"").replace(Rn,En[1]+"//"),d.dataTypes=X.trim(d.dataType||"*").toLowerCase().split(tt),null==d.crossDomain&&(c=$n.exec(d.url.toLowerCase()),d.crossDomain=!(!c||c[1]===En[1]&&c[2]===En[2]&&(c[3]||("http:"===c[1]?80:443))==(En[3]||("http:"===En[1]?80:443)))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=X.param(d.data,d.traditional)),E(On,d,n,C),2===w)return C;if(u=d.global,d.type=d.type.toUpperCase(),d.hasContent=!jn.test(d.type),u&&0===X.active++&&X.event.trigger("ajaxStart"),!d.hasContent&&(d.data&&(d.url+=(An.test(d.url)?"&":"?")+d.data,delete d.data),o=d.url,d.cache===!1)){var S=X.now(),x=d.url.replace(Pn,"$1_="+S);d.url=x+(x===d.url?(An.test(d.url)?"&":"?")+"_="+S:"")}(d.data&&d.hasContent&&d.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(o=o||d.url,X.lastModified[o]&&C.setRequestHeader("If-Modified-Since",X.lastModified[o]),X.etag[o]&&C.setRequestHeader("If-None-Match",X.etag[o])),C.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Ln+"; q=0.01":""):d.accepts["*"]);for(h in d.headers)C.setRequestHeader(h,d.headers[h]);if(d.beforeSend&&(d.beforeSend.call(p,C,d)===!1||2===w))return C.abort();_="abort";for(h in{success:1,error:1,complete:1})C[h](d[h]);if(a=E(Fn,d,n,C)){C.readyState=1,u&&f.trigger("ajaxSend",[C,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){C.abort("timeout")},d.timeout));try{w=1,a.send(y,i)}catch(k){if(!(2>w))throw k;i(-1,k)}}else i(-1,"No Transport");return C},active:0,lastModified:{},etag:{}});var Hn=[],Un=/\?/,Wn=/(=)\?(?=&|$)|\?\?/,zn=X.now();X.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Hn.pop()||X.expando+"_"+zn++;return this[e]=!0,e}}),X.ajaxPrefilter("json jsonp",function(n,i,o){var r,s,a,l=n.data,c=n.url,u=n.jsonp!==!1,h=u&&Wn.test(c),d=u&&!h&&"string"==typeof l&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Wn.test(l);return"jsonp"===n.dataTypes[0]||h||d?(r=n.jsonpCallback=X.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,s=e[r],h?n.url=c.replace(Wn,"$1"+r):d?n.data=l.replace(Wn,"$1"+r):u&&(n.url+=(Un.test(c)?"&":"?")+n.jsonp+"="+r),n.converters["script json"]=function(){return a||X.error(r+" was not called"),a[0]},n.dataTypes[0]="json",e[r]=function(){a=arguments},o.always(function(){e[r]=s,n[r]&&(n.jsonpCallback=i.jsonpCallback,Hn.push(r)),a&&X.isFunction(s)&&s(a[0]),a=s=t}),"script"):void 0}),X.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return X.globalEval(e),e}}}),X.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),X.ajaxTransport("script",function(e){if(e.crossDomain){var n,i=H.head||H.getElementsByTagName("head")[0]||H.documentElement;return{send:function(o,r){n=H.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,o){(o||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),n=t,o||r(200,"success"))},i.insertBefore(n,i.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var qn,Vn=e.ActiveXObject?function(){for(var e in qn)qn[e](0,1)}:!1,Yn=0;X.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&M()||j()}:M,function(e){X.extend(X.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(X.ajaxSettings.xhr()),X.support.ajax&&X.ajaxTransport(function(n){if(!n.crossDomain||X.support.cors){var i;return{send:function(o,r){var s,a,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(a in n.xhrFields)l[a]=n.xhrFields[a];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");try{for(a in o)l.setRequestHeader(a,o[a])}catch(c){}l.send(n.hasContent&&n.data||null),i=function(e,o){var a,c,u,h,d;try{if(i&&(o||4===l.readyState))if(i=t,s&&(l.onreadystatechange=X.noop,Vn&&delete qn[s]),o)4!==l.readyState&&l.abort();else{a=l.status,u=l.getAllResponseHeaders(),h={},d=l.responseXML,d&&d.documentElement&&(h.xml=d);try{h.text=l.responseText}catch(p){}try{c=l.statusText}catch(p){c=""}a||!n.isLocal||n.crossDomain?1223===a&&(a=204):a=h.text?200:404}}catch(f){o||r(-1,f)}h&&r(a,c,h,u)},n.async?4===l.readyState?setTimeout(i,0):(s=++Yn,Vn&&(qn||(qn={},X(e).unload(Vn)),qn[s]=i),l.onreadystatechange=i):i()},abort:function(){i&&i(0,1)}}}});var Gn,Kn,Qn=/^(?:toggle|show|hide)$/,Jn=new RegExp("^(?:([-+])=|)("+Z+")([a-z%]*)$","i"),Xn=/queueHooks$/,Zn=[$],ei={"*":[function(e,t){var n,i,o=this.createTween(e,t),r=Jn.exec(t),s=o.cur(),a=+s||0,l=1,c=20;if(r){if(n=+r[2],i=r[3]||(X.cssNumber[e]?"":"px"),"px"!==i&&a){a=X.css(o.elem,e,!0)||n||1;do l=l||".5",a/=l,X.style(o.elem,e,a+i);while(l!==(l=o.cur()/s)&&1!==l&&--c)}o.unit=i,o.start=a,o.end=r[1]?a+(r[1]+1)*n:n}return o}]};X.Animation=X.extend(N,{tweener:function(e,t){X.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,o=e.length;o>i;i++)n=e[i],ei[n]=ei[n]||[],ei[n].unshift(t)},prefilter:function(e,t){t?Zn.unshift(e):Zn.push(e)}}),X.Tween=I,I.prototype={constructor:I,init:function(e,t,n,i,o,r){this.elem=e,this.prop=n,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(X.cssNumber[n]?"":"px")},cur:function(){var e=I.propHooks[this.prop];return e&&e.get?e.get(this):I.propHooks._default.get(this)},run:function(e){var t,n=I.propHooks[this.prop];return this.pos=t=this.options.duration?X.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):I.propHooks._default.set(this),this}},I.prototype.init.prototype=I.prototype,I.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=X.css(e.elem,e.prop,!1,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){X.fx.step[e.prop]?X.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[X.cssProps[e.prop]]||X.cssHooks[e.prop])?X.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},I.propHooks.scrollTop=I.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},X.each(["toggle","show","hide"],function(e,t){var n=X.fn[t];X.fn[t]=function(i,o,r){return null==i||"boolean"==typeof i||!e&&X.isFunction(i)&&X.isFunction(o)?n.apply(this,arguments):this.animate(O(t,!0),i,o,r)}}),X.fn.extend({fadeTo:function(e,t,n,i){return this.filter(v).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var o=X.isEmptyObject(e),r=X.speed(t,n,i),s=function(){var t=N(this,X.extend({},e),r);o&&t.stop(!0)};return o||r.queue===!1?this.each(s):this.queue(r.queue,s)},stop:function(e,n,i){var o=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",r=X.timers,s=X._data(this);if(n)s[n]&&s[n].stop&&o(s[n]);else for(n in s)s[n]&&s[n].stop&&Xn.test(n)&&o(s[n]);for(n=r.length;n--;)r[n].elem!==this||null!=e&&r[n].queue!==e||(r[n].anim.stop(i),t=!1,r.splice(n,1));(t||!i)&&X.dequeue(this,e)})}}),X.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){X.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),X.speed=function(e,t,n){var i=e&&"object"==typeof e?X.extend({},e):{complete:n||!n&&t||X.isFunction(e)&&e,duration:e,easing:n&&t||t&&!X.isFunction(t)&&t};return i.duration=X.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in X.fx.speeds?X.fx.speeds[i.duration]:X.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){X.isFunction(i.old)&&i.old.call(this),i.queue&&X.dequeue(this,i.queue)},i},X.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},X.timers=[],X.fx=I.prototype.init,X.fx.tick=function(){var e,n=X.timers,i=0;for(Gn=X.now();i<n.length;i++)e=n[i],e()||n[i]!==e||n.splice(i--,1);n.length||X.fx.stop(),Gn=t},X.fx.timer=function(e){e()&&X.timers.push(e)&&!Kn&&(Kn=setInterval(X.fx.tick,X.fx.interval))},X.fx.interval=13,X.fx.stop=function(){clearInterval(Kn),Kn=null},X.fx.speeds={slow:600,fast:200,_default:400},X.fx.step={},X.expr&&X.expr.filters&&(X.expr.filters.animated=function(e){return X.grep(X.timers,function(t){return e===t.elem}).length});var ti=/^(?:body|html)$/i;X.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){X.offset.setOffset(this,e,t)});var n,i,o,r,s,a,l,c={top:0,left:0},u=this[0],h=u&&u.ownerDocument;if(h)return(i=h.body)===u?X.offset.bodyOffset(u):(n=h.documentElement,X.contains(n,u)?("undefined"!=typeof u.getBoundingClientRect&&(c=u.getBoundingClientRect()),o=F(h),r=n.clientTop||i.clientTop||0,s=n.clientLeft||i.clientLeft||0,a=o.pageYOffset||n.scrollTop,l=o.pageXOffset||n.scrollLeft,{top:c.top+a-r,left:c.left+l-s}):c)},X.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return X.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(X.css(e,"marginTop"))||0,n+=parseFloat(X.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var i=X.css(e,"position");"static"===i&&(e.style.position="relative");var o,r,s=X(e),a=s.offset(),l=X.css(e,"top"),c=X.css(e,"left"),u=("absolute"===i||"fixed"===i)&&X.inArray("auto",[l,c])>-1,h={},d={};u?(d=s.position(),o=d.top,r=d.left):(o=parseFloat(l)||0,r=parseFloat(c)||0),X.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(h.top=t.top-a.top+o),null!=t.left&&(h.left=t.left-a.left+r),"using"in t?t.using.call(e,h):s.css(h)}},X.fn.extend({position:function(){if(this[0]){var e=this[0],t=this.offsetParent(),n=this.offset(),i=ti.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(X.css(e,"marginTop"))||0,n.left-=parseFloat(X.css(e,"marginLeft"))||0,i.top+=parseFloat(X.css(t[0],"borderTopWidth"))||0,i.left+=parseFloat(X.css(t[0],"borderLeftWidth"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||H.body;e&&!ti.test(e.nodeName)&&"static"===X.css(e,"position");)e=e.offsetParent;return e||H.body})}}),X.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var i=/Y/.test(n);X.fn[e]=function(o){return X.access(this,function(e,o,r){var s=F(e);return r===t?s?n in s?s[n]:s.document.documentElement[o]:e[o]:void(s?s.scrollTo(i?X(s).scrollLeft():r,i?r:X(s).scrollTop()):e[o]=r)},e,o,arguments.length,null)}}),X.each({Height:"height",Width:"width"},function(e,n){X.each({padding:"inner"+e,content:n,"":"outer"+e},function(i,o){X.fn[o]=function(o,r){var s=arguments.length&&(i||"boolean"!=typeof o),a=i||(o===!0||r===!0?"margin":"border");return X.access(this,function(n,i,o){var r;return X.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(r=n.documentElement,Math.max(n.body["scroll"+e],r["scroll"+e],n.body["offset"+e],r["offset"+e],r["client"+e])):o===t?X.css(n,i,o,a):X.style(n,i,o,a)},n,s?o:t,s,null)}})}),e.jQuery=e.$=X,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return X})}(window),/*! jQuery UI - v1.9.2 - 2012-11-23
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.effect.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js, jquery.ui.menu.js, jquery.ui.position.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js
* Copyright 2012 jQuery Foundation and other contributors; Licensed MIT */
function(e,t){function n(t,n){var o,r,s,a=t.nodeName.toLowerCase();return"area"===a?(o=t.parentNode,r=o.name,t.href&&r&&"map"===o.nodeName.toLowerCase()?(s=e("img[usemap=#"+r+"]")[0],!!s&&i(s)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().andSelf().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var o=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.ui.version||(e.extend(e.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return"number"==typeof t?this.each(function(){var i=this;setTimeout(function(){e(i).focus(),n&&n.call(i)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,o,r=e(this[0]);r.length&&r[0]!==document;){if(i=r.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(o=parseInt(r.css("zIndex"),10),!isNaN(o)&&0!==o))return o;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),o=isNaN(i);return(o||i>=0)&&n(t,!o)}}),e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));n.offsetHeight,e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=100===n.offsetHeight,e.support.selectstart="onselectstart"in n,t.removeChild(n).style.display="none"}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function o(t,n,i,o){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?a["inner"+i].call(this):this.each(function(){e(this).css(s,o(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?a["outer"+i].call(this,t):this.each(function(){e(this).css(s,o(this,t,!0,n)+"px")})}}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),function(){var t=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];e.ui.ie=t.length?!0:!1,e.ui.ie6=6===parseFloat(t[1],10)}(),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var o,r=e.ui[t].prototype;for(o in i)r.plugins[o]=r.plugins[o]||[],r.plugins[o].push([n,i[o]])},call:function(e,t,n){var i,o=e.plugins[t];if(o&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<o.length;i++)e.options[o[i][0]]&&o[i][1].apply(e.element,n)}},contains:e.contains,hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",o=!1;return t[i]>0?!0:(t[i]=1,o=t[i]>0,t[i]=0,o)},isOverAxis:function(e,t,n){return e>t&&t+n>e},isOver:function(t,n,i,o,r,s){return e.ui.isOverAxis(t,i,r)&&e.ui.isOverAxis(n,o,s)}}))}(jQuery),function(e,t){var n=0,i=Array.prototype.slice,o=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(r){}o(t)},e.widget=function(t,n,i){var o,r,s,a,l=t.split(".")[0];t=t.split(".")[1],o=l+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][o.toLowerCase()]=function(t){return!!e.data(t,o)},e[l]=e[l]||{},r=e[l][t],s=e[l][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new s(e,t)},e.extend(s,r,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),a=new n,a.options=e.widget.extend({},a.options),e.each(i,function(t,o){e.isFunction(o)&&(i[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,r=this._superApply;return this._super=e,this._superApply=i,t=o.apply(this,arguments),this._super=n,this._superApply=r,t}}())}),s.prototype=e.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix:t},i,{constructor:s,namespace:l,widgetName:t,widgetBaseClass:o,widgetFullName:o}),r?(e.each(r._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,s,n._proto)}),delete r._childConstructors):n._childConstructors.push(s),e.widget.bridge(t,s)},e.widget.extend=function(n){for(var o,r,s=i.call(arguments,1),a=0,l=s.length;l>a;a++)for(o in s[a])r=s[a][o],s[a].hasOwnProperty(o)&&r!==t&&(n[o]=e.isPlainObject(r)?e.isPlainObject(n[o])?e.widget.extend({},n[o],r):e.widget.extend({},r):r);return n},e.widget.bridge=function(n,o){var r=o.prototype.widgetFullName||n;e.fn[n]=function(s){var a="string"==typeof s,l=i.call(arguments,1),c=this;return s=!a&&l.length?e.widget.extend.apply(null,[s].concat(l)):s,this.each(a?function(){var i,o=e.data(this,r);return o?e.isFunction(o[s])&&"_"!==s.charAt(0)?(i=o[s].apply(o,l),i!==o&&i!==t?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+s+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+s+"'")}:function(){var t=e.data(this,r);t?t.option(s||{})._init():e.data(this,r,new o(s,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetName,this),e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var o,r,s,a=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(a={},o=n.split("."),n=o.shift(),o.length){for(r=a[n]=e.widget.extend({},this.options[n]),s=0;s<o.length-1;s++)r[o[s]]=r[o[s]]||{},r=r[o[s]];if(n=o.pop(),i===t)return r[n]===t?null:r[n];r[n]=i}else{if(i===t)return this.options[n]===t?null:this.options[n];a[n]=i}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var o,r=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=o=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,o=this.widget()),e.each(i,function(i,s){function a(){return t||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof s?r[s]:s).apply(r,arguments):void 0}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+r.eventNamespace,u=l[2];u?o.delegate(u,c,a):n.bind(c,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var o,r,s=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],r=n.originalEvent)for(o in r)o in n||(n[o]=r[o]);return this.element.trigger(n,i),!(e.isFunction(s)&&s.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,o,r){"string"==typeof o&&(o={effect:o});var s,a=o?o===!0||"number"==typeof o?n:o.effect||n:t;o=o||{},"number"==typeof o&&(o={duration:o}),s=!e.isEmptyObject(o),o.complete=r,o.delay&&i.delay(o.delay),s&&e.effects&&(e.effects.effect[a]||e.uiBackCompat!==!1&&e.effects[a])?i[t](o):a!==t&&i[a]?i[a](o.duration,o.easing,r):i.queue(function(n){e(this)[t](),r&&r.call(i[0]),n()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,o=1===n.which,r="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return o&&!r&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return!e.ui.ie||document.documentMode>=9||t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"!=this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1);for(var i=this.element[0],o=!1;i&&(i=i.parentNode);)i==document&&(o=!0);if(!o&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!n||"valid"==this.options.revert&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)){var r=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){r._trigger("stop",t)!==!1&&r._clear()})}else this._trigger("stop",t)!==!1&&this._clear();return!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=this.options.handle&&e(this.options.handle,this.element).length?!1:!0;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(n=!0)}),n},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"==n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"==n.appendTo?this.element[0].parentNode:n.appendTo),i[0]==this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if("parent"==t.containment&&(t.containment=this.helper[0].parentNode),("document"==t.containment||"window"==t.containment)&&(this.containment=["document"==t.containment?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==t.containment?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==t.containment?0:e(window).scrollLeft())+e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==t.containment?0:e(window).scrollTop())+(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(t.containment)||t.containment.constructor==Array)t.containment.constructor==Array&&(this.containment=t.containment);else{var n=e(t.containment),i=n[0];if(!i)return;var o=(n.offset(),"hidden"!=e(i).css("overflow"));this.containment=[(parseInt(e(i).css("borderLeftWidth"),10)||0)+(parseInt(e(i).css("paddingLeft"),10)||0),(parseInt(e(i).css("borderTopWidth"),10)||0)+(parseInt(e(i).css("paddingTop"),10)||0),(o?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e(i).css("borderLeftWidth"),10)||0)-(parseInt(e(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(o?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e(i).css("borderTopWidth"),10)||0)-(parseInt(e(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"==t?1:-1,o=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),r=/(html|body)/i.test(o[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():r?0:o.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():r?0:o.scrollLeft())*i}},_generatePosition:function(t){var n=this.options,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(i[0].tagName),r=t.pageX,s=t.pageY;if(this.originalPosition){var a;if(this.containment){if(this.relative_container){var l=this.relative_container.offset();a=[this.containment[0]+l.left,this.containment[1]+l.top,this.containment[2]+l.left,this.containment[3]+l.top]}else a=this.containment;t.pageX-this.offset.click.left<a[0]&&(r=a[0]+this.offset.click.left),t.pageY-this.offset.click.top<a[1]&&(s=a[1]+this.offset.click.top),t.pageX-this.offset.click.left>a[2]&&(r=a[2]+this.offset.click.left),t.pageY-this.offset.click.top>a[3]&&(s=a[3]+this.offset.click.top)}if(n.grid){var c=n.grid[1]?this.originalPageY+Math.round((s-this.originalPageY)/n.grid[1])*n.grid[1]:this.originalPageY;s=a&&(c-this.offset.click.top<a[1]||c-this.offset.click.top>a[3])?c-this.offset.click.top<a[1]?c+n.grid[1]:c-n.grid[1]:c;var u=n.grid[0]?this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0]:this.originalPageX;r=a&&(u-this.offset.click.left<a[0]||u-this.offset.click.left>a[2])?u-this.offset.click.left<a[0]?u+n.grid[0]:u-n.grid[0]:u}}return{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():o?0:i.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():o?0:i.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]==this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i]),"drag"==t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var i=e(this).data("draggable"),o=i.options,r=e.extend({},n,{item:i.element});i.sortables=[],e(o.connectToSortable).each(function(){var n=e.data(this,"sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,r))})},stop:function(t,n){var i=e(this).data("draggable"),o=e.extend({},n,{item:i.element});e.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"==i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,o))})},drag:function(t,n){var i=e(this).data("draggable"),o=this;e.each(i.sortables,function(){var r=!1,s=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(r=!0,e.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!=s&&this.instance._intersectsWith(this.instance.containerCache)&&e.ui.contains(s.instance.element[0],this.instance.element[0])&&(r=!1),r})),r?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(o).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var i=e(n.helper),o=e(this).data("draggable").options;i.css("opacity")&&(o._opacity=i.css("opacity")),i.css("opacity",o.opacity)},stop:function(t,n){var i=e(this).data("draggable").options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("draggable");t.scrollParent[0]!=document&&"HTML"!=t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("draggable"),i=n.options,o=!1;n.scrollParent[0]!=document&&"HTML"!=n.scrollParent[0].tagName?(i.axis&&"x"==i.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?n.scrollParent[0].scrollTop=o=n.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-n.overflowOffset.top<i.scrollSensitivity&&(n.scrollParent[0].scrollTop=o=n.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"==i.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?n.scrollParent[0].scrollLeft=o=n.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-n.overflowOffset.left<i.scrollSensitivity&&(n.scrollParent[0].scrollLeft=o=n.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"==i.axis||(t.pageY-e(document).scrollTop()<i.scrollSensitivity?o=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(o=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"==i.axis||(t.pageX-e(document).scrollLeft()<i.scrollSensitivity?o=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(o=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed)))),o!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!=String?n.snap.items||":data(draggable)":n.snap).each(function(){var n=e(this),i=n.offset();this!=t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:i.top,left:i.left})})},drag:function(t,n){for(var i=e(this).data("draggable"),o=i.options,r=o.snapTolerance,s=n.offset.left,a=s+i.helperProportions.width,l=n.offset.top,c=l+i.helperProportions.height,u=i.snapElements.length-1;u>=0;u--){var h=i.snapElements[u].left,d=h+i.snapElements[u].width,p=i.snapElements[u].top,f=p+i.snapElements[u].height;if(s>h-r&&d+r>s&&l>p-r&&f+r>l||s>h-r&&d+r>s&&c>p-r&&f+r>c||a>h-r&&d+r>a&&l>p-r&&f+r>l||a>h-r&&d+r>a&&c>p-r&&f+r>c){if("inner"!=o.snapMode){var m=Math.abs(p-c)<=r,g=Math.abs(f-l)<=r,v=Math.abs(h-a)<=r,y=Math.abs(d-s)<=r;m&&(n.position.top=i._convertPositionTo("relative",{top:p-i.helperProportions.height,left:0}).top-i.margins.top),g&&(n.position.top=i._convertPositionTo("relative",{top:f,left:0}).top-i.margins.top),v&&(n.position.left=i._convertPositionTo("relative",{top:0,left:h-i.helperProportions.width}).left-i.margins.left),y&&(n.position.left=i._convertPositionTo("relative",{top:0,left:d}).left-i.margins.left)}var b=m||g||v||y;if("outer"!=o.snapMode){var m=Math.abs(p-l)<=r,g=Math.abs(f-c)<=r,v=Math.abs(h-s)<=r,y=Math.abs(d-a)<=r;m&&(n.position.top=i._convertPositionTo("relative",{top:p,left:0}).top-i.margins.top),g&&(n.position.top=i._convertPositionTo("relative",{top:f-i.helperProportions.height,left:0}).top-i.margins.top),v&&(n.position.left=i._convertPositionTo("relative",{top:0,left:h}).left-i.margins.left),y&&(n.position.left=i._convertPositionTo("relative",{top:0,left:d-i.helperProportions.width}).left-i.margins.left)}!i.snapElements[u].snapping&&(m||g||v||y||b)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[u].item})),i.snapElements[u].snapping=m||g||v||y||b}else i.snapElements[u].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[u].item})),i.snapElements[u].snapping=!1}}}),e.ui.plugin.add("draggable","stack",{start:function(){var t=e(this).data("draggable").options,n=e.makeArray(e(t.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(n.length){var i=parseInt(n[0].style.zIndex)||0;e(n).each(function(e){this.style.zIndex=i+e}),this[0].style.zIndex=i+n.length}}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var i=e(n.helper),o=e(this).data("draggable").options;i.css("zIndex")&&(o._zIndex=i.css("zIndex")),i.css("zIndex",o.zIndex)},stop:function(t,n){var i=e(this).data("draggable").options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(jQuery),function(e){e.widget("ui.droppable",{version:"1.9.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var t=this.options,n=t.accept;this.isover=0,this.isout=1,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=e.ui.ddmanager.droppables[this.options.scope],n=0;n<t.length;n++)t[n]==this&&t.splice(n,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){"accept"==t&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)
}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!=this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!=this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var i=n||e.ui.ddmanager.current;if(!i||(i.currentItem||i.element)[0]==this.element[0])return!1;var o=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"droppable");return t.options.greedy&&!t.options.disabled&&t.options.scope==i.options.scope&&t.accept.call(t.element[0],i.currentItem||i.element)&&e.ui.intersect(i,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(o=!0,!1):void 0}),o?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(i)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(t,n,i){if(!n.offset)return!1;var o=(t.positionAbs||t.position.absolute).left,r=o+t.helperProportions.width,s=(t.positionAbs||t.position.absolute).top,a=s+t.helperProportions.height,l=n.offset.left,c=l+n.proportions.width,u=n.offset.top,h=u+n.proportions.height;switch(i){case"fit":return o>=l&&c>=r&&s>=u&&h>=a;case"intersect":return l<o+t.helperProportions.width/2&&r-t.helperProportions.width/2<c&&u<s+t.helperProportions.height/2&&a-t.helperProportions.height/2<h;case"pointer":var d=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,p=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,f=e.ui.isOver(p,d,u,l,n.proportions.height,n.proportions.width);return f;case"touch":return(s>=u&&h>=s||a>=u&&h>=a||u>s&&a>h)&&(o>=l&&c>=o||r>=l&&c>=r||l>o&&r>c);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var i=e.ui.ddmanager.droppables[t.options.scope]||[],o=n?n.type:null,r=(t.currentItem||t.element).find(":data(droppable)").andSelf();e:for(var s=0;s<i.length;s++)if(!(i[s].options.disabled||t&&!i[s].accept.call(i[s].element[0],t.currentItem||t.element))){for(var a=0;a<r.length;a++)if(r[a]==i[s].element[0]){i[s].proportions.height=0;continue e}i[s].visible="none"!=i[s].element.css("display"),i[s].visible&&("mousedown"==o&&i[s]._activate.call(i[s],n),i[s].offset=i[s].element.offset(),i[s].proportions={width:i[s].element[0].offsetWidth,height:i[s].element[0].offsetHeight})}},drop:function(t,n){var i=!1;return e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(i=this._drop.call(this,n)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,n)))}),i},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i=e.ui.intersect(t,this,this.options.tolerance),o=i||1!=this.isover?i&&0==this.isover?"isover":null:"isout";if(o){var r;if(this.options.greedy){var s=this.options.scope,a=this.element.parents(":data(droppable)").filter(function(){return e.data(this,"droppable").options.scope===s});a.length&&(r=e.data(a[0],"droppable"),r.greedyChild="isover"==o?1:0)}r&&"isover"==o&&(r.isover=0,r.isout=1,r._out.call(r,n)),this[o]=1,this["isout"==o?"isover":"isout"]=0,this["isover"==o?"_over":"_out"].call(this,n),r&&"isout"==o&&(r.isout=0,r.isover=1,r._over.call(r,n))}}})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e){e.widget("ui.resizable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,n=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=n.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var i=this.handles.split(",");this.handles={};for(var o=0;o<i.length;o++){var r=e.trim(i[o]),s="ui-resizable-"+r,a=e('<div class="ui-resizable-handle '+s+'"></div>');a.css({zIndex:n.zIndex}),"se"==r&&a.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(a)}}this._renderAxis=function(t){t=t||this.element;for(var n in this.handles){if(this.handles[n].constructor==String&&(this.handles[n]=e(this.handles[n],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var i=e(this.handles[n],this.element),o=0;o=/sw|ne|nw|se|n|s/.test(n)?i.outerHeight():i.outerWidth();var r=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");t.css(r,o),this._proportionallyResize()}e(this.handles[n]).length}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:"se"}}),n.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){n.disabled||(e(this).removeClass("ui-resizable-autohide"),t._handles.show())}).mouseleave(function(){n.disabled||t.resizing||(e(this).addClass("ui-resizable-autohide"),t._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){t(this.element);var n=this.element;this.originalElement.css({position:n.css("position"),width:n.outerWidth(),height:n.outerHeight(),top:n.css("top"),left:n.css("left")}).insertAfter(n),n.remove()}return this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var n=!1;for(var i in this.handles)e(this.handles[i])[0]==t.target&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(n){var i=this.options,o=this.element.position(),r=this.element;this.resizing=!0,this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()},(r.is(".ui-draggable")||/absolute/.test(r.css("position")))&&r.css({position:"absolute",top:o.top,left:o.left}),this._renderProxy();var s=t(this.helper.css("left")),a=t(this.helper.css("top"));i.containment&&(s+=e(i.containment).scrollLeft()||0,a+=e(i.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:s,top:a},this.size=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.originalPosition={left:s,top:a},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalMousePosition={left:n.pageX,top:n.pageY},this.aspectRatio="number"==typeof i.aspectRatio?i.aspectRatio:this.originalSize.width/this.originalSize.height||1;var l=e(".ui-resizable-"+this.axis).css("cursor");return e("body").css("cursor","auto"==l?this.axis+"-resize":l),r.addClass("ui-resizable-resizing"),this._propagate("start",n),!0},_mouseDrag:function(e){var t=this.helper,n=(this.options,this.originalMousePosition),i=this.axis,o=e.pageX-n.left||0,r=e.pageY-n.top||0,s=this._change[i];if(!s)return!1;var a=s.apply(this,[e,o,r]);return this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(a=this._updateRatio(a,e)),a=this._respectSize(a,e),this._propagate("resize",e),t.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(a),this._trigger("resize",e,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n=this.options,i=this;if(this._helper){var o=this._proportionallyResizeElements,r=o.length&&/textarea/i.test(o[0].nodeName),s=r&&e.ui.hasScroll(o[0],"left")?0:i.sizeDiff.height,a=r?0:i.sizeDiff.width,l={width:i.helper.width()-a,height:i.helper.height()-s},c=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;n.animate||this.element.css(e.extend(l,{top:u,left:c})),i.helper.height(i.size.height),i.helper.width(i.size.width),this._helper&&!n.animate&&this._proportionallyResize()}return e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,i,o,r,s,a=this.options;s={minWidth:n(a.minWidth)?a.minWidth:0,maxWidth:n(a.maxWidth)?a.maxWidth:1/0,minHeight:n(a.minHeight)?a.minHeight:0,maxHeight:n(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||e)&&(t=s.minHeight*this.aspectRatio,o=s.minWidth/this.aspectRatio,i=s.maxHeight*this.aspectRatio,r=s.maxWidth/this.aspectRatio,t>s.minWidth&&(s.minWidth=t),o>s.minHeight&&(s.minHeight=o),i<s.maxWidth&&(s.maxWidth=i),r<s.maxHeight&&(s.maxHeight=r)),this._vBoundaries=s},_updateCache:function(e){this.options;this.offset=this.helper.offset(),n(e.left)&&(this.position.left=e.left),n(e.top)&&(this.position.top=e.top),n(e.height)&&(this.size.height=e.height),n(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=(this.options,this.position),i=this.size,o=this.axis;return n(e.height)?e.width=e.height*this.aspectRatio:n(e.width)&&(e.height=e.width/this.aspectRatio),"sw"==o&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"==o&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e,t){var i=(this.helper,this._vBoundaries),o=(this._aspectRatio||t.shiftKey,this.axis),r=n(e.width)&&i.maxWidth&&i.maxWidth<e.width,s=n(e.height)&&i.maxHeight&&i.maxHeight<e.height,a=n(e.width)&&i.minWidth&&i.minWidth>e.width,l=n(e.height)&&i.minHeight&&i.minHeight>e.height;a&&(e.width=i.minWidth),l&&(e.height=i.minHeight),r&&(e.width=i.maxWidth),s&&(e.height=i.maxHeight);var c=this.originalPosition.left+this.originalSize.width,u=this.position.top+this.size.height,h=/sw|nw|w/.test(o),d=/nw|ne|n/.test(o);a&&h&&(e.left=c-i.minWidth),r&&h&&(e.left=c-i.maxWidth),l&&d&&(e.top=u-i.minHeight),s&&d&&(e.top=u-i.maxHeight);var p=!e.width&&!e.height;return p&&!e.left&&e.top?e.top=null:p&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){this.options;if(this._proportionallyResizeElements.length)for(var t=this.helper||this.element,n=0;n<this._proportionallyResizeElements.length;n++){var i=this._proportionallyResizeElements[n];if(!this.borderDif){var o=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],r=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")];this.borderDif=e.map(o,function(e,t){var n=parseInt(e,10)||0,i=parseInt(r[t],10)||0;return n+i})}i.css({height:t.height()-this.borderDif[0]-this.borderDif[2]||0,width:t.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;if(this.elementOffset=t.offset(),this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var i=e.ui.ie6?1:0,o=e.ui.ie6?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+o,height:this.element.outerHeight()+o,position:"absolute",left:this.elementOffset.left-i+"px",top:this.elementOffset.top-i+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=(this.options,this.originalSize),i=this.originalPosition;return{left:i.left+t,width:n.width-t}},n:function(e,t,n){var i=(this.options,this.originalSize),o=this.originalPosition;return{top:o.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},sw:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,i]))},ne:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},nw:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,i]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!=t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("resizable"),n=t.options,i=function(t){e(t).each(function(){var t=e(this);t.data("resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof n.alsoResize||n.alsoResize.parentNode?i(n.alsoResize):n.alsoResize.length?(n.alsoResize=n.alsoResize[0],i(n.alsoResize)):e.each(n.alsoResize,function(e){i(e)})},resize:function(t,n){var i=e(this).data("resizable"),o=i.options,r=i.originalSize,s=i.originalPosition,a={height:i.size.height-r.height||0,width:i.size.width-r.width||0,top:i.position.top-s.top||0,left:i.position.left-s.left||0},l=function(t,i){e(t).each(function(){var t=e(this),o=e(this).data("resizable-alsoresize"),r={},s=i&&i.length?i:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(s,function(e,t){var n=(o[t]||0)+(a[t]||0);n&&n>=0&&(r[t]=n||null)}),t.css(r)})};"object"!=typeof o.alsoResize||o.alsoResize.nodeType?l(o.alsoResize):e.each(o.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).data("resizable"),i=n.options,o=n._proportionallyResizeElements,r=o.length&&/textarea/i.test(o[0].nodeName),s=r&&e.ui.hasScroll(o[0],"left")?0:n.sizeDiff.height,a=r?0:n.sizeDiff.width,l={width:n.size.width-a,height:n.size.height-s},c=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,u=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(l,u&&c?{top:u,left:c}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};o&&o.length&&e(o[0]).css({width:i.width,height:i.height}),n._updateCache(i),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var n=e(this).data("resizable"),i=n.options,o=n.element,r=i.containment,s=r instanceof e?r.get(0):/parent/.test(r)?o.parent().get(0):r;if(s)if(n.containerElement=e(s),/document/.test(r)||r==document)n.containerOffset={left:0,top:0},n.containerPosition={left:0,top:0},n.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var a=e(s),l=[];e(["Top","Right","Left","Bottom"]).each(function(e,n){l[e]=t(a.css("padding"+n))}),n.containerOffset=a.offset(),n.containerPosition=a.position(),n.containerSize={height:a.innerHeight()-l[3],width:a.innerWidth()-l[1]};var c=n.containerOffset,u=n.containerSize.height,h=n.containerSize.width,d=e.ui.hasScroll(s,"left")?s.scrollWidth:h,p=e.ui.hasScroll(s)?s.scrollHeight:u;n.parentData={element:s,left:c.left,top:c.top,width:d,height:p}}},resize:function(t){var n=e(this).data("resizable"),i=n.options,o=(n.containerSize,n.containerOffset),r=(n.size,n.position),s=n._aspectRatio||t.shiftKey,a={top:0,left:0},l=n.containerElement;l[0]!=document&&/static/.test(l.css("position"))&&(a=o),r.left<(n._helper?o.left:0)&&(n.size.width=n.size.width+(n._helper?n.position.left-o.left:n.position.left-a.left),s&&(n.size.height=n.size.width/n.aspectRatio),n.position.left=i.helper?o.left:0),r.top<(n._helper?o.top:0)&&(n.size.height=n.size.height+(n._helper?n.position.top-o.top:n.position.top),s&&(n.size.width=n.size.height*n.aspectRatio),n.position.top=n._helper?o.top:0),n.offset.left=n.parentData.left+n.position.left,n.offset.top=n.parentData.top+n.position.top;var c=Math.abs((n._helper?n.offset.left-a.left:n.offset.left-a.left)+n.sizeDiff.width),u=Math.abs((n._helper?n.offset.top-a.top:n.offset.top-o.top)+n.sizeDiff.height),h=n.containerElement.get(0)==n.element.parent().get(0),d=/relative|absolute/.test(n.containerElement.css("position"));h&&d&&(c-=n.parentData.left),c+n.size.width>=n.parentData.width&&(n.size.width=n.parentData.width-c,s&&(n.size.height=n.size.width/n.aspectRatio)),u+n.size.height>=n.parentData.height&&(n.size.height=n.parentData.height-u,s&&(n.size.width=n.size.height*n.aspectRatio))},stop:function(){var t=e(this).data("resizable"),n=t.options,i=(t.position,t.containerOffset),o=t.containerPosition,r=t.containerElement,s=e(t.helper),a=s.offset(),l=s.outerWidth()-t.sizeDiff.width,c=s.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(r.css("position"))&&e(this).css({left:a.left-o.left-i.left,width:l,height:c}),t._helper&&!n.animate&&/static/.test(r.css("position"))&&e(this).css({left:a.left-o.left-i.left,width:l,height:c})}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("resizable"),n=t.options,i=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){{var t=e(this).data("resizable");t.options}t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){{var t=e(this).data("resizable");t.options}t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(t){{var n=e(this).data("resizable"),i=n.options,o=n.size,r=n.originalSize,s=n.originalPosition,a=n.axis;i._aspectRatio||t.shiftKey}i.grid="number"==typeof i.grid?[i.grid,i.grid]:i.grid;var l=Math.round((o.width-r.width)/(i.grid[0]||1))*(i.grid[0]||1),c=Math.round((o.height-r.height)/(i.grid[1]||1))*(i.grid[1]||1);/^(se|s|e)$/.test(a)?(n.size.width=r.width+l,n.size.height=r.height+c):/^(ne)$/.test(a)?(n.size.width=r.width+l,n.size.height=r.height+c,n.position.top=s.top-c):/^(sw)$/.test(a)?(n.size.width=r.width+l,n.size.height=r.height+c,n.position.left=s.left-l):(n.size.width=r.width+l,n.size.height=r.height+c,n.position.top=s.top-c,n.position.left=s.left-l)}});var t=function(e){return parseInt(e,10)||0},n=function(e){return!isNaN(parseInt(e,10))}}(jQuery),function(e){e.widget("ui.selectable",e.ui.mouse,{version:"1.9.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var t=this;this.element.addClass("ui-selectable"),this.dragged=!1;var n;this.refresh=function(){n=e(t.options.filter,t.element[0]),n.addClass("ui-selectee"),n.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=n.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this;if(this.opos=[t.pageX,t.pageY],!this.options.disabled){var i=this.options;this.selectees=e(i.filter,this.element[0]),this._trigger("start",t),e(i.appendTo).append(this.helper),this.helper.css({left:t.clientX,top:t.clientY,width:0,height:0}),i.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var i=e.data(this,"selectable-item");i.startselected=!0,t.metaKey||t.ctrlKey||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",t,{unselecting:i.element}))}),e(t.target).parents().andSelf().each(function(){var i=e.data(this,"selectable-item");if(i){var o=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected");return i.$element.removeClass(o?"ui-unselecting":"ui-selected").addClass(o?"ui-selecting":"ui-unselecting"),i.unselecting=!o,i.selecting=o,i.selected=o,o?n._trigger("selecting",t,{selecting:i.element}):n._trigger("unselecting",t,{unselecting:i.element}),!1}})}},_mouseDrag:function(t){var n=this;if(this.dragged=!0,!this.options.disabled){var i=this.options,o=this.opos[0],r=this.opos[1],s=t.pageX,a=t.pageY;if(o>s){var l=s;s=o,o=l}if(r>a){var l=a;a=r,r=l}return this.helper.css({left:o,top:r,width:s-o,height:a-r}),this.selectees.each(function(){var l=e.data(this,"selectable-item");if(l&&l.element!=n.element[0]){var c=!1;"touch"==i.tolerance?c=!(l.left>s||l.right<o||l.top>a||l.bottom<r):"fit"==i.tolerance&&(c=l.left>o&&l.right<s&&l.top>r&&l.bottom<a),c?(l.selected&&(l.$element.removeClass("ui-selected"),l.selected=!1),l.unselecting&&(l.$element.removeClass("ui-unselecting"),l.unselecting=!1),l.selecting||(l.$element.addClass("ui-selecting"),l.selecting=!0,n._trigger("selecting",t,{selecting:l.element}))):(l.selecting&&((t.metaKey||t.ctrlKey)&&l.startselected?(l.$element.removeClass("ui-selecting"),l.selecting=!1,l.$element.addClass("ui-selected"),l.selected=!0):(l.$element.removeClass("ui-selecting"),l.selecting=!1,l.startselected&&(l.$element.addClass("ui-unselecting"),l.unselecting=!0),n._trigger("unselecting",t,{unselecting:l.element}))),l.selected&&(t.metaKey||t.ctrlKey||l.startselected||(l.$element.removeClass("ui-selected"),l.selected=!1,l.$element.addClass("ui-unselecting"),l.unselecting=!0,n._trigger("unselecting",t,{unselecting:l.element}))))}}),!1}},_mouseStop:function(t){var n=this;this.dragged=!1;this.options;return e(".ui-unselecting",this.element[0]).each(function(){var i=e.data(this,"selectable-item");i.$element.removeClass("ui-unselecting"),i.unselecting=!1,i.startselected=!1,n._trigger("unselected",t,{unselected:i.element})}),e(".ui-selecting",this.element[0]).each(function(){var i=e.data(this,"selectable-item");i.$element.removeClass("ui-selecting").addClass("ui-selected"),i.selecting=!1,i.selected=!0,i.startselected=!0,n._trigger("selected",t,{selected:i.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(e){e.widget("ui.sortable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var i=this;if(this.reverting)return!1;if(this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(t);{var o=null;e(t.target).parents().each(function(){return e.data(this,i.widgetName+"-item")==i?(o=e(this),!1):void 0})}if(e.data(t.target,i.widgetName+"-item")==i&&(o=e(t.target)),!o)return!1;if(this.options.handle&&!n){var r=!1;if(e(this.options.handle,o).find("*").andSelf().each(function(){this==t.target&&(r=!0)}),!r)return!1}return this.currentItem=o,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,i){var o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",o.cursor)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(var r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll){var n=this.options,i=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-this.overflowOffset.top<n.scrollSensitivity&&(this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop-n.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-this.overflowOffset.left<n.scrollSensitivity&&(this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft-n.scrollSpeed)):(t.pageY-e(document).scrollTop()<n.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed)),t.pageX-e(document).scrollLeft()<n.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed))),i!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(var o=this.items.length-1;o>=0;o--){var r=this.items[o],s=r.item[0],a=this._intersectsWithPointer(r);if(a&&r.instance===this.currentContainer&&s!=this.currentItem[0]&&this.placeholder[1==a?"next":"prev"]()[0]!=s&&!e.contains(this.placeholder[0],s)&&("semi-dynamic"==this.options.type?!e.contains(this.element[0],s):!0)){if(this.direction=1==a?"down":"up","pointer"!=this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,o=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:o.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:o.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this
},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each(function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,o=i+this.helperProportions.height,r=e.left,s=r+e.width,a=e.top,l=a+e.height,c=this.offset.click.top,u=this.offset.click.left,h=i+c>a&&l>i+c&&t+u>r&&s>t+u;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?h:r<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<s&&a<i+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var n="x"===this.options.axis||e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),o=n&&i,r=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return o?this.floating?s&&"right"==s||"down"==r?2:1:r&&("down"==r?2:1):!1},_intersectsWithSides:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),o=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"==r&&i||"left"==r&&!i:o&&("down"==o&&n||"up"==o&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!=e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!=e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n=[],i=[],o=this._connectWith();if(o&&t)for(var r=o.length-1;r>=0;r--)for(var s=e(o[r]),a=s.length-1;a>=0;a--){var l=e.data(s[a],this.widgetName);l&&l!=this&&!l.options.disabled&&i.push([e.isFunction(l.options.items)?l.options.items.call(l.element):e(l.options.items,l.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),l])}i.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var r=i.length-1;r>=0;r--)i[r][0].each(function(){n.push(this)});return e(n)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]==e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n=this.items,i=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],o=this._connectWith();if(o&&this.ready)for(var r=o.length-1;r>=0;r--)for(var s=e(o[r]),a=s.length-1;a>=0;a--){var l=e.data(s[a],this.widgetName);l&&l!=this&&!l.options.disabled&&(i.push([e.isFunction(l.options.items)?l.options.items.call(l.element[0],t,{item:this.currentItem}):e(l.options.items,l.element),l]),this.containers.push(l))}for(var r=i.length-1;r>=0;r--)for(var c=i[r][1],u=i[r][0],a=0,h=u.length;h>a;a++){var d=e(u[a]);d.data(this.widgetName+"-item",c),n.push({item:d,instance:c,width:0,height:0,left:0,top:0})}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var n=this.items.length-1;n>=0;n--){var i=this.items[n];if(i.instance==this.currentContainer||!this.currentContainer||i.item[0]==this.currentItem[0]){var o=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item;t||(i.width=o.outerWidth(),i.height=o.outerHeight());var r=o.offset();i.left=r.left,i.top=r.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var n=this.containers.length-1;n>=0;n--){var r=this.containers[n].element.offset();this.containers[n].containerCache.left=r.left,this.containers[n].containerCache.top=r.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight()}return this},_createPlaceholder:function(t){t=t||this;var n=t.options;if(!n.placeholder||n.placeholder.constructor==String){var i=n.placeholder;n.placeholder={element:function(){var n=e(document.createElement(t.currentItem[0].nodeName)).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return i||(n.style.visibility="hidden"),n},update:function(e,o){(!i||n.forcePlaceholderSize)&&(o.height()||o.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),o.width()||o.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}}t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(t){for(var n=null,i=null,o=this.containers.length-1;o>=0;o--)if(!e.contains(this.currentItem[0],this.containers[o].element[0]))if(this._intersectsWith(this.containers[o].containerCache)){if(n&&e.contains(this.containers[o].element[0],n.element[0]))continue;n=this.containers[o],i=o}else this.containers[o].containerCache.over&&(this.containers[o]._trigger("out",t,this._uiHash(this)),this.containers[o].containerCache.over=0);if(n)if(1===this.containers.length)this.containers[i]._trigger("over",t,this._uiHash(this)),this.containers[i].containerCache.over=1;else{for(var r=1e4,s=null,a=this.containers[i].floating?"left":"top",l=this.containers[i].floating?"width":"height",c=this.positionAbs[a]+this.offset.click[a],u=this.items.length-1;u>=0;u--)if(e.contains(this.containers[i].element[0],this.items[u].item[0])&&this.items[u].item[0]!=this.currentItem[0]){var h=this.items[u].item.offset()[a],d=!1;Math.abs(h-c)>Math.abs(h+this.items[u][l]-c)&&(d=!0,h+=this.items[u][l]),Math.abs(h-c)<r&&(r=Math.abs(h-c),s=this.items[u],this.direction=d?"up":"down")}if(!s&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[i],s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[i].element,!0),this._trigger("change",t,this._uiHash()),this.containers[i]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[i]._trigger("over",t,this._uiHash(this)),this.containers[i].containerCache.over=1}},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"==n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||e("parent"!=n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==i[0].style.width||n.forceHelperSize)&&i.width(this.currentItem.width()),(""==i[0].style.height||n.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;if("parent"==t.containment&&(t.containment=this.helper[0].parentNode),("document"==t.containment||"window"==t.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(t.containment)){var n=e(t.containment)[0],i=e(t.containment).offset(),o="hidden"!=e(n).css("overflow");this.containment=[i.left+(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0)-this.margins.top,i.left+(o?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(o?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"==t?1:-1,o=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),r=/(html|body)/i.test(o[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():r?0:o.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():r?0:o.scrollLeft())*i}},_generatePosition:function(t){var n=this.options,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(i[0].tagName);"relative"!=this.cssPosition||this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset());var r=t.pageX,s=t.pageY;if(this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),n.grid)){var a=this.originalPageY+Math.round((s-this.originalPageY)/n.grid[1])*n.grid[1];s=this.containment&&(a-this.offset.click.top<this.containment[1]||a-this.offset.click.top>this.containment[3])?a-this.offset.click.top<this.containment[1]?a+n.grid[1]:a-n.grid[1]:a;var l=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0];r=this.containment&&(l-this.offset.click.left<this.containment[0]||l-this.offset.click.left>this.containment[2])?l-this.offset.click.left<this.containment[0]?l+n.grid[0]:l-n.grid[0]:l}return{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():o?0:i.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():o?0:i.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay(function(){o==this.counter&&this.refreshPositions(!i)})},_clear:function(t,n){this.reverting=!1;var i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]==this.currentItem[0]){for(var o in this._storedCSS)("auto"==this._storedCSS[o]||"static"==this._storedCSS[o])&&(this._storedCSS[o]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!n&&i.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev==this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent==this.currentItem.parent()[0]||n||i.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(n||(i.push(function(e){this._trigger("remove",e,this._uiHash())}),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(var o=this.containers.length-1;o>=0;o--)n||i.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[o])),this.containers[o].containerCache.over&&(i.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[o])),this.containers[o].containerCache.over=0);if(this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!n){this._trigger("beforeStop",t,this._uiHash());for(var o=0;o<i.length;o++)i[o].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null,!n){for(var o=0;o<i.length;o++)i[o].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),jQuery.effects||function(e,t){var n=e.uiBackCompat!==!1,i="ui-effects-";e.effects={effect:{}},/*!
 * jQuery Color Animations v2.0.0
 * http://jquery.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Mon Aug 13 13:41:02 2012 -0500
 */
function(t,n){function i(e,t,n){var i=d[t.type]||{};return null==e?n||!t.def?null:t.def:(e=i.floor?~~e:parseFloat(e),isNaN(e)?t.def:i.mod?(e+i.mod)%i.mod:0>e?0:i.max<e?i.max:e)}function o(e){var n=u(),i=n._rgba=[];return e=e.toLowerCase(),m(c,function(t,o){var r,s=o.re.exec(e),a=s&&o.parse(s),l=o.space||"rgba";return a?(r=n[l](a),n[h[l].cache]=r[h[l].cache],i=n._rgba=r._rgba,!1):void 0}),i.length?("0,0,0,0"===i.join()&&t.extend(i,s.transparent),n):s[e]}function r(e,t,n){return n=(n+1)%1,1>6*n?e+(t-e)*n*6:1>2*n?t:2>3*n?e+(t-e)*(2/3-n)*6:e}var s,a="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),l=/^([\-+])=\s*(\d+\.?\d*)/,c=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],u=t.Color=function(e,n,i,o){return new t.Color.fn.parse(e,n,i,o)},h={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},p=u.support={},f=t("<p>")[0],m=t.each;f.style.cssText="background-color:rgba(1,1,1,.5)",p.rgba=f.style.backgroundColor.indexOf("rgba")>-1,m(h,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),u.fn=t.extend(u.prototype,{parse:function(r,a,l,c){if(r===n)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=t(r).css(a),a=n);var d=this,p=t.type(r),f=this._rgba=[];return a!==n&&(r=[r,a,l,c],p="array"),"string"===p?this.parse(o(r)||s._default):"array"===p?(m(h.rgba.props,function(e,t){f[t.idx]=i(r[t.idx],t)}),this):"object"===p?(r instanceof u?m(h,function(e,t){r[t.cache]&&(d[t.cache]=r[t.cache].slice())}):m(h,function(t,n){var o=n.cache;m(n.props,function(e,t){if(!d[o]&&n.to){if("alpha"===e||null==r[e])return;d[o]=n.to(d._rgba)}d[o][t.idx]=i(r[e],t,!0)}),d[o]&&e.inArray(null,d[o].slice(0,3))<0&&(d[o][3]=1,n.from&&(d._rgba=n.from(d[o])))}),this):void 0},is:function(e){var t=u(e),n=!0,i=this;return m(h,function(e,o){var r,s=t[o.cache];return s&&(r=i[o.cache]||o.to&&o.to(i._rgba)||[],m(o.props,function(e,t){return null!=s[t.idx]?n=s[t.idx]===r[t.idx]:void 0})),n}),n},_space:function(){var e=[],t=this;return m(h,function(n,i){t[i.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=u(e),o=n._space(),r=h[o],s=0===this.alpha()?u("transparent"):this,a=s[r.cache]||r.to(s._rgba),l=a.slice();return n=n[r.cache],m(r.props,function(e,o){var r=o.idx,s=a[r],c=n[r],u=d[o.type]||{};null!==c&&(null===s?l[r]=c:(u.mod&&(c-s>u.mod/2?s+=u.mod:s-c>u.mod/2&&(s-=u.mod)),l[r]=i((c-s)*t+s,o)))}),this[o](l)},blend:function(e){if(1===this._rgba[3])return this;var n=this._rgba.slice(),i=n.pop(),o=u(e)._rgba;return u(t.map(n,function(e,t){return(1-i)*o[t]+i*e}))},toRgbaString:function(){var e="rgba(",n=t.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===n[3]&&(n.pop(),e="rgb("),e+n.join()+")"},toHslaString:function(){var e="hsla(",n=t.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),e="hsl("),e+n.join()+")"},toHexString:function(e){var n=this._rgba.slice(),i=n.pop();return e&&n.push(~~(255*i)),"#"+t.map(n,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),u.fn.parse.prototype=u.fn,h.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,i=e[0]/255,o=e[1]/255,r=e[2]/255,s=e[3],a=Math.max(i,o,r),l=Math.min(i,o,r),c=a-l,u=a+l,h=.5*u;return t=l===a?0:i===a?60*(o-r)/c+360:o===a?60*(r-i)/c+120:60*(i-o)/c+240,n=0===h||1===h?h:.5>=h?c/u:c/(2-u),[Math.round(t)%360,n,h,null==s?1:s]},h.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],i=e[2],o=e[3],s=.5>=i?i*(1+n):i+n-i*n,a=2*i-s;return[Math.round(255*r(a,s,t+1/3)),Math.round(255*r(a,s,t)),Math.round(255*r(a,s,t-1/3)),o]},m(h,function(e,o){var r=o.props,s=o.cache,a=o.to,c=o.from;u.fn[e]=function(e){if(a&&!this[s]&&(this[s]=a(this._rgba)),e===n)return this[s].slice();var o,l=t.type(e),h="array"===l||"object"===l?e:arguments,d=this[s].slice();return m(r,function(e,t){var n=h["object"===l?e:t.idx];null==n&&(n=d[t.idx]),d[t.idx]=i(n,t)}),c?(o=u(c(d)),o[s]=d,o):u(d)},m(r,function(n,i){u.fn[n]||(u.fn[n]=function(o){var r,s=t.type(o),a="alpha"===n?this._hsla?"hsla":"rgba":e,c=this[a](),u=c[i.idx];return"undefined"===s?u:("function"===s&&(o=o.call(this,u),s=t.type(o)),null==o&&i.empty?this:("string"===s&&(r=l.exec(o),r&&(o=u+parseFloat(r[2])*("+"===r[1]?1:-1))),c[i.idx]=o,this[a](c)))})})}),m(a,function(e,n){t.cssHooks[n]={set:function(e,i){var r,s,a="";if("string"!==t.type(i)||(r=o(i))){if(i=u(r||i),!p.rgba&&1!==i._rgba[3]){for(s="backgroundColor"===n?e.parentNode:e;(""===a||"transparent"===a)&&s&&s.style;)try{a=t.css(s,"backgroundColor"),s=s.parentNode}catch(l){}i=i.blend(a&&"transparent"!==a?a:"_default")}i=i.toRgbaString()}try{e.style[n]=i}catch(c){}}},t.fx.step[n]=function(e){e.colorInit||(e.start=u(e.elem,n),e.end=u(e.end),e.colorInit=!0),t.cssHooks[n].set(e.elem,e.start.transition(e.end,e.pos))}}),t.cssHooks.borderColor={expand:function(e){var t={};return m(["Top","Right","Bottom","Left"],function(n,i){t["border"+i+"Color"]=e}),t}},s=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function n(){var t,n,i=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,o={};if(i&&i.length&&i[0]&&i[i[0]])for(n=i.length;n--;)t=i[n],"string"==typeof i[t]&&(o[e.camelCase(t)]=i[t]);else for(t in i)"string"==typeof i[t]&&(o[t]=i[t]);return o}function i(t,n){var i,o,s={};for(i in n)o=n[i],t[i]!==o&&(r[i]||(e.fx.step[i]||!isNaN(parseFloat(o)))&&(s[i]=o));return s}var o=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,n,e.end),e.setAttr=!0)}}),e.effects.animateClass=function(t,r,s,a){var l=e.speed(r,s,a);return this.queue(function(){var r,s=e(this),a=s.attr("class")||"",c=l.children?s.find("*").andSelf():s;c=c.map(function(){var t=e(this);return{el:t,start:n.call(this)}}),r=function(){e.each(o,function(e,n){t[n]&&s[n+"Class"](t[n])})},r(),c=c.map(function(){return this.end=n.call(this.el[0]),this.diff=i(this.start,this.end),this}),s.attr("class",a),c=c.map(function(){var t=this,n=e.Deferred(),i=jQuery.extend({},l,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,i),n.promise()}),e.when.apply(e,c.get()).done(function(){r(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),l.complete.call(s[0])})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,i,o){return n?e.effects.animateClass.call(this,{add:t},n,i,o):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,i,o){return n?e.effects.animateClass.call(this,{remove:t},n,i,o):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,i,o,r,s){return"boolean"==typeof i||i===t?o?e.effects.animateClass.call(this,i?{add:n}:{remove:n},o,r,s):this._toggleClass(n,i):e.effects.animateClass.call(this,{toggle:n},i,o,r)},switchClass:function(t,n,i,o,r){return e.effects.animateClass.call(this,{add:n,remove:t},i,o,r)}})}(),function(){function o(t,n,i,o){return e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},null==n&&(n={}),e.isFunction(n)&&(o=n,i=null,n={}),("number"==typeof n||e.fx.speeds[n])&&(o=i,i=n,n={}),e.isFunction(i)&&(o=i,i=null),n&&e.extend(t,n),i=i||n.duration,t.duration=e.fx.off?0:"number"==typeof i?i:i in e.fx.speeds?e.fx.speeds[i]:e.fx.speeds._default,t.complete=o||n.complete,t}function r(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?!1:n&&e.effects[t]?!1:!0}e.extend(e.effects,{version:"1.9.2",save:function(e,t){for(var n=0;n<t.length;n++)null!==t[n]&&e.data(i+t[n],e[0].style[t[n]])},restore:function(e,n){var o,r;for(r=0;r<n.length;r++)null!==n[r]&&(o=e.data(i+n[r]),o===t&&(o=""),e.css(n[r],o))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,i;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":i=0;break;case"center":i=.5;break;case"right":i=1;break;default:i=e[1]/t.width}return{x:i,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},i=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),o={width:t.width(),height:t.height()},r=document.activeElement;try{r.id}catch(s){r=document.body}return t.wrap(i),(t[0]===r||e.contains(t[0],r))&&e(r).focus(),i=t.parent(),"static"===t.css("position")?(i.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,i){n[i]=t.css(i),isNaN(parseInt(n[i],10))&&(n[i]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(o),i.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,i,o){return o=o||{},e.each(n,function(e,n){var r=t.cssUnit(n);r[0]>0&&(o[n]=r[0]*i+r[1])}),o}}),e.fn.extend({effect:function(){function t(t){function n(){e.isFunction(r)&&r.call(o[0]),e.isFunction(t)&&t()}var o=e(this),r=i.complete,s=i.mode;(o.is(":hidden")?"hide"===s:"show"===s)?n():a.call(o[0],i,n)}var i=o.apply(this,arguments),r=i.mode,s=i.queue,a=e.effects.effect[i.effect],l=!a&&n&&e.effects[i.effect];return e.fx.off||!a&&!l?r?this[r](i.duration,i.complete):this.each(function(){i.complete&&i.complete.call(this)}):a?s===!1?this.each(t):this.queue(s||"fx",t):l.call(this,{options:i,duration:i.duration,callback:i.complete,mode:i.mode})},_show:e.fn.show,show:function(e){if(r(e))return this._show.apply(this,arguments);var t=o.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(r(e))return this._hide.apply(this,arguments);var t=o.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(r(t)||"boolean"==typeof t||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=o.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),i=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(i=[parseFloat(n),t])}),i}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?n(2*e)/2:1-n(-2*e+2)/2}})}()}(jQuery),function(e){var t=0,n={},i={};n.height=n.paddingTop=n.paddingBottom=n.borderTopWidth=n.borderBottomWidth="hide",i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.9.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var n=this.accordionId="ui-accordion-"+(this.element.attr("id")||++t),i=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset"),this.headers=this.element.find(i.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this._hoverable(this.headers),this._focusable(this.headers),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide(),i.collapsible||i.active!==!1&&null!=i.active||(i.active=0),i.active<0&&(i.active+=this.headers.length),this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"),this.active.next().addClass("ui-accordion-content-active").show(),this._createIcons(),this.refresh(),this.element.attr("role","tablist"),this.headers.attr("role","tab").each(function(t){var i=e(this),o=i.attr("id"),r=i.next(),s=r.attr("id");o||(o=n+"-header-"+t,i.attr("id",o)),s||(s=n+"-panel-"+t,r.attr("id",s)),i.attr("aria-controls",s),r.attr("aria-labelledby",o)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._on(this.headers,{keydown:"_keydown"}),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._setupEvents(i.event)},_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)))},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var n=e.ui.keyCode,i=this.headers.length,o=this.headers.index(t.target),r=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:r=this.headers[(o+1)%i];break;case n.LEFT:case n.UP:r=this.headers[(o-1+i)%i];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:r=this.headers[0];break;case n.END:r=this.headers[i-1]}r&&(e(t.target).attr("tabIndex",-1),e(r).attr("tabIndex",0),r.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t,n,i=this.options.heightStyle,o=this.element.parent();"fill"===i?(e.support.minHeight||(n=o.css("overflow"),o.css("overflow","hidden")),t=o.height(),this.element.siblings(":visible").each(function(){var n=e(this),i=n.css("position");"absolute"!==i&&"fixed"!==i&&(t-=n.outerHeight(!0))}),n&&o.css("overflow",n),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===i&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var n=this._findActive(t)[0];n!==this.active[0]&&(n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var n={};t&&(e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._on(this.headers,n))},_eventHandler:function(t){var n=this.options,i=this.active,o=e(t.currentTarget),r=o[0]===i[0],s=r&&n.collapsible,a=s?e():o.next(),l=i.next(),c={oldHeader:i,oldPanel:l,newHeader:s?e():o,newPanel:a};t.preventDefault(),r&&!n.collapsible||this._trigger("beforeActivate",t,c)===!1||(n.active=s?!1:this.headers.index(o),this.active=r?e():o,this._toggle(c),i.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),r||(o.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&o.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),o.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var n=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=i,this.options.animate?this._animate(n,i,t):(i.hide(),n.show(),this._toggleComplete(t)),i.attr({"aria-expanded":"false","aria-hidden":"true"}),i.prev().attr("aria-selected","false"),n.length&&i.length?i.prev().attr("tabIndex",-1):n.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),n.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,o){var r,s,a,l=this,c=0,u=e.length&&(!t.length||e.index()<t.index()),h=this.options.animate||{},d=u&&h.down||h,p=function(){l._toggleComplete(o)};return"number"==typeof d&&(a=d),"string"==typeof d&&(s=d),s=s||d.easing||h.easing,a=a||d.duration||h.duration,t.length?e.length?(r=e.show().outerHeight(),t.animate(n,{duration:a,easing:s,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(i,{duration:a,easing:s,complete:p,step:function(e,n){n.now=Math.round(e),"height"!==n.prop?c+=n.now:"content"!==l.options.heightStyle&&(n.now=Math.round(r-t.outerHeight()-c),c=0)}})):t.animate(n,a,s,p):e.animate(i,a,s,p)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.uiBackCompat!==!1&&(!function(e,t){e.extend(t.options,{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var n=t._create;t._create=function(){if(this.options.navigation){var t=this,i=this.element.find(this.options.header),o=i.next(),r=i.add(o).find("a").filter(this.options.navigationFilter)[0];r&&i.add(o).each(function(n){return e.contains(this,r)?(t.options.active=Math.floor(n/2),!1):void 0})}n.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});var n=t._create,i=t._setOption;e.extend(t,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle(),n.call(this)},_setOption:function(e){("autoHeight"===e||"clearStyle"===e||"fillSpace"===e)&&(this.options.heightStyle=this._mergeHeightStyle()),i.apply(this,arguments)},_mergeHeightStyle:function(){var e=this.options;return e.fillSpace?"fill":e.clearStyle?"content":e.autoHeight?"auto":void 0}})}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var n=t._createIcons;t._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected),n.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){t.activate=t._activate;var n=t._findActive;t._findActive=function(e){return-1===e&&(e=!1),e&&"number"!=typeof e&&(e=this.headers.index(this.headers.filter(e)),-1===e&&(e=!1)),n.call(this,e)}}(jQuery,jQuery.ui.accordion.prototype),jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh,function(e,t){e.extend(t.options,{change:null,changestart:null});var n=t._trigger;t._trigger=function(e,t,i){var o=n.apply(this,arguments);return o?("beforeActivate"===e?o=n.call(this,"changestart",t,{oldHeader:i.oldHeader,oldContent:i.oldPanel,newHeader:i.newHeader,newContent:i.newPanel}):"activate"===e&&(o=n.call(this,"change",t,{oldHeader:i.oldHeader,oldContent:i.oldPanel,newHeader:i.newHeader,newContent:i.newPanel})),o):!1}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options,{animate:null,animated:"slide"});var n=t._create;t._create=function(){var e=this.options;null===e.animate&&(e.animate=e.animated?"slide"===e.animated?300:"bounceslide"===e.animated?{duration:200,down:{easing:"easeOutBounce",duration:1e3}}:e.animated:!1),n.call(this)}}(jQuery,jQuery.ui.accordion.prototype))}(jQuery),function(e){var t=0;e.widget("ui.autocomplete",{version:"1.9.2",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,i;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(o){if(this.element.prop("readOnly"))return t=!0,i=!0,void(n=!0);t=!1,i=!1,n=!1;var r=e.ui.keyCode;switch(o.keyCode){case r.PAGE_UP:t=!0,this._move("previousPage",o);break;case r.PAGE_DOWN:t=!0,this._move("nextPage",o);break;case r.UP:t=!0,this._keyEvent("previous",o);break;case r.DOWN:t=!0,this._keyEvent("next",o);break;case r.ENTER:case r.NUMPAD_ENTER:this.menu.active&&(t=!0,o.preventDefault(),this.menu.select(o));break;case r.TAB:this.menu.active&&this.menu.select(o);break;case r.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(o),o.preventDefault());break;default:n=!0,this._searchTimeout(o)}},keypress:function(i){if(t)return t=!1,void i.preventDefault();if(!n){var o=e.ui.keyCode;switch(i.keyCode){case o.PAGE_UP:this._move("previousPage",i);break;case o.PAGE_DOWN:this._move("nextPage",i);break;case o.UP:this._keyEvent("previous",i);break;case o.DOWN:this._keyEvent("next",i)}}},input:function(e){return i?(i=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:e(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(i){i.target===t.element[0]||i.target===n||e.contains(n,i.target)||t.close()})})},menufocus:function(t,n){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});var i=n.item.data("ui-autocomplete-item")||n.item.data("item.autocomplete");!1!==this._trigger("focus",t,{item:i})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(i.value):this.liveRegion.text(i.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item")||t.item.data("item.autocomplete"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),e.fn.bgiframe&&this.menu.element.bgiframe(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this.document.find(t||"body")[0]),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var t,n,i=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,i){i(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,o){i.xhr&&i.xhr.abort(),i.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){o(e)},error:function(){o([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,n=++t;return function(i){n===t&&e.__response(i),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t),this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var i=this;e.each(n,function(e,n){i._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var i=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return i.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function(e){var t,n,i,o,r="ui-button ui-widget ui-state-default ui-corner-all",s="ui-state-hover ui-state-active ",a="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",l=function(){var t=e(this).find(":ui-button");setTimeout(function(){t.button("refresh")},1)},c=function(t){var n=t.name,i=t.form,o=e([]);return n&&(o=i?e(i).find("[name='"+n+"']"):e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),o};e.widget("ui.button",{version:"1.9.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,l),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var s=this,a=this.options,u="checkbox"===this.type||"radio"===this.type,h=u?"":"ui-state-active",d="ui-state-focus";null===a.label&&(a.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(r).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){a.disabled||this===t&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){a.disabled||e(this).removeClass(h)}).bind("click"+this.eventNamespace,function(e){a.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){s.buttonElement.addClass(d)}).bind("blur"+this.eventNamespace,function(){s.buttonElement.removeClass(d)}),u&&(this.element.bind("change"+this.eventNamespace,function(){o||s.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){a.disabled||(o=!1,n=e.pageX,i=e.pageY)}).bind("mouseup"+this.eventNamespace,function(e){a.disabled||(n!==e.pageX||i!==e.pageY)&&(o=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return a.disabled||o?!1:(e(this).toggleClass("ui-state-active"),void s.buttonElement.attr("aria-pressed",s.element[0].checked))}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(a.disabled||o)return!1;
e(this).addClass("ui-state-active"),s.buttonElement.attr("aria-pressed","true");var t=s.element[0];c(t).not(t).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return a.disabled?!1:(e(this).addClass("ui-state-active"),t=this,void s.document.one("mouseup",function(){t=null}))}).bind("mouseup"+this.eventNamespace,function(){return a.disabled?!1:void e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return a.disabled?!1:void((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",a.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(r+" "+s+" "+a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?void(t?this.element.prop("disabled",!0):this.element.prop("disabled",!1)):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?c(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(a),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),i=this.options.icons,o=i.primary&&i.secondary,r=[];i.primary||i.secondary?(this.options.text&&r.push("ui-button-text-icon"+(o?"s":i.primary?"-primary":"-secondary")),i.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+i.primary+"'></span>"),i.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+i.secondary+"'></span>"),this.options.text||(r.push(o?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):r.push("ui-button-text-only"),t.addClass(r.join(" "))}}),e.widget("ui.buttonset",{version:"1.9.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function($,undefined){function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function bindHover(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){$(this).removeClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&$(this).removeClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",function(){$.datepicker._isDisabledDatepicker(instActive.inline?e.parent()[0]:instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&$(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&$(this).addClass("ui-datepicker-next-hover"))})}/* jQuery extend now ignores nulls! */
function extendRemove(e,t){$.extend(e,t);for(var n in t)(null==t[n]||t[n]==undefined)&&(e[n]=t[n]);return e}$.extend($.ui,{datepicker:{version:"1.9.2"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline="div"==nodeName||"span"==nodeName;target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),"input"==nodeName?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(e,t){var n=e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(e,t){var n=$(e);t.append=$([]),t.trigger=$([]),n.hasClass(this.markerClassName)||(this._attachments(n,t),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,n,i){t.settings[n]=i}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),this._autoSize(t),$.data(e,PROP_NAME,t),t.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,t){var n=this._get(t,"appendText"),i=this._get(t,"isRTL");t.append&&t.append.remove(),n&&(t.append=$('<span class="'+this._appendClass+'">'+n+"</span>"),e[i?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove();var o=this._get(t,"showOn");if(("focus"==o||"both"==o)&&e.focus(this._showDatepicker),"button"==o||"both"==o){var r=this._get(t,"buttonText"),s=this._get(t,"buttonImage");t.trigger=$(this._get(t,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:s,alt:r,title:r}):$('<button type="button"></button>').addClass(this._triggerClass).html(""==s?r:$("<img/>").attr({src:s,alt:r,title:r}))),e[i?"before":"after"](t.trigger),t.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput==e[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!=e[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(e[0])):$.datepicker._showDatepicker(e[0]),!1})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,11,20),n=this._get(e,"dateFormat");if(n.match(/[DM]/)){var i=function(e){for(var t=0,n=0,i=0;i<e.length;i++)e[i].length>t&&(t=e[i].length,n=i);return n};t.setMonth(i(this._get(e,n.match(/MM/)?"monthNames":"monthNamesShort"))),t.setDate(i(this._get(e,n.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(e,t){var n=$(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker",function(e,n,i){t.settings[n]=i}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),$.data(e,PROP_NAME,t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block"))},_dialogDatepicker:function(e,t,n,i,o){var r=this._dialogInst;if(!r){this.uuid+=1;var s="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+s+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),r=this._dialogInst=this._newInst(this._dialogInput,!1),r.settings={},$.data(this._dialogInput[0],PROP_NAME,r)}if(extendRemove(r.settings,i||{}),t=t&&t.constructor==Date?this._formatDate(r,t):t,this._dialogInput.val(t),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,!this._pos){var a=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[a/2-100+c,l/2-150+u]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),r.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,r),this},_destroyDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(t.hasClass(this.markerClassName)){var i=e.nodeName.toLowerCase();$.removeData(e,PROP_NAME),"input"==i?(n.append.remove(),n.trigger.remove(),t.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==i||"span"==i)&&t.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(t.hasClass(this.markerClassName)){var i=e.nodeName.toLowerCase();if("input"==i)e.disabled=!1,n.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==i||"span"==i){var o=t.children("."+this._inlineClass);o.children().removeClass("ui-state-disabled"),o.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t})}},_disableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(t.hasClass(this.markerClassName)){var i=e.nodeName.toLowerCase();if("input"==i)e.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==i||"span"==i){var o=t.children("."+this._inlineClass);o.children().addClass("ui-state-disabled"),o.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t}),this._disabledInputs[this._disabledInputs.length]=e}},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]==e)return!0;return!1},_getInst:function(e){try{return $.data(e,PROP_NAME)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,n){var i=this._getInst(e);if(2==arguments.length&&"string"==typeof t)return"defaults"==t?$.extend({},$.datepicker._defaults):i?"all"==t?$.extend({},i.settings):this._get(i,t):null;var o=t||{};if("string"==typeof t&&(o={},o[t]=n),i){this._curInst==i&&this._hideDatepicker();var r=this._getDateDatepicker(e,!0),s=this._getMinMaxDate(i,"min"),a=this._getMinMaxDate(i,"max");extendRemove(i.settings,o),null!==s&&o.dateFormat!==undefined&&o.minDate===undefined&&(i.settings.minDate=this._formatDate(i,s)),null!==a&&o.dateFormat!==undefined&&o.maxDate===undefined&&(i.settings.maxDate=this._formatDate(i,a)),this._attachments($(e),i),this._autoSize(i),this._setDate(i,r),this._updateAlternate(i),this._updateDatepicker(i)}},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(e){var t=$.datepicker._getInst(e.target),n=!0,i=t.dpDiv.is(".ui-datepicker-rtl");if(t._keyEvent=!0,$.datepicker._datepickerShowing)switch(e.keyCode){case 9:$.datepicker._hideDatepicker(),n=!1;break;case 13:var o=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",t.dpDiv);o[0]&&$.datepicker._selectDay(e.target,t.selectedMonth,t.selectedYear,o[0]);var r=$.datepicker._get(t,"onSelect");if(r){var s=$.datepicker._formatDate(t);r.apply(t.input?t.input[0]:null,[s,t])}else $.datepicker._hideDatepicker();return!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&$.datepicker._clearDate(e.target),n=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&$.datepicker._gotoToday(e.target),n=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,i?1:-1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,-7,"D"),n=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,i?-1:1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,7,"D"),n=e.ctrlKey||e.metaKey;break;default:n=!1}else 36==e.keyCode&&e.ctrlKey?$.datepicker._showDatepicker(this):n=!1;n&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t=$.datepicker._getInst(e.target);if($.datepicker._get(t,"constrainInput")){var n=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),i=String.fromCharCode(e.charCode==undefined?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||" ">i||!n||n.indexOf(i)>-1}},_doKeyUp:function(e){var t=$.datepicker._getInst(e.target);if(t.input.val()!=t.lastVal)try{var n=$.datepicker.parseDate($.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,$.datepicker._getFormatConfig(t));n&&($.datepicker._setDateFromField(t),$.datepicker._updateAlternate(t),$.datepicker._updateDatepicker(t))}catch(i){$.datepicker.log(i)}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!=e.nodeName.toLowerCase()&&(e=$("input",e.parentNode)[0]),!$.datepicker._isDisabledDatepicker(e)&&$.datepicker._lastInput!=e){var t=$.datepicker._getInst(e);$.datepicker._curInst&&$.datepicker._curInst!=t&&($.datepicker._curInst.dpDiv.stop(!0,!0),t&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var n=$.datepicker._get(t,"beforeShow"),i=n?n.apply(e,[e,t]):{};if(i!==!1){extendRemove(t.settings,i),t.lastVal=null,$.datepicker._lastInput=e,$.datepicker._setDateFromField(t),$.datepicker._inDialog&&(e.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(e),$.datepicker._pos[1]+=e.offsetHeight);var o=!1;$(e).parents().each(function(){return o|="fixed"==$(this).css("position"),!o});var r={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};if($.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(t),r=$.datepicker._checkOffset(t,r,o),t.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":o?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),!t.inline){var s=$.datepicker._get(t,"showAnim"),a=$.datepicker._get(t,"duration"),l=function(){var e=t.dpDiv.find("iframe.ui-datepicker-cover");if(e.length){var n=$.datepicker._getBorders(t.dpDiv);e.css({left:-n[0],top:-n[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()})}};t.dpDiv.zIndex($(e).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&($.effects.effect[s]||$.effects[s])?t.dpDiv.show(s,$.datepicker._get(t,"showOptions"),a,l):t.dpDiv[s||"show"](s?a:null,l),s&&a||l(),t.input.is(":visible")&&!t.input.is(":disabled")&&t.input.focus(),$.datepicker._curInst=t}}}},_updateDatepicker:function(e){this.maxRows=4;var t=$.datepicker._getBorders(e.dpDiv);instActive=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var n=e.dpDiv.find("iframe.ui-datepicker-cover");n.length&&n.css({left:-t[0],top:-t[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()}),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i=this._getNumberOfMonths(e),o=i[1],r=17;if(e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&e.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",r*o+"em"),e.dpDiv[(1!=i[0]||1!=i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e==$.datepicker._curInst&&$.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement&&e.input.focus(),e.yearshtml){var s=e.yearshtml;setTimeout(function(){s===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),s=e.yearshtml=null},0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,n){var i=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),r=e.input?e.input.outerWidth():0,s=e.input?e.input.outerHeight():0,a=document.documentElement.clientWidth+(n?0:$(document).scrollLeft()),l=document.documentElement.clientHeight+(n?0:$(document).scrollTop());return t.left-=this._get(e,"isRTL")?i-r:0,t.left-=n&&t.left==e.input.offset().left?$(document).scrollLeft():0,t.top-=n&&t.top==e.input.offset().top+s?$(document).scrollTop():0,t.left-=Math.min(t.left,t.left+i>a&&a>i?Math.abs(t.left+i-a):0),t.top-=Math.min(t.top,t.top+o>l&&l>o?Math.abs(o+s):0),t},_findPos:function(e){for(var t=this._getInst(e),n=this._get(t,"isRTL");e&&("hidden"==e.type||1!=e.nodeType||$.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];var i=$(e).offset();return[i.left,i.top]},_hideDatepicker:function(e){var t=this._curInst;if(t&&(!e||t==$.data(e,PROP_NAME))&&this._datepickerShowing){var n=this._get(t,"showAnim"),i=this._get(t,"duration"),o=function(){$.datepicker._tidyDialog(t)};$.effects&&($.effects.effect[n]||$.effects[n])?t.dpDiv.hide(n,$.datepicker._get(t,"showOptions"),i,o):t.dpDiv["slideDown"==n?"slideUp":"fadeIn"==n?"fadeOut":"hide"](n?i:null,o),n||o(),this._datepickerShowing=!1;var r=this._get(t,"onClose");r&&r.apply(t.input?t.input[0]:null,[t.input?t.input.val():"",t]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if($.datepicker._curInst){var t=$(e.target),n=$.datepicker._getInst(t[0]);(t[0].id!=$.datepicker._mainDivId&&0==t.parents("#"+$.datepicker._mainDivId).length&&!t.hasClass($.datepicker.markerClassName)&&!t.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||t.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=n)&&$.datepicker._hideDatepicker()}},_adjustDate:function(e,t,n){var i=$(e),o=this._getInst(i[0]);this._isDisabledDatepicker(i[0])||(this._adjustInstDate(o,t+("M"==n?this._get(o,"showCurrentAtPos"):0),n),this._updateDatepicker(o))},_gotoToday:function(e){var t=$(e),n=this._getInst(t[0]);if(this._get(n,"gotoCurrent")&&n.currentDay)n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear;else{var i=new Date;n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()}this._notifyChange(n),this._adjustDate(t)},_selectMonthYear:function(e,t,n){var i=$(e),o=this._getInst(i[0]);o["selected"+("M"==n?"Month":"Year")]=o["draw"+("M"==n?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(i)},_selectDay:function(e,t,n,i){var o=$(e);if(!$(i).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(o[0])){var r=this._getInst(o[0]);r.selectedDay=r.currentDay=$("a",i).html(),r.selectedMonth=r.currentMonth=t,r.selectedYear=r.currentYear=n,this._selectDate(e,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear))}},_clearDate:function(e){{var t=$(e);this._getInst(t[0])}this._selectDate(t,"")},_selectDate:function(e,t){var n=$(e),i=this._getInst(n[0]);t=null!=t?t:this._formatDate(i),i.input&&i.input.val(t),this._updateAlternate(i);var o=this._get(i,"onSelect");o?o.apply(i.input?i.input[0]:null,[t,i]):i.input&&i.input.trigger("change"),i.inline?this._updateDatepicker(i):(this._hideDatepicker(),this._lastInput=i.input[0],"object"!=typeof i.input[0]&&i.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t=this._get(e,"altField");if(t){var n=this._get(e,"altFormat")||this._get(e,"dateFormat"),i=this._getDate(e),o=this.formatDate(n,i,this._getFormatConfig(e));$(t).each(function(){$(this).val(o)})}},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t=new Date(e.getTime());t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1},parseDate:function(e,t,n){if(null==e||null==t)throw"Invalid arguments";if(t="object"==typeof t?t.toString():t+"",""==t)return null;var i=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff;i="string"!=typeof i?i:(new Date).getFullYear()%100+parseInt(i,10);for(var o=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,r=(n?n.dayNames:null)||this._defaults.dayNames,s=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,a=(n?n.monthNames:null)||this._defaults.monthNames,l=-1,c=-1,u=-1,h=-1,d=!1,p=function(t){var n=y+1<e.length&&e.charAt(y+1)==t;return n&&y++,n},f=function(e){var n=p(e),i="@"==e?14:"!"==e?20:"y"==e&&n?4:"o"==e?3:2,o=new RegExp("^\\d{1,"+i+"}"),r=t.substring(v).match(o);if(!r)throw"Missing number at position "+v;return v+=r[0].length,parseInt(r[0],10)},m=function(e,n,i){var o=$.map(p(e)?i:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)}),r=-1;if($.each(o,function(e,n){var i=n[1];return t.substr(v,i.length).toLowerCase()==i.toLowerCase()?(r=n[0],v+=i.length,!1):void 0}),-1!=r)return r+1;throw"Unknown name at position "+v},g=function(){if(t.charAt(v)!=e.charAt(y))throw"Unexpected literal at position "+v;v++},v=0,y=0;y<e.length;y++)if(d)"'"!=e.charAt(y)||p("'")?g():d=!1;else switch(e.charAt(y)){case"d":u=f("d");break;case"D":m("D",o,r);break;case"o":h=f("o");break;case"m":c=f("m");break;case"M":c=m("M",s,a);break;case"y":l=f("y");break;case"@":var b=new Date(f("@"));l=b.getFullYear(),c=b.getMonth()+1,u=b.getDate();break;case"!":var b=new Date((f("!")-this._ticksTo1970)/1e4);l=b.getFullYear(),c=b.getMonth()+1,u=b.getDate();break;case"'":p("'")?g():d=!0;break;default:g()}if(v<t.length){var w=t.substr(v);if(!/^\s+/.test(w))throw"Extra/unparsed characters found in date: "+w}if(-1==l?l=(new Date).getFullYear():100>l&&(l+=(new Date).getFullYear()-(new Date).getFullYear()%100+(i>=l?0:-100)),h>-1)for(c=1,u=h;;){var _=this._getDaysInMonth(l,c-1);if(_>=u)break;c++,u-=_}var b=this._daylightSavingAdjust(new Date(l,c-1,u));if(b.getFullYear()!=l||b.getMonth()+1!=c||b.getDate()!=u)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,/* Format a date object into a string value.
	   The format can be combinations of the following:
	   d  - day of month (no leading zero)
	   dd - day of month (two digit)
	   o  - day of year (no leading zeros)
	   oo - day of year (three digit)
	   D  - day name short
	   DD - day name long
	   m  - month of year (no leading zero)
	   mm - month of year (two digit)
	   M  - month name short
	   MM - month name long
	   y  - year (two digit)
	   yy - year (four digit)
	   @ - Unix timestamp (ms since 01/01/1970)
	   ! - Windows ticks (100ns since 01/01/0001)
	   '...' - literal text
	   '' - single quote

	   @param  format    string - the desired format of the date
	   @param  date      Date - the date value to format
	   @param  settings  Object - attributes include:
	                     dayNamesShort    string[7] - abbreviated names of the days from Sunday (optional)
	                     dayNames         string[7] - names of the days from Sunday (optional)
	                     monthNamesShort  string[12] - abbreviated names of the months (optional)
	                     monthNames       string[12] - names of the months (optional)
	   @return  string - the date in the above format */
formatDate:function(e,t,n){if(!t)return"";var i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,o=(n?n.dayNames:null)||this._defaults.dayNames,r=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,s=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=d+1<e.length&&e.charAt(d+1)==t;return n&&d++,n},l=function(e,t,n){var i=""+t;if(a(e))for(;i.length<n;)i="0"+i;return i},c=function(e,t,n,i){return a(e)?i[t]:n[t]},u="",h=!1;if(t)for(var d=0;d<e.length;d++)if(h)"'"!=e.charAt(d)||a("'")?u+=e.charAt(d):h=!1;else switch(e.charAt(d)){case"d":u+=l("d",t.getDate(),2);break;case"D":u+=c("D",t.getDay(),i,o);break;case"o":u+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=l("m",t.getMonth()+1,2);break;case"M":u+=c("M",t.getMonth(),r,s);break;case"y":u+=a("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=1e4*t.getTime()+this._ticksTo1970;break;case"'":a("'")?u+="'":h=!0;break;default:u+=e.charAt(d)}return u},_possibleChars:function(e){for(var t="",n=!1,i=function(t){var n=o+1<e.length&&e.charAt(o+1)==t;return n&&o++,n},o=0;o<e.length;o++)if(n)"'"!=e.charAt(o)||i("'")?t+=e.charAt(o):n=!1;else switch(e.charAt(o)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":i("'")?t+="'":n=!0;break;default:t+=e.charAt(o)}return t},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!=e.lastVal){var n,i,o=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null;n=i=this._getDefaultDate(e);var s=this._getFormatConfig(e);try{n=this.parseDate(o,r,s)||i}catch(a){this.log(a),r=t?"":r}e.selectedDay=n.getDate(),e.drawMonth=e.selectedMonth=n.getMonth(),e.drawYear=e.selectedYear=n.getFullYear(),e.currentDay=r?n.getDate():0,e.currentMonth=r?n.getMonth():0,e.currentYear=r?n.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,n){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},o=function(t){try{return $.datepicker.parseDate($.datepicker._get(e,"dateFormat"),t,$.datepicker._getFormatConfig(e))}catch(n){}for(var i=(t.toLowerCase().match(/^c/)?$.datepicker._getDate(e):null)||new Date,o=i.getFullYear(),r=i.getMonth(),s=i.getDate(),a=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=a.exec(t);l;){switch(l[2]||"d"){case"d":case"D":s+=parseInt(l[1],10);break;case"w":case"W":s+=7*parseInt(l[1],10);break;case"m":case"M":r+=parseInt(l[1],10),s=Math.min(s,$.datepicker._getDaysInMonth(o,r));break;case"y":case"Y":o+=parseInt(l[1],10),s=Math.min(s,$.datepicker._getDaysInMonth(o,r))}l=a.exec(t)}return new Date(o,r,s)},r=null==t||""===t?n:"string"==typeof t?o(t):"number"==typeof t?isNaN(t)?n:i(t):new Date(t.getTime());return r=r&&"Invalid Date"==r.toString()?n:r,r&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var i=!t,o=e.selectedMonth,r=e.selectedYear,s=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=s.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=s.getMonth(),e.drawYear=e.selectedYear=e.currentYear=s.getFullYear(),o==e.selectedMonth&&r==e.selectedYear||n||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(i?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""==e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,-t,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,+t,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(n)},selectDay:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t=new Date;t=this._daylightSavingAdjust(new Date(t.getFullYear(),t.getMonth(),t.getDate()));var n=this._get(e,"isRTL"),i=this._get(e,"showButtonPanel"),o=this._get(e,"hideIfNoPrevNext"),r=this._get(e,"navigationAsDateFormat"),s=this._getNumberOfMonths(e),a=this._get(e,"showCurrentAtPos"),l=this._get(e,"stepMonths"),c=1!=s[0]||1!=s[1],u=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),h=this._getMinMaxDate(e,"min"),d=this._getMinMaxDate(e,"max"),p=e.drawMonth-a,f=e.drawYear;if(0>p&&(p+=12,f--),d){var m=this._daylightSavingAdjust(new Date(d.getFullYear(),d.getMonth()-s[0]*s[1]+1,d.getDate()));for(m=h&&h>m?h:m;this._daylightSavingAdjust(new Date(f,p,1))>m;)p--,0>p&&(p=11,f--)}e.drawMonth=p,e.drawYear=f;var g=this._get(e,"prevText");g=r?this.formatDate(g,this._daylightSavingAdjust(new Date(f,p-l,1)),this._getFormatConfig(e)):g;var v=this._canAdjustMonth(e,-1,f,p)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+g+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+g+"</span></a>":o?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+g+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+g+"</span></a>",y=this._get(e,"nextText");y=r?this.formatDate(y,this._daylightSavingAdjust(new Date(f,p+l,1)),this._getFormatConfig(e)):y;var b=this._canAdjustMonth(e,1,f,p)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>":o?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>",w=this._get(e,"currentText"),_=this._get(e,"gotoCurrent")&&e.currentDay?u:t;w=r?this.formatDate(w,_,this._getFormatConfig(e)):w;var C=e.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(e,"closeText")+"</button>",S=i?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(n?C:"")+(this._isInRange(e,_)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+w+"</button>":"")+(n?"":C)+"</div>":"",x=parseInt(this._get(e,"firstDay"),10);x=isNaN(x)?0:x;for(var E=this._get(e,"showWeek"),k=this._get(e,"dayNames"),T=(this._get(e,"dayNamesShort"),this._get(e,"dayNamesMin")),D=this._get(e,"monthNames"),M=this._get(e,"monthNamesShort"),j=this._get(e,"beforeShowDay"),R=this._get(e,"showOtherMonths"),A=this._get(e,"selectOtherMonths"),N=(this._get(e,"calculateWeek")||this.iso8601Week,this._getDefaultDate(e)),P="",I=0;I<s[0];I++){var O="";this.maxRows=4;for(var F=0;F<s[1];F++){var L=this._daylightSavingAdjust(new Date(f,p,e.selectedDay)),B=" ui-corner-all",H="";if(c){if(H+='<div class="ui-datepicker-group',s[1]>1)switch(F){case 0:H+=" ui-datepicker-group-first",B=" ui-corner-"+(n?"right":"left");break;case s[1]-1:H+=" ui-datepicker-group-last",B=" ui-corner-"+(n?"left":"right");break;default:H+=" ui-datepicker-group-middle",B=""}H+='">'}H+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+B+'">'+(/all|left/.test(B)&&0==I?n?b:v:"")+(/all|right/.test(B)&&0==I?n?v:b:"")+this._generateMonthYearHeader(e,p,f,h,d,I>0||F>0,D,M)+'</div><table class="ui-datepicker-calendar"><thead><tr>';for(var U=E?'<th class="ui-datepicker-week-col">'+this._get(e,"weekHeader")+"</th>":"",W=0;7>W;W++){var z=(W+x)%7;U+="<th"+((W+x+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+k[z]+'">'+T[z]+"</span></th>"}H+=U+"</tr></thead><tbody>";var q=this._getDaysInMonth(f,p);f==e.selectedYear&&p==e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,q));var V=(this._getFirstDayOfMonth(f,p)-x+7)%7,Y=Math.ceil((V+q)/7),G=c&&this.maxRows>Y?this.maxRows:Y;this.maxRows=G;for(var K=this._daylightSavingAdjust(new Date(f,p,1-V)),Q=0;G>Q;Q++){H+="<tr>";for(var J=E?'<td class="ui-datepicker-week-col">'+this._get(e,"calculateWeek")(K)+"</td>":"",W=0;7>W;W++){var X=j?j.apply(e.input?e.input[0]:null,[K]):[!0,""],Z=K.getMonth()!=p,et=Z&&!A||!X[0]||h&&h>K||d&&K>d;J+='<td class="'+((W+x+6)%7>=5?" ui-datepicker-week-end":"")+(Z?" ui-datepicker-other-month":"")+(K.getTime()==L.getTime()&&p==e.selectedMonth&&e._keyEvent||N.getTime()==K.getTime()&&N.getTime()==L.getTime()?" "+this._dayOverClass:"")+(et?" "+this._unselectableClass+" ui-state-disabled":"")+(Z&&!R?"":" "+X[1]+(K.getTime()==u.getTime()?" "+this._currentClass:"")+(K.getTime()==t.getTime()?" ui-datepicker-today":""))+'"'+(Z&&!R||!X[2]?"":' title="'+X[2]+'"')+(et?"":' data-handler="selectDay" data-event="click" data-month="'+K.getMonth()+'" data-year="'+K.getFullYear()+'"')+">"+(Z&&!R?"&#xa0;":et?'<span class="ui-state-default">'+K.getDate()+"</span>":'<a class="ui-state-default'+(K.getTime()==t.getTime()?" ui-state-highlight":"")+(K.getTime()==u.getTime()?" ui-state-active":"")+(Z?" ui-priority-secondary":"")+'" href="#">'+K.getDate()+"</a>")+"</td>",K.setDate(K.getDate()+1),K=this._daylightSavingAdjust(K)}H+=J+"</tr>"}p++,p>11&&(p=0,f++),H+="</tbody></table>"+(c?"</div>"+(s[0]>0&&F==s[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),O+=H}P+=O}return P+=S+($.ui.ie6&&!e.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),e._keyEvent=!1,P},_generateMonthYearHeader:function(e,t,n,i,o,r,s,a){var l=this._get(e,"changeMonth"),c=this._get(e,"changeYear"),u=this._get(e,"showMonthAfterYear"),h='<div class="ui-datepicker-title">',d="";if(r||!l)d+='<span class="ui-datepicker-month">'+s[t]+"</span>";else{var p=i&&i.getFullYear()==n,f=o&&o.getFullYear()==n;d+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var m=0;12>m;m++)(!p||m>=i.getMonth())&&(!f||m<=o.getMonth())&&(d+='<option value="'+m+'"'+(m==t?' selected="selected"':"")+">"+a[m]+"</option>");d+="</select>"}if(u||(h+=d+(!r&&l&&c?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",r||!c)h+='<span class="ui-datepicker-year">'+n+"</span>";else{var g=this._get(e,"yearRange").split(":"),v=(new Date).getFullYear(),y=function(e){var t=e.match(/c[+-].*/)?n+parseInt(e.substring(1),10):e.match(/[+-].*/)?v+parseInt(e,10):parseInt(e,10);return isNaN(t)?v:t},b=y(g[0]),w=Math.max(b,y(g[1]||""));for(b=i?Math.max(b,i.getFullYear()):b,w=o?Math.min(w,o.getFullYear()):w,e.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';w>=b;b++)e.yearshtml+='<option value="'+b+'"'+(b==n?' selected="selected"':"")+">"+b+"</option>";e.yearshtml+="</select>",h+=e.yearshtml,e.yearshtml=null}return h+=this._get(e,"yearSuffix"),u&&(h+=(!r&&l&&c?"":"&#xa0;")+d),h+="</div>"},_adjustInstDate:function(e,t,n){var i=e.drawYear+("Y"==n?t:0),o=e.drawMonth+("M"==n?t:0),r=Math.min(e.selectedDay,this._getDaysInMonth(i,o))+("D"==n?t:0),s=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(i,o,r)));e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),("M"==n||"Y"==n)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),o=n&&n>t?n:t;return o=i&&o>i?i:o},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,n,i){var o=this._getNumberOfMonths(e),r=this._daylightSavingAdjust(new Date(n,i+(0>t?t:o[0]*o[1]),1));return 0>t&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(e,r)},_isInRange:function(e,t){var n=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max");return(!n||t.getTime()>=n.getTime())&&(!i||t.getTime()<=i.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,i){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var o=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(i,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),o,this._getFormatConfig(e))}}),$.fn.datepicker=function(e){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find(document.body).append($.datepicker.dpDiv),$.datepicker.initialized=!0);var t=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!=e&&"getDate"!=e&&"widget"!=e?"option"==e&&2==arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this].concat(t)):$.datepicker._attachDatepicker(this,e)}):$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.9.2",window["DP_jQuery_"+dpuuid]=$}(jQuery),function(e,t){var n="ui-dialog ui-widget ui-widget-content ui-corner-all ",i={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},o={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.9.2",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;0>n&&e(this).css("top",t.top-n)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),"string"!=typeof this.originalTitle&&(this.originalTitle=""),this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.options.title=this.options.title||this.originalTitle;var t,i,o,r,s,a=this,l=this.options,c=l.title||"&#160;";t=(this.uiDialog=e("<div>")).addClass(n+l.dialogClass).css({display:"none",outline:0,zIndex:l.zIndex}).attr("tabIndex",-1).keydown(function(t){l.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE&&(a.close(t),t.preventDefault())}).mousedown(function(e){a.moveToTop(!1,e)}).appendTo("body"),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(t),i=(this.uiDialogTitlebar=e("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").bind("mousedown",function(){t.focus()}).prependTo(t),o=e("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(e){e.preventDefault(),a.close(e)}).appendTo(i),(this.uiDialogTitlebarCloseText=e("<span>")).addClass("ui-icon ui-icon-closethick").text(l.closeText).appendTo(o),r=e("<span>").uniqueId().addClass("ui-dialog-title").html(c).prependTo(i),s=(this.uiDialogButtonPane=e("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),(this.uiButtonSet=e("<div>")).addClass("ui-dialog-buttonset").appendTo(s),t.attr({role:"dialog","aria-labelledby":r.attr("id")}),i.find("*").add(i).disableSelection(),this._hoverable(o),this._focusable(o),l.draggable&&e.fn.draggable&&this._makeDraggable(),l.resizable&&e.fn.resizable&&this._makeResizable(),this._createButtons(l.buttons),this._isOpen=!1,e.fn.bgiframe&&t.bgiframe(),this._on(t,{keydown:function(n){if(l.modal&&n.keyCode===e.ui.keyCode.TAB){var i=e(":tabbable",t),o=i.filter(":first"),r=i.filter(":last");return n.target!==r[0]||n.shiftKey?n.target===o[0]&&n.shiftKey?(r.focus(1),!1):void 0:(o.focus(1),!1)}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var e,t=this.oldPosition;this.overlay&&this.overlay.destroy(),this.uiDialog.hide(),this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(t){var n,i,o=this;if(this._isOpen&&!1!==this._trigger("beforeClose",t))return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this._hide(this.uiDialog,this.options.hide,function(){o._trigger("close",t)}):(this.uiDialog.hide(),this._trigger("close",t)),e.ui.dialog.overlay.resize(),this.options.modal&&(n=0,e(".ui-dialog").each(function(){this!==o.uiDialog[0]&&(i=e(this).css("z-index"),isNaN(i)||(n=Math.max(n,i)))}),e.ui.dialog.maxZ=n),this},isOpen:function(){return this._isOpen},moveToTop:function(t,n){var i,o=this.options;return o.modal&&!t||!o.stack&&!o.modal?this._trigger("focus",n):(o.zIndex>e.ui.dialog.maxZ&&(e.ui.dialog.maxZ=o.zIndex),this.overlay&&(e.ui.dialog.maxZ+=1,e.ui.dialog.overlay.maxZ=e.ui.dialog.maxZ,this.overlay.$el.css("z-index",e.ui.dialog.overlay.maxZ)),i={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},e.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",e.ui.dialog.maxZ),this.element.attr(i),this._trigger("focus",n),this)},open:function(){if(!this._isOpen){var t,n=this.options,i=this.uiDialog;return this._size(),this._position(n.position),i.show(n.show),this.overlay=n.modal?new e.ui.dialog.overlay(this):null,this.moveToTop(!0),t=this.element.find(":tabbable"),t.length||(t=this.uiDialogButtonPane.find(":tabbable"),t.length||(t=i)),t.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this}},_createButtons:function(t){var n=this,i=!1;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),"object"==typeof t&&null!==t&&e.each(t,function(){return!(i=!0)}),i?(e.each(t,function(t,i){var o,r;i=e.isFunction(i)?{click:i,text:t}:i,i=e.extend({type:"button"},i),r=i.click,i.click=function(){r.apply(n.element[0],arguments)},o=e("<button></button>",i).appendTo(n.uiButtonSet),e.fn.button&&o.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var n=this,i=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(i,o){e(this).addClass("ui-dialog-dragging"),n._trigger("dragStart",i,t(o))},drag:function(e,i){n._trigger("drag",e,t(i))},stop:function(o,r){i.position=[r.position.left-n.document.scrollLeft(),r.position.top-n.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),n._trigger("dragStop",o,t(r)),e.ui.dialog.overlay.resize()}})},_makeResizable:function(n){function i(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}n=n===t?this.options.resizable:n;var o=this,r=this.options,s=this.uiDialog.css("position"),a="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:r.maxWidth,maxHeight:r.maxHeight,minWidth:r.minWidth,minHeight:this._minHeight(),handles:a,start:function(t,n){e(this).addClass("ui-dialog-resizing"),o._trigger("resizeStart",t,i(n))},resize:function(e,t){o._trigger("resize",e,i(t))},stop:function(t,n){e(this).removeClass("ui-dialog-resizing"),r.height=e(this).height(),r.width=e(this).width(),o._trigger("resizeStop",t,i(n)),e.ui.dialog.overlay.resize()}}).css("position",s).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(t){var n,i=[],o=[0,0];t?(("string"==typeof t||"object"==typeof t&&"0"in t)&&(i=t.split?t.split(" "):[t[0],t[1]],1===i.length&&(i[1]=i[0]),e.each(["left","top"],function(e,t){+i[e]===i[e]&&(o[e]=i[e],i[e]=t)}),t={my:i[0]+(o[0]<0?o[0]:"+"+o[0])+" "+i[1]+(o[1]<0?o[1]:"+"+o[1]),at:i.join(" ")}),t=e.extend({},e.ui.dialog.prototype.options.position,t)):t=e.ui.dialog.prototype.options.position,n=this.uiDialog.is(":visible"),n||this.uiDialog.show(),this.uiDialog.position(t),n||this.uiDialog.hide()},_setOptions:function(t){var n=this,r={},s=!1;e.each(t,function(e,t){n._setOption(e,t),e in i&&(s=!0),e in o&&(r[e]=t)}),s&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",r)},_setOption:function(t,i){var o,r,s=this.uiDialog;switch(t){case"buttons":this._createButtons(i);break;case"closeText":this.uiDialogTitlebarCloseText.text(""+i);break;case"dialogClass":s.removeClass(this.options.dialogClass).addClass(n+i);break;case"disabled":i?s.addClass("ui-dialog-disabled"):s.removeClass("ui-dialog-disabled");break;case"draggable":o=s.is(":data(draggable)"),o&&!i&&s.draggable("destroy"),!o&&i&&this._makeDraggable();break;case"position":this._position(i);break;case"resizable":r=s.is(":data(resizable)"),r&&!i&&s.resizable("destroy"),r&&"string"==typeof i&&s.resizable("option","handles",i),r||i===!1||this._makeResizable(i);break;case"title":e(".ui-dialog-title",this.uiDialogTitlebar).html(""+(i||"&#160;"))}this._super(t,i)},_size:function(){var t,n,i,o=this.options,r=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),o.minWidth>o.width&&(o.width=o.minWidth),t=this.uiDialog.css({height:"auto",width:o.width}).outerHeight(),n=Math.max(0,o.minHeight-t),"auto"===o.height?e.support.minHeight?this.element.css({minHeight:n,height:"auto"}):(this.uiDialog.show(),i=this.element.css("height","auto").height(),r||this.uiDialog.hide(),this.element.height(Math.max(i,n))):this.element.height(Math.max(o.height-t,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),e.extend(e.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(e){var t=e.attr("id");return t||(this.uuid+=1,t=this.uuid),"ui-dialog-title-"+t},overlay:function(t){this.$el=e.ui.dialog.overlay.create(t)}}),e.extend(e.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".dialog-overlay"}).join(" "),create:function(t){0===this.instances.length&&(setTimeout(function(){e.ui.dialog.overlay.instances.length&&e(document).bind(e.ui.dialog.overlay.events,function(t){return e(t.target).zIndex()<e.ui.dialog.overlay.maxZ?!1:void 0})},1),e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize));var n=this.oldInstances.pop()||e("<div>").addClass("ui-widget-overlay");return e(document).bind("keydown.dialog-overlay",function(i){var o=e.ui.dialog.overlay.instances;0!==o.length&&o[o.length-1]===n&&t.options.closeOnEscape&&!i.isDefaultPrevented()&&i.keyCode&&i.keyCode===e.ui.keyCode.ESCAPE&&(t.close(i),i.preventDefault())}),n.appendTo(document.body).css({width:this.width(),height:this.height()}),e.fn.bgiframe&&n.bgiframe(),this.instances.push(n),n},destroy:function(t){var n=e.inArray(t,this.instances),i=0;-1!==n&&this.oldInstances.push(this.instances.splice(n,1)[0]),0===this.instances.length&&e([document,window]).unbind(".dialog-overlay"),t.height(0).width(0).remove(),e.each(this.instances,function(){i=Math.max(i,this.css("z-index"))}),this.maxZ=i},height:function(){var t,n;return e.ui.ie?(t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),n=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),n>t?e(window).height()+"px":t+"px"):e(document).height()+"px"},width:function(){var t,n;return e.ui.ie?(t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),n=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),n>t?e(window).width()+"px":t+"px"):e(document).width()+"px"},resize:function(){var t=e([]);e.each(e.ui.dialog.overlay.instances,function(){t=t.add(this)}),t.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}}),e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(e){var t=/up|down|vertical/,n=/up|left|vertical|horizontal/;e.effects.effect.blind=function(i,o){var r,s,a,l=e(this),c=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(l,i.mode||"hide"),h=i.direction||"up",d=t.test(h),p=d?"height":"width",f=d?"top":"left",m=n.test(h),g={},v="show"===u;l.parent().is(".ui-effects-wrapper")?e.effects.save(l.parent(),c):e.effects.save(l,c),l.show(),r=e.effects.createWrapper(l).css({overflow:"hidden"}),s=r[p](),a=parseFloat(r.css(f))||0,g[p]=v?s:0,m||(l.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),g[f]=v?a:s+a),v&&(r.css(p,0),m||r.css(f,a+s)),r.animate(g,{duration:i.duration,easing:i.easing,queue:!1,complete:function(){"hide"===u&&l.hide(),e.effects.restore(l,c),e.effects.removeWrapper(l),o()}})}}(jQuery),function(e){e.effects.effect.bounce=function(t,n){var i,o,r,s=e(this),a=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(s,t.mode||"effect"),c="hide"===l,u="show"===l,h=t.direction||"up",d=t.distance,p=t.times||5,f=2*p+(u||c?1:0),m=t.duration/f,g=t.easing,v="up"===h||"down"===h?"top":"left",y="up"===h||"left"===h,b=s.queue(),w=b.length;for((u||c)&&a.push("opacity"),e.effects.save(s,a),s.show(),e.effects.createWrapper(s),d||(d=s["top"===v?"outerHeight":"outerWidth"]()/3),u&&(r={opacity:1},r[v]=0,s.css("opacity",0).css(v,y?2*-d:2*d).animate(r,m,g)),c&&(d/=Math.pow(2,p-1)),r={},r[v]=0,i=0;p>i;i++)o={},o[v]=(y?"-=":"+=")+d,s.animate(o,m,g).animate(r,m,g),d=c?2*d:d/2;c&&(o={opacity:0},o[v]=(y?"-=":"+=")+d,s.animate(o,m,g)),s.queue(function(){c&&s.hide(),e.effects.restore(s,a),e.effects.removeWrapper(s),n()}),w>1&&b.splice.apply(b,[1,0].concat(b.splice(w,f+1))),s.dequeue()}}(jQuery),function(e){e.effects.effect.clip=function(t,n){var i,o,r,s=e(this),a=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(s,t.mode||"hide"),c="show"===l,u=t.direction||"vertical",h="vertical"===u,d=h?"height":"width",p=h?"top":"left",f={};e.effects.save(s,a),s.show(),i=e.effects.createWrapper(s).css({overflow:"hidden"}),o="IMG"===s[0].tagName?i:s,r=o[d](),c&&(o.css(d,0),o.css(p,r/2)),f[d]=c?r:0,f[p]=c?0:r/2,o.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){c||s.hide(),e.effects.restore(s,a),e.effects.removeWrapper(s),n()}})}}(jQuery),function(e){e.effects.effect.drop=function(t,n){var i,o=e(this),r=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(o,t.mode||"hide"),a="show"===s,l=t.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l?"pos":"neg",h={opacity:a?1:0};e.effects.save(o,r),o.show(),e.effects.createWrapper(o),i=t.distance||o["top"===c?"outerHeight":"outerWidth"](!0)/2,a&&o.css("opacity",0).css(c,"pos"===u?-i:i),h[c]=(a?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+i,o.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),n()}})}}(jQuery),function(e){e.effects.effect.explode=function(t,n){function i(){b.push(this),b.length===h*d&&o()}function o(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),n()}var r,s,a,l,c,u,h=t.pieces?Math.round(Math.sqrt(t.pieces)):3,d=h,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),y=Math.ceil(p.outerHeight()/h),b=[];for(r=0;h>r;r++)for(l=g.top+r*y,u=r-(h-1)/2,s=0;d>s;s++)a=g.left+s*v,c=s-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-s*v,top:-r*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:a+(m?c*v:0),top:l+(m?u*y:0),opacity:m?0:1}).animate({left:a+(m?0:c*v),top:l+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,i)}}(jQuery),function(e){e.effects.effect.fade=function(t,n){var i=e(this),o=e.effects.setMode(i,t.mode||"toggle");i.animate({opacity:o},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}}(jQuery),function(e){e.effects.effect.fold=function(t,n){var i,o,r=e(this),s=["position","top","bottom","left","right","height","width"],a=e.effects.setMode(r,t.mode||"hide"),l="show"===a,c="hide"===a,u=t.size||15,h=/([0-9]+)%/.exec(u),d=!!t.horizFirst,p=l!==d,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(r,s),r.show(),i=e.effects.createWrapper(r).css({overflow:"hidden"}),o=p?[i.width(),i.height()]:[i.height(),i.width()],h&&(u=parseInt(h[1],10)/100*o[c?0:1]),l&&i.css(d?{height:0,width:u}:{height:u,width:0}),g[f[0]]=l?o[0]:u,v[f[1]]=l?o[1]:0,i.animate(g,m,t.easing).animate(v,m,t.easing,function(){c&&r.hide(),e.effects.restore(r,s),e.effects.removeWrapper(r),n()})}}(jQuery),function(e){e.effects.effect.highlight=function(t,n){var i=e(this),o=["backgroundImage","backgroundColor","opacity"],r=e.effects.setMode(i,t.mode||"show"),s={backgroundColor:i.css("backgroundColor")};"hide"===r&&(s.opacity=0),e.effects.save(i,o),i.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(s,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===r&&i.hide(),e.effects.restore(i,o),n()}})}}(jQuery),function(e){e.effects.effect.pulsate=function(t,n){var i,o=e(this),r=e.effects.setMode(o,t.mode||"show"),s="show"===r,a="hide"===r,l=s||"hide"===r,c=2*(t.times||5)+(l?1:0),u=t.duration/c,h=0,d=o.queue(),p=d.length;for((s||!o.is(":visible"))&&(o.css("opacity",0).show(),h=1),i=1;c>i;i++)o.animate({opacity:h},u,t.easing),h=1-h;o.animate({opacity:h},u,t.easing),o.queue(function(){a&&o.hide(),n()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,c+1))),o.dequeue()}}(jQuery),function(e){e.effects.effect.puff=function(t,n){var i=e(this),o=e.effects.setMode(i,t.mode||"hide"),r="hide"===o,s=parseInt(t.percent,10)||150,a=s/100,l={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:o,complete:n,percent:r?s:100,from:r?l:{height:l.height*a,width:l.width*a,outerHeight:l.outerHeight*a,outerWidth:l.outerWidth*a}}),i.effect(t)},e.effects.effect.scale=function(t,n){var i=e(this),o=e.extend(!0,{},t),r=e.effects.setMode(i,t.mode||"effect"),s=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===r?0:100),a=t.direction||"both",l=t.origin,c={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()},u={y:"horizontal"!==a?s/100:1,x:"vertical"!==a?s/100:1};o.effect="size",o.queue=!1,o.complete=n,"effect"!==r&&(o.origin=l||["middle","center"],o.restore=!0),o.from=t.from||("show"===r?{height:0,width:0,outerHeight:0,outerWidth:0}:c),o.to={height:c.height*u.y,width:c.width*u.x,outerHeight:c.outerHeight*u.y,outerWidth:c.outerWidth*u.x},o.fade&&("show"===r&&(o.from.opacity=0,o.to.opacity=1),"hide"===r&&(o.from.opacity=1,o.to.opacity=0)),i.effect(o)},e.effects.effect.size=function(t,n){var i,o,r,s=e(this),a=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],c=["width","height","overflow"],u=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(s,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=s.css("position"),y=f?a:l,b={height:0,width:0,outerHeight:0,outerWidth:0};
"show"===p&&s.show(),i={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},"toggle"===t.mode&&"show"===p?(s.from=t.to||b,s.to=t.from||i):(s.from=t.from||("show"===p?b:i),s.to=t.to||("hide"===p?b:i)),r={from:{y:s.from.height/i.height,x:s.from.width/i.width},to:{y:s.to.height/i.height,x:s.to.width/i.width}},("box"===m||"both"===m)&&(r.from.y!==r.to.y&&(y=y.concat(h),s.from=e.effects.setTransition(s,h,r.from.y,s.from),s.to=e.effects.setTransition(s,h,r.to.y,s.to)),r.from.x!==r.to.x&&(y=y.concat(d),s.from=e.effects.setTransition(s,d,r.from.x,s.from),s.to=e.effects.setTransition(s,d,r.to.x,s.to))),("content"===m||"both"===m)&&r.from.y!==r.to.y&&(y=y.concat(u).concat(c),s.from=e.effects.setTransition(s,u,r.from.y,s.from),s.to=e.effects.setTransition(s,u,r.to.y,s.to)),e.effects.save(s,y),s.show(),e.effects.createWrapper(s),s.css("overflow","hidden").css(s.from),g&&(o=e.effects.getBaseline(g,i),s.from.top=(i.outerHeight-s.outerHeight())*o.y,s.from.left=(i.outerWidth-s.outerWidth())*o.x,s.to.top=(i.outerHeight-s.to.outerHeight)*o.y,s.to.left=(i.outerWidth-s.to.outerWidth)*o.x),s.css(s.from),("content"===m||"both"===m)&&(h=h.concat(["marginTop","marginBottom"]).concat(u),d=d.concat(["marginLeft","marginRight"]),c=a.concat(h).concat(d),s.find("*[width]").each(function(){var n=e(this),i={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};f&&e.effects.save(n,c),n.from={height:i.height*r.from.y,width:i.width*r.from.x,outerHeight:i.outerHeight*r.from.y,outerWidth:i.outerWidth*r.from.x},n.to={height:i.height*r.to.y,width:i.width*r.to.x,outerHeight:i.height*r.to.y,outerWidth:i.width*r.to.x},r.from.y!==r.to.y&&(n.from=e.effects.setTransition(n,h,r.from.y,n.from),n.to=e.effects.setTransition(n,h,r.to.y,n.to)),r.from.x!==r.to.x&&(n.from=e.effects.setTransition(n,d,r.from.x,n.from),n.to=e.effects.setTransition(n,d,r.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){f&&e.effects.restore(n,c)})})),s.animate(s.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===s.to.opacity&&s.css("opacity",s.from.opacity),"hide"===p&&s.hide(),e.effects.restore(s,y),f||("static"===v?s.css({position:"relative",top:s.to.top,left:s.to.left}):e.each(["top","left"],function(e,t){s.css(t,function(t,n){var i=parseInt(n,10),o=e?s.to.left:s.to.top;return"auto"===n?o+"px":i+o+"px"})})),e.effects.removeWrapper(s),n()}})}}(jQuery),function(e){e.effects.effect.shake=function(t,n){var i,o=e(this),r=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(o,t.mode||"effect"),a=t.direction||"left",l=t.distance||20,c=t.times||3,u=2*c+1,h=Math.round(t.duration/u),d="up"===a||"down"===a?"top":"left",p="up"===a||"left"===a,f={},m={},g={},v=o.queue(),y=v.length;for(e.effects.save(o,r),o.show(),e.effects.createWrapper(o),f[d]=(p?"-=":"+=")+l,m[d]=(p?"+=":"-=")+2*l,g[d]=(p?"-=":"+=")+2*l,o.animate(f,h,t.easing),i=1;c>i;i++)o.animate(m,h,t.easing).animate(g,h,t.easing);o.animate(m,h,t.easing).animate(f,h/2,t.easing).queue(function(){"hide"===s&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),n()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),o.dequeue()}}(jQuery),function(e){e.effects.effect.slide=function(t,n){var i,o=e(this),r=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(o,t.mode||"show"),a="show"===s,l=t.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l,h={};e.effects.save(o,r),o.show(),i=t.distance||o["top"===c?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(o).css({overflow:"hidden"}),a&&o.css(c,u?isNaN(i)?"-"+i:-i:i),h[c]=(a?u?"+=":"-=":u?"-=":"+=")+i,o.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),n()}})}}(jQuery),function(e){e.effects.effect.transfer=function(t,n){var i=e(this),o=e(t.to),r="fixed"===o.css("position"),s=e("body"),a=r?s.scrollTop():0,l=r?s.scrollLeft():0,c=o.offset(),u={top:c.top-a,left:c.left-l,height:o.innerHeight(),width:o.innerWidth()},h=i.offset(),d=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.className).css({top:h.top-a,left:h.left-l,height:i.innerHeight(),width:i.innerWidth(),position:r?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){d.remove(),n()})}}(jQuery),function(e){var t=!1;e.widget("ui.menu",{version:"1.9.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(n){var i=e(n.target).closest(".ui-menu-item");!t&&i.not(".ui-state-disabled").length&&(t=!0,this.select(n),i.has(".ui-menu").length?this.expand(n):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(n){e(n.target).closest(".ui-menu").length||this.collapseAll(n),t=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var i,o,r,s,a,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,o=this.previousFilter||"",r=String.fromCharCode(t.keyCode),s=!1,clearTimeout(this.filterTimer),r===o?s=!0:r=o+r,a=new RegExp("^"+n(r),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(e(this).children("a").text())}),i=s&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(r=String.fromCharCode(t.keyCode),a=new RegExp("^"+n(r),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(e(this).children("a").text())})),i.length?(this.focus(t,i),i.length>1?(this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,i=this.element.find(this.options.menus);i.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.prev("a"),o=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(o),t.attr("aria-labelledby",i.attr("id"))}),t=i.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(e,t){var n,i;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),i=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,i,o,r,s,a;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,o=t.offset().top-this.activeMenu.offset().top-n-i,r=this.activeMenu.scrollTop(),s=this.activeMenu.height(),a=t.height(),0>o?this.activeMenu.scrollTop(r+o):o+a>s&&this.activeMenu.scrollTop(r+o-s+a))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var i=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(t),this.activeMenu=i},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(n,i)},nextPage:function(t){var n,i,o;return this.active?void(this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,o=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-i-o<0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var n,i,o;return this.active?void(this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,o=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-i+o>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){function n(e,t,n){return[parseInt(e[0],10)*(d.test(e[0])?t/100:1),parseInt(e[1],10)*(d.test(e[1])?n/100:1)]}function i(t,n){return parseInt(e.css(t,n),10)||0}e.ui=e.ui||{};var o,r=Math.max,s=Math.abs,a=Math.round,l=/left|center|right/,c=/top|center|bottom/,u=/[\+\-]\d+%?/,h=/^\w+/,d=/%$/,p=e.fn.position;e.position={scrollbarWidth:function(){if(o!==t)return o;var n,i,r=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=r.children()[0];return e("body").append(r),n=s.offsetWidth,r.css("overflow","scroll"),i=s.offsetWidth,n===i&&(i=r[0].clientWidth),r.remove(),o=n-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),i=t.isWindow?"":t.element.css("overflow-y"),o="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,r="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;return{width:o?e.position.scrollbarWidth():0,height:r?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=e.isWindow(n[0]);return{element:n,isWindow:i,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:i?n.width():n.outerWidth(),height:i?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return p.apply(this,arguments);t=e.extend({},t);var o,d,f,m,g,v=e(t.of),y=e.position.getWithinInfo(t.within),b=e.position.getScrollInfo(y),w=v[0],_=(t.collision||"flip").split(" "),C={};return 9===w.nodeType?(d=v.width(),f=v.height(),m={top:0,left:0}):e.isWindow(w)?(d=v.width(),f=v.height(),m={top:v.scrollTop(),left:v.scrollLeft()}):w.preventDefault?(t.at="left top",d=f=0,m={top:w.pageY,left:w.pageX}):(d=v.outerWidth(),f=v.outerHeight(),m=v.offset()),g=e.extend({},m),e.each(["my","at"],function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",e=u.exec(i[0]),n=u.exec(i[1]),C[this]=[e?e[0]:0,n?n[0]:0],t[this]=[h.exec(i[0])[0],h.exec(i[1])[0]]}),1===_.length&&(_[1]=_[0]),"right"===t.at[0]?g.left+=d:"center"===t.at[0]&&(g.left+=d/2),"bottom"===t.at[1]?g.top+=f:"center"===t.at[1]&&(g.top+=f/2),o=n(C.at,d,f),g.left+=o[0],g.top+=o[1],this.each(function(){var l,c,u=e(this),h=u.outerWidth(),p=u.outerHeight(),w=i(this,"marginLeft"),S=i(this,"marginTop"),x=h+w+i(this,"marginRight")+b.width,E=p+S+i(this,"marginBottom")+b.height,k=e.extend({},g),T=n(C.my,u.outerWidth(),u.outerHeight());"right"===t.my[0]?k.left-=h:"center"===t.my[0]&&(k.left-=h/2),"bottom"===t.my[1]?k.top-=p:"center"===t.my[1]&&(k.top-=p/2),k.left+=T[0],k.top+=T[1],e.support.offsetFractions||(k.left=a(k.left),k.top=a(k.top)),l={marginLeft:w,marginTop:S},e.each(["left","top"],function(n,i){e.ui.position[_[n]]&&e.ui.position[_[n]][i](k,{targetWidth:d,targetHeight:f,elemWidth:h,elemHeight:p,collisionPosition:l,collisionWidth:x,collisionHeight:E,offset:[o[0]+T[0],o[1]+T[1]],my:t.my,at:t.at,within:y,elem:u})}),e.fn.bgiframe&&u.bgiframe(),t.using&&(c=function(e){var n=m.left-k.left,i=n+d-h,o=m.top-k.top,a=o+f-p,l={target:{element:v,left:m.left,top:m.top,width:d,height:f},element:{element:u,left:k.left,top:k.top,width:h,height:p},horizontal:0>i?"left":n>0?"right":"center",vertical:0>a?"top":o>0?"bottom":"middle"};h>d&&s(n+i)<d&&(l.horizontal="center"),p>f&&s(o+a)<f&&(l.vertical="middle"),l.important=r(s(n),s(i))>r(s(o),s(a))?"horizontal":"vertical",t.using.call(this,e,l)}),u.offset(e.extend(k,{using:c}))})},e.ui.position={fit:{left:function(e,t){var n,i=t.within,o=i.isWindow?i.scrollLeft:i.offset.left,s=i.width,a=e.left-t.collisionPosition.marginLeft,l=o-a,c=a+t.collisionWidth-s-o;t.collisionWidth>s?l>0&&0>=c?(n=e.left+l+t.collisionWidth-s-o,e.left+=l-n):e.left=c>0&&0>=l?o:l>c?o+s-t.collisionWidth:o:l>0?e.left+=l:c>0?e.left-=c:e.left=r(e.left-a,e.left)},top:function(e,t){var n,i=t.within,o=i.isWindow?i.scrollTop:i.offset.top,s=t.within.height,a=e.top-t.collisionPosition.marginTop,l=o-a,c=a+t.collisionHeight-s-o;t.collisionHeight>s?l>0&&0>=c?(n=e.top+l+t.collisionHeight-s-o,e.top+=l-n):e.top=c>0&&0>=l?o:l>c?o+s-t.collisionHeight:o:l>0?e.top+=l:c>0?e.top-=c:e.top=r(e.top-a,e.top)}},flip:{left:function(e,t){var n,i,o=t.within,r=o.offset.left+o.scrollLeft,a=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,c=e.left-t.collisionPosition.marginLeft,u=c-l,h=c+t.collisionWidth-a-l,d="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(n=e.left+d+p+f+t.collisionWidth-a-r,(0>n||n<s(u))&&(e.left+=d+p+f)):h>0&&(i=e.left-t.collisionPosition.marginLeft+d+p+f-l,(i>0||s(i)<h)&&(e.left+=d+p+f))},top:function(e,t){var n,i,o=t.within,r=o.offset.top+o.scrollTop,a=o.height,l=o.isWindow?o.scrollTop:o.offset.top,c=e.top-t.collisionPosition.marginTop,u=c-l,h=c+t.collisionHeight-a-l,d="top"===t.my[1],p=d?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(i=e.top+p+f+m+t.collisionHeight-a-r,e.top+p+f+m>u&&(0>i||i<s(u))&&(e.top+=p+f+m)):h>0&&(n=e.top-t.collisionPosition.marginTop+p+f+m-l,e.top+p+f+m>h&&(n>0||s(n)<h)&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,i,o,r,s=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(s?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in i)t.style[r]=i[r];t.appendChild(a),n=s||document.documentElement,n.insertBefore(t,n.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",o=e(a).offset().left,e.support.offsetFractions=o>10&&11>o,t.innerHTML="",n.removeChild(t)}(),e.uiBackCompat!==!1&&!function(e){var n=e.fn.position;e.fn.position=function(i){if(!i||!i.offset)return n.call(this,i);var o=i.offset.split(" "),r=i.at.split(" ");return 1===o.length&&(o[1]=o[0]),/^\d/.test(o[0])&&(o[0]="+"+o[0]),/^\d/.test(o[1])&&(o[1]="+"+o[1]),1===r.length&&(/left|center|right/.test(r[0])?r[1]="center":(r[1]=r[0],r[0]="center")),n.call(this,e.extend(i,{at:r[0]+o[0]+" "+r[1]+o[1],offset:t}))}}(jQuery)}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.9.2",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this._value():(this._setOption("value",e),this)},_setOption:function(e,t){"value"===e&&(this.options.value=t,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),this._super(e,t)},_value:function(){var e=this.options.value;return"number"!=typeof e&&(e=0),Math.min(this.options.max,Math.max(this.min,e))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var e=this.value(),t=this._percentage();this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),this.valueDiv.toggle(e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%"),this.element.attr("aria-valuenow",e)}})}(jQuery),function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var n,i,o=this.options,r=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",a=[];for(this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(o.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),o.range&&(o.range===!0&&(o.values||(o.values=[this._valueMin(),this._valueMin()]),o.values.length&&2!==o.values.length&&(o.values=[o.values[0],o.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===o.range||"max"===o.range?" ui-slider-range-"+o.range:""))),i=o.values&&o.values.length||1,n=r.length;i>n;n++)a.push(s);this.handles=r.add(e(a.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).mouseenter(function(){o.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){o.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)}),this._on(this.handles,{keydown:function(n){var i,o,r,s,a=e(n.target).data("ui-slider-handle-index");switch(n.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(n.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(n.target).addClass("ui-state-active"),i=this._start(n,a),i===!1))return}switch(s=this.options.step,o=r=this.options.values&&this.options.values.length?this.values(a):this.value(),n.keyCode){case e.ui.keyCode.HOME:r=this._valueMin();break;case e.ui.keyCode.END:r=this._valueMax();break;case e.ui.keyCode.PAGE_UP:r=this._trimAlignValue(o+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(o-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(o===this._valueMax())return;r=this._trimAlignValue(o+s);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(o===this._valueMin())return;r=this._trimAlignValue(o-s)}this._slide(n,a,r)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,i,o,r,s,a,l,c,u=this,h=this.options;return h.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(n),o=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(i-u.values(t));o>n&&(o=n,r=e(this),s=t)}),h.range===!0&&this.values(1)===h.min&&(s+=1,r=e(this.handles[s])),a=this._start(t,s),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=s,r.addClass("ui-state-active").focus(),l=r.offset(),c=!e(t.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:t.pageX-l.left-r.width()/2,top:t.pageY-l.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,s,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,i,o,r;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),i=n/t,i>1&&(i=1),0>i&&(i=0),"vertical"===this.orientation&&(i=1-i),o=this._valueMax()-this._valueMin(),r=this._valueMin()+i*o,this._trimAlignValue(r)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var i,o,r;this.options.values&&this.options.values.length?(i=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&n>i||1===t&&i>n)&&(n=i),n!==this.values(t)&&(o=this.values(),o[t]=n,r=this._trigger("slide",e,{handle:this.handles[t],value:n,values:o}),i=this.values(t?0:1),r!==!1&&this.values(t,n,!0))):n!==this.value()&&(r=this._trigger("slide",e,{handle:this.handles[t],value:n}),r!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,n){var i,o,r;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,o=arguments[0],r=0;r<i.length;r+=1)i[r]=this._trimAlignValue(o[r]),this._change(null,r);this._refreshValue()},_setOption:function(t,n){var i,o=0;switch(e.isArray(this.options.values)&&(o=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;o>i;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,i=e-n;return 2*Math.abs(n)>=t&&(i+=n>0?t:-t),parseFloat(i.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,i,o,r,s=this.options.range,a=this.options,l=this,c=this._animateOff?!1:a.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(i){n=(l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())*100,u["horizontal"===l.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[c?"animate":"css"](u,a.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[c?"animate":"css"]({left:n+"%"},a.animate),1===i&&l.range[c?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:a.animate})):(0===i&&l.range.stop(1,1)[c?"animate":"css"]({bottom:n+"%"},a.animate),1===i&&l.range[c?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:a.animate}))),t=n}):(i=this.value(),o=this._valueMin(),r=this._valueMax(),n=r!==o?(i-o)/(r-o)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[c?"animate":"css"](u,a.animate),"min"===s&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:n+"%"},a.animate),"max"===s&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:a.animate}),"min"===s&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:n+"%"},a.animate),"max"===s&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:a.animate}))}})}(jQuery),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.9.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},n=this.element;return e.each(["min","max","step"],function(e,i){var o=n.attr(i);void 0!==o&&o.length&&(t[i]=o)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function n(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i}))}var i;i=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),n.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,n.call(this)
}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,i=e.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,n.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,n)},e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:n})===!1||(this._value(n),this.counter++)},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return-1===n?0:t.length-n-1},_adjustValue:function(e){var t,n,i=this.options;return t=null!==i.min?i.min:0,n=e-t,n=Math.round(n/i.step)*i.step,e=t+n,e=parseFloat(e.toFixed(this._precision())),null!==i.max&&e>i.max?i.max:null!==i.min&&e<i.min?i.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var n=this._parse(this.element.val());return this.options[e]=t,void this.element.val(this._format(n))}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),this._super(e,t),"disabled"===e&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var n;""!==e&&(n=this._parse(e),null!==n&&(t||(n=this._adjustValue(n)),e=this._format(n))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._spin((e||1)*this.options.step)},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._spin((e||1)*-this.options.step)},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void t(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(e,t){function n(){return++o}function i(e){return e.hash.length>1&&e.href.replace(r,"")===location.href.replace(r,"").replace(/\s/g,"%20")}var o=0,r=/#.*$/;e.widget("ui.tabs",{version:"1.9.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,n=this.options,i=n.active,o=location.hash.substring(1);this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",n.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),null===i&&(o&&this.tabs.each(function(t,n){return e(n).attr("aria-controls")===o?(i=t,!1):void 0}),null===i&&(i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===i||-1===i)&&(i=this.tabs.length?0:!1)),i!==!1&&(i=this.tabs.index(this.tabs.eq(i)),-1===i&&(i=n.collapsible?!1:0)),n.active=i,!n.collapsible&&n.active===!1&&this.anchors.length&&(n.active=0),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(this.options.active):e(),this._refresh(),this.active.length&&this.load(n.active)},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),i=this.tabs.index(n),o=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:i++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:o=!1,i--;break;case e.ui.keyCode.END:i=this.anchors.length-1;break;case e.ui.keyCode.HOME:i=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i===this.options.active?!1:i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,o),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,n){function i(){return t>o&&(t=0),0>t&&(t=o),t}for(var o=this.tabs.length-1;-1!==e.inArray(i(),this.options.disabled);)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+n()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,o){var r,s,a,l=e(o).uniqueId().attr("id"),c=e(o).closest("li"),u=c.attr("aria-controls");i(o)?(r=o.hash,s=t.element.find(t._sanitizeSelector(r))):(a=t._tabId(c),r="#"+a,s=t.element.find(r),s.length||(s=t._createPanel(a),s.insertAfter(t.panels[n-1]||t.tablist)),s.attr("aria-live","polite")),s.length&&(t.panels=t.panels.add(s)),u&&c.data("ui-tabs-aria-controls",u),c.attr({"aria-controls":r.substring(1),"aria-labelledby":l}),s.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n,i=0;n=this.tabs[i];i++)t===!0||-1!==e.inArray(i,t)?e(n).addClass("ui-state-disabled").attr("aria-disabled","true"):e(n).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,i,o=this.element.parent();"fill"===t?(e.support.minHeight||(i=o.css("overflow"),o.css("overflow","hidden")),n=o.height(),this.element.siblings(":visible").each(function(){var t=e(this),i=t.css("position");"absolute"!==i&&"fixed"!==i&&(n-=t.outerHeight(!0))}),i&&o.css("overflow",i),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,i=this.active,o=e(t.currentTarget),r=o.closest("li"),s=r[0]===i[0],a=s&&n.collapsible,l=a?e():this._getPanelForTab(r),c=i.length?this._getPanelForTab(i):e(),u={oldTab:i,oldPanel:c,newTab:a?e():r,newPanel:l};t.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||s&&!n.collapsible||this._trigger("beforeActivate",t,u)===!1||(n.active=a?!1:this.tabs.index(r),this.active=s?e():r,this.xhr&&this.xhr.abort(),c.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(r),t),this._toggle(t,u))},_toggle:function(t,n){function i(){r.running=!1,r._trigger("activate",t,n)}function o(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),s.length&&r.options.show?r._show(s,r.options.show,i):(s.show(),i())}var r=this,s=n.newPanel,a=n.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),o()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),o()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),n.oldTab.attr("aria-selected","false"),s.length&&a.length?n.oldTab.attr("tabIndex",-1):s.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),s.attr({"aria-expanded":"true","aria-hidden":"false"}),n.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var n,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),n=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(n){var i=this.options.disabled;i!==!1&&(n===t?i=!1:(n=this._getIndex(n),i=e.isArray(i)?e.map(i,function(e){return e!==n?e:null}):e.map(this.tabs,function(e,t){return t!==n?t:null})),this._setupDisabled(i))},disable:function(n){var i=this.options.disabled;if(i!==!0){if(n===t)i=!0;else{if(n=this._getIndex(n),-1!==e.inArray(n,i))return;i=e.isArray(i)?e.merge([n],i).sort():[n]}this._setupDisabled(i)}},load:function(t,n){t=this._getIndex(t);var o=this,r=this.tabs.eq(t),s=r.find(".ui-tabs-anchor"),a=this._getPanelForTab(r),l={tab:r,panel:a};i(s[0])||(this.xhr=e.ajax(this._ajaxSettings(s,n,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(r.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){a.html(e),o._trigger("load",n,l)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&o.panels.stop(!1,!0),r.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),e===o.xhr&&delete o.xhr},1)})))},_ajaxSettings:function(t,n,i){var o=this;return{url:t.attr("href"),beforeSend:function(t,r){return o._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:r},i))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}}),e.uiBackCompat!==!1&&(e.ui.tabs.prototype._ui=function(e,t){return{tab:e,panel:t,index:this.anchors.index(e)}},e.widget("ui.tabs",e.ui.tabs,{url:function(e,t){this.anchors.eq(e).attr("href",t)}}),e.widget("ui.tabs",e.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var t=this;this._on({tabsbeforeload:function(n,i){return e.data(i.tab[0],"cache.tabs")?void n.preventDefault():void i.jqXHR.success(function(){t.options.cache&&e.data(i.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(t,n,i){var o=this.options.ajaxOptions;return e.extend({},o,{error:function(e,t){try{o.error(e,t,i.tab.closest("li").index(),i.tab[0])}catch(n){}}},this._superApply(arguments))},_setOption:function(e,t){"cache"===e&&t===!1&&this.anchors.removeData("cache.tabs"),this._super(e,t)},_destroy:function(){this.anchors.removeData("cache.tabs"),this._super()},url:function(e){this.anchors.eq(e).removeData("cache.tabs"),this._superApply(arguments)}}),e.widget("ui.tabs",e.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}}),e.widget("ui.tabs",e.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super(),this._on({tabsbeforeload:function(e,t){if(e.target===this.element[0]&&this.options.spinner){var n=t.tab.find("span"),i=n.html();n.html(this.options.spinner),t.jqXHR.complete(function(){n.html(i)})}}})}}),e.widget("ui.tabs",e.ui.tabs,{options:{enable:null,disable:null},enable:function(t){var n,i=this.options;(t&&i.disabled===!0||e.isArray(i.disabled)&&-1!==e.inArray(t,i.disabled))&&(n=!0),this._superApply(arguments),n&&this._trigger("enable",null,this._ui(this.anchors[t],this.panels[t]))},disable:function(t){var n,i=this.options;(t&&i.disabled===!1||e.isArray(i.disabled)&&-1===e.inArray(t,i.disabled))&&(n=!0),this._superApply(arguments),n&&this._trigger("disable",null,this._ui(this.anchors[t],this.panels[t]))}}),e.widget("ui.tabs",e.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(n,i,o){o===t&&(o=this.anchors.length);var r,s,a=this.options,l=e(a.tabTemplate.replace(/#\{href\}/g,n).replace(/#\{label\}/g,i)),c=n.indexOf("#")?this._tabId(l):n.replace("#","");return l.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",!0),l.attr("aria-controls",c),r=o>=this.tabs.length,s=this.element.find("#"+c),s.length||(s=this._createPanel(c),r?o>0?s.insertAfter(this.panels.eq(-1)):s.appendTo(this.element):s.insertBefore(this.panels[o])),s.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide(),r?l.appendTo(this.tablist):l.insertBefore(this.tabs[o]),a.disabled=e.map(a.disabled,function(e){return e>=o?++e:e}),this.refresh(),1===this.tabs.length&&a.active===!1&&this.option("active",0),this._trigger("add",null,this._ui(this.anchors[o],this.panels[o])),this},remove:function(t){t=this._getIndex(t);var n=this.options,i=this.tabs.eq(t).remove(),o=this._getPanelForTab(i).remove();return i.hasClass("ui-tabs-active")&&this.anchors.length>2&&this._activate(t+(t+1<this.anchors.length?1:-1)),n.disabled=e.map(e.grep(n.disabled,function(e){return e!==t}),function(e){return e>=t?--e:e}),this.refresh(),this._trigger("remove",null,this._ui(i.find("a")[0],o[0])),this}}),e.widget("ui.tabs",e.ui.tabs,{length:function(){return this.anchors.length}}),e.widget("ui.tabs",e.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(t){var i=t.is("li")?t.find("a[href]"):t;return i=i[0],e(i).closest("li").attr("aria-controls")||i.title&&i.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+n()}}),e.widget("ui.tabs",e.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(t){return e(this.options.panelTemplate).attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}}),e.widget("ui.tabs",e.ui.tabs,{_create:function(){var e=this.options;null===e.active&&e.selected!==t&&(e.active=-1===e.selected?!1:e.selected),this._super(),e.selected=e.active,e.selected===!1&&(e.selected=-1)},_setOption:function(e,t){if("selected"!==e)return this._super(e,t);var n=this.options;this._super("active",-1===t?!1:t),n.selected=n.active,n.selected===!1&&(n.selected=-1)},_eventHandler:function(){this._superApply(arguments),this.options.selected=this.options.active,this.options.selected===!1&&(this.options.selected=-1)}}),e.widget("ui.tabs",e.ui.tabs,{options:{show:null,select:null},_create:function(){this._super(),this.options.active!==!1&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(e,t,n){var i,o,r=this._superApply(arguments);return r?("beforeActivate"===e?(i=n.newTab.length?n.newTab:n.oldTab,o=n.newPanel.length?n.newPanel:n.oldPanel,r=this._super("select",t,{tab:i.find(".ui-tabs-anchor")[0],panel:o[0],index:i.closest("li").index()})):"activate"===e&&n.newTab.length&&(r=this._super("show",t,{tab:n.newTab.find(".ui-tabs-anchor")[0],panel:n.newPanel[0],index:n.newTab.closest("li").index()})),r):!1}}),e.widget("ui.tabs",e.ui.tabs,{select:function(e){if(e=this._getIndex(e),-1===e){if(!this.options.collapsible||-1===this.options.selected)return;e=this.options.selected}this.anchors.eq(e).trigger(this.options.event+this.eventNamespace)}}),function(){var t=0;e.widget("ui.tabs",e.ui.tabs,{options:{cookie:null},_create:function(){var e,t=this.options;null==t.active&&t.cookie&&(e=parseInt(this._cookie(),10),-1===e&&(e=!1),t.active=e),this._super()},_cookie:function(n){var i=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++t)];return arguments.length&&(i.push(n===!1?-1:n),i.push(this.options.cookie)),e.cookie.apply(null,i)},_refresh:function(){this._super(),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(){this._superApply(arguments),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super(),this.options.cookie&&this._cookie(null,this.options.cookie)}})}(),e.widget("ui.tabs",e.ui.tabs,{_trigger:function(t,n,i){var o=e.extend({},i);return"load"===t&&(o.panel=o.panel[0],o.tab=o.tab.find(".ui-tabs-anchor")[0]),this._super(t,n,o)}}),e.widget("ui.tabs",e.ui.tabs,{options:{fx:null},_getFx:function(){var t,n,i=this.options.fx;return i&&(e.isArray(i)?(t=i[0],n=i[1]):t=n=i),i?{show:n,hide:t}:null},_toggle:function(e,t){function n(){o.running=!1,o._trigger("activate",e,t)}function i(){t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),r.length&&a.show?r.animate(a.show,a.show.duration,function(){n()}):(r.show(),n())}var o=this,r=t.newPanel,s=t.oldPanel,a=this._getFx();return a?(o.running=!0,void(s.length&&a.hide?s.animate(a.hide,a.hide.duration,function(){t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),i()}):(t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),i()))):this._super(e,t)}}))}(jQuery),function(e){function t(t,n){var i=(t.attr("aria-describedby")||"").split(/\s+/);i.push(n),t.data("ui-tooltip-id",n).attr("aria-describedby",e.trim(i.join(" ")))}function n(t){var n=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),o=e.inArray(n,i);-1!==o&&i.splice(o,1),t.removeData("ui-tooltip-id"),i=e.trim(i.join(" ")),i?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")}var i=0;e.widget("ui.tooltip",{version:"1.9.2",options:{content:function(){return e(this).attr("title")},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,n){var i=this;return"disabled"===t?(this[n?"_disable":"_enable"](),void(this.options[t]=n)):(this._super(t,n),void("content"===t&&e.each(this.tooltips,function(e,t){i._updateContent(t)})))},_disable:function(){var t=this;e.each(this.tooltips,function(n,i){var o=e.Event("blur");o.target=o.currentTarget=i[0],t.close(o,!0)}),this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var n=this,i=e(t?t.target:this.element).closest(this.options.items);i.length&&!i.data("ui-tooltip-id")&&(i.attr("title")&&i.data("ui-tooltip-title",i.attr("title")),i.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&i.parents().each(function(){var t,i=e(this);i.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,n.close(t,!0)),i.attr("title")&&(i.uniqueId(),n.parents[this.id]={element:this,title:i.attr("title")},i.attr("title",""))}),this._updateContent(i,t))},_updateContent:function(e,t){var n,i=this.options.content,o=this,r=t?t.type:null;return"string"==typeof i?this._open(t,e,i):(n=i.call(e[0],function(n){e.data("ui-tooltip-open")&&o._delay(function(){t&&(t.type=r),this._open(t,e,n)})}),void(n&&this._open(t,e,n)))},_open:function(n,i,o){function r(e){c.of=e,s.is(":hidden")||s.position(c)}var s,a,l,c=e.extend({},this.options.position);if(o){if(s=this._find(i),s.length)return void s.find(".ui-tooltip-content").html(o);i.is("[title]")&&(n&&"mouseover"===n.type?i.attr("title",""):i.removeAttr("title")),s=this._tooltip(i),t(i,s.attr("id")),s.find(".ui-tooltip-content").html(o),this.options.track&&n&&/^mouse/.test(n.type)?(this._on(this.document,{mousemove:r}),r(n)):s.position(e.extend({of:i},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.show&&this.options.show.delay&&(l=setInterval(function(){s.is(":visible")&&(r(c.of),clearInterval(l))},e.fx.interval)),this._trigger("open",n,{tooltip:s}),a={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=i[0],this.close(n,!0)}},remove:function(){this._removeTooltip(s)}},n&&"mouseover"!==n.type||(a.mouseleave="close"),n&&"focusin"!==n.type||(a.focusout="close"),this._on(!0,i,a)}},close:function(t){var i=this,o=e(t?t.currentTarget:this.element),r=this._find(o);this.closing||(o.data("ui-tooltip-title")&&o.attr("title",o.data("ui-tooltip-title")),n(o),r.stop(!0),this._hide(r,this.options.hide,function(){i._removeTooltip(e(this))}),o.removeData("ui-tooltip-open"),this._off(o,"mouseleave focusout keyup"),o[0]!==this.element[0]&&this._off(o,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,n){e(n.element).attr("title",n.title),delete i.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:r}),this.closing=!1)},_tooltip:function(t){var n="ui-tooltip-"+i++,o=e("<div>").attr({id:n,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(o),o.appendTo(this.document[0].body),e.fn.bgiframe&&o.bgiframe(),this.tooltips[n]=t,o},_find:function(t){var n=t.data("ui-tooltip-id");return n?e("#"+n):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(n,i){var o=e.Event("blur");o.target=o.currentTarget=i[0],t.close(o,!0),e("#"+n).remove(),i.data("ui-tooltip-title")&&(i.attr("title",i.data("ui-tooltip-title")),i.removeData("ui-tooltip-title"))})}})}(jQuery),function(e,t){/**
 * Unobtrusive scripting adapter for jQuery
 *
 * Requires jQuery 1.6.0 or later.
 * https://github.com/rails/jquery-ujs

 * Uploading file using rails.js
 * =============================
 *
 * By default, browsers do not allow files to be uploaded via AJAX. As a result, if there are any non-blank file fields
 * in the remote form, this adapter aborts the AJAX submission and allows the form to submit through standard means.
 *
 * The `ajax:aborted:file` event allows you to bind your own handler to process the form submission however you wish.
 *
 * Ex:
 *     $('form').live('ajax:aborted:file', function(event, elements){
 *       // Implement own remote file-transfer handler here for non-blank file inputs passed in `elements`.
 *       // Returning false in this handler tells rails.js to disallow standard form submission
 *       return false;
 *     });
 *
 * The `ajax:aborted:file` event is fired when a file-type input is detected with a non-blank value.
 *
 * Third-party tools can use this hook to detect when an AJAX file upload is attempted, and then use
 * techniques like the iframe method to upload the file instead.
 *
 * Required fields in rails.js
 * ===========================
 *
 * If any blank required inputs (required="required") are detected in the remote form, the whole form submission
 * is canceled. Note that this is unlike file inputs, which still allow standard (non-AJAX) form submission.
 *
 * The `ajax:aborted:required` event allows you to bind your own handler to inform the user of blank required inputs.
 *
 * !! Note that Opera does not fire the form's submit event if there are blank required inputs, so this event may never
 *    get fired in Opera. This event is what causes other browsers to exhibit the same submit-aborting behavior.
 *
 * Ex:
 *     $('form').live('ajax:aborted:required', function(event, elements){
 *       // Returning false in this handler tells rails.js to submit the form anyway.
 *       // The blank required inputs are passed to this function in `elements`.
 *       return ! confirm("Would you like to submit the form with missing info?");
 *     });
 */
var n=function(){var t=e._data(document,"events");return t&&t.click&&e.grep(t.click,function(e){return"rails"===e.namespace}).length};n()&&e.error("jquery-ujs has already been loaded!");var i;e.rails=i={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input:file",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,i){var o=e.Event(n);return t.trigger(o,i),o.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(n){var o,r,s,a,l,c,u,h;if(i.fire(n,"ajax:before")){if(a=n.data("cross-domain"),l=a===t?null:a,c=n.data("with-credentials")||null,u=n.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,n.is("form")){o=n.attr("method"),r=n.attr("action"),s=n.serializeArray();var d=n.data("ujs:submit-button");d&&(s.push(d),n.data("ujs:submit-button",null))}else n.is(i.inputChangeSelector)?(o=n.data("method"),r=n.data("url"),s=n.serialize(),n.data("params")&&(s=s+"&"+n.data("params"))):(o=n.data("method"),r=i.href(n),s=n.data("params")||null);h={type:o||"GET",data:s,dataType:u,beforeSend:function(e,o){return o.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+o.accepts.script),i.fire(n,"ajax:beforeSend",[e,o])},success:function(e,t,i){n.trigger("ajax:success",[e,t,i])},complete:function(e,t){n.trigger("ajax:complete",[e,t])},error:function(e,t,i){n.trigger("ajax:error",[e,t,i])},xhrFields:{withCredentials:c},crossDomain:l},r&&(h.url=r);var p=i.ajax(h);return n.trigger("ajax:send",p),p}return!1},handleMethod:function(n){var o=i.href(n),r=n.data("method"),s=n.attr("target"),a=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),c=e('<form method="post" action="'+o+'"></form>'),u='<input name="_method" value="'+r+'" type="hidden" />';l!==t&&a!==t&&(u+='<input name="'+l+'" value="'+a+'" type="hidden" />'),s&&c.attr("target",s),c.hide().append(u).appendTo("body"),c.submit()},disableFormElements:function(t){t.find(i.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(i.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t,n=e.data("confirm"),o=!1;return n?(i.fire(e,"confirm")&&(o=i.confirm(n),t=i.fire(e,"confirm:complete",[o])),o&&t):!0},blankInputs:function(t,n,i){var o,r,s=e(),a=n||"input,textarea",l=t.find(a);return l.each(function(){if(o=e(this),r=o.is(":checkbox,:radio")?o.is(":checked"):o.val(),!r==!i){if(o.is(":radio")&&l.filter('input:radio:checked[name="'+o.attr("name")+'"]').length)return!0;s=s.add(o)}}),s.length?s:!1},nonBlankInputs:function(e,t){return i.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},callFormSubmitBindings:function(n,i){var o=n.data("events"),r=!0;return o!==t&&o.submit!==t&&e.each(o.submit,function(e,t){return"function"==typeof t.handler?r=t.handler(i):void 0}),r},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return i.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.data("ujs:enable-with",!1)),e.unbind("click.railsDisable")}},i.fire(e(document),"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,n){e.crossDomain||i.CSRFProtection(n)}),e(document).delegate(i.linkDisableSelector,"ajax:complete",function(){i.enableElement(e(this))}),e(document).delegate(i.linkClickSelector,"click.rails",function(n){var o=e(this),r=o.data("method"),s=o.data("params");if(!i.allowAction(o))return i.stopEverything(n);if(o.is(i.linkDisableSelector)&&i.disableElement(o),o.data("remote")!==t){if(!(!n.metaKey&&!n.ctrlKey||r&&"GET"!==r||s))return!0;var a=i.handleRemote(o);return a===!1?i.enableElement(o):a.error(function(){i.enableElement(o)}),!1}return o.data("method")?(i.handleMethod(o),!1):void 0}),e(document).delegate(i.inputChangeSelector,"change.rails",function(t){var n=e(this);return i.allowAction(n)?(i.handleRemote(n),!1):i.stopEverything(t)}),e(document).delegate(i.formSubmitSelector,"submit.rails",function(n){var o=e(this),r=o.data("remote")!==t,s=i.blankInputs(o,i.requiredInputSelector),a=i.nonBlankInputs(o,i.fileInputSelector);if(!i.allowAction(o))return i.stopEverything(n);if(s&&o.attr("novalidate")==t&&i.fire(o,"ajax:aborted:required",[s]))return i.stopEverything(n);if(r){if(a){setTimeout(function(){i.disableFormElements(o)},13);var l=i.fire(o,"ajax:aborted:file",[a]);return l||setTimeout(function(){i.enableFormElements(o)},13),l}return!e.support.submitBubbles&&e().jquery<"1.7"&&i.callFormSubmitBindings(o,n)===!1?i.stopEverything(n):(i.handleRemote(o),!1)}setTimeout(function(){i.disableFormElements(o)},13)}),e(document).delegate(i.formInputClickSelector,"click.rails",function(t){var n=e(this);if(!i.allowAction(n))return i.stopEverything(t);var o=n.attr("name"),r=o?{name:o,value:n.val()}:null;n.closest("form").data("ujs:submit-button",r)}),e(document).delegate(i.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&i.disableFormElements(e(this))}),e(document).delegate(i.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&i.enableFormElements(e(this))}),e(function(){csrf_token=e("meta[name=csrf-token]").attr("content"),csrf_param=e("meta[name=csrf-param]").attr("content"),e('form input[name="'+csrf_param+'"]').val(csrf_token)}))}(jQuery);var $j=jQuery.noConflict(),Prototype={Version:"1.7",Browser:function(){var e=navigator.userAgent,t="[object Opera]"==Object.prototype.toString.call(window.opera);return{IE:!!window.attachEvent&&!t,Opera:t,WebKit:e.indexOf("AppleWebKit/")>-1,Gecko:e.indexOf("Gecko")>-1&&-1===e.indexOf("KHTML"),MobileSafari:/Apple.*Mobile/.test(e)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var e=window.Element||window.HTMLElement;return!(!e||!e.prototype)}(),SpecificElementExtensions:function(){if("undefined"!=typeof window.HTMLDivElement)return!0;var e=document.createElement("div"),t=document.createElement("form"),n=!1;return e.__proto__&&e.__proto__!==t.__proto__&&(n=!0),e=t=null,n}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)</script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(e){return e}};Prototype.Browser.MobileSafari&&(Prototype.BrowserFeatures.SpecificElementExtensions=!1);var Abstract={},Try={these:function(){for(var e,t=0,n=arguments.length;n>t;t++){var i=arguments[t];try{e=i();break}catch(o){}}return e}},Class=function(){function e(){}function t(){function t(){this.initialize.apply(this,arguments)}var n=null,i=$A(arguments);Object.isFunction(i[0])&&(n=i.shift()),Object.extend(t,Class.Methods),t.superclass=n,t.subclasses=[],n&&(e.prototype=n.prototype,t.prototype=new e,n.subclasses.push(t));for(var o=0,r=i.length;r>o;o++)t.addMethods(i[o]);return t.prototype.initialize||(t.prototype.initialize=Prototype.emptyFunction),t.prototype.constructor=t,t}function n(e){var t=this.superclass&&this.superclass.prototype,n=Object.keys(e);i&&(e.toString!=Object.prototype.toString&&n.push("toString"),e.valueOf!=Object.prototype.valueOf&&n.push("valueOf"));for(var o=0,r=n.length;r>o;o++){var s=n[o],a=e[s];if(t&&Object.isFunction(a)&&"$super"==a.argumentNames()[0]){var l=a;a=function(e){return function(){return t[e].apply(this,arguments)}}(s).wrap(l),a.valueOf=l.valueOf.bind(l),a.toString=l.toString.bind(l)}this.prototype[s]=a}return this}var i=function(){for(var e in{toString:1})if("toString"===e)return!1;return!0}();return{create:t,Methods:{addMethods:n}}}();!function(){function e(e){switch(e){case null:return w;case void 0:return _}var t=typeof e;switch(t){case"boolean":return C;case"number":return S;case"string":return x}return E}function t(e,t){for(var n in t)e[n]=t[n];return e}function n(e){try{return y(e)?"undefined":null===e?"null":e.inspect?e.inspect():String(e)}catch(t){if(t instanceof RangeError)return"...";throw t}}function i(e){return o("",{"":e},[])}function o(t,n,i){var r=n[t],s=typeof r;e(r)===E&&"function"==typeof r.toJSON&&(r=r.toJSON(t));var a=b.call(r);switch(a){case D:case T:case M:r=r.valueOf()}switch(r){case null:return"null";case!0:return"true";case!1:return"false"}switch(s=typeof r){case"string":return r.inspect(!0);case"number":return isFinite(r)?String(r):"null";case"object":for(var l=0,c=i.length;c>l;l++)if(i[l]===r)throw new TypeError;i.push(r);var u=[];if(a===j){for(var l=0,c=r.length;c>l;l++){var h=o(l,r,i);u.push("undefined"==typeof h?"null":h)}u="["+u.join(",")+"]"}else{for(var d=Object.keys(r),l=0,c=d.length;c>l;l++){var t=d[l],h=o(t,r,i);"undefined"!=typeof h&&u.push(t.inspect(!0)+":"+h)}u="{"+u.join(",")+"}"}return i.pop(),u}}function r(e){return JSON.stringify(e)}function s(e){return $H(e).toQueryString()}function a(e){return e&&e.toHTML?e.toHTML():String.interpret(e)}function l(t){if(e(t)!==E)throw new TypeError;var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(i);return n}function c(e){var t=[];for(var n in e)t.push(e[n]);return t}function u(e){return t({},e)}function h(e){return!(!e||1!=e.nodeType)}function d(e){return b.call(e)===j}function p(e){return e instanceof Hash}function f(e){return b.call(e)===k}function m(e){return b.call(e)===M}function g(e){return b.call(e)===D}function v(e){return b.call(e)===R}function y(e){return"undefined"==typeof e}var b=Object.prototype.toString,w="Null",_="Undefined",C="Boolean",S="Number",x="String",E="Object",k="[object Function]",T="[object Boolean]",D="[object Number]",M="[object String]",j="[object Array]",R="[object Date]",A=window.JSON&&"function"==typeof JSON.stringify&&"0"===JSON.stringify(0)&&"undefined"==typeof JSON.stringify(Prototype.K),N="function"==typeof Array.isArray&&Array.isArray([])&&!Array.isArray({});N&&(d=Array.isArray),t(Object,{extend:t,inspect:n,toJSON:A?r:i,toQueryString:s,toHTML:a,keys:Object.keys||l,values:c,clone:u,isElement:h,isArray:d,isHash:p,isFunction:f,isString:m,isNumber:g,isDate:v,isUndefined:y})}(),Object.extend(Function.prototype,function(){function e(e,t){for(var n=e.length,i=t.length;i--;)e[n+i]=t[i];return e}function t(t,n){return t=u.call(t,0),e(t,n)}function n(){var e=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return 1!=e.length||e[0]?e:[]}function i(e){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var n=this,i=u.call(arguments,1);return function(){var o=t(i,arguments);return n.apply(e,o)}}function o(t){var n=this,i=u.call(arguments,1);return function(o){var r=e([o||window.event],i);return n.apply(t,r)}}function r(){if(!arguments.length)return this;var e=this,n=u.call(arguments,0);return function(){var i=t(n,arguments);return e.apply(this,i)}}function s(e){var t=this,n=u.call(arguments,1);return e=1e3*e,window.setTimeout(function(){return t.apply(t,n)},e)}function a(){var t=e([.01],arguments);return this.delay.apply(this,t)}function l(t){var n=this;return function(){var i=e([n.bind(this)],arguments);return t.apply(this,i)}}function c(){if(this._methodized)return this._methodized;var t=this;return this._methodized=function(){var n=e([this],arguments);return t.apply(null,n)}}var u=Array.prototype.slice;return{argumentNames:n,bind:i,bindAsEventListener:o,curry:r,delay:s,defer:a,wrap:l,methodize:c}}()),function(e){function t(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}function n(){return this.toISOString()}e.toISOString||(e.toISOString=t),e.toJSON||(e.toJSON=n)}(Date.prototype),RegExp.prototype.match=RegExp.prototype.test,RegExp.escape=function(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};var PeriodicalExecuter=Class.create({initialize:function(e,t){this.callback=e,this.frequency=t,this.currentlyExecuting=!1,this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),1e3*this.frequency)},execute:function(){this.callback(this)},stop:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=!0,this.execute(),this.currentlyExecuting=!1}catch(e){throw this.currentlyExecuting=!1,e}}});Object.extend(String,{interpret:function(e){return null==e?"":String(e)},specialChar:{"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}}),Object.extend(String.prototype,function(){function prepareReplacement(e){if(Object.isFunction(e))return e;var t=new Template(e);return function(e){return t.evaluate(e)}}function gsub(e,t){var n,i="",o=this;if(t=prepareReplacement(t),Object.isString(e)&&(e=RegExp.escape(e)),!e.length&&!e.source)return t=t(""),t+o.split("").join(t)+t;for(;o.length>0;)(n=o.match(e))?(i+=o.slice(0,n.index),i+=String.interpret(t(n)),o=o.slice(n.index+n[0].length)):(i+=o,o="");return i}function sub(e,t,n){return t=prepareReplacement(t),n=Object.isUndefined(n)?1:n,this.gsub(e,function(e){return--n<0?e[0]:t(e)})}function scan(e,t){return this.gsub(e,t),String(this)}function truncate(e,t){return e=e||30,t=Object.isUndefined(t)?"...":t,this.length>e?this.slice(0,e-t.length)+t:String(this)}function strip(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function extractScripts(){var e=new RegExp(Prototype.ScriptFragment,"img"),t=new RegExp(Prototype.ScriptFragment,"im");return(this.match(e)||[]).map(function(e){return(e.match(t)||["",""])[1]})}function evalScripts(){return this.extractScripts().map(function(script){return eval(script)})}function escapeHTML(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function unescapeHTML(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function toQueryParams(e){var t=this.strip().match(/([^?#]*)(#.*)?$/);return t?t[1].split(e||"&").inject({},function(e,t){if((t=t.split("="))[0]){var n=decodeURIComponent(t.shift()),i=t.length>1?t.join("="):t[0];void 0!=i&&(i=decodeURIComponent(i)),n in e?(Object.isArray(e[n])||(e[n]=[e[n]]),e[n].push(i)):e[n]=i}return e}):{}}function toArray(){return this.split("")}function succ(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function times(e){return 1>e?"":new Array(e+1).join(this)}function camelize(){return this.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})}function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function underscore(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function dasherize(){return this.replace(/_/g,"-")}function inspect(e){var t=this.replace(/[\x00-\x1f\\]/g,function(e){return e in String.specialChar?String.specialChar[e]:"\\u00"+e.charCodeAt().toPaddedString(2,16)});return e?'"'+t.replace(/"/g,'\\"')+'"':"'"+t.replace(/'/g,"\\'")+"'"}function unfilterJSON(e){return this.replace(e||Prototype.JSONFilter,"$1")}function isJSON(){var e=this;return e.blank()?!1:(e=e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@"),e=e.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),e=e.replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(e))}function evalJSON(sanitize){var json=this.unfilterJSON(),cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;cx.test(json)&&(json=json.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));try{if(!sanitize||json.isJSON())return eval("("+json+")")}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())}function parseJSON(){var e=this.unfilterJSON();return JSON.parse(e)}function include(e){return this.indexOf(e)>-1}function startsWith(e){return 0===this.lastIndexOf(e,0)}function endsWith(e){var t=this.length-e.length;return t>=0&&this.indexOf(e,t)===t}function empty(){return""==this}function blank(){return/^\s*$/.test(this)}function interpolate(e,t){return new Template(this,t).evaluate(e)}var NATIVE_JSON_PARSE_SUPPORT=window.JSON&&"function"==typeof JSON.parse&&JSON.parse('{"test": true}').test;return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim||strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:NATIVE_JSON_PARSE_SUPPORT?parseJSON:evalJSON,include:include,startsWith:startsWith,endsWith:endsWith,empty:empty,blank:blank,interpolate:interpolate}}());var Template=Class.create({initialize:function(e,t){this.template=e.toString(),this.pattern=t||Template.Pattern},evaluate:function(e){return e&&Object.isFunction(e.toTemplateReplacements)&&(e=e.toTemplateReplacements()),this.template.gsub(this.pattern,function(t){if(null==e)return t[1]+"";var n=t[1]||"";if("\\"==n)return t[2];var i=e,o=t[3],r=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;if(t=r.exec(o),null==t)return n;for(;null!=t;){var s=t[1].startsWith("[")?t[2].replace(/\\\\]/g,"]"):t[1];if(i=i[s],null==i||""==t[3])break;o=o.substring("["==t[3]?t[1].length:t[0].length),t=r.exec(o)}return n+String.interpret(i)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={},Enumerable=function(){function e(e,t){var n=0;try{this._each(function(i){e.call(t,i,n++)})}catch(i){if(i!=$break)throw i}return this}function t(e,t,n){var i=-e,o=[],r=this.toArray();if(1>e)return r;for(;(i+=e)<r.length;)o.push(r.slice(i,i+e));return o.collect(t,n)}function n(e,t){e=e||Prototype.K;var n=!0;return this.each(function(i,o){if(n=n&&!!e.call(t,i,o),!n)throw $break}),n}function i(e,t){e=e||Prototype.K;var n=!1;return this.each(function(i,o){if(n=!!e.call(t,i,o))throw $break}),n}function o(e,t){e=e||Prototype.K;var n=[];return this.each(function(i,o){n.push(e.call(t,i,o))}),n}function r(e,t){var n;return this.each(function(i,o){if(e.call(t,i,o))throw n=i,$break}),n}function s(e,t){var n=[];return this.each(function(i,o){e.call(t,i,o)&&n.push(i)}),n}function a(e,t,n){t=t||Prototype.K;var i=[];return Object.isString(e)&&(e=new RegExp(RegExp.escape(e))),this.each(function(o,r){e.match(o)&&i.push(t.call(n,o,r))}),i}function l(e){if(Object.isFunction(this.indexOf)&&-1!=this.indexOf(e))return!0;var t=!1;return this.each(function(n){if(n==e)throw t=!0,$break}),t}function c(e,t){return t=Object.isUndefined(t)?null:t,this.eachSlice(e,function(n){for(;n.length<e;)n.push(t);return n})}function u(e,t,n){return this.each(function(i,o){e=t.call(n,e,i,o)}),e}function h(e){var t=$A(arguments).slice(1);return this.map(function(n){return n[e].apply(n,t)})}function d(e,t){e=e||Prototype.K;var n;return this.each(function(i,o){i=e.call(t,i,o),(null==n||i>=n)&&(n=i)}),n}function p(e,t){e=e||Prototype.K;var n;return this.each(function(i,o){i=e.call(t,i,o),(null==n||n>i)&&(n=i)}),n}function f(e,t){e=e||Prototype.K;var n=[],i=[];return this.each(function(o,r){(e.call(t,o,r)?n:i).push(o)}),[n,i]}function m(e){var t=[];return this.each(function(n){t.push(n[e])}),t}function g(e,t){var n=[];return this.each(function(i,o){e.call(t,i,o)||n.push(i)}),n}function v(e,t){return this.map(function(n,i){return{value:n,criteria:e.call(t,n,i)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;return i>n?-1:n>i?1:0}).pluck("value")}function y(){return this.map()}function b(){var e=Prototype.K,t=$A(arguments);Object.isFunction(t.last())&&(e=t.pop());var n=[this].concat(t).map($A);return this.map(function(t,i){return e(n.pluck(i))})}function w(){return this.toArray().length}function _(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:e,eachSlice:t,all:n,every:n,any:i,some:i,collect:o,map:o,detect:r,findAll:s,select:s,filter:s,grep:a,include:l,member:l,inGroupsOf:c,inject:u,invoke:h,max:d,min:p,partition:f,pluck:m,reject:g,sortBy:v,toArray:y,entries:y,zip:b,size:w,inspect:_,find:r}}();Array.from=$A,function(){function e(e,t){for(var n=0,i=this.length>>>0;i>n;n++)n in this&&e.call(t,this[n],n,this)}function t(){return this.length=0,this}function n(){return this[0]}function i(){return this[this.length-1]}function o(){return this.select(function(e){return null!=e})}function r(){return this.inject([],function(e,t){return Object.isArray(t)?e.concat(t.flatten()):(e.push(t),e)})}function s(){var e=v.call(arguments,0);return this.select(function(t){return!e.include(t)})}function a(e){return(e===!1?this.toArray():this)._reverse()}function l(e){return this.inject([],function(t,n,i){return 0!=i&&(e?t.last()==n:t.include(n))||t.push(n),t})}function c(e){return this.uniq().findAll(function(t){return e.detect(function(e){return t===e})})}function u(){return v.call(this,0)}function h(){return this.length}function d(){return"["+this.map(Object.inspect).join(", ")+"]"}function p(e,t){t||(t=0);var n=this.length;for(0>t&&(t=n+t);n>t;t++)if(this[t]===e)return t;return-1}function f(e,t){t=isNaN(t)?this.length:(0>t?this.length+t:t)+1;var n=this.slice(0,t).reverse().indexOf(e);return 0>n?n:t-n-1}function m(){for(var e,t=v.call(this,0),n=0,i=arguments.length;i>n;n++)if(e=arguments[n],!Object.isArray(e)||"callee"in e)t.push(e);else for(var o=0,r=e.length;r>o;o++)t.push(e[o]);return t}var g=Array.prototype,v=g.slice,y=g.forEach;y||(y=e),Object.extend(g,Enumerable),g._reverse||(g._reverse=g.reverse),Object.extend(g,{_each:y,clear:t,first:n,last:i,compact:o,flatten:r,without:s,reverse:a,uniq:l,intersect:c,clone:u,toArray:u,size:h,inspect:d});var b=function(){return 1!==[].concat(arguments)[0][0]}(1,2);b&&(g.concat=m),g.indexOf||(g.indexOf=p),g.lastIndexOf||(g.lastIndexOf=f)}();var Hash=Class.create(Enumerable,function(){function e(e){this._object=Object.isHash(e)?e.toObject():Object.clone(e)}function t(e){for(var t in this._object){var n=this._object[t],i=[t,n];i.key=t,i.value=n,e(i)}}function n(e,t){return this._object[e]=t}function i(e){return this._object[e]!==Object.prototype[e]?this._object[e]:void 0}function o(e){var t=this._object[e];return delete this._object[e],t}function r(){return Object.clone(this._object)}function s(){return this.pluck("key")}function a(){return this.pluck("value")}function l(e){var t=this.detect(function(t){return t.value===e});return t&&t.key}function c(e){return this.clone().update(e)}function u(e){return new Hash(e).inject(this,function(e,t){return e.set(t.key,t.value),e})}function h(e,t){return Object.isUndefined(t)?e:e+"="+encodeURIComponent(String.interpret(t))}function d(){return this.inject([],function(e,t){var n=encodeURIComponent(t.key),i=t.value;if(i&&"object"==typeof i){if(Object.isArray(i)){for(var o,r=[],s=0,a=i.length;a>s;s++)o=i[s],r.push(h(n,o));return e.concat(r)}}else e.push(h(n,i));return e}).join("&")}function p(){return"#<Hash:{"+this.map(function(e){return e.map(Object.inspect).join(": ")}).join(", ")+"}>"}function f(){return new Hash(this)}return{initialize:e,_each:t,set:n,get:i,unset:o,toObject:r,toTemplateReplacements:r,keys:s,values:a,index:l,merge:c,update:u,toQueryString:d,inspect:p,toJSON:r,clone:f}}());Hash.from=$H,Object.extend(Number.prototype,function(){function e(){return this.toPaddedString(2,16)}function t(){return this+1}function n(e,t){return $R(0,this,!0).each(e,t),this}function i(e,t){var n=this.toString(t||10);return"0".times(e-n.length)+n}function o(){return Math.abs(this)}function r(){return Math.round(this)}function s(){return Math.ceil(this)}function a(){return Math.floor(this)}return{toColorPart:e,succ:t,times:n,toPaddedString:i,abs:o,round:r,ceil:s,floor:a}}());var ObjectRange=Class.create(Enumerable,function(){function e(e,t,n){this.start=e,this.end=t,this.exclusive=n}function t(e){for(var t=this.start;this.include(t);)e(t),t=t.succ()}function n(e){return e<this.start?!1:this.exclusive?e<this.end:e<=this.end}return{initialize:e,_each:t,include:n}}()),Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||!1},activeRequestCount:0};if(Ajax.Responders={responders:[],_each:function(e){this.responders._each(e)},register:function(e){this.include(e)||this.responders.push(e)},unregister:function(e){this.responders=this.responders.without(e)},dispatch:function(e,t,n,i){this.each(function(o){if(Object.isFunction(o[e]))try{o[e].apply(o,[t,n,i])}catch(r){}})}},Object.extend(Ajax.Responders,Enumerable),Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}}),Ajax.Base=Class.create({initialize:function(e){this.options={method:"post",asynchronous:!0,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:!0,evalJS:!0},Object.extend(this.options,e||{}),this.options.method=this.options.method.toLowerCase(),Object.isHash(this.options.parameters)&&(this.options.parameters=this.options.parameters.toObject())}}),Ajax.Request=Class.create(Ajax.Base,{_complete:!1,initialize:function($super,e,t){$super(t),this.transport=Ajax.getTransport(),this.request(e)},request:function(e){this.url=e,this.method=this.options.method;var t=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);["get","post"].include(this.method)||(t+=(t?"&":"")+"_method="+this.method,this.method="post"),t&&"get"===this.method&&(this.url+=(this.url.include("?")?"&":"?")+t),this.parameters=t.toQueryParams();try{var n=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(n),Ajax.Responders.dispatch("onCreate",this,n),this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous),this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1),this.transport.onreadystatechange=this.onStateChange.bind(this),this.setRequestHeaders(),this.body="post"==this.method?this.options.postBody||t:null,this.transport.send(this.body),!this.options.asynchronous&&this.transport.overrideMimeType&&this.onStateChange()}catch(i){this.dispatchException(i)}},onStateChange:function(){var e=this.transport.readyState;e>1&&(4!=e||!this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var e={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if("post"==this.method&&(e["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005&&(e.Connection="close")),"object"==typeof this.options.requestHeaders){var t=this.options.requestHeaders;if(Object.isFunction(t.push))for(var n=0,i=t.length;i>n;n+=2)e[t[n]]=t[n+1];else $H(t).each(function(t){e[t.key]=t.value})}for(var o in e)this.transport.setRequestHeader(o,e[o])},success:function(){var e=this.getStatus();return!e||e>=200&&300>e||304==e},getStatus:function(){try{return 1223===this.transport.status?204:this.transport.status||0}catch(e){return 0}},respondToReadyState:function(e){var t=Ajax.Request.Events[e],n=new Ajax.Response(this);if("Complete"==t){try{this._complete=!0,(this.options["on"+n.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(n,n.headerJSON)}catch(i){this.dispatchException(i)}var o=n.getHeader("Content-type");("force"==this.options.evalJS||this.options.evalJS&&this.isSameOrigin()&&o&&o.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))&&this.evalResponse()}try{(this.options["on"+t]||Prototype.emptyFunction)(n,n.headerJSON),Ajax.Responders.dispatch("on"+t,this,n,n.headerJSON)}catch(i){this.dispatchException(i)}"Complete"==t&&(this.transport.onreadystatechange=Prototype.emptyFunction)},isSameOrigin:function(){var e=this.url.match(/^\s*https?:\/\/[^\/]*/);return!e||e[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(e){try{return this.transport.getResponseHeader(e)||null}catch(t){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(e){(this.options.onException||Prototype.emptyFunction)(this,e),Ajax.Responders.dispatch("onException",this,e)}}),Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"],Ajax.Response=Class.create({initialize:function(e){this.request=e;var t=this.transport=e.transport,n=this.readyState=t.readyState;if((n>2&&!Prototype.Browser.IE||4==n)&&(this.status=this.getStatus(),this.statusText=this.getStatusText(),this.responseText=String.interpret(t.responseText),this.headerJSON=this._getHeaderJSON()),4==n){var i=t.responseXML;this.responseXML=Object.isUndefined(i)?null:i,this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(e){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(e){return null}},getResponseHeader:function(e){return this.transport.getResponseHeader(e)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var e=this.getHeader("X-JSON");if(!e)return null;e=decodeURIComponent(escape(e));try{return e.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin())}catch(t){this.request.dispatchException(t)}},_getResponseJSON:function(){var e=this.request.options;if(!e.evalJSON||"force"!=e.evalJSON&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(e.sanitizeJSON||!this.request.isSameOrigin())}catch(t){this.request.dispatchException(t)}}}),Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,e,t,n){this.container={success:e.success||e,failure:e.failure||(e.success?null:e)},n=Object.clone(n);var i=n.onComplete;n.onComplete=function(e,t){this.updateContent(e.responseText),Object.isFunction(i)&&i(e,t)}.bind(this),$super(t,n)},updateContent:function(e){var t=this.container[this.success()?"success":"failure"],n=this.options;if(n.evalScripts||(e=e.stripScripts()),t=$(t))if(n.insertion)if(Object.isString(n.insertion)){var i={};i[n.insertion]=e,t.insert(i)}else n.insertion(t,e);else t.update(e)}}),Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,e,t,n){$super(n),this.onComplete=this.options.onComplete,this.frequency=this.options.frequency||2,this.decay=this.options.decay||1,this.updater={},this.container=e,this.url=t,this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this),this.onTimerEvent()},stop:function(){this.updater.options.onComplete=void 0,clearTimeout(this.timer),(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(e){this.options.decay&&(this.decay=e.responseText==this.lastText?this.decay*this.options.decay:1,this.lastText=e.responseText),this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}}),Prototype.BrowserFeatures.XPath&&(document._getElementsByXPath=function(e,t){for(var n=[],i=document.evaluate(e,$(t)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),o=0,r=i.snapshotLength;r>o;o++)n.push(Element.extend(i.snapshotItem(o)));
return n}),!Node)var Node={};Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),function(e){function t(e,t){return"select"===e?!1:"type"in t?!1:!0}var n=function(){try{var e=document.createElement('<input name="x">');return"input"===e.tagName.toLowerCase()&&"x"===e.name}catch(t){return!1}}(),i=e.Element;e.Element=function(e,i){i=i||{},e=e.toLowerCase();var o=Element.cache;if(n&&i.name)return e="<"+e+' name="'+i.name+'">',delete i.name,Element.writeAttribute(document.createElement(e),i);o[e]||(o[e]=Element.extend(document.createElement(e)));var r=t(e,i)?o[e].cloneNode(!1):document.createElement(e);return Element.writeAttribute(r,i)},Object.extend(e.Element,i||{}),i&&(e.Element.prototype=i.prototype)}(this),Element.idCounter=1,Element.cache={},Element._purgeElement=function(e){var t=e._prototypeUID;t&&(Element.stopObserving(e),e._prototypeUID=void 0,delete Element.Storage[t])},Element.Methods={visible:function(e){return"none"!=$(e).style.display},toggle:function(e){return e=$(e),Element[Element.visible(e)?"hide":"show"](e),e},hide:function(e){return e=$(e),e.style.display="none",e},show:function(e){return e=$(e),e.style.display="",e},remove:function(e){return e=$(e),e.parentNode.removeChild(e),e},update:function(){function e(e,t){e=$(e);for(var n=Element._purgeElement,s=e.getElementsByTagName("*"),a=s.length;a--;)n(s[a]);if(t&&t.toElement&&(t=t.toElement()),Object.isElement(t))return e.update().insert(t);t=Object.toHTML(t);var l=e.tagName.toUpperCase();if("SCRIPT"===l&&r)return e.text=t,e;if(o)if(l in Element._insertionTranslations.tags){for(;e.firstChild;)e.removeChild(e.firstChild);Element._getContentFromAnonymousElement(l,t.stripScripts()).each(function(t){e.appendChild(t)})}else if(i&&Object.isString(t)&&t.indexOf("<link")>-1){for(;e.firstChild;)e.removeChild(e.firstChild);var c=Element._getContentFromAnonymousElement(l,t.stripScripts(),!0);c.each(function(t){e.appendChild(t)})}else e.innerHTML=t.stripScripts();else e.innerHTML=t.stripScripts();return t.evalScripts.bind(t).defer(),e}var t=function(){var e=document.createElement("select"),t=!0;return e.innerHTML='<option value="test">test</option>',e.options&&e.options[0]&&(t="OPTION"!==e.options[0].nodeName.toUpperCase()),e=null,t}(),n=function(){try{var e=document.createElement("table");if(e&&e.tBodies){e.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var t="undefined"==typeof e.tBodies[0];return e=null,t}}catch(n){return!0}}(),i=function(){try{var e=document.createElement("div");e.innerHTML="<link>";var t=0===e.childNodes.length;return e=null,t}catch(n){return!0}}(),o=t||n||i,r=function(){var e=document.createElement("script"),t=!1;try{e.appendChild(document.createTextNode("")),t=!e.firstChild||e.firstChild&&3!==e.firstChild.nodeType}catch(n){t=!0}return e=null,t}();return e}(),replace:function(e,t){if(e=$(e),t&&t.toElement)t=t.toElement();else if(!Object.isElement(t)){t=Object.toHTML(t);var n=e.ownerDocument.createRange();n.selectNode(e),t.evalScripts.bind(t).defer(),t=n.createContextualFragment(t.stripScripts())}return e.parentNode.replaceChild(t,e),e},insert:function(e,t){e=$(e),(Object.isString(t)||Object.isNumber(t)||Object.isElement(t)||t&&(t.toElement||t.toHTML))&&(t={bottom:t});var n,i,o,r;for(var s in t)n=t[s],s=s.toLowerCase(),i=Element._insertionTranslations[s],n&&n.toElement&&(n=n.toElement()),Object.isElement(n)?i(e,n):(n=Object.toHTML(n),o=("before"==s||"after"==s?e.parentNode:e).tagName.toUpperCase(),r=Element._getContentFromAnonymousElement(o,n.stripScripts()),("top"==s||"after"==s)&&r.reverse(),r.each(i.curry(e)),n.evalScripts.bind(n).defer());return e},wrap:function(e,t,n){return e=$(e),Object.isElement(t)?$(t).writeAttribute(n||{}):t=Object.isString(t)?new Element(t,n):new Element("div",t),e.parentNode&&e.parentNode.replaceChild(t,e),t.appendChild(e),t},inspect:function(e){e=$(e);var t="<"+e.tagName.toLowerCase();return $H({id:"id",className:"class"}).each(function(n){var i=n.first(),o=n.last(),r=(e[i]||"").toString();r&&(t+=" "+o+"="+r.inspect(!0))}),t+">"},recursivelyCollect:function(e,t,n){e=$(e),n=n||-1;for(var i=[];(e=e[t])&&(1==e.nodeType&&i.push(Element.extend(e)),i.length!=n););return i},ancestors:function(e){return Element.recursivelyCollect(e,"parentNode")},descendants:function(e){return Element.select(e,"*")},firstDescendant:function(e){for(e=$(e).firstChild;e&&1!=e.nodeType;)e=e.nextSibling;return $(e)},immediateDescendants:function(e){for(var t=[],n=$(e).firstChild;n;)1===n.nodeType&&t.push(Element.extend(n)),n=n.nextSibling;return t},previousSiblings:function(e){return Element.recursivelyCollect(e,"previousSibling")},nextSiblings:function(e){return Element.recursivelyCollect(e,"nextSibling")},siblings:function(e){return e=$(e),Element.previousSiblings(e).reverse().concat(Element.nextSiblings(e))},match:function(e,t){return e=$(e),Object.isString(t)?Prototype.Selector.match(e,t):t.match(e)},up:function(e,t,n){if(e=$(e),1==arguments.length)return $(e.parentNode);var i=Element.ancestors(e);return Object.isNumber(t)?i[t]:Prototype.Selector.find(i,t,n)},down:function(e,t,n){return e=$(e),1==arguments.length?Element.firstDescendant(e):Object.isNumber(t)?Element.descendants(e)[t]:Element.select(e,t)[n||0]},previous:function(e,t,n){return e=$(e),Object.isNumber(t)&&(n=t,t=!1),Object.isNumber(n)||(n=0),t?Prototype.Selector.find(e.previousSiblings(),t,n):e.recursivelyCollect("previousSibling",n+1)[n]},next:function(e,t,n){if(e=$(e),Object.isNumber(t)&&(n=t,t=!1),Object.isNumber(n)||(n=0),t)return Prototype.Selector.find(e.nextSiblings(),t,n);Object.isNumber(n)?n+1:1;return e.recursivelyCollect("nextSibling",n+1)[n]},select:function(e){e=$(e);var t=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(t,e)},adjacent:function(e){e=$(e);var t=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(t,e.parentNode).without(e)},identify:function(e){e=$(e);var t=Element.readAttribute(e,"id");if(t)return t;do t="anonymous_element_"+Element.idCounter++;while($(t));return Element.writeAttribute(e,"id",t),t},readAttribute:function(e,t){if(e=$(e),Prototype.Browser.IE){var n=Element._attributeTranslations.read;if(n.values[t])return n.values[t](e,t);if(n.names[t]&&(t=n.names[t]),t.include(":"))return e.attributes&&e.attributes[t]?e.attributes[t].value:null}return e.getAttribute(t)},writeAttribute:function(e,t,n){e=$(e);var i={},o=Element._attributeTranslations.write;"object"==typeof t?i=t:i[t]=Object.isUndefined(n)?!0:n;for(var r in i)t=o.names[r]||r,n=i[r],o.values[r]&&(t=o.values[r](e,n)),n===!1||null===n?e.removeAttribute(t):n===!0?e.setAttribute(t,t):e.setAttribute(t,n);return e},getHeight:function(e){return Element.getDimensions(e).height},getWidth:function(e){return Element.getDimensions(e).width},classNames:function(e){return new Element.ClassNames(e)},hasClassName:function(e,t){if(e=$(e)){var n=e.className;return n.length>0&&(n==t||new RegExp("(^|\\s)"+t+"(\\s|$)").test(n))}},addClassName:function(e,t){return(e=$(e))?(Element.hasClassName(e,t)||(e.className+=(e.className?" ":"")+t),e):void 0},removeClassName:function(e,t){return(e=$(e))?(e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ").strip(),e):void 0},toggleClassName:function(e,t){return(e=$(e))?Element[Element.hasClassName(e,t)?"removeClassName":"addClassName"](e,t):void 0},cleanWhitespace:function(e){e=$(e);for(var t=e.firstChild;t;){var n=t.nextSibling;3!=t.nodeType||/\S/.test(t.nodeValue)||e.removeChild(t),t=n}return e},empty:function(e){return $(e).innerHTML.blank()},descendantOf:function(e,t){if(e=$(e),t=$(t),e.compareDocumentPosition)return 8===(8&e.compareDocumentPosition(t));if(t.contains)return t.contains(e)&&t!==e;for(;e=e.parentNode;)if(e==t)return!0;return!1},scrollTo:function(e){e=$(e);var t=Element.cumulativeOffset(e);return window.scrollTo(t[0],t[1]),e},getStyle:function(e,t){e=$(e),t="float"==t?"cssFloat":t.camelize();var n=e.style[t];if(!n||"auto"==n){var i=document.defaultView.getComputedStyle(e,null);n=i?i[t]:null}return"opacity"==t?n?parseFloat(n):1:"auto"==n?null:n},getOpacity:function(e){return $(e).getStyle("opacity")},setStyle:function(e,t){e=$(e);var n=e.style;if(Object.isString(t))return e.style.cssText+=";"+t,t.include("opacity")?e.setOpacity(t.match(/opacity:\s*(\d?\.?\d*)/)[1]):e;for(var i in t)"opacity"==i?e.setOpacity(t[i]):n["float"==i||"cssFloat"==i?Object.isUndefined(n.styleFloat)?"cssFloat":"styleFloat":i]=t[i];return e},setOpacity:function(e,t){return e=$(e),e.style.opacity=1==t||""===t?"":1e-5>t?0:t,e},makePositioned:function(e){e=$(e);var t=Element.getStyle(e,"position");return"static"!=t&&t||(e._madePositioned=!0,e.style.position="relative",Prototype.Browser.Opera&&(e.style.top=0,e.style.left=0)),e},undoPositioned:function(e){return e=$(e),e._madePositioned&&(e._madePositioned=void 0,e.style.position=e.style.top=e.style.left=e.style.bottom=e.style.right=""),e},makeClipping:function(e){return e=$(e),e._overflow?e:(e._overflow=Element.getStyle(e,"overflow")||"auto","hidden"!==e._overflow&&(e.style.overflow="hidden"),e)},undoClipping:function(e){return e=$(e),e._overflow?(e.style.overflow="auto"==e._overflow?"":e._overflow,e._overflow=null,e):e},clonePosition:function(e,t){var n=Object.extend({setLeft:!0,setTop:!0,setWidth:!0,setHeight:!0,offsetTop:0,offsetLeft:0},arguments[2]||{});t=$(t);var i=Element.viewportOffset(t),o=[0,0],r=null;return e=$(e),"absolute"==Element.getStyle(e,"position")&&(r=Element.getOffsetParent(e),o=Element.viewportOffset(r)),r==document.body&&(o[0]-=document.body.offsetLeft,o[1]-=document.body.offsetTop),n.setLeft&&(e.style.left=i[0]-o[0]+n.offsetLeft+"px"),n.setTop&&(e.style.top=i[1]-o[1]+n.offsetTop+"px"),n.setWidth&&(e.style.width=t.offsetWidth+"px"),n.setHeight&&(e.style.height=t.offsetHeight+"px"),e}},Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants}),Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}},Prototype.Browser.Opera?(Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(e,t,n){switch(n){case"height":case"width":if(!Element.visible(t))return null;var i=parseInt(e(t,n),10);if(i!==t["offset"+n.capitalize()])return i+"px";var o;return o="height"===n?["border-top-width","padding-top","padding-bottom","border-bottom-width"]:["border-left-width","padding-left","padding-right","border-right-width"],o.inject(i,function(n,i){var o=e(t,i);return null===o?n:n-parseInt(o,10)})+"px";default:return e(t,n)}}),Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(e,t,n){return"title"===n?t.title:e(t,n)})):Prototype.Browser.IE?(Element.Methods.getStyle=function(e,t){e=$(e),t="float"==t||"cssFloat"==t?"styleFloat":t.camelize();var n=e.style[t];return!n&&e.currentStyle&&(n=e.currentStyle[t]),"opacity"==t?(n=(e.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))&&n[1]?parseFloat(n[1])/100:1:"auto"==n?"width"!=t&&"height"!=t||"none"==e.getStyle("display")?null:e["offset"+t.capitalize()]+"px":n},Element.Methods.setOpacity=function(e,t){function n(e){return e.replace(/alpha\([^\)]*\)/gi,"")}e=$(e);var i=e.currentStyle;(i&&!i.hasLayout||!i&&"normal"==e.style.zoom)&&(e.style.zoom=1);var o=e.getStyle("filter"),r=e.style;return 1==t||""===t?((o=n(o))?r.filter=o:r.removeAttribute("filter"),e):(1e-5>t&&(t=0),r.filter=n(o)+"alpha(opacity="+100*t+")",e)},Element._attributeTranslations=function(){var e="className",t="for",n=document.createElement("div");return n.setAttribute(e,"x"),"x"!==n.className&&(n.setAttribute("class","x"),"x"===n.className&&(e="class")),n=null,n=document.createElement("label"),n.setAttribute(t,"x"),"x"!==n.htmlFor&&(n.setAttribute("htmlFor","x"),"x"===n.htmlFor&&(t="htmlFor")),n=null,{read:{names:{"class":e,className:e,"for":t,htmlFor:t},values:{_getAttr:function(e,t){return e.getAttribute(t)},_getAttr2:function(e,t){return e.getAttribute(t,2)},_getAttrNode:function(e,t){var n=e.getAttributeNode(t);return n?n.value:""},_getEv:function(){var e,t=document.createElement("div");t.onclick=Prototype.emptyFunction;var n=t.getAttribute("onclick");return String(n).indexOf("{")>-1?e=function(e,t){return(t=e.getAttribute(t))?(t=t.toString(),t=t.split("{")[1],t=t.split("}")[0],t.strip()):null}:""===n&&(e=function(e,t){return t=e.getAttribute(t),t?t.strip():null}),t=null,e}(),_flag:function(e,t){return $(e).hasAttribute(t)?t:null},style:function(e){return e.style.cssText.toLowerCase()},title:function(e){return e.title}}}}}(),Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(e,t){e.checked=!!t},style:function(e,t){e.style.cssText=t?t:""}}},Element._attributeTranslations.has={},$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(e){Element._attributeTranslations.write.names[e.toLowerCase()]=e,Element._attributeTranslations.has[e.toLowerCase()]=e}),function(e){Object.extend(e,{href:e._getAttr2,src:e._getAttr2,type:e._getAttr,action:e._getAttrNode,disabled:e._flag,checked:e._flag,readonly:e._flag,multiple:e._flag,onload:e._getEv,onunload:e._getEv,onclick:e._getEv,ondblclick:e._getEv,onmousedown:e._getEv,onmouseup:e._getEv,onmouseover:e._getEv,onmousemove:e._getEv,onmouseout:e._getEv,onfocus:e._getEv,onblur:e._getEv,onkeypress:e._getEv,onkeydown:e._getEv,onkeyup:e._getEv,onsubmit:e._getEv,onreset:e._getEv,onselect:e._getEv,onchange:e._getEv})}(Element._attributeTranslations.read.values),Prototype.BrowserFeatures.ElementExtensions&&!function(){function e(e){for(var t,n=e.getElementsByTagName("*"),i=[],o=0;t=n[o];o++)"!"!==t.tagName&&i.push(t);return i}Element.Methods.down=function(t,n,i){return t=$(t),1==arguments.length?t.firstDescendant():Object.isNumber(n)?e(t)[n]:Element.select(t,n)[i||0]}}()):Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent)?Element.Methods.setOpacity=function(e,t){return e=$(e),e.style.opacity=1==t?.999999:""===t?"":1e-5>t?0:t,e}:Prototype.Browser.WebKit&&(Element.Methods.setOpacity=function(e,t){if(e=$(e),e.style.opacity=1==t||""===t?"":1e-5>t?0:t,1==t)if("IMG"==e.tagName.toUpperCase()&&e.width)e.width++,e.width--;else try{var n=document.createTextNode(" ");e.appendChild(n),e.removeChild(n)}catch(i){}return e}),"outerHTML"in document.documentElement&&(Element.Methods.replace=function(e,t){if(e=$(e),t&&t.toElement&&(t=t.toElement()),Object.isElement(t))return e.parentNode.replaceChild(t,e),e;t=Object.toHTML(t);var n=e.parentNode,i=n.tagName.toUpperCase();if(Element._insertionTranslations.tags[i]){var o=e.next(),r=Element._getContentFromAnonymousElement(i,t.stripScripts());n.removeChild(e),r.each(o?function(e){n.insertBefore(e,o)}:function(e){n.appendChild(e)})}else e.outerHTML=t.stripScripts();return t.evalScripts.bind(t).defer(),e}),Element._returnOffset=function(e,t){var n=[e,t];return n.left=e,n.top=t,n},Element._getContentFromAnonymousElement=function(e,t,n){var i=new Element("div"),o=Element._insertionTranslations.tags[e],r=!1;if(o?r=!0:n&&(r=!0,o=["","",0]),r){i.innerHTML="&nbsp;"+o[0]+t+o[1],i.removeChild(i.firstChild);for(var s=o[2];s--;)i=i.firstChild}else i.innerHTML=t;return $A(i.childNodes)},Element._insertionTranslations={before:function(e,t){e.parentNode.insertBefore(t,e)},top:function(e,t){e.insertBefore(t,e.firstChild)},bottom:function(e,t){e.appendChild(t)},after:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}},function(){var e=Element._insertionTranslations.tags;Object.extend(e,{THEAD:e.TBODY,TFOOT:e.TBODY,TH:e.TD})}(),Element.Methods.Simulated={hasAttribute:function(e,t){t=Element._attributeTranslations.has[t]||t;var n=$(e).getAttributeNode(t);return!(!n||!n.specified)}},Element.Methods.ByTag={},Object.extend(Element,Element.Methods),function(e){!Prototype.BrowserFeatures.ElementExtensions&&e.__proto__&&(window.HTMLElement={},window.HTMLElement.prototype=e.__proto__,Prototype.BrowserFeatures.ElementExtensions=!0),e=null}(document.createElement("div")),Element.extend=function(){function e(e){if("undefined"!=typeof window.Element){var t=window.Element.prototype;if(t){var n="_"+(Math.random()+"").slice(2),i=document.createElement(e);t[n]="x";var o="x"!==i[n];return delete t[n],i=null,o}}return!1}function t(e,t){for(var n in t){var i=t[n];!Object.isFunction(i)||n in e||(e[n]=i.methodize())}}var n=e("object");if(Prototype.BrowserFeatures.SpecificElementExtensions)return n?function(e){if(e&&"undefined"==typeof e._extendedByPrototype){var n=e.tagName;n&&/^(?:object|applet|embed)$/i.test(n)&&(t(e,Element.Methods),t(e,Element.Methods.Simulated),t(e,Element.Methods.ByTag[n.toUpperCase()]))}return e}:Prototype.K;var i={},o=Element.Methods.ByTag,r=Object.extend(function(e){if(!e||"undefined"!=typeof e._extendedByPrototype||1!=e.nodeType||e==window)return e;var n=Object.clone(i),r=e.tagName.toUpperCase();return o[r]&&Object.extend(n,o[r]),t(e,n),e._extendedByPrototype=Prototype.emptyFunction,e},{refresh:function(){Prototype.BrowserFeatures.ElementExtensions||(Object.extend(i,Element.Methods),Object.extend(i,Element.Methods.Simulated))}});return r.refresh(),r}(),Element.hasAttribute=document.documentElement.hasAttribute?function(e,t){return e.hasAttribute(t)}:Element.Methods.Simulated.hasAttribute,Element.addMethods=function(e){function t(t){t=t.toUpperCase(),Element.Methods.ByTag[t]||(Element.Methods.ByTag[t]={}),Object.extend(Element.Methods.ByTag[t],e)}function n(e,t,n){n=n||!1;for(var i in e){var o=e[i];Object.isFunction(o)&&(n&&i in t||(t[i]=o.methodize()))}}function i(e){var t,n={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(n[e]&&(t="HTML"+n[e]+"Element"),window[t])return window[t];if(t="HTML"+e+"Element",window[t])return window[t];if(t="HTML"+e.capitalize()+"Element",window[t])return window[t];var i=document.createElement(e),o=i.__proto__||i.constructor.prototype;return i=null,o}var o=Prototype.BrowserFeatures,r=Element.Methods.ByTag;if(e||(Object.extend(Form,Form.Methods),Object.extend(Form.Element,Form.Element.Methods),Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods),BUTTON:Object.clone(Form.Element.Methods)})),2==arguments.length){var s=e;e=arguments[1]}s?Object.isArray(s)?s.each(t):t(s):Object.extend(Element.Methods,e||{});var a=window.HTMLElement?HTMLElement.prototype:Element.prototype;if(o.ElementExtensions&&(n(Element.Methods,a),n(Element.Methods.Simulated,a,!0)),o.SpecificElementExtensions)for(var l in Element.Methods.ByTag){var c=i(l);Object.isUndefined(c)||n(r[l],c.prototype)}Object.extend(Element,Element.Methods),delete Element.ByTag,Element.extend.refresh&&Element.extend.refresh(),Element.cache={}},document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}},function(e){function t(){return o.WebKit&&!r.evaluate?document:o.Opera&&window.parseFloat(window.opera.version())<9.5?document.body:document.documentElement}function n(n){return i||(i=t()),s[n]="client"+n,e["get"+n]=function(){return i[s[n]]},e["get"+n]()}var i,o=Prototype.Browser,r=document,s={};e.getWidth=n.curry("Width"),e.getHeight=n.curry("Height")}(document.viewport),Element.Storage={UID:1},Element.addMethods({getStorage:function(e){if(e=$(e)){var t;return e===window?t=0:("undefined"==typeof e._prototypeUID&&(e._prototypeUID=Element.Storage.UID++),t=e._prototypeUID),Element.Storage[t]||(Element.Storage[t]=$H()),Element.Storage[t]}},store:function(e,t,n){return(e=$(e))?(2===arguments.length?Element.getStorage(e).update(t):Element.getStorage(e).set(t,n),e):void 0},retrieve:function(e,t,n){if(e=$(e)){var i=Element.getStorage(e),o=i.get(t);return Object.isUndefined(o)&&(i.set(t,n),o=n),o}},clone:function(e,t){if(e=$(e)){var n=e.cloneNode(t);if(n._prototypeUID=void 0,t)for(var i=Element.select(n,"*"),o=i.length;o--;)i[o]._prototypeUID=void 0;return Element.extend(n)}},purge:function(e){if(e=$(e)){var t=Element._purgeElement;t(e);for(var n=e.getElementsByTagName("*"),i=n.length;i--;)t(n[i]);return null}}}),function(){function e(e){var t=e.match(/^(\d+)%?$/i);return t?Number(t[1])/100:null}function t(t,n,i){var o=null;if(Object.isElement(t)&&(o=t,t=o.getStyle(n)),null===t)return null;if(/^(?:-)?\d+(\.\d+)?(px)?$/i.test(t))return window.parseFloat(t);var r=t.include("%"),s=i===document.viewport;if(/\d/.test(t)&&o&&o.runtimeStyle&&(!r||!s)){var a=o.style.left,l=o.runtimeStyle.left;return o.runtimeStyle.left=o.currentStyle.left,o.style.left=t||0,t=o.style.pixelLeft,o.style.left=a,o.runtimeStyle.left=l,t}if(o&&r){i=i||o.parentNode;var c=e(t),u=null,h=(o.getStyle("position"),n.include("left")||n.include("right")||n.include("width")),d=n.include("top")||n.include("bottom")||n.include("height");return i===document.viewport?h?u=document.viewport.getWidth():d&&(u=document.viewport.getHeight()):h?u=$(i).measure("width"):d&&(u=$(i).measure("height")),null===u?0:u*c}return 0}function n(e){for(;e&&e.parentNode;){var t=e.getStyle("display");if("none"===t)return!1;e=$(e.parentNode)}return!0}function i(e){return e.include("border")&&(e+="-width"),e.camelize()}function o(e,t){return new Element.Layout(e,t)}function r(e,t){return $(e).getLayout().get(t)}function s(e){e=$(e);var t=Element.getStyle(e,"display");if(t&&"none"!==t)return{width:e.offsetWidth,height:e.offsetHeight};var n=e.style,i={visibility:n.visibility,position:n.position,display:n.display},o={visibility:"hidden",display:"block"};"fixed"!==i.position&&(o.position="absolute"),Element.setStyle(e,o);var r={width:e.offsetWidth,height:e.offsetHeight};return Element.setStyle(e,i),r}function a(e){if(e=$(e),g(e)||v(e)||f(e)||m(e))return $(document.body);var t="inline"===Element.getStyle(e,"display");if(!t&&e.offsetParent)return $(e.offsetParent);for(;(e=e.parentNode)&&e!==document.body;)if("static"!==Element.getStyle(e,"position"))return $(m(e)?document.body:e);return $(document.body)}function l(e){e=$(e);var t=0,n=0;if(e.parentNode)do t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent;while(e);return new Element.Offset(n,t)}function c(e){e=$(e);var t=e.getLayout(),n=0,i=0;do if(n+=e.offsetTop||0,i+=e.offsetLeft||0,e=e.offsetParent){if(f(e))break;var o=Element.getStyle(e,"position");if("static"!==o)break}while(e);return i-=t.get("margin-top"),n-=t.get("margin-left"),new Element.Offset(i,n)}function u(e){var t=0,n=0;do t+=e.scrollTop||0,n+=e.scrollLeft||0,e=e.parentNode;while(e);return new Element.Offset(n,t)}function h(e){o=$(o);var t=0,n=0,i=document.body,o=e;do if(t+=o.offsetTop||0,n+=o.offsetLeft||0,o.offsetParent==i&&"absolute"==Element.getStyle(o,"position"))break;while(o=o.offsetParent);o=e;do o!=i&&(t-=o.scrollTop||0,n-=o.scrollLeft||0);while(o=o.parentNode);return new Element.Offset(n,t)}function d(e){if(e=$(e),"absolute"===Element.getStyle(e,"position"))return e;var t=a(e),n=e.viewportOffset(),i=t.viewportOffset(),o=n.relativeTo(i),r=e.getLayout();return e.store("prototype_absolutize_original_styles",{left:e.getStyle("left"),top:e.getStyle("top"),width:e.getStyle("width"),height:e.getStyle("height")}),e.setStyle({position:"absolute",top:o.top+"px",left:o.left+"px",width:r.get("width")+"px",height:r.get("height")+"px"}),e}function p(e){if(e=$(e),"relative"===Element.getStyle(e,"position"))return e;var t=e.retrieve("prototype_absolutize_original_styles");return t&&e.setStyle(t),e}function f(e){return"BODY"===e.nodeName.toUpperCase()}function m(e){return"HTML"===e.nodeName.toUpperCase()}function g(e){return e.nodeType===Node.DOCUMENT_NODE}function v(e){return e!==document.body&&!Element.descendantOf(e,document.body)}var y=Prototype.K;"currentStyle"in document.documentElement&&(y=function(e){return e.currentStyle.hasLayout||(e.style.zoom=1),e}),Element.Layout=Class.create(Hash,{initialize:function($super,e,t){$super(),this.element=$(e),Element.Layout.PROPERTIES.each(function(e){this._set(e,null)},this),t&&(this._preComputing=!0,this._begin(),Element.Layout.PROPERTIES.each(this._compute,this),this._end(),this._preComputing=!1)},_set:function(e,t){return Hash.prototype.set.call(this,e,t)},set:function(){throw"Properties of Element.Layout are read-only."},get:function($super,e){var t=$super(e);return null===t?this._compute(e):t},_begin:function(){if(!this._prepared){var e=this.element;if(n(e))return void(this._prepared=!0);var i={position:e.style.position||"",width:e.style.width||"",visibility:e.style.visibility||"",display:e.style.display||""};e.store("prototype_original_styles",i);var o=e.getStyle("position"),r=e.getStyle("width");("0px"===r||null===r)&&(e.style.display="block",r=e.getStyle("width"));var s="fixed"===o?document.viewport:e.parentNode;e.setStyle({position:"absolute",visibility:"hidden",display:"block"});var a,l=e.getStyle("width");if(r&&l===r)a=t(e,"width",s);else if("absolute"===o||"fixed"===o)a=t(e,"width",s);else{var c=e.parentNode,u=$(c).getLayout();a=u.get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right")}e.setStyle({width:a+"px"}),this._prepared=!0}},_end:function(){var e=this.element,t=e.retrieve("prototype_original_styles");e.store("prototype_original_styles",null),e.setStyle(t),this._prepared=!1},_compute:function(e){var t=Element.Layout.COMPUTATIONS;if(!(e in t))throw"Property not found.";return this._set(e,t[e].call(this,this.element))},toObject:function(){var e=$A(arguments),t=0===e.length?Element.Layout.PROPERTIES:e.join(" ").split(" "),n={};return t.each(function(e){if(Element.Layout.PROPERTIES.include(e)){var t=this.get(e);null!=t&&(n[e]=t)}},this),n},toHash:function(){var e=this.toObject.apply(this,arguments);return new Hash(e)},toCSS:function(){var e=$A(arguments),t=0===e.length?Element.Layout.PROPERTIES:e.join(" ").split(" "),n={};return t.each(function(e){if(Element.Layout.PROPERTIES.include(e)&&!Element.Layout.COMPOSITE_PROPERTIES.include(e)){var t=this.get(e);null!=t&&(n[i(e)]=t+"px")}},this),n},inspect:function(){return"#<Element.Layout>"}}),Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),COMPUTATIONS:{height:function(){this._preComputing||this._begin();var e=this.get("border-box-height");if(0>=e)return this._preComputing||this._end(),0;var t=this.get("border-top"),n=this.get("border-bottom"),i=this.get("padding-top"),o=this.get("padding-bottom");return this._preComputing||this._end(),e-t-n-i-o},width:function(){this._preComputing||this._begin();var e=this.get("border-box-width");if(0>=e)return this._preComputing||this._end(),0;var t=this.get("border-left"),n=this.get("border-right"),i=this.get("padding-left"),o=this.get("padding-right");return this._preComputing||this._end(),e-t-n-i-o},"padding-box-height":function(){var e=this.get("height"),t=this.get("padding-top"),n=this.get("padding-bottom");return e+t+n},"padding-box-width":function(){var e=this.get("width"),t=this.get("padding-left"),n=this.get("padding-right");return e+t+n},"border-box-height":function(e){this._preComputing||this._begin();var t=e.offsetHeight;return this._preComputing||this._end(),t},"border-box-width":function(e){this._preComputing||this._begin();var t=e.offsetWidth;return this._preComputing||this._end(),t},"margin-box-height":function(){var e=this.get("border-box-height"),t=this.get("margin-top"),n=this.get("margin-bottom");return 0>=e?0:e+t+n},"margin-box-width":function(){var e=this.get("border-box-width"),t=this.get("margin-left"),n=this.get("margin-right");return 0>=e?0:e+t+n},top:function(e){var t=e.positionedOffset();return t.top},bottom:function(e){var t=e.positionedOffset(),n=e.getOffsetParent(),i=n.measure("height"),o=this.get("border-box-height");return i-o-t.top},left:function(e){var t=e.positionedOffset();return t.left},right:function(e){var t=e.positionedOffset(),n=e.getOffsetParent(),i=n.measure("width"),o=this.get("border-box-width");return i-o-t.left},"padding-top":function(e){return t(e,"paddingTop")},"padding-bottom":function(e){return t(e,"paddingBottom")},"padding-left":function(e){return t(e,"paddingLeft")},"padding-right":function(e){return t(e,"paddingRight")},"border-top":function(e){return t(e,"borderTopWidth")},"border-bottom":function(e){return t(e,"borderBottomWidth")},"border-left":function(e){return t(e,"borderLeftWidth")},"border-right":function(e){return t(e,"borderRightWidth")},"margin-top":function(e){return t(e,"marginTop")},"margin-bottom":function(e){return t(e,"marginBottom")},"margin-left":function(e){return t(e,"marginLeft")},"margin-right":function(e){return t(e,"marginRight")}}}),"getBoundingClientRect"in document.documentElement&&Object.extend(Element.Layout.COMPUTATIONS,{right:function(e){var t=y(e.getOffsetParent()),n=e.getBoundingClientRect(),i=t.getBoundingClientRect();return(i.right-n.right).round()},bottom:function(e){var t=y(e.getOffsetParent()),n=e.getBoundingClientRect(),i=t.getBoundingClientRect();return(i.bottom-n.bottom).round()}}),Element.Offset=Class.create({initialize:function(e,t){this.left=e.round(),this.top=t.round(),this[0]=this.left,this[1]=this.top},relativeTo:function(e){return new Element.Offset(this.left-e.left,this.top-e.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,this.top]}}),Prototype.Browser.IE?(a=a.wrap(function(e,t){if(t=$(t),g(t)||v(t)||f(t)||m(t))return $(document.body);var n=t.getStyle("position");if("static"!==n)return e(t);t.setStyle({position:"relative"});var i=e(t);return t.setStyle({position:n}),i}),c=c.wrap(function(e,t){if(t=$(t),!t.parentNode)return new Element.Offset(0,0);var n=t.getStyle("position");if("static"!==n)return e(t);var i=t.getOffsetParent();i&&"fixed"===i.getStyle("position")&&y(i),t.setStyle({position:"relative"});var o=e(t);return t.setStyle({position:n}),o})):Prototype.Browser.Webkit&&(l=function(e){e=$(e);var t=0,n=0;do{if(t+=e.offsetTop||0,n+=e.offsetLeft||0,e.offsetParent==document.body&&"absolute"==Element.getStyle(e,"position"))break;e=e.offsetParent}while(e);return new Element.Offset(n,t)}),Element.addMethods({getLayout:o,measure:r,getDimensions:s,getOffsetParent:a,cumulativeOffset:l,positionedOffset:c,cumulativeScrollOffset:u,viewportOffset:h,absolutize:d,relativize:p}),"getBoundingClientRect"in document.documentElement&&Element.addMethods({viewportOffset:function(e){if(e=$(e),v(e))return new Element.Offset(0,0);var t=e.getBoundingClientRect(),n=document.documentElement;return new Element.Offset(t.left-n.clientLeft,t.top-n.clientTop)}})}(),window.$$=function(){var e=$A(arguments).join(", ");return Prototype.Selector.select(e,document)},Prototype.Selector=function(){function e(){throw new Error('Method "Prototype.Selector.select" must be defined.')}function t(){throw new Error('Method "Prototype.Selector.match" must be defined.')}function n(e,t,n){n=n||0;var i,o=Prototype.Selector.match,r=e.length,s=0;for(i=0;r>i;i++)if(o(e[i],t)&&n==s++)return Element.extend(e[i])}function i(e){for(var t=0,n=e.length;n>t;t++)Element.extend(e[t]);return e}var o=Prototype.K;return{select:e,match:t,find:n,extendElements:Element.extend===o?o:i,extendElement:Element.extend}}(),Prototype._original_property=window.Sizzle,/*!
 * Sizzle CSS Selector Engine - v1.0
 *  Copyright 2009, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
function(){function e(e,t,n,i,o,r){for(var s="previousSibling"==e&&!r,a=0,l=i.length;l>a;a++){var c=i[a];if(c){s&&1===c.nodeType&&(c.sizcache=n,c.sizset=a),c=c[e];for(var u=!1;c;){if(c.sizcache===n){u=i[c.sizset];break}if(1!==c.nodeType||r||(c.sizcache=n,c.sizset=a),c.nodeName===t){u=c;break}c=c[e]}i[a]=u}}}function t(e,t,n,i,o,r){for(var s="previousSibling"==e&&!r,l=0,c=i.length;c>l;l++){var u=i[l];if(u){s&&1===u.nodeType&&(u.sizcache=n,u.sizset=l),u=u[e];for(var h=!1;u;){if(u.sizcache===n){h=i[u.sizset];break}if(1===u.nodeType)if(r||(u.sizcache=n,u.sizset=l),"string"!=typeof t){if(u===t){h=!0;break}}else if(a.filter(t,[u]).length>0){h=u;break}u=u[e]}i[l]=h}}}var n=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,i=0,o=Object.prototype.toString,r=!1,s=!0;[0,0].sort(function(){return s=!1,0});var a=function(e,t,i,r){i=i||[];var s=t=t||document;if(1!==t.nodeType&&9!==t.nodeType)return[];if(!e||"string"!=typeof e)return i;for(var u,d,p,v,y=[],b=!0,w=m(t),_=e;null!==(n.exec(""),u=n.exec(_));)if(_=u[3],y.push(u[1]),u[2]){v=u[3];break}if(y.length>1&&c.exec(e))if(2===y.length&&l.relative[y[0]])d=g(y[0]+y[1],t);else for(d=l.relative[y[0]]?[t]:a(y.shift(),t);y.length;)e=y.shift(),l.relative[e]&&(e+=y.shift()),d=g(e,d);else{if(!r&&y.length>1&&9===t.nodeType&&!w&&l.match.ID.test(y[0])&&!l.match.ID.test(y[y.length-1])){var C=a.find(y.shift(),t,w);t=C.expr?a.filter(C.expr,C.set)[0]:C.set[0]}if(t){var C=r?{expr:y.pop(),set:h(r)}:a.find(y.pop(),1!==y.length||"~"!==y[0]&&"+"!==y[0]||!t.parentNode?t:t.parentNode,w);for(d=C.expr?a.filter(C.expr,C.set):C.set,y.length>0?p=h(d):b=!1;y.length;){var S=y.pop(),x=S;l.relative[S]?x=y.pop():S="",null==x&&(x=t),l.relative[S](p,x,w)}}else p=y=[]}if(p||(p=d),!p)throw"Syntax error, unrecognized expression: "+(S||e);if("[object Array]"===o.call(p))if(b)if(t&&1===t.nodeType)for(var E=0;null!=p[E];E++)p[E]&&(p[E]===!0||1===p[E].nodeType&&f(t,p[E]))&&i.push(d[E]);else for(var E=0;null!=p[E];E++)p[E]&&1===p[E].nodeType&&i.push(d[E]);else i.push.apply(i,p);else h(p,i);return v&&(a(v,s,i,r),a.uniqueSort(i)),i};a.uniqueSort=function(e){if(p&&(r=s,e.sort(p),r))for(var t=1;t<e.length;t++)e[t]===e[t-1]&&e.splice(t--,1);return e},a.matches=function(e,t){return a(e,null,null,t)},a.find=function(e,t,n){var i,o;if(!e)return[];for(var r=0,s=l.order.length;s>r;r++){var o,a=l.order[r];if(o=l.leftMatch[a].exec(e)){var c=o[1];if(o.splice(1,1),"\\"!==c.substr(c.length-1)&&(o[1]=(o[1]||"").replace(/\\/g,""),i=l.find[a](o,t,n),null!=i)){e=e.replace(l.match[a],"");break}}}return i||(i=t.getElementsByTagName("*")),{set:i,expr:e}},a.filter=function(e,t,n,i){for(var o,r,s=e,a=[],c=t,u=t&&t[0]&&m(t[0]);e&&t.length;){for(var h in l.filter)if(null!=(o=l.match[h].exec(e))){var d,p,f=l.filter[h];if(r=!1,c==a&&(a=[]),l.preFilter[h])if(o=l.preFilter[h](o,c,n,a,i,u)){if(o===!0)continue}else r=d=!0;if(o)for(var g=0;null!=(p=c[g]);g++)if(p){d=f(p,o,g,c);var v=i^!!d;n&&null!=d?v?r=!0:c[g]=!1:v&&(a.push(p),r=!0)}if(void 0!==d){if(n||(c=a),e=e.replace(l.match[h],""),!r)return[];break}}if(e==s){if(null==r)throw"Syntax error, unrecognized expression: "+e;break}s=e}return c};var l=a.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")}},relative:{"+":function(e,t,n){var i="string"==typeof t,o=i&&!/\W/.test(t),r=i&&!o;o&&!n&&(t=t.toUpperCase());for(var s,l=0,c=e.length;c>l;l++)if(s=e[l]){for(;(s=s.previousSibling)&&1!==s.nodeType;);e[l]=r||s&&s.nodeName===t?s||!1:s===t}r&&a.filter(t,e,!0)},">":function(e,t,n){var i="string"==typeof t;if(i&&!/\W/.test(t)){t=n?t:t.toUpperCase();for(var o=0,r=e.length;r>o;o++){var s=e[o];if(s){var l=s.parentNode;e[o]=l.nodeName===t?l:!1}}}else{for(var o=0,r=e.length;r>o;o++){var s=e[o];s&&(e[o]=i?s.parentNode:s.parentNode===t)}i&&a.filter(t,e,!0)}},"":function(n,o,r){var s=i++,a=t;if(!/\W/.test(o)){var l=o=r?o:o.toUpperCase();a=e}a("parentNode",o,s,n,l,r)},"~":function(n,o,r){var s=i++,a=t;if("string"==typeof o&&!/\W/.test(o)){var l=o=r?o:o.toUpperCase();a=e}a("previousSibling",o,s,n,l,r)}},find:{ID:function(e,t,n){if("undefined"!=typeof t.getElementById&&!n){var i=t.getElementById(e[1]);return i?[i]:[]}},NAME:function(e,t){if("undefined"!=typeof t.getElementsByName){for(var n=[],i=t.getElementsByName(e[1]),o=0,r=i.length;r>o;o++)i[o].getAttribute("name")===e[1]&&n.push(i[o]);return 0===n.length?null:n}},TAG:function(e,t){return t.getElementsByTagName(e[1])}},preFilter:{CLASS:function(e,t,n,i,o,r){if(e=" "+e[1].replace(/\\/g,"")+" ",r)return e;for(var s,a=0;null!=(s=t[a]);a++)s&&(o^(s.className&&(" "+s.className+" ").indexOf(e)>=0)?n||i.push(s):n&&(t[a]=!1));return!1},ID:function(e){return e[1].replace(/\\/g,"")},TAG:function(e,t){for(var n=0;t[n]===!1;n++);return t[n]&&m(t[n])?e[1]:e[1].toUpperCase()},CHILD:function(e){if("nth"==e[1]){var t=/(-?)(\d*)n((?:\+|-)?\d*)/.exec("even"==e[2]&&"2n"||"odd"==e[2]&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=t[1]+(t[2]||1)-0,e[3]=t[3]-0}return e[0]=i++,e},ATTR:function(e,t,n,i,o,r){var s=e[1].replace(/\\/g,"");return!r&&l.attrMap[s]&&(e[1]=l.attrMap[s]),"~="===e[2]&&(e[4]=" "+e[4]+" "),e},PSEUDO:function(e,t,i,o,r){if("not"===e[1]){if(!((n.exec(e[3])||"").length>1||/^\w/.test(e[3]))){var s=a.filter(e[3],t,i,!0^r);return i||o.push.apply(o,s),!1}e[3]=a(e[3],null,null,t)}else if(l.match.POS.test(e[0])||l.match.CHILD.test(e[0]))return!0;return e},POS:function(e){return e.unshift(!0),e}},filters:{enabled:function(e){return e.disabled===!1&&"hidden"!==e.type},disabled:function(e){return e.disabled===!0},checked:function(e){return e.checked===!0},selected:function(e){return e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!!e.firstChild},empty:function(e){return!e.firstChild},has:function(e,t,n){return!!a(n[3],e).length},header:function(e){return/h\d/i.test(e.nodeName)},text:function(e){return"text"===e.type},radio:function(e){return"radio"===e.type},checkbox:function(e){return"checkbox"===e.type},file:function(e){return"file"===e.type},password:function(e){return"password"===e.type},submit:function(e){return"submit"===e.type},image:function(e){return"image"===e.type},reset:function(e){return"reset"===e.type},button:function(e){return"button"===e.type||"BUTTON"===e.nodeName.toUpperCase()},input:function(e){return/input|select|textarea|button/i.test(e.nodeName)}},setFilters:{first:function(e,t){return 0===t},last:function(e,t,n,i){return t===i.length-1},even:function(e,t){return t%2===0},odd:function(e,t){return t%2===1},lt:function(e,t,n){return t<n[3]-0},gt:function(e,t,n){return t>n[3]-0},nth:function(e,t,n){return n[3]-0==t},eq:function(e,t,n){return n[3]-0==t}},filter:{PSEUDO:function(e,t,n,i){var o=t[1],r=l.filters[o];if(r)return r(e,n,t,i);if("contains"===o)return(e.textContent||e.innerText||"").indexOf(t[3])>=0;if("not"===o){for(var s=t[3],n=0,a=s.length;a>n;n++)if(s[n]===e)return!1;return!0}},CHILD:function(e,t){var n=t[1],i=e;switch(n){case"only":case"first":for(;i=i.previousSibling;)if(1===i.nodeType)return!1;if("first"==n)return!0;i=e;case"last":for(;i=i.nextSibling;)if(1===i.nodeType)return!1;return!0;case"nth":var o=t[2],r=t[3];if(1==o&&0==r)return!0;var s=t[0],a=e.parentNode;if(a&&(a.sizcache!==s||!e.nodeIndex)){var l=0;for(i=a.firstChild;i;i=i.nextSibling)1===i.nodeType&&(i.nodeIndex=++l);a.sizcache=s}var c=e.nodeIndex-r;return 0==o?0==c:c%o==0&&c/o>=0}},ID:function(e,t){return 1===e.nodeType&&e.getAttribute("id")===t},TAG:function(e,t){return"*"===t&&1===e.nodeType||e.nodeName===t},CLASS:function(e,t){return(" "+(e.className||e.getAttribute("class"))+" ").indexOf(t)>-1},ATTR:function(e,t){var n=t[1],i=l.attrHandle[n]?l.attrHandle[n](e):null!=e[n]?e[n]:e.getAttribute(n),o=i+"",r=t[2],s=t[4];return null==i?"!="===r:"="===r?o===s:"*="===r?o.indexOf(s)>=0:"~="===r?(" "+o+" ").indexOf(s)>=0:s?"!="===r?o!=s:"^="===r?0===o.indexOf(s):"$="===r?o.substr(o.length-s.length)===s:"|="===r?o===s||o.substr(0,s.length+1)===s+"-":!1:o&&i!==!1},POS:function(e,t,n,i){var o=t[2],r=l.setFilters[o];return r?r(e,n,t,i):void 0}}},c=l.match.POS;for(var u in l.match)l.match[u]=new RegExp(l.match[u].source+/(?![^\[]*\])(?![^\(]*\))/.source),l.leftMatch[u]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.match[u].source);var h=function(e,t){return e=Array.prototype.slice.call(e,0),t?(t.push.apply(t,e),t):e};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(d){h=function(e,t){var n=t||[];if("[object Array]"===o.call(e))Array.prototype.push.apply(n,e);else if("number"==typeof e.length)for(var i=0,r=e.length;r>i;i++)n.push(e[i]);else for(var i=0;e[i];i++)n.push(e[i]);return n}}var p;document.documentElement.compareDocumentPosition?p=function(e,t){if(!e.compareDocumentPosition||!t.compareDocumentPosition)return e==t&&(r=!0),0;var n=4&e.compareDocumentPosition(t)?-1:e===t?0:1;return 0===n&&(r=!0),n}:"sourceIndex"in document.documentElement?p=function(e,t){if(!e.sourceIndex||!t.sourceIndex)return e==t&&(r=!0),0;var n=e.sourceIndex-t.sourceIndex;return 0===n&&(r=!0),n}:document.createRange&&(p=function(e,t){if(!e.ownerDocument||!t.ownerDocument)return e==t&&(r=!0),0;var n=e.ownerDocument.createRange(),i=t.ownerDocument.createRange();n.setStart(e,0),n.setEnd(e,0),i.setStart(t,0),i.setEnd(t,0);var o=n.compareBoundaryPoints(Range.START_TO_END,i);return 0===o&&(r=!0),o}),function(){var e=document.createElement("div"),t="script"+(new Date).getTime();e.innerHTML="<a name='"+t+"'/>";var n=document.documentElement;n.insertBefore(e,n.firstChild),document.getElementById(t)&&(l.find.ID=function(e,t,n){if("undefined"!=typeof t.getElementById&&!n){var i=t.getElementById(e[1]);return i?i.id===e[1]||"undefined"!=typeof i.getAttributeNode&&i.getAttributeNode("id").nodeValue===e[1]?[i]:void 0:[]}},l.filter.ID=function(e,t){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return 1===e.nodeType&&n&&n.nodeValue===t}),n.removeChild(e),n=e=null}(),function(){var e=document.createElement("div");e.appendChild(document.createComment("")),e.getElementsByTagName("*").length>0&&(l.find.TAG=function(e,t){var n=t.getElementsByTagName(e[1]);if("*"===e[1]){for(var i=[],o=0;n[o];o++)1===n[o].nodeType&&i.push(n[o]);n=i}return n}),e.innerHTML="<a href='#'></a>",e.firstChild&&"undefined"!=typeof e.firstChild.getAttribute&&"#"!==e.firstChild.getAttribute("href")&&(l.attrHandle.href=function(e){return e.getAttribute("href",2)}),e=null}(),document.querySelectorAll&&function(){var e=a,t=document.createElement("div");if(t.innerHTML="<p class='TEST'></p>",!t.querySelectorAll||0!==t.querySelectorAll(".TEST").length){a=function(t,n,i,o){if(n=n||document,!o&&9===n.nodeType&&!m(n))try{return h(n.querySelectorAll(t),i)}catch(r){}return e(t,n,i,o)};for(var n in e)a[n]=e[n];t=null}}(),document.getElementsByClassName&&document.documentElement.getElementsByClassName&&function(){var e=document.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>",0!==e.getElementsByClassName("e").length&&(e.lastChild.className="e",1!==e.getElementsByClassName("e").length&&(l.order.splice(1,0,"CLASS"),l.find.CLASS=function(e,t,n){return"undefined"==typeof t.getElementsByClassName||n?void 0:t.getElementsByClassName(e[1])},e=null))}();var f=document.compareDocumentPosition?function(e,t){return 16&e.compareDocumentPosition(t)}:function(e,t){return e!==t&&(e.contains?e.contains(t):!0)},m=function(e){return 9===e.nodeType&&"HTML"!==e.documentElement.nodeName||!!e.ownerDocument&&"HTML"!==e.ownerDocument.documentElement.nodeName},g=function(e,t){for(var n,i=[],o="",r=t.nodeType?[t]:t;n=l.match.PSEUDO.exec(e);)o+=n[0],e=e.replace(l.match.PSEUDO,"");e=l.relative[e]?e+"*":e;for(var s=0,c=r.length;c>s;s++)a(e,r[s],i);return a.filter(o,i)};window.Sizzle=a}(),function(e){function t(t,n){return i(e(t,n||document))}function n(t,n){return 1==e.matches(n,[t]).length}var i=Prototype.Selector.extendElements;Prototype.Selector.engine=e,Prototype.Selector.select=t,Prototype.Selector.match=n}(Sizzle),window.Sizzle=Prototype._original_property,delete Prototype._original_property;var Form={reset:function(e){return e=$(e),e.reset(),e},serializeElements:function(e,t){"object"!=typeof t?t={hash:!!t}:Object.isUndefined(t.hash)&&(t.hash=!0);var n,i,o,r,s=!1,a=t.submit;return t.hash?(r={},o=function(e,t,n){return t in e?(Object.isArray(e[t])||(e[t]=[e[t]]),e[t].push(n)):e[t]=n,e}):(r="",o=function(e,t,n){return e+(e?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(n)}),e.inject(r,function(e,t){return!t.disabled&&t.name&&(n=t.name,i=$(t).getValue(),null==i||"file"==t.type||"submit"==t.type&&(s||a===!1||a&&n!=a||!(s=!0))||(e=o(e,n,i))),e})}};Form.Methods={serialize:function(e,t){return Form.serializeElements(Form.getElements(e),t)},getElements:function(e){for(var t,n=$(e).getElementsByTagName("*"),i=[],o=Form.Element.Serializers,r=0;t=n[r];r++)i.push(t);return i.inject([],function(e,t){return o[t.tagName.toLowerCase()]&&e.push(Element.extend(t)),e})},getInputs:function(e,t,n){e=$(e);var i=e.getElementsByTagName("input");if(!t&&!n)return $A(i).map(Element.extend);for(var o=0,r=[],s=i.length;s>o;o++){var a=i[o];t&&a.type!=t||n&&a.name!=n||r.push(Element.extend(a))}return r},disable:function(e){return e=$(e),Form.getElements(e).invoke("disable"),e},enable:function(e){return e=$(e),Form.getElements(e).invoke("enable"),e},findFirstElement:function(e){var t=$(e).getElements().findAll(function(e){return"hidden"!=e.type&&!e.disabled}),n=t.findAll(function(e){return e.hasAttribute("tabIndex")&&e.tabIndex>=0}).sortBy(function(e){return e.tabIndex}).first();return n?n:t.find(function(e){return/^(?:input|select|textarea)$/i.test(e.tagName)})},focusFirstElement:function(e){e=$(e);var t=e.findFirstElement();return t&&t.activate(),e},request:function(e,t){e=$(e),t=Object.clone(t||{});var n=t.parameters,i=e.readAttribute("action")||"";return i.blank()&&(i=window.location.href),t.parameters=e.serialize(!0),n&&(Object.isString(n)&&(n=n.toQueryParams()),Object.extend(t.parameters,n)),e.hasAttribute("method")&&!t.method&&(t.method=e.method),new Ajax.Request(i,t)}},Form.Element={focus:function(e){return $(e).focus(),e},select:function(e){return $(e).select(),e}},Form.Element.Methods={serialize:function(e){if(e=$(e),!e.disabled&&e.name){var t=e.getValue();if(void 0!=t){var n={};return n[e.name]=t,Object.toQueryString(n)}}return""},getValue:function(e){e=$(e);var t=e.tagName.toLowerCase();return Form.Element.Serializers[t](e)},setValue:function(e,t){e=$(e);var n=e.tagName.toLowerCase();return Form.Element.Serializers[n](e,t),e},clear:function(e){return $(e).value="",e},present:function(e){return""!=$(e).value},activate:function(e){e=$(e);try{e.focus(),!e.select||"input"==e.tagName.toLowerCase()&&/^(?:button|reset|submit)$/i.test(e.type)||e.select()}catch(t){}return e},disable:function(e){return e=$(e),e.disabled=!0,e},enable:function(e){return e=$(e),e.disabled=!1,e}};var Field=Form.Element,$F=Form.Element.Methods.getValue;Form.Element.Serializers=function(){function e(e,i){switch(e.type.toLowerCase()){case"checkbox":case"radio":return t(e,i);default:return n(e,i)}}function t(e,t){return Object.isUndefined(t)?e.checked?e.value:null:void(e.checked=!!t)}function n(e,t){return Object.isUndefined(t)?e.value:void(e.value=t)}function i(e,t){if(Object.isUndefined(t))return("select-one"===e.type?o:r)(e);for(var n,i,s=!Object.isArray(t),a=0,l=e.length;l>a;a++)if(n=e.options[a],i=this.optionValue(n),s){if(i==t)return void(n.selected=!0)}else n.selected=t.include(i)}function o(e){var t=e.selectedIndex;return t>=0?s(e.options[t]):null}function r(e){var t,n=e.length;if(!n)return null;for(var i=0,t=[];n>i;i++){var o=e.options[i];o.selected&&t.push(s(o))}return t}function s(e){return Element.hasAttribute(e,"value")?e.value:e.text}return{input:e,inputSelector:t,textarea:n,select:i,selectOne:o,selectMany:r,optionValue:s,button:n}}(),Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,e,t,n){$super(n,t),this.element=$(e),this.lastValue=this.getValue()},execute:function(){var e=this.getValue();(Object.isString(this.lastValue)&&Object.isString(e)?this.lastValue!=e:String(this.lastValue)!=String(e))&&(this.callback(this.element,e),this.lastValue=e)}}),Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}}),Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}}),Abstract.EventObserver=Class.create({initialize:function(e,t){this.element=$(e),this.callback=t,this.lastValue=this.getValue(),"form"==this.element.tagName.toLowerCase()?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var e=this.getValue();this.lastValue!=e&&(this.callback(this.element,e),this.lastValue=e)},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(e){if(e.type)switch(e.type.toLowerCase()){case"checkbox":case"radio":Event.observe(e,"click",this.onElementEvent.bind(this));break;default:Event.observe(e,"change",this.onElementEvent.bind(this))}}}),Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}}),Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}}),function(){function e(e,t){return e.which?e.which===t+1:e.button===t}function t(e,t){return e.button===x[t]}function n(e,t){switch(t){case 0:return 1==e.which&&!e.metaKey;case 1:return 2==e.which||1==e.which&&e.metaKey;case 2:return 3==e.which;default:return!1}}function i(e){return S(e,0)}function o(e){return S(e,1)}function r(e){return S(e,2)}function s(e){e=b.extend(e);var t=e.target,n=e.type,i=e.currentTarget;return i&&i.tagName&&("load"===n||"error"===n||"click"===n&&"input"===i.tagName.toLowerCase()&&"radio"===i.type)&&(t=i),t.nodeType==Node.TEXT_NODE&&(t=t.parentNode),Element.extend(t)}function a(e,t){var n=b.element(e);if(!t)return n;for(;n;){if(Object.isElement(n)&&Prototype.Selector.match(n,t))return Element.extend(n);n=n.parentNode}}function l(e){return{x:c(e),y:u(e)}}function c(e){var t=document.documentElement,n=document.body||{scrollLeft:0};return e.pageX||e.clientX+(t.scrollLeft||n.scrollLeft)-(t.clientLeft||0)}function u(e){var t=document.documentElement,n=document.body||{scrollTop:0};return e.pageY||e.clientY+(t.scrollTop||n.scrollTop)-(t.clientTop||0)}function h(e){b.extend(e),e.preventDefault(),e.stopPropagation(),e.stopped=!0}function d(e){var t;switch(e.type){case"mouseover":case"mouseenter":t=e.fromElement;break;case"mouseout":case"mouseleave":t=e.toElement;break;default:return null}return Element.extend(t)}function p(e,t,n){var i=Element.retrieve(e,"prototype_event_registry");Object.isUndefined(i)&&(T.push(e),i=Element.retrieve(e,"prototype_event_registry",$H()));var o=i.get(t);if(Object.isUndefined(o)&&(o=[],i.set(t,o)),o.pluck("handler").include(n))return!1;var r;return t.include(":")?r=function(i){return Object.isUndefined(i.eventName)?!1:i.eventName!==t?!1:(b.extend(i,e),void n.call(e,i))}:_||"mouseenter"!==t&&"mouseleave"!==t?r=function(t){b.extend(t,e),n.call(e,t)}:("mouseenter"===t||"mouseleave"===t)&&(r=function(t){b.extend(t,e);for(var i=t.relatedTarget;i&&i!==e;)try{i=i.parentNode}catch(o){i=e}i!==e&&n.call(e,t)}),r.handler=n,o.push(r),r}function f(){for(var e=0,t=T.length;t>e;e++)b.stopObserving(T[e]),T[e]=null}function m(e,t,n){e=$(e);var i=p(e,t,n);if(!i)return e;if(t.include(":"))e.addEventListener?e.addEventListener("dataavailable",i,!1):(e.attachEvent("ondataavailable",i),e.attachEvent("onlosecapture",i));else{var o=D(t);e.addEventListener?e.addEventListener(o,i,!1):e.attachEvent("on"+o,i)}return e}function g(e,t,n){e=$(e);var i=Element.retrieve(e,"prototype_event_registry");if(!i)return e;if(!t)return i.each(function(t){var n=t.key;g(e,n)}),e;var o=i.get(t);if(!o)return e;if(!n)return o.each(function(n){g(e,t,n.handler)}),e;for(var r,s=o.length;s--;)if(o[s].handler===n){r=o[s];break}if(!r)return e;if(t.include(":"))e.removeEventListener?e.removeEventListener("dataavailable",r,!1):(e.detachEvent("ondataavailable",r),e.detachEvent("onlosecapture",r));else{var a=D(t);e.removeEventListener?e.removeEventListener(a,r,!1):e.detachEvent("on"+a,r)}return i.set(t,o.without(r)),e}function v(e,t,n,i){e=$(e),Object.isUndefined(i)&&(i=!0),e==document&&document.createEvent&&!e.dispatchEvent&&(e=document.documentElement);var o;return document.createEvent?(o=document.createEvent("HTMLEvents"),o.initEvent("dataavailable",i,!0)):(o=document.createEventObject(),o.eventType=i?"ondataavailable":"onlosecapture"),o.eventName=t,o.memo=n||{},document.createEvent?e.dispatchEvent(o):e.fireEvent(o.eventType,o),b.extend(o)}function y(e,t,n,i){return e=$(e),Object.isFunction(n)&&Object.isUndefined(i)&&(i=n,n=null),new b.Handler(e,t,n,i).start()}var b={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}},w=document.documentElement,_="onmouseenter"in w&&"onmouseleave"in w,C=function(){return!1};window.attachEvent&&(C=window.addEventListener?function(e){return!(e instanceof window.Event)}:function(){return!0});var S,x={0:1,1:4,2:2};S=window.attachEvent?window.addEventListener?function(n,i){return C(n)?t(n,i):e(n,i)}:t:Prototype.Browser.WebKit?n:e,b.Methods={isLeftClick:i,isMiddleClick:o,isRightClick:r,element:s,findElement:a,pointer:l,pointerX:c,pointerY:u,stop:h};var E=Object.keys(b.Methods).inject({},function(e,t){return e[t]=b.Methods[t].methodize(),e});if(window.attachEvent){var k={stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.returnValue=!1},inspect:function(){return"[object Event]"}};b.extend=function(e,t){if(!e)return!1;if(!C(e))return e;if(e._extendedByPrototype)return e;e._extendedByPrototype=Prototype.emptyFunction;var n=b.pointer(e);return Object.extend(e,{target:e.srcElement||t,relatedTarget:d(e),pageX:n.x,pageY:n.y}),Object.extend(e,E),Object.extend(e,k),e}}else b.extend=Prototype.K;window.addEventListener&&(b.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__,Object.extend(b.prototype,E));var T=[];Prototype.Browser.IE&&window.attachEvent("onunload",f),Prototype.Browser.WebKit&&window.addEventListener("unload",Prototype.emptyFunction,!1);var D=Prototype.K,M={mouseenter:"mouseover",mouseleave:"mouseout"};_||(D=function(e){return M[e]||e}),b.Handler=Class.create({initialize:function(e,t,n,i){this.element=$(e),this.eventName=t,this.selector=n,this.callback=i,this.handler=this.handleEvent.bind(this)},start:function(){return b.observe(this.element,this.eventName,this.handler),this},stop:function(){return b.stopObserving(this.element,this.eventName,this.handler),this},handleEvent:function(e){var t=b.findElement(e,this.selector);t&&this.callback.call(this.element,e,t)}}),Object.extend(b,b.Methods),Object.extend(b,{fire:v,observe:m,stopObserving:g,on:y}),Element.addMethods({fire:v,observe:m,stopObserving:g,on:y}),Object.extend(document,{fire:v.methodize(),observe:m.methodize(),stopObserving:g.methodize(),on:y.methodize(),loaded:!1}),window.Event?Object.extend(window.Event,b):window.Event=b}(),function(){function e(){document.loaded||(i&&window.clearTimeout(i),document.loaded=!0,document.fire("dom:loaded"))}function t(){"complete"===document.readyState&&(document.stopObserving("readystatechange",t),e())}function n(){try{document.documentElement.doScroll("left")}catch(t){return void(i=n.defer())}e()}var i;document.addEventListener?document.addEventListener("DOMContentLoaded",e,!1):(document.observe("readystatechange",t),window==top&&(i=n.defer())),Event.observe(window,"load",e)}(),Element.addMethods(),Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(e,t){return Element.insert(e,{before:t})},Top:function(e,t){return Element.insert(e,{top:t})},Bottom:function(e,t){return Element.insert(e,{bottom:t})},After:function(e,t){return Element.insert(e,{after:t})}},$continue=new Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:!1,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(e,t,n){return this.includeScrollOffsets?this.withinIncludingScrolloffsets(e,t,n):(this.xcomp=t,this.ycomp=n,this.offset=Element.cumulativeOffset(e),n>=this.offset[1]&&n<this.offset[1]+e.offsetHeight&&t>=this.offset[0]&&t<this.offset[0]+e.offsetWidth)},withinIncludingScrolloffsets:function(e,t,n){var i=Element.cumulativeScrollOffset(e);return this.xcomp=t+i[0]-this.deltaX,this.ycomp=n+i[1]-this.deltaY,this.offset=Element.cumulativeOffset(e),this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+e.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+e.offsetWidth},overlap:function(e,t){return e?"vertical"==e?(this.offset[1]+t.offsetHeight-this.ycomp)/t.offsetHeight:"horizontal"==e?(this.offset[0]+t.offsetWidth-this.xcomp)/t.offsetWidth:void 0:0},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(e){return Position.prepare(),Element.absolutize(e)},relativize:function(e){return Position.prepare(),Element.relativize(e)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(e,t,n){return n=n||{},Element.clonePosition(t,e,n)}};document.getElementsByClassName||(document.getElementsByClassName=function(e){function t(e){return e.blank()?null:"[contains(concat(' ', @class, ' '), ' "+e+" ')]"}return e.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(e,n){n=n.toString().strip();var i=/\s/.test(n)?$w(n).map(t).join(""):t(n);return i?document._getElementsByXPath(".//*"+i,e):[]}:function(e,t){t=t.toString().strip();var n=[],i=/\s/.test(t)?$w(t):null;if(!i&&!t)return n;var o=$(e).getElementsByTagName("*");t=" "+t+" ";for(var r,s,a=0;r=o[a];a++)r.className&&(s=" "+r.className+" ")&&(s.include(t)||i&&i.all(function(e){return!e.toString().blank()&&s.include(" "+e+" ")}))&&n.push(Element.extend(r));return n},function(e,t){return $(t||document.body).getElementsByClassName(e)}}(Element.Methods)),Element.ClassNames=Class.create(),Element.ClassNames.prototype={initialize:function(e){this.element=$(e)},_each:function(e){this.element.className.split(/\s+/).select(function(e){return e.length>0})._each(e)},set:function(e){this.element.className=e},add:function(e){this.include(e)||this.set($A(this).concat(e).join(" "))},remove:function(e){this.include(e)&&this.set($A(this).without(e).join(" "))},toString:function(){return $A(this).join(" ")}},Object.extend(Element.ClassNames.prototype,Enumerable),function(){window.Selector=Class.create({initialize:function(e){this.expression=e.strip()},findElements:function(e){return Prototype.Selector.select(this.expression,e)},match:function(e){return Prototype.Selector.match(e,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}}),Object.extend(Selector,{matchElements:function(e,t){for(var n=Prototype.Selector.match,i=[],o=0,r=e.length;r>o;o++){var s=e[o];n(s,t)&&i.push(Element.extend(s))}return i},findElement:function(e,t,n){n=n||0;for(var i,o=0,r=0,s=e.length;s>r;r++)if(i=e[r],Prototype.Selector.match(i,t)&&n===o++)return Element.extend(i)},findChildElements:function(e,t){var n=t.toArray().join(", ");return Prototype.Selector.select(n,e||document)}})}(),$abTesting=function(){var e=function(e,n,i){var o=Cookies.get(e+"Cohort");return"Y"===o||"N"===o||"0"===o?(Cookies.set(e+"Cohort",o,i),jQuery.Deferred().resolve().promise()):t(e)?Math.round(Math.floor(99*Math.random())+1)<=n?$j.post("/track/track",{tid:e+"_cohort_y"},null,"script").done(function(){Cookies.set(e+"Cohort","Y",i)}):$j.post("/track/track",{tid:e+"_cohort_n"},null,"script").done(function(){Cookies.set(e+"Cohort","N",i)}):(Cookies.set(e+"Cohort","0",i),jQuery.Deferred().resolve().promise())},t=function(e){return $j("#js-"+e+"ExperimentResource").length>0},n=function(e){var t=Cookies.get(e+"Cohort");return"Y"===t},i=function(t,i,r){var s=$j("#js-"+t+"ExperimentResource");s.hasClass("js-"+t+"Experiment")&&e(t,i,r).done(function(){n(t)&&o(t)})},o=function(e){$j("#js-"+e+"ExperimentResource").hasClass(e+"Hidden")?$j("#js-"+e+"ExperimentResource").removeClass(e+"Hidden").addClass(e+"Shown"):$j("#js-"+e+"ExperimentResource").removeClass(e+"Shown").addClass(e+"Hidden")};return{runExperiment:i}}();var kindleCloudReaderAutoResize=function(){var e=.9*$j(window).width(),t=.9*$j(window).height();Lightbox.setLightboxDimensions(e,t),$j("#box .kindleCloudReader iframe").css("height",t-40+"px"),Lightbox.center("box")},kindleCloudReaderOpen=function(e){e.preventDefault();var t=$j(this).data("book-id"),n="kindleCloudReaderBook"+t;Lightbox.showBoxByID(n,970,400,!0);var i=$j("#boxContents"),o=$j("#close"),r={padding:i.css("padding"),margin:i.css("margin")};i.css("padding","0px").css("margin","0px"),o.css("top","13px").css("right","15px");var s=$j("#box .kindleCloudReader iframe"),a=$j(this).attr("href");s.attr("src",a).css({width:"100%",border:"none"}).show(),$j(window).resize(_.debounce(kindleCloudReaderAutoResize,300)),$("box").observe("Lightbox:hideBox",function(){$j(window).off("resize"),setTimeout(function(){i.css(r),o.css("top","5px").css("right","5px")},1e3)});for(var l=location.pathname.split("/"),c="",u=0;u<l.length-1;u++)c+=l[u];$j.post("/track/track",{tid:"preview_button--"+c+"--click"}),kindleCloudReaderAutoResize()},showWrongBookKindlePreviewScreen=function(e){e.preventDefault();var t=$j(this).data("book-id");Lightbox.showBoxByID("wrongBookKindlePreviewScreenBook"+t,500,150,!0)},hideWrongBookKindlePreviewScreen=function(){Lightbox.hideBox(),Lightbox.showBoxByID("js-wrongBookKindlePreviewScreenConfirmation")},hideWrongBookReportConfirmation=function(){Lightbox.hideBox()};$j(document).on("click","#js-kcrPreviewButton",kindleCloudReaderOpen).on("click",".js-wrongBookKindlePreview",showWrongBookKindlePreviewScreen).on("click","#js-wrongBookKindlePreviewScreenCancelLink",hideWrongBookReportConfirmation).on("click","#js-wrongBookKindlePreviewScreenConfirmationDismiss",hideWrongBookReportConfirmation).on("submit",".new_kindle_book_mapping_flag",hideWrongBookKindlePreviewScreen),// Copyright (c) 2005-2009 Thomas Fuchs (http://script.aculo.us, http://mir.aculo.us)
String.prototype.parseColor=function(){var e="#";if("rgb("==this.slice(0,4)){var t=this.slice(4,this.length-1).split(","),n=0;do e+=parseInt(t[n]).toColorPart();while(++n<3)}else if("#"==this.slice(0,1)){if(4==this.length)for(var n=1;4>n;n++)e+=(this.charAt(n)+this.charAt(n)).toLowerCase();7==this.length&&(e=this.toLowerCase())}return 7==e.length?e:arguments[0]||this},Element.collectTextNodes=function(e){return $A($(e).childNodes).collect(function(e){return 3==e.nodeType?e.nodeValue:e.hasChildNodes()?Element.collectTextNodes(e):""}).flatten().join("")},Element.collectTextNodesIgnoreClass=function(e,t){return $A($(e).childNodes).collect(function(e){return 3==e.nodeType?e.nodeValue:e.hasChildNodes()&&!Element.hasClassName(e,t)?Element.collectTextNodesIgnoreClass(e,t):""}).flatten().join("")},Element.setContentZoom=function(e,t){return e=$(e),e.setStyle({fontSize:t/100+"em"}),Prototype.Browser.WebKit&&window.scrollBy(0,0),e},Element.getInlineOpacity=function(e){return $(e).style.opacity||""},Element.forceRerendering=function(e){try{e=$(e);var t=document.createTextNode(" ");e.appendChild(t),e.removeChild(t)}catch(n){}};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(e){return-Math.cos(e*Math.PI)/2+.5},reverse:function(e){return 1-e},flicker:function(e){var e=-Math.cos(e*Math.PI)/4+.75+Math.random()/4;return e>1?1:e},wobble:function(e){return-Math.cos(e*Math.PI*9*e)/2+.5},pulse:function(e,t){return-Math.cos(e*((t||5)-.5)*2*Math.PI)/2+.5},spring:function(e){return 1-Math.cos(4.5*e*Math.PI)*Math.exp(6*-e)},none:function(){return 0},full:function(){return 1}},DefaultOptions:{duration:1,fps:100,sync:!1,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(e){var t="position:relative";Prototype.Browser.IE&&(t+=";zoom:1"),e=$(e),$A(e.childNodes).each(function(n){3==n.nodeType&&(n.nodeValue.toArray().each(function(i){e.insertBefore(new Element("span",{style:t}).update(" "==i?String.fromCharCode(160):i),n)}),Element.remove(n))})},multiple:function(e,t){var n;n=("object"==typeof e||Object.isFunction(e))&&e.length?e:$(e).childNodes;var i=Object.extend({speed:.1,delay:0},arguments[2]||{}),o=i.delay;$A(n).each(function(e,n){new t(e,Object.extend(i,{delay:n*i.speed+o}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(e,t,n){return e=$(e),t=(t||"appear").toLowerCase(),Effect[Effect.PAIRS[t][e.visible()?1:0]](e,Object.extend({queue:{position:"end",scope:e.id||"global",limit:1}},n||{}))}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal,Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[],this.interval=null},_each:function(e){this.effects._each(e)},add:function(e){var t=(new Date).getTime(),n=Object.isString(e.options.queue)?e.options.queue:e.options.queue.position;switch(n){case"front":this.effects.findAll(function(e){return"idle"==e.state}).each(function(t){t.startOn+=e.finishOn,t.finishOn+=e.finishOn});break;case"with-last":t=this.effects.pluck("startOn").max()||t;break;case"end":t=this.effects.pluck("finishOn").max()||t}e.startOn+=t,e.finishOn+=t,(!e.options.queue.limit||this.effects.length<e.options.queue.limit)&&this.effects.push(e),this.interval||(this.interval=setInterval(this.loop.bind(this),15))},remove:function(e){this.effects=this.effects.reject(function(t){return t==e}),0==this.effects.length&&(clearInterval(this.interval),this.interval=null)},loop:function(){for(var e=(new Date).getTime(),t=0,n=this.effects.length;n>t;t++)this.effects[t]&&this.effects[t].loop(e)}}),Effect.Queues={instances:$H(),get:function(e){return Object.isString(e)?this.instances.get(e)||this.instances.set(e,new Effect.ScopedQueue):e}},Effect.Queue=Effect.Queues.get("global"),Effect.Base=Class.create({position:null,start:function(e){e&&e.transition===!1&&(e.transition=Effect.Transitions.linear),this.options=Object.extend(Object.extend({},Effect.DefaultOptions),e||{}),this.currentFrame=0,this.state="idle",this.startOn=1e3*this.options.delay,this.finishOn=this.startOn+1e3*this.options.duration,this.fromToDelta=this.options.to-this.options.from,this.totalTime=this.finishOn-this.startOn,this.totalFrames=this.options.fps*this.options.duration,this.render=function(){function e(e,t){e.options[t+"Internal"]&&e.options[t+"Internal"](e),e.options[t]&&e.options[t](e)}return function(t){"idle"===this.state&&(this.state="running",e(this,"beforeSetup"),this.setup&&this.setup(),e(this,"afterSetup")),"running"===this.state&&(t=this.options.transition(t)*this.fromToDelta+this.options.from,this.position=t,e(this,"beforeUpdate"),this.update&&this.update(t),e(this,"afterUpdate"))}}(),this.event("beforeStart"),this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this)},loop:function(e){if(e>=this.startOn){if(e>=this.finishOn)return this.render(1),this.cancel(),this.event("beforeFinish"),this.finish&&this.finish(),void this.event("afterFinish");var t=(e-this.startOn)/this.totalTime,n=(t*this.totalFrames).round();n>this.currentFrame&&(this.render(t),this.currentFrame=n)}},cancel:function(){this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this),this.state="finished"},event:function(e){this.options[e+"Internal"]&&this.options[e+"Internal"](this),this.options[e]&&this.options[e](this)},inspect:function(){var e=$H();for(property in this)Object.isFunction(this[property])||e.set(property,this[property]);return"#<Effect:"+e.inspect()+",options:"+$H(this.options).inspect()+">"}}),Effect.Parallel=Class.create(Effect.Base,{initialize:function(e){this.effects=e||[],this.start(arguments[1])},update:function(e){this.effects.invoke("render",e)},finish:function(e){this.effects.each(function(t){t.render(1),t.cancel(),t.event("beforeFinish"),t.finish&&t.finish(e),t.event("afterFinish")})}}),Effect.Tween=Class.create(Effect.Base,{initialize:function(e,t,n){e=Object.isString(e)?$(e):e;var i=$A(arguments),o=i.last(),r=5==i.length?i[3]:null;this.method=Object.isFunction(o)?o.bind(e):Object.isFunction(e[o])?e[o].bind(e):function(t){e[o]=t},this.start(Object.extend({from:t,to:n},r||{}))},update:function(e){this.method(e)}}),Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}))},update:Prototype.emptyFunction}),Effect.Opacity=Class.create(Effect.Base,{initialize:function(e){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&this.element.setStyle({zoom:1});var t=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(t)},update:function(e){this.element.setOpacity(e)}}),Effect.Move=Class.create(Effect.Base,{initialize:function(e){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(t)},setup:function(){this.element.makePositioned(),this.originalLeft=parseFloat(this.element.getStyle("left")||"0"),this.originalTop=parseFloat(this.element.getStyle("top")||"0"),"absolute"==this.options.mode&&(this.options.x=this.options.x-this.originalLeft,this.options.y=this.options.y-this.originalTop)},update:function(e){this.element.setStyle({left:(this.options.x*e+this.originalLeft).round()+"px",top:(this.options.y*e+this.originalTop).round()+"px"})}}),Effect.MoveBy=function(e,t,n){return new Effect.Move(e,Object.extend({x:n,y:t},arguments[3]||{}))},Effect.Scale=Class.create(Effect.Base,{initialize:function(e,t){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;var n=Object.extend({scaleX:!0,scaleY:!0,scaleContent:!0,scaleFromCenter:!1,scaleMode:"box",scaleFrom:100,scaleTo:t},arguments[2]||{});this.start(n)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||!1,this.elementPositioning=this.element.getStyle("position"),this.originalStyle={},["top","left","width","height","fontSize"].each(function(e){this.originalStyle[e]=this.element.style[e]}.bind(this)),this.originalTop=this.element.offsetTop,this.originalLeft=this.element.offsetLeft;var e=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(t){e.indexOf(t)>0&&(this.fontSize=parseFloat(e),this.fontSizeType=t)}.bind(this)),this.factor=(this.options.scaleTo-this.options.scaleFrom)/100,this.dims=null,"box"==this.options.scaleMode&&(this.dims=[this.element.offsetHeight,this.element.offsetWidth]),/^content/.test(this.options.scaleMode)&&(this.dims=[this.element.scrollHeight,this.element.scrollWidth]),this.dims||(this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth])},update:function(e){var t=this.options.scaleFrom/100+this.factor*e;this.options.scaleContent&&this.fontSize&&this.element.setStyle({fontSize:this.fontSize*t+this.fontSizeType}),this.setDimensions(this.dims[0]*t,this.dims[1]*t)},finish:function(){this.restoreAfterFinish&&this.element.setStyle(this.originalStyle)},setDimensions:function(e,t){var n={};if(this.options.scaleX&&(n.width=t.round()+"px"),this.options.scaleY&&(n.height=e.round()+"px"),this.options.scaleFromCenter){var i=(e-this.dims[0])/2,o=(t-this.dims[1])/2;"absolute"==this.elementPositioning?(this.options.scaleY&&(n.top=this.originalTop-i+"px"),this.options.scaleX&&(n.left=this.originalLeft-o+"px")):(this.options.scaleY&&(n.top=-i+"px"),this.options.scaleX&&(n.left=-o+"px"))}this.element.setStyle(n)}}),Effect.Highlight=Class.create(Effect.Base,{initialize:function(e){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(t)},setup:function(){return"none"==this.element.getStyle("display")?void this.cancel():(this.oldStyle={},this.options.keepBackgroundImage||(this.oldStyle.backgroundImage=this.element.getStyle("background-image"),this.element.setStyle({backgroundImage:"none"})),this.options.endcolor||(this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff")),this.options.restorecolor||(this.options.restorecolor=this.element.getStyle("background-color")),this._base=$R(0,2).map(function(e){return parseInt(this.options.startcolor.slice(2*e+1,2*e+3),16)}.bind(this)),void(this._delta=$R(0,2).map(function(e){return parseInt(this.options.endcolor.slice(2*e+1,2*e+3),16)-this._base[e]}.bind(this))))},update:function(e){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(t,n,i){return t+(this._base[i]+this._delta[i]*e).round().toColorPart()}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}}),Effect.ScrollTo=function(e){var t=arguments[1]||{},n=document.viewport.getScrollOffsets(),i=$(e).cumulativeOffset();return t.offset&&(i[1]+=t.offset),new Effect.Tween(null,n.top,i[1],t,function(e){scrollTo(n.left,e.round())})},Effect.Fade=function(e){e=$(e);var t=e.getInlineOpacity(),n=Object.extend({from:e.getOpacity()||1,to:0,afterFinishInternal:function(e){0==e.options.to&&e.element.hide().setStyle({opacity:t})}},arguments[1]||{});return new Effect.Opacity(e,n)},Effect.Appear=function(e){e=$(e);var t=Object.extend({from:"none"==e.getStyle("display")?0:e.getOpacity()||0,to:1,afterFinishInternal:function(e){e.element.forceRerendering()},beforeSetup:function(e){e.element.setOpacity(e.options.from).show()}},arguments[1]||{});return new Effect.Opacity(e,t)},Effect.Puff=function(e){e=$(e);var t={opacity:e.getInlineOpacity(),position:e.getStyle("position"),top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height};return new Effect.Parallel([new Effect.Scale(e,200,{sync:!0,scaleFromCenter:!0,scaleContent:!0,restoreAfterFinish:!0}),new Effect.Opacity(e,{sync:!0,to:0})],Object.extend({duration:1,beforeSetupInternal:function(e){Position.absolutize(e.effects[0].element)},afterFinishInternal:function(e){e.effects[0].element.hide().setStyle(t)}},arguments[1]||{}))},Effect.BlindUp=function(e){return e=$(e),e.makeClipping(),new Effect.Scale(e,0,Object.extend({scaleContent:!1,scaleX:!1,restoreAfterFinish:!0,afterFinishInternal:function(e){e.element.hide().undoClipping()}},arguments[1]||{}))},Effect.BlindDown=function(e){e=$(e);var t=e.getDimensions();return new Effect.Scale(e,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:0,scaleMode:{originalHeight:t.height,originalWidth:t.width},restoreAfterFinish:!0,afterSetup:function(e){e.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(e){e.element.undoClipping()}},arguments[1]||{}))},Effect.SwitchOff=function(e){e=$(e);var t=e.getInlineOpacity();return new Effect.Appear(e,Object.extend({duration:.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(e){new Effect.Scale(e.element,1,{duration:.3,scaleFromCenter:!0,scaleX:!1,scaleContent:!1,restoreAfterFinish:!0,beforeSetup:function(e){e.element.makePositioned().makeClipping()},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned().setStyle({opacity:t})}})}},arguments[1]||{}))},Effect.DropOut=function(e){e=$(e);var t={top:e.getStyle("top"),left:e.getStyle("left"),opacity:e.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(e,{x:0,y:100,sync:!0}),new Effect.Opacity(e,{sync:!0,to:0})],Object.extend({duration:.5,beforeSetup:function(e){e.effects[0].element.makePositioned()},afterFinishInternal:function(e){e.effects[0].element.hide().undoPositioned().setStyle(t)}},arguments[1]||{}))},Effect.Shake=function(e){e=$(e);var t=Object.extend({distance:20,duration:.5},arguments[1]||{}),n=parseFloat(t.distance),i=parseFloat(t.duration)/10,o={top:e.getStyle("top"),left:e.getStyle("left")};return new Effect.Move(e,{x:n,y:0,duration:i,afterFinishInternal:function(e){new Effect.Move(e.element,{x:2*-n,y:0,duration:2*i,afterFinishInternal:function(e){new Effect.Move(e.element,{x:2*n,y:0,duration:2*i,afterFinishInternal:function(e){new Effect.Move(e.element,{x:2*-n,y:0,duration:2*i,afterFinishInternal:function(e){new Effect.Move(e.element,{x:2*n,y:0,duration:2*i,afterFinishInternal:function(e){new Effect.Move(e.element,{x:-n,y:0,duration:i,afterFinishInternal:function(e){e.element.undoPositioned().setStyle(o)}})}})}})}})}})}})},Effect.SlideDown=function(e){e=$(e).cleanWhitespace();var t=e.down().getStyle("bottom"),n=e.getDimensions();return new Effect.Scale(e,100,Object.extend({scaleContent:!1,scaleX:!1,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:n.height,originalWidth:n.width},restoreAfterFinish:!0,afterSetup:function(e){e.element.makePositioned(),e.element.down().makePositioned(),window.opera&&e.element.setStyle({top:""}),e.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:e.dims[0]-e.element.clientHeight+"px"})},afterFinishInternal:function(e){e.element.undoClipping().undoPositioned(),e.element.down().undoPositioned().setStyle({bottom:t})}},arguments[1]||{}))},Effect.SlideUp=function(e){e=$(e).cleanWhitespace();var t=e.down().getStyle("bottom"),n=e.getDimensions();return new Effect.Scale(e,window.opera?0:1,Object.extend({scaleContent:!1,scaleX:!1,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:n.height,originalWidth:n.width},restoreAfterFinish:!0,afterSetup:function(e){e.element.makePositioned(),e.element.down().makePositioned(),window.opera&&e.element.setStyle({top:""}),e.element.makeClipping().show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:e.dims[0]-e.element.clientHeight+"px"})},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned(),e.element.down().undoPositioned().setStyle({bottom:t})}},arguments[1]||{}))},Effect.Squish=function(e){return new Effect.Scale(e,window.opera?1:0,{restoreAfterFinish:!0,beforeSetup:function(e){e.element.makeClipping()},afterFinishInternal:function(e){e.element.hide().undoClipping()}})},Effect.Grow=function(e){e=$(e);var t,n,i,o,r=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{}),s={top:e.style.top,left:e.style.left,height:e.style.height,width:e.style.width,opacity:e.getInlineOpacity()},a=e.getDimensions();switch(r.direction){case"top-left":t=n=i=o=0;break;case"top-right":t=a.width,n=o=0,i=-a.width;break;case"bottom-left":t=i=0,n=a.height,o=-a.height;break;case"bottom-right":t=a.width,n=a.height,i=-a.width,o=-a.height;break;case"center":t=a.width/2,n=a.height/2,i=-a.width/2,o=-a.height/2}return new Effect.Move(e,{x:t,y:n,duration:.01,beforeSetup:function(e){e.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(e){new Effect.Parallel([new Effect.Opacity(e.element,{sync:!0,to:1,from:0,transition:r.opacityTransition}),new Effect.Move(e.element,{x:i,y:o,sync:!0,transition:r.moveTransition}),new Effect.Scale(e.element,100,{scaleMode:{originalHeight:a.height,originalWidth:a.width},sync:!0,scaleFrom:window.opera?1:0,transition:r.scaleTransition,restoreAfterFinish:!0})],Object.extend({beforeSetup:function(e){e.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(e){e.effects[0].element.undoClipping().undoPositioned().setStyle(s)}},r))}})},Effect.Shrink=function(e){e=$(e);var t,n,i=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{}),o={top:e.style.top,left:e.style.left,height:e.style.height,width:e.style.width,opacity:e.getInlineOpacity()},r=e.getDimensions();switch(i.direction){case"top-left":t=n=0;break;case"top-right":t=r.width,n=0;break;case"bottom-left":t=0,n=r.height;break;case"bottom-right":t=r.width,n=r.height;break;case"center":t=r.width/2,n=r.height/2}return new Effect.Parallel([new Effect.Opacity(e,{sync:!0,to:0,from:1,transition:i.opacityTransition}),new Effect.Scale(e,window.opera?1:0,{sync:!0,transition:i.scaleTransition,restoreAfterFinish:!0}),new Effect.Move(e,{x:t,y:n,sync:!0,transition:i.moveTransition})],Object.extend({beforeStartInternal:function(e){e.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(e){e.effects[0].element.hide().undoClipping().undoPositioned().setStyle(o)}},i))},Effect.Pulsate=function(e){e=$(e);var t=arguments[1]||{},n=e.getInlineOpacity(),i=t.transition||Effect.Transitions.linear,o=function(e){return 1-i(-Math.cos(e*(t.pulses||5)*2*Math.PI)/2+.5)};return new Effect.Opacity(e,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(e){e.element.setStyle({opacity:n})}},t),{transition:o}))},Effect.Fold=function(e){e=$(e);var t={top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height};return e.makeClipping(),new Effect.Scale(e,5,Object.extend({scaleContent:!1,scaleX:!1,afterFinishInternal:function(){new Effect.Scale(e,1,{scaleContent:!1,scaleY:!1,afterFinishInternal:function(e){e.element.hide().undoClipping().setStyle(t)}})}},arguments[1]||{}))},Effect.Morph=Class.create(Effect.Base,{initialize:function(e){if(this.element=$(e),!this.element)throw Effect._elementDoesNotExistError;var t=Object.extend({style:{}},arguments[1]||{});if(Object.isString(t.style))if(t.style.include(":"))this.style=t.style.parseStyle();else{this.element.addClassName(t.style),this.style=$H(this.element.getStyles()),this.element.removeClassName(t.style);var n=this.element.getStyles();this.style=this.style.reject(function(e){return e.value==n[e.key]}),t.afterFinishInternal=function(e){e.element.addClassName(e.options.style),e.transforms.each(function(t){e.element.style[t.style]=""})}}else this.style=$H(t.style);this.start(t)},setup:function(){function e(e){return(!e||["rgba(0, 0, 0, 0)","transparent"].include(e))&&(e="#ffffff"),e=e.parseColor(),$R(0,2).map(function(t){return parseInt(e.slice(2*t+1,2*t+3),16)})}this.transforms=this.style.map(function(t){var n=t[0],i=t[1],o=null;if("#zzzzzz"!=i.parseColor("#zzzzzz"))i=i.parseColor(),o="color";else if("opacity"==n)i=parseFloat(i),Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&this.element.setStyle({zoom:1});else if(Element.CSS_LENGTH.test(i)){var r=i.match(/^([\+\-]?[0-9\.]+)(.*)$/);i=parseFloat(r[1]),o=3==r.length?r[2]:null}var s=this.element.getStyle(n);return{style:n.camelize(),originalValue:"color"==o?e(s):parseFloat(s||0),targetValue:"color"==o?e(i):i,unit:o}}.bind(this)).reject(function(e){return e.originalValue==e.targetValue||"color"!=e.unit&&(isNaN(e.originalValue)||isNaN(e.targetValue))})},update:function(e){for(var t,n={},i=this.transforms.length;i--;)n[(t=this.transforms[i]).style]="color"==t.unit?"#"+Math.round(t.originalValue[0]+(t.targetValue[0]-t.originalValue[0])*e).toColorPart()+Math.round(t.originalValue[1]+(t.targetValue[1]-t.originalValue[1])*e).toColorPart()+Math.round(t.originalValue[2]+(t.targetValue[2]-t.originalValue[2])*e).toColorPart():(t.originalValue+(t.targetValue-t.originalValue)*e).toFixed(3)+(null===t.unit?"":t.unit);this.element.setStyle(n,!0)}}),Effect.Transform=Class.create({initialize:function(e){this.tracks=[],this.options=arguments[1]||{},this.addTracks(e)},addTracks:function(e){return e.each(function(e){e=$H(e);var t=e.values().first();this.tracks.push($H({ids:e.keys().first(),effect:Effect.Morph,options:{style:t}}))}.bind(this)),this},play:function(){return new Effect.Parallel(this.tracks.map(function(e){var t=e.get("ids"),n=e.get("effect"),i=e.get("options"),o=[$(t)||$$(t)].flatten();return o.map(function(e){return new n(e,Object.extend({sync:!0},i))})}).flatten(),this.options)}}),Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex"),Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/,String.__parseStyleElement=document.createElement("div"),String.prototype.parseStyle=function(){var e,t=$H();return Prototype.Browser.WebKit?e=new Element("div",{style:this}).style:(String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>',e=String.__parseStyleElement.childNodes[0].style),Element.CSS_PROPERTIES.each(function(n){e[n]&&t.set(n,e[n])}),Prototype.Browser.IE&&this.include("opacity")&&t.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]),t},Element.getStyles=document.defaultView&&document.defaultView.getComputedStyle?function(e){var t=document.defaultView.getComputedStyle($(e),null);return Element.CSS_PROPERTIES.inject({},function(e,n){return e[n]=t[n],e})}:function(e){e=$(e);var t,n=e.currentStyle;return t=Element.CSS_PROPERTIES.inject({},function(e,t){return e[t]=n[t],e}),t.opacity||(t.opacity=e.getOpacity()),t},Effect.Methods={morph:function(e,t){return e=$(e),new Effect.Morph(e,Object.extend({style:t},arguments[2]||{})),e},visualEffect:function(e,t,n){e=$(e);var i=t.dasherize().camelize(),o=i.charAt(0).toUpperCase()+i.substring(1);return new Effect[o](e,n),e},highlight:function(e,t){return e=$(e),new Effect.Highlight(e,t),e}},$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(e){Effect.Methods[e]=function(t,n){return t=$(t),Effect[e.charAt(0).toUpperCase()+e.substring(1)](t,n),t}}),$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(e){Effect.Methods[e]=Element[e]}),Element.addMethods(Effect.Methods);var InlineFlash={_templateString:'<div id="header_#{message_type}_container"><div class="box noticeBox #{extra_classes}"><a href="#" onclick="$(this).up().up().hide()" class="right"><img src=\'/assets/layout/delete.png\' alt=\'Dismiss\' /></a>#{message}</div><br/></div>',showNotice:function(e){this._showFlash({message_type:"notice",message:e})},showError:function(e){this._showFlash({message_type:"error",extra_classes:"errorBox",message:e})},hideFlash:function(){this.flashContainer||(this.flashContainer=$("flashContainer")),this.flashContainer||(this.flashContainer=$("flashMessageContainer")),this.flashContainer.update("")},_showFlash:function(e){this.flashContainer||(this.flashContainer=$("flashContainer")),this.flashContainer||(this.flashContainer=$("flashMessageContainer")),this._template||(this._template=new Template(this._templateString)),this.flashContainer.update(this._template.evaluate(e))}};Element.Methods.cumulativeScrollOffset=function(){var e=$j(document);if($j(".suggestedAuthorsContainer").length){var t=$j(".suggestedAuthorsContainer"),n=t.scrollLeft()+e.scrollLeft(),i=t.scrollTop()+e.scrollTop();return new Element.Offset(n,i)}return new Element.Offset(e.scrollLeft(),e.scrollTop())};var _={};// Copyright (c) 2005-2008 Thomas Fuchs (http://script.aculo.us, http://mir.aculo.us)
if(function(e){var t={};e.debounce=function(e,t,n){var i,o;return function(){var r=this,s=arguments,a=function(){i=null,n||(o=e.apply(r,s))},l=n&&!i;return clearTimeout(i),i=setTimeout(a,t),l&&(o=e.apply(r,s)),o}};var n=Array.prototype,i=n.slice,o=n.forEach,r=Object.keys,s=e.each=e.forEach=function(n,i,r){if(null!=n)if(o&&n.forEach===o)n.forEach(i,r);else if(n.length===+n.length){for(var s=0,a=n.length;a>s;s++)if(i.call(r,n[s],s,n)===t)return}else for(var l=e.keys(n),s=0,a=l.length;a>s;s++)if(i.call(r,n[l[s]],l[s],n)===t)return};e.defaults=function(e){return s(i.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/\{\{(.+?)\}\}/g,escape:/<%-([\s\S]+?)%>/g};var a=/(.)^/,l={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},c=/\\|'|\r|\n|\t|\u2028|\u2029/g;e.keys=r||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var n=[];for(var i in t)e.has(t,i)&&n.push(i);return n},e.invert=function(t){for(var n={},i=e.keys(t),o=0,r=i.length;r>o;o++)n[t[i[o]]]=i[o];return n};var u={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};u.unescape=e.invert(u.escape);var h={escape:new RegExp("["+e.keys(u.escape).join("")+"]","g"),unescape:new RegExp("("+e.keys(u.unescape).join("|")+")","g")};e.each(["escape","unescape"],function(t){e[t]=function(e){return null==e?"":(""+e).replace(h[t],function(e){return u[t][e]})}}),e.template=function(t,n,i){var o;i=e.defaults({},i,e.templateSettings);var r=new RegExp([(i.escape||a).source,(i.interpolate||a).source,(i.evaluate||a).source].join("|")+"|$","g"),s=0,u="__p+='";t.replace(r,function(e,n,i,o,r){return u+=t.slice(s,r).replace(c,function(e){return"\\"+l[e]}),n&&(u+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(u+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),o&&(u+="';\n"+o+"\n__p+='"),s=r+e.length,e}),u+="';\n",i.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{o=new Function(i.variable||"obj","_",u)}catch(h){throw h.source=u,h}if(n)return o(n,e);var d=function(t){return o.call(this,t,e)};return d.source="function("+(i.variable||"obj")+"){\n"+u+"}",d},s(["Arguments","Function","String","Number","Date","RegExp"],function(t){e["is"+t]=function(e){return Object.prototype.toString.call(e)=="[object "+t+"]"}})}(_),SignedOutExperiment=function(e){var t,n=e,i=.04,o=[],r=function(e){i=e},s=function(e,t){void 0===a(e)&&(cell={},cell.name=e,cell.callback=t,o.push(cell))},a=function(e){return $j.grep(o,function(t){return t.name===e})[0]},l=function(){var e=Math.floor(Math.random()*o.length);return o[e]},c=function(){Cookies.set(n+"Cell",t.name,i)},u=function(){return t=a(Cookies.get(n+"Cell")),void 0!==t?(c(),jQuery.Deferred().resolve().promise()):(t=l(),$j.post("/track/track",{tid:n+"_cell_"+t.name},null,"script").done(function(){c()}))},h=function(){u().done(function(){t.callback()})};return{setDurationDays:r,addCell:s,runExperiment:h}},/*
Copyright (c) 2009 Victor Stanciu - http://www.victorstanciu.ro

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.


2010-07-06 kueda Updated to support AJAX slide loading.

*/
Carousel=Class.create(Abstract,{initialize:function(e,t,n,i){if(this.scrolling=!1,this.scroller=$(e),this.slides=t,this.controls=n,this.options=Object.extend({duration:1,auto:!1,frequency:3,visibleSlides:1,controlClassName:"carousel-control",jumperClassName:"carousel-jumper",disabledClassName:"carousel-disabled",selectedClassName:"carousel-selected",circular:!1,wheel:!0,effect:"scroll",transition:"sinoidal"},i||{}),"fade"==this.options.effect&&(this.options.circular=!0),this.slides.each(function(e,t){e._index=t}),this.controls&&this.controls.invoke("observe","click",this.click.bind(this)),this.options.wheel&&this.scroller.observe("mousewheel",this.wheel.bindAsEventListener(this)).observe("DOMMouseScroll",this.wheel.bindAsEventListener(this)),this.options.auto&&this.start(),this.options.initial){var o=this.slides.indexOf($(this.options.initial));o>this.options.visibleSlides-1&&this.options.visibleSlides>1&&o>this.slides.length-(this.options.visibleSlides+1)&&(o=this.slides.length-this.options.visibleSlides),this.moveTo(this.slides[o])}},click:function(event){this.stop();var element=event.findElement("a");element.hasClassName(this.options.disabledClassName)||(element.hasClassName(this.options.controlClassName)?eval("this."+element.rel+"()"):element.hasClassName(this.options.jumperClassName)&&(this.moveTo(element.rel),this.options.selectedClassName&&(this.controls.invoke("removeClassName",this.options.selectedClassName),element.addClassName(this.options.selectedClassName)))),this.deactivateControls(),event.stop()},moveTo:function(e){this.options.beforeMove&&"function"==typeof this.options.beforeMove&&this.options.beforeMove(e),this.previous=this.current?this.current:this.slides[0],this.current=$(e);var t=this.scroller.cumulativeOffset(),n=this.current.cumulativeOffset();switch(this.scrolling&&this.scrolling.cancel(),this.options.effect){case"fade":this.scrolling=new Effect.Opacity(this.scroller,{from:1,to:0,duration:this.options.duration,afterFinish:function(){this.scroller.scrollLeft=n[0]-t[0],this.scroller.scrollTop=n[1]-t[1],new Effect.Opacity(this.scroller,{from:0,to:1,duration:this.options.duration,afterFinish:function(){this.controls&&this.activateControls(),this.options.afterMove&&"function"==typeof this.options.afterMove&&this.options.afterMove()}.bind(this)})}.bind(this)});break;case"scroll":default:var i;switch(this.options.transition){case"spring":i=Effect.Transitions.spring;break;case"sinoidal":default:i=Effect.Transitions.sinoidal}this.scrolling=new Effect.SmoothScroll(this.scroller,{duration:this.options.duration,x:n[0]-t[0],y:n[1]-t[1],transition:i,afterFinish:function(){this.controls&&this.activateControls(),this.options.afterMove&&"function"==typeof this.options.afterMove&&this.options.afterMove(),this.scrolling=!1}.bind(this)})}return!1},prev:function(){if(this.current)var e=this.current._index,t=0==e?this.options.circular?this.slides.length-1:0:e-1;else var t=this.options.circular?this.slides.length-1:0;t==this.slides.length-1&&this.options.circular&&"fade"!=this.options.effect&&(this.scroller.scrollLeft=(this.slides.length-1)*this.slides.first().getWidth(),this.scroller.scrollTop=(this.slides.length-1)*this.slides.first().getHeight(),t=this.slides.length-2),this.moveTo(this.slides[t])},next:function(){if(this.current)var e=this.current._index,t=this.slides.length-1==e?this.options.circular?0:e:e+1;else var t=1;if(0==t&&this.options.circular&&"fade"!=this.options.effect&&(this.scroller.scrollLeft=0,this.scroller.scrollTop=0,t=1),t>this.slides.length-(this.options.visibleSlides+1)&&(t=this.slides.length-this.options.visibleSlides),this.options.beforeNext&&"function"==typeof this.options.beforeNext){var n=this.options.beforeNext(this,e,t);if(0==n)return!1}if(this.options.url&&(null==e||e==t||t>=this.slides.length)){(null==e||e==t)&&(t+=1);var i=new Element("div",{"class":this.slides[0].className+" loading"}).update(this.options.loading||"loading...");i._index=t,$(this.slides[0]).up().appendChild(i),this.slides[t]=i;var o=this,r=Object.extend({parameters:{},onSuccess:function(e){$(i).up().insert(e.responseText);var n=$(i).next();o.slides[t]=n,n._index=t,o.current=n,$(i).remove()}},this.options.ajaxOptions||{}),s=t+1;"string"==typeof r.parameters?r.parameters="page="+s+"&"+r.parameters:r.parameters.page=s,new Ajax.Request(this.options.url,r)}this.moveTo(this.slides[t])},first:function(){this.moveTo(this.slides[0])},last:function(){this.moveTo(this.slides[this.slides.length-1])},toggle:function(){return this.previous?void this.moveTo(this.slides[this.previous._index]):!1},stop:function(){this.timer&&clearTimeout(this.timer)},start:function(){this.periodicallyUpdate()},pause:function(){this.stop(),this.activateControls()},resume:function(e){if(e){var t=e.relatedTarget||e.toElement;t&&(this.slides.include(t)||this.slides.any(function(e){return t.descendantOf(e)}))||this.start()}else this.start()},periodicallyUpdate:function(){null!=this.timer&&(clearTimeout(this.timer),this.next()),this.timer=setTimeout(this.periodicallyUpdate.bind(this),1e3*this.options.frequency)},wheel:function(e){e.cancelBubble=!0,e.stop();var t=0;return e||(e=window.event),e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),this.scrolling||(this.deactivateControls(),t>0?this.prev():this.next()),Math.round(t)},deactivateControls:function(){this.controls.invoke("addClassName",this.options.disabledClassName)},activateControls:function(){this.controls.invoke("removeClassName",this.options.disabledClassName)}}),Effect.SmoothScroll=Class.create(),Object.extend(Object.extend(Effect.SmoothScroll.prototype,Effect.Base.prototype),{initialize:function(e){this.element=$(e);var t=Object.extend({x:0,y:0,mode:"absolute"},arguments[1]||{});this.start(t)},setup:function(){this.options.continuous&&!this.element._ext&&(this.element.cleanWhitespace(),this.element._ext=!0,this.element.appendChild(this.element.firstChild)),this.originalLeft=this.element.scrollLeft,this.originalTop=this.element.scrollTop,"absolute"==this.options.mode&&(this.options.x-=this.originalLeft,this.options.y-=this.originalTop)},update:function(e){this.element.scrollLeft=this.options.x*e+this.originalLeft,this.element.scrollTop=this.options.y*e+this.originalTop}}),"undefined"==typeof Effect)throw"controls.js requires including script.aculo.us' effects.js library";var Autocompleter={};Autocompleter.Base=Class.create({baseInitialize:function(e,t,n){e=$(e),this.element=e,this.update=$(t),this.hasFocus=!1,this.changed=!1,this.active=!1,this.index=0,this.entryCount=0,this.oldElementValue=this.element.value,this.setOptions?this.setOptions(n):this.options=n||{},this.options.paramName=this.options.paramName||this.element.name,this.options.tokens=this.options.tokens||[],this.options.frequency=this.options.frequency||.4,this.options.minChars=this.options.minChars||1,this.options.onShow=this.options.onShow||function(e,t){t.style.position&&"absolute"!=t.style.position||(t.style.position="absolute",Position.clone(e,t,{setHeight:!1,offsetTop:e.offsetHeight})),Effect.Appear(t,{duration:.15})},this.options.onHide=this.options.onHide||function(e,t){new Effect.Fade(t,{duration:.15})},"string"==typeof this.options.tokens&&(this.options.tokens=new Array(this.options.tokens)),this.options.tokens.include("\n")||this.options.tokens.push("\n"),this.observer=null,this.element.setAttribute("autocomplete","off"),Element.hide(this.update),Event.observe(this.element,"blur",this.onBlur.bindAsEventListener(this)),Event.observe(this.element,"keydown",this.onKeyPress.bindAsEventListener(this))},show:function(){"none"==Element.getStyle(this.update,"display")&&this.options.onShow(this.element,this.update),!this.iefix&&Prototype.Browser.IE&&"absolute"==Element.getStyle(this.update,"position")&&(new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" src="javascript:false;" frameborder="0" scrolling="no"></iframe>'),this.iefix=$(this.update.id+"_iefix")),this.iefix&&setTimeout(this.fixIEOverlapping.bind(this),50)},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:!this.update.style.height}),this.iefix.style.zIndex=1,this.update.style.zIndex=2,Element.show(this.iefix)},hide:function(){this.stopIndicator(),"none"!=Element.getStyle(this.update,"display")&&this.options.onHide(this.element,this.update),this.iefix&&Element.hide(this.iefix)},startIndicator:function(){this.options.indicator&&Element.show(this.options.indicator)},stopIndicator:function(){this.options.indicator&&Element.hide(this.options.indicator)},onKeyPress:function(e){if(this.active)switch(e.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry(),Event.stop(e);case Event.KEY_ESC:return this.hide(),this.active=!1,void Event.stop(e);case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:return this.markPrevious(),this.render(),void Event.stop(e);case Event.KEY_DOWN:return this.markNext(),this.render(),void Event.stop(e)}else if(e.keyCode==Event.KEY_TAB||e.keyCode==Event.KEY_RETURN||Prototype.Browser.WebKit>0&&0==e.keyCode)return;this.changed=!0,this.hasFocus=!0,this.observer&&clearTimeout(this.observer),this.observer=setTimeout(this.onObserverEvent.bind(this),1e3*this.options.frequency)},activate:function(){this.changed=!1,this.hasFocus=!0,this.getUpdatedChoices()},onHover:function(e){var t=Event.findElement(e,"LI");this.index!=t.autocompleteIndex&&(this.index=t.autocompleteIndex,this.render()),Event.stop(e)},onClick:function(e){var t=Event.findElement(e,"LI");this.index=t.autocompleteIndex,this.selectEntry(),this.hide()},onBlur:function(){setTimeout(this.hide.bind(this),250),this.hasFocus=!1,this.active=!1},render:function(){if(this.entryCount>0){for(var e=0;e<this.entryCount;e++)this.index==e?Element.addClassName(this.getEntry(e),"selected"):Element.removeClassName(this.getEntry(e),"selected");this.hasFocus&&(this.show(),this.active=!0)}else this.active=!1,this.hide()},markPrevious:function(){this.index>0?(this.index--,this.elementAbovePage()&&this.getEntry(this.index).scrollIntoView(!0)):(this.index=this.entryCount-1,this.elementBelowPage()&&this.getEntry(this.index).scrollIntoView(!1))},markNext:function(){this.index<this.entryCount-1?(this.index++,this.elementBelowPage()&&this.getEntry(this.index).scrollIntoView(!1)):(this.index=0,this.elementAbovePage()&&this.getEntry(this.index).scrollIntoView(!0))},elementAbovePage:function(){var e=$j(this.getEntry(this.index)).offset().top,t=$j(window).scrollTop();return t>e},elementBelowPage:function(){var e=$j(window).scrollTop()+$j(window).height(),t=$j(this.getEntry(this.index)).offset().top+$j(this.getEntry(this.index)).height();return t>e},getEntry:function(e){return this.update.firstChild.childNodes[e]},getCurrentEntry:function(){return this.getEntry(this.index)},selectEntry:function(){this.active=!1,this.updateElement(this.getCurrentEntry())},updateElement:function(e){if(this.options.updateElement)return void this.options.updateElement(e);var t="";if(this.options.select){var n=$(e).select("."+this.options.select)||[];n.length>0&&(t=Element.collectTextNodes(n[0],this.options.select))}else t=Element.collectTextNodesIgnoreClass(e,"informal");var i=this.getTokenBounds();if(-1!=i[0]){var o=this.element.value.substr(0,i[0]),r=this.element.value.substr(i[0]).match(/^\s+/);r&&(o+=r[0]),this.element.value=o+t+this.element.value.substr(i[1])}else this.element.value=t;this.oldElementValue=this.element.value,this.element.focus(),this.options.afterUpdateElement&&this.options.afterUpdateElement(this.element,e)},updateChoices:function(e){if(!this.changed&&this.hasFocus){if(this.update.innerHTML=e,Element.cleanWhitespace(this.update),Element.cleanWhitespace(this.update.down()),this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var t=0;t<this.entryCount;t++){var n=this.getEntry(t);n.autocompleteIndex=t,this.addObservers(n)}}else this.entryCount=0;this.stopIndicator(),this.index=0,1==this.entryCount&&this.options.autoSelect?(this.selectEntry(),this.hide()):this.render()}},addObservers:function(e){Event.observe(e,"mouseover",this.onHover.bindAsEventListener(this)),Event.observe(e,"click",this.onClick.bindAsEventListener(this))},onObserverEvent:function(){this.changed=!1,this.tokenBounds=null,this.getToken().length>=this.options.minChars?this.getUpdatedChoices():(this.active=!1,this.hide()),this.oldElementValue=this.element.value},getToken:function(){var e=this.getTokenBounds();return this.element.value.substring(e[0],e[1]).strip()},getTokenBounds:function(){if(null!=this.tokenBounds)return this.tokenBounds;var e=this.element.value;if(e.strip().empty())return[-1,0];for(var t,n=arguments.callee.getFirstDifferencePos(e,this.oldElementValue),i=n==this.oldElementValue.length?1:0,o=-1,r=e.length,s=0,a=this.options.tokens.length;a>s;++s)t=e.lastIndexOf(this.options.tokens[s],n+i-1),t>o&&(o=t),t=e.indexOf(this.options.tokens[s],n+i),-1!=t&&r>t&&(r=t);return this.tokenBounds=[o+1,r]}}),Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(e,t){for(var n=Math.min(e.length,t.length),i=0;n>i;++i)if(e[i]!=t[i])return i;return n},Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(e,t,n,i){this.baseInitialize(e,t,i),this.options.asynchronous=!0,this.options.onComplete=this.onComplete.bind(this),this.options.defaultParams=this.options.parameters||null,this.url=n},getUpdatedChoices:function(){this.startIndicator();var e=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,e):e,this.options.defaultParams&&(this.options.parameters+="&"+this.options.defaultParams),new Ajax.Request(this.url,this.options)},onComplete:function(e){this.updateChoices(e.responseText)}}),Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(e,t,n,i){this.baseInitialize(e,t,i),this.options.array=n},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this))},setOptions:function(e){this.options=Object.extend({choices:10,partialSearch:!0,partialChars:2,ignoreCase:!0,fullSearch:!1,selector:function(e){for(var t=[],n=[],i=e.getToken(),o=0;o<e.options.array.length&&t.length<e.options.choices;o++)for(var r=e.options.array[o],s=e.options.ignoreCase?r.toLowerCase().indexOf(i.toLowerCase()):r.indexOf(i);-1!=s;){if(0==s&&r.length!=i.length){t.push("<li><strong>"+r.substr(0,i.length)+"</strong>"+r.substr(i.length)+"</li>");break}if(i.length>=e.options.partialChars&&e.options.partialSearch&&-1!=s&&(e.options.fullSearch||/\s/.test(r.substr(s-1,1)))){n.push("<li>"+r.substr(0,s)+"<strong>"+r.substr(s,i.length)+"</strong>"+r.substr(s+i.length)+"</li>");break}s=e.options.ignoreCase?r.toLowerCase().indexOf(i.toLowerCase(),s+1):r.indexOf(i,s+1)}return n.length&&(t=t.concat(n.slice(0,e.options.choices-t.length))),"<ul>"+t.join("")+"</ul>"}},e||{})}}),Field.scrollFreeActivate=function(e){setTimeout(function(){Field.activate(e)},1)},Ajax.InPlaceEditor=Class.create({initialize:function(e,t,n){this.url=t,this.element=e=$(e),this.prepareOptions(),this._controls={},arguments.callee.dealWithDeprecatedOptions(n),Object.extend(this.options,n||{}),!this.options.formId&&this.element.id&&(this.options.formId=this.element.id+"-inplaceeditor",$(this.options.formId)&&(this.options.formId="")),this.options.externalControl&&(this.options.externalControl=$(this.options.externalControl)),this.options.externalControl||(this.options.externalControlOnly=!1),this._originalBackground=this.element.getStyle("background-color")||"transparent",this.element.title=this.options.clickToEditText,this._boundCancelHandler=this.handleFormCancellation.bind(this),this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this),this._boundFailureHandler=this.handleAJAXFailure.bind(this),this._boundSubmitHandler=this.handleFormSubmission.bind(this),this._boundWrapperHandler=this.wrapUp.bind(this),this.registerListeners()},checkForEscapeOrReturn:function(e){!this._editing||e.ctrlKey||e.altKey||e.shiftKey||(Event.KEY_ESC==e.keyCode?this.handleFormCancellation(e):Event.KEY_RETURN==e.keyCode&&this.handleFormSubmission(e))},createControl:function(e,t,n){var i=this.options[e+"Control"],o=this.options[e+"Text"];if("button"==i){var r=document.createElement("input");r.type="submit",r.value=o,r.className="editor_"+e+"_button","cancel"==e&&(r.onclick=this._boundCancelHandler),this._form.appendChild(r),this._controls[e]=r}else if("link"==i){var s=document.createElement("a");s.href="#",s.appendChild(document.createTextNode(o)),s.onclick="cancel"==e?this._boundCancelHandler:this._boundSubmitHandler,s.className="editor_"+e+"_link",n&&(s.className+=" "+n),this._form.appendChild(s),this._controls[e]=s}},createEditField:function(){var e,t=this.options.loadTextURL?this.options.loadingText:this.getText();if(1>=this.options.rows&&!/\r|\n/.test(this.getText())){e=document.createElement("input"),e.type="text";var n=this.options.size||this.options.cols||0;n>0&&(e.size=n)}else e=document.createElement("textarea"),e.rows=1>=this.options.rows?this.options.autoRows:this.options.rows,e.cols=this.options.cols||40;e.name=this.options.paramName,e.value=t,e.className="editor_field",this.options.submitOnBlur&&(e.onblur=this._boundSubmitHandler),this._controls.editor=e,this.options.loadTextURL&&this.loadExternalText(),this._form.appendChild(this._controls.editor)},createForm:function(){function e(e,n){var i=t.options["text"+e+"Controls"];i&&n!==!1&&t._form.appendChild(document.createTextNode(i))}var t=this;this._form=$(document.createElement("form")),this._form.id=this.options.formId,this._form.addClassName(this.options.formClassName),this._form.onsubmit=this._boundSubmitHandler,this.createEditField(),"textarea"==this._controls.editor.tagName.toLowerCase()&&this._form.appendChild(document.createElement("br")),this.options.onFormCustomization&&this.options.onFormCustomization(this,this._form),e("Before",this.options.okControl||this.options.cancelControl),this.createControl("ok",this._boundSubmitHandler),e("Between",this.options.okControl&&this.options.cancelControl),this.createControl("cancel",this._boundCancelHandler,"editor_cancel"),e("After",this.options.okControl||this.options.cancelControl)},destroy:function(){this._oldInnerHTML&&(this.element.innerHTML=this._oldInnerHTML),this.leaveEditMode(),this.unregisterListeners()},enterEditMode:function(e){this._saving||this._editing||(this._editing=!0,this.triggerCallback("onEnterEditMode"),this.options.externalControl&&this.options.externalControl.hide(),this.element.hide(),this.createForm(),this.element.parentNode.insertBefore(this._form,this.element),this.options.loadTextURL||this.postProcessEditField(),e&&Event.stop(e))},enterHover:function(){this.options.hoverClassName&&this.element.addClassName(this.options.hoverClassName),this._saving||this.triggerCallback("onEnterHover")},getText:function(){return this.element.innerHTML.unescapeHTML()},handleAJAXFailure:function(e){this.triggerCallback("onFailure",e),this._oldInnerHTML&&(this.element.innerHTML=this._oldInnerHTML,this._oldInnerHTML=null)},handleFormCancellation:function(e){this.wrapUp(),e&&Event.stop(e)},handleFormSubmission:function(e){var t=this._form,n=$F(this._controls.editor);this.prepareSubmission();var i=this.options.callback(t,n)||"";if(Object.isString(i)&&(i=i.toQueryParams()),i.editorId=this.element.id,this.options.htmlResponse){var o=Object.extend({evalScripts:!0},this.options.ajaxOptions);Object.extend(o,{parameters:i,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler}),new Ajax.Updater({success:this.element},this.url,o)}else{var o=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(o,{parameters:i,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler}),new Ajax.Request(this.url,o)}e&&Event.stop(e)},leaveEditMode:function(){this.element.removeClassName(this.options.savingClassName),this.removeForm(),this.leaveHover(),this.element.style.backgroundColor=this._originalBackground,this.element.show(),this.options.externalControl&&this.options.externalControl.show(),this._saving=!1,this._editing=!1,this._oldInnerHTML=null,this.triggerCallback("onLeaveEditMode")},leaveHover:function(){this.options.hoverClassName&&this.element.removeClassName(this.options.hoverClassName),this._saving||this.triggerCallback("onLeaveHover")},loadExternalText:function(){this._form.addClassName(this.options.loadingClassName),this._controls.editor.disabled=!0;var e=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(e,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(e){this._form.removeClassName(this.options.loadingClassName);var t=e.responseText;this.options.stripLoadedTextTags&&(t=t.stripTags()),this._controls.editor.value=t,this._controls.editor.disabled=!1,this.postProcessEditField()}.bind(this),onFailure:this._boundFailureHandler}),new Ajax.Request(this.options.loadTextURL,e)},postProcessEditField:function(){var e=this.options.fieldPostCreation;e&&$(this._controls.editor)["focus"==e?"focus":"activate"]()},prepareOptions:function(){this.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions),Object.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks),[this._extraDefaultOptions].flatten().compact().each(function(e){Object.extend(this.options,e)}.bind(this))},prepareSubmission:function(){this._saving=!0,this.removeForm(),this.leaveHover(),this.showSaving()},registerListeners:function(){this._listeners={};var e;$H(Ajax.InPlaceEditor.Listeners).each(function(t){e=this[t.value].bind(this),this._listeners[t.key]=e,this.options.externalControlOnly||this.element.observe(t.key,e),this.options.externalControl&&this.options.externalControl.observe(t.key,e)}.bind(this))},removeForm:function(){this._form&&(this._form.remove(),this._form=null,this._controls={})},showSaving:function(){this._oldInnerHTML=this.element.innerHTML,this.element.innerHTML=this.options.savingText,this.element.addClassName(this.options.savingClassName),this.element.style.backgroundColor=this._originalBackground,this.element.show()},triggerCallback:function(e,t){"function"==typeof this.options[e]&&this.options[e](this,t)},unregisterListeners:function(){$H(this._listeners).each(function(e){this.options.externalControlOnly||this.element.stopObserving(e.key,e.value),this.options.externalControl&&this.options.externalControl.stopObserving(e.key,e.value)}.bind(this))},wrapUp:function(e){this.leaveEditMode(),this._boundComplete(e,this.element)}}),Object.extend(Ajax.InPlaceEditor.prototype,{dispose:Ajax.InPlaceEditor.prototype.destroy}),Ajax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{initialize:function($super,e,t,n){this._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions,$super(e,t,n)},createEditField:function(){var e=document.createElement("select");e.name=this.options.paramName,e.size=1,this._controls.editor=e,this._collection=this.options.collection||[],this.options.loadCollectionURL?this.loadCollection():this.checkForExternalText(),this._form.appendChild(this._controls.editor)},loadCollection:function(){this._form.addClassName(this.options.loadingClassName),this.showLoadingText(this.options.loadingCollectionText);var options=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(options,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){var js=transport.responseText.strip();if(!/^\[.*\]$/.test(js))throw"Server returned an invalid collection representation.";this._collection=eval(js),this.checkForExternalText()}.bind(this),onFailure:this.onFailure}),new Ajax.Request(this.options.loadCollectionURL,options)},showLoadingText:function(e){this._controls.editor.disabled=!0;var t=this._controls.editor.firstChild;t||(t=document.createElement("option"),t.value="",this._controls.editor.appendChild(t),t.selected=!0),t.update((e||"").stripScripts().stripTags())},checkForExternalText:function(){this._text=this.getText(),this.options.loadTextURL?this.loadExternalText():this.buildOptionList()},loadExternalText:function(){this.showLoadingText(this.options.loadingText);var e=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(e,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(e){this._text=e.responseText.strip(),this.buildOptionList()}.bind(this),onFailure:this.onFailure}),new Ajax.Request(this.options.loadTextURL,e)},buildOptionList:function(){this._form.removeClassName(this.options.loadingClassName),this._collection=this._collection.map(function(e){return 2===e.length?e:[e,e].flatten()});var e="value"in this.options?this.options.value:this._text,t=this._collection.any(function(t){return t[0]==e}.bind(this));this._controls.editor.update("");var n;this._collection.each(function(i,o){n=document.createElement("option"),n.value=i[0],n.selected=t?i[0]==e:0==o,n.appendChild(document.createTextNode(i[1])),this._controls.editor.appendChild(n)}.bind(this)),this._controls.editor.disabled=!1,Field.scrollFreeActivate(this._controls.editor)}}),//**** DEPRECATION LAYER FOR InPlace[Collection]Editor! ****
//**** API and convert your code to it ASAP!            ****
Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(e){function t(t,n){t in e||void 0===n||(e[t]=n)}e&&(t("cancelControl",e.cancelLink?"link":e.cancelButton?"button":e.cancelLink==e.cancelButton==0?!1:void 0),t("okControl",e.okLink?"link":e.okButton?"button":e.okLink==e.okButton==0?!1:void 0),t("highlightColor",e.highlightcolor),t("highlightEndColor",e.highlightendcolor))},Object.extend(Ajax.InPlaceEditor,{DefaultOptions:{ajaxOptions:{},autoRows:3,cancelControl:"link",cancelText:"cancel",clickToEditText:"Click to edit",externalControl:null,externalControlOnly:!1,fieldPostCreation:"activate",formClassName:"inplaceeditor-form",formId:null,highlightColor:"#ffff99",highlightEndColor:"#ffffff",hoverClassName:"",htmlResponse:!0,loadingClassName:"inplaceeditor-loading",loadingText:"Loading...",okControl:"button",okText:"ok",paramName:"value",rows:1,savingClassName:"inplaceeditor-saving",savingText:"Saving...",size:0,stripLoadedTextTags:!1,submitOnBlur:!1,textAfterControls:"",textBeforeControls:"",textBetweenControls:""},DefaultCallbacks:{callback:function(e){return Form.serialize(e)},onComplete:function(e,t){new Effect.Highlight(t,{startcolor:this.options.highlightColor,keepBackgroundImage:!0})},onEnterEditMode:null,onEnterHover:function(e){e.element.style.backgroundColor=e.options.highlightColor,e._effect&&e._effect.cancel()},onFailure:function(e){alert("Error communication with the server: "+e.responseText.stripTags())},onFormCustomization:null,onLeaveEditMode:null,onLeaveHover:function(e){e._effect=new Effect.Highlight(e.element,{startcolor:e.options.highlightColor,endcolor:e.options.highlightEndColor,restorecolor:e._originalBackground,keepBackgroundImage:!0})}},Listeners:{click:"enterEditMode",keydown:"checkForEscapeOrReturn",mouseover:"enterHover",mouseout:"leaveHover"}}),Ajax.InPlaceCollectionEditor.DefaultOptions={loadingCollectionText:"Loading options..."},Form.Element.DelayedObserver=Class.create({initialize:function(e,t,n){this.delay=t||.5,this.element=$(e),this.callback=n,this.timer=null,this.lastValue=$F(this.element),Event.observe(this.element,"keyup",this.delayedListener.bindAsEventListener(this))},delayedListener:function(){this.lastValue!=$F(this.element)&&(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.onTimerEvent.bind(this),1e3*this.delay),this.lastValue=$F(this.element))},onTimerEvent:function(){this.timer=null,this.callback(this.element,$F(this.element))}});var DatePickerUtils={oneDayInMs:864e5,_daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],getMonthDays:function(e,t){return 0!=e%4||0==e%100&&0!=e%400||1!=t?this._daysInMonth[t]:29},parseDate:function(e){var t=DatePickerUtils.ansiDateToObject(e);if(!t){{parseFloat(e)}t=new Date,t.setTime(t.getTime()+e*this.oneDayInMs)}return t},dateObjectToAnsi:function(e){return e?e.getFullYear().toPaddedString(4)+"-"+(e.getMonth()+1).toPaddedString(2)+"-"+e.getDate().toPaddedString(2):null},ansiDateToObject:function(e){var t=null,n=String(e).match(/^(\d+)-0*(\d+)-0*(\d+)$/);return n&&(t=new Date(n[1],n[2]-1,n[3])),t},yearMonthToAnsiStub:function(e,t){return e.toPaddedString(4)+"-"+(t+1).toPaddedString(2)+"-"},noDatesBefore:function(e){return new DatePickerFilter(function(t,n){for(var i=DatePickerUtils.dateObjectToAnsi(DatePickerUtils.parseDate(e)),o=new Array,r=DatePickerUtils.getMonthDays(t,n),s=DatePickerUtils.yearMonthToAnsiStub(t,n),a=1;r>=a;a++)o[a]=i>s+a.toPaddedString(2);return o},function(t,n){var i=DatePickerUtils.dateObjectToAnsi(DatePickerUtils.parseDate(e)),o=DatePickerUtils.yearMonthToAnsiStub(t,n)+DatePickerUtils.getMonthDays(t,n);return o>=i})},noDatesAfter:function(e){return new DatePickerFilter(function(t,n){for(var i=DatePickerUtils.dateObjectToAnsi(DatePickerUtils.parseDate(e)),o=new Array,r=DatePickerUtils.getMonthDays(t,n),s=DatePickerUtils.yearMonthToAnsiStub(t,n),a=1;r>=a;a++)o[a]=i<s+a.toPaddedString(2);return o},function(t,n){var i=DatePickerUtils.dateObjectToAnsi(DatePickerUtils.parseDate(e)),o=DatePickerUtils.yearMonthToAnsiStub(t,n)+"01";return i>=o})},noWeekends:function(){return new DatePickerFilter(function(e,t){for(var n=new Array,i=DatePickerUtils.getMonthDays(e,t),o=new Date(e,t,1),r=1;i>=r;o.setFullYear(e,t,++r))n[r]=o.getDay()%6==0;return n},null)}},DatePickerFormatter=Class.create();DatePickerFormatter.prototype={initialize:function(e,t){Object.isUndefined(e)&&(e=["yyyy","mm","dd"]),Object.isUndefined(t)&&(t="-"),this._format=e,this.separator=t,this._formatYearIndex=e.indexOf("yyyy"),this._formatMonthIndex=e.indexOf("mm"),this._formatDayIndex=e.indexOf("dd"),this._yearRegexp=/^\d{4}$/,this._monthRegexp=/^0\d|1[012]|\d$/,this._dayRegexp=/^0\d|[12]\d|3[01]|\d$/},match:function(e){var t=e.split(this.separator);if(t.length<3)return!1;var n=t[this._formatYearIndex].match(this._yearRegexp);if(!n)return!1;n=n[0];var i=t[this._formatMonthIndex].match(this._monthRegexp);if(!i)return!1;i=i[0];var o=t[this._formatDayIndex].match(this._dayRegexp);return o?(o=o[0],[n,i,o]):!1},currentDate:function(){var e=new Date;return this.dateToString(e.getFullYear(),e.getMonth()+1,e.getDate())},dateToString:function(e,t,n,i){Object.isUndefined(i)&&(i=this.separator);var o=[0,0,0];return o[this._formatYearIndex]=e,o[this._formatMonthIndex]=t.toPaddedString(2),o[this._formatDayIndex]=n.toPaddedString(2),o.join(i)}};var DatePickerFilter=Class.create();DatePickerFilter.prototype={initialize:function(e,t){e&&(this.badDates=e),t&&(this.validMonthP=t)},badDates:null,validMonthP:null,/* Using "append" we can string filters together, such as "before date a",
     "after date b", and "not on weekends".  Note: this changes the current
     DatePickerFilter rather than returning a new one.
     Caveat Integrator: This uses closures. These can cause memory leaks (in
     IE) so be careful!
  */
append:function(e){if(this.badDates){if(e.badDates){var t=this.badDates;this.badDates=function(n,i){for(var o=t(n,i),r=e.badDates(n,i),s=0;s<o.length;s++)o[s]=o[s]||r[s];return o}}}else this.badDates=e.badDates;if(this.validMonthP){if(e.validMonthP){var n=this.validMonthP;this.validMonthP=function(t,i){return n(t,i)&&e.validMonthP(t,i)}}}else this.validMonthP=e.validMonthP;return this}};var DatePicker=Class.create();// Copyright (c) 2005-2008 Thomas Fuchs (http://script.aculo.us, http://mir.aculo.us)
if(DatePicker.prototype={Version:"1.0.0",_relative:null,_div:null,_zindex:1,_keepFieldEmpty:!1,_dateFormat:null,_language:"en",_language_month:$H({fr:["Janvier","F&#233;vrier","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","D&#233;cembre"],en:["January","February","March","April","May","June","July","August","September","October","November","December"],sp:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],it:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],de:["Januar","Februar","M&#228;rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],pt:["Janeiro","Fevereiro","Mar&#231;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],hu:["Janu&#225;r","Febru&#225;r","M&#225;rcius","&#193;prilis","M&#225;jus","J&#250;nius","J&#250;lius","Augusztus","Szeptember","Okt&#243;ber","November","December"],lt:["Sausis","Vasaris","Kovas","Balandis","Gegu&#382;&#279;","Bir&#382;elis","Liepa","Rugj&#363;tis","Rus&#279;jis","Spalis","Lapkritis","Gruodis"],nl:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],dk:["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],no:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],lv:["Janv&#257;ris","Febru&#257;ris","Marts","Apr&#299;lis","Maijs","J&#363;nijs","J&#363;lijs","Augusts","Septembris","Oktobris","Novembris","Decemberis"],ja:["1&#26376;","2&#26376;","3&#26376;","4&#26376;","5&#26376;","6&#26376;","7&#26376;","8&#26376;","9&#26376;","10&#26376;","11&#26376;","12&#26376;"],fi:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kes&#228;kuu","Hein&#228;kuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],ro:["Ianuarie","Februarie","Martie","Aprilie","Mai","Junie","Julie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],zh:["1&#32;&#26376;","2&#32;&#26376;","3&#32;&#26376;","4&#32;&#26376;","5&#32;&#26376;","6&#32;&#26376;","7&#32;&#26376;","8&#32;&#26376;","9&#32;&#26376;","10&#26376;","11&#26376;","12&#26376;"],sv:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],pl:["Stycze\u0144","Luty","Marzec","Kwiecie\u0144","Maj","Czerwiec","Lipiec","Sierpie\u0144","Wrzesie\u0144","Pa\u017adziernik","Listopad","Grudzie\u0144"]}),_language_day:$H({fr:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],en:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],sp:["Lun","Mar","Mie","Jue","Vie","S&#224;b","Dom"],it:["Lun","Mar","Mer","Gio","Ven","Sab","Dom"],de:["Mon","Die","Mit","Don","Fre","Sam","Son"],pt:["Seg","Ter","Qua","Qui","Sex","S&#225;","Dom"],hu:["H&#233;","Ke","Sze","Cs&#252;","P&#233;","Szo","Vas"],lt:["Pir","Ant","Tre","Ket","Pen","&Scaron;e&scaron;","Sek"],nl:["ma","di","wo","do","vr","za","zo"],dk:["Man","Tir","Ons","Tor","Fre","L&#248;r","S&#248;n"],no:["Man","Tir","Ons","Tor","Fre","L&#248;r","Sun"],lv:["P","O","T","C","Pk","S","Sv"],ja:["&#26376;","&#28779;","&#27700;","&#26408;","&#37329;","&#22303;","&#26085;"],fi:["Ma","Ti","Ke","To","Pe","La","Su"],ro:["Lun","Mar","Mie","Joi","Vin","Sam","Dum"],zh:["&#21608;&#19968;","&#21608;&#20108;","&#21608;&#19977;","&#21608;&#22235;","&#21608;&#20116;","&#21608;&#20845;","&#21608;&#26085;"],sv:["M&#229;n","Tis","Ons","Tor","Fre","L&#246;r","S&#246;n"],pl:["Pon","Wt","\u015ar","Czw","Pt","Sob","Nie"]}),_language_close:$H({fr:"fermer",en:"close",sp:"cierre",it:"fine",de:"schliessen",pt:"fim",hu:"bez&#225;r",lt:"u&#382;daryti",nl:"sluiten",dk:"luk",no:"lukk",lv:"aizv&#275;rt",ja:"&#38281;&#12376;&#12427;",fi:"sulje",ro:"inchide",zh:"&#20851;&#32;&#38381",sv:"st&#228;ng",pl:"zamknij"}),_language_date_format:$H({en:[["mm","dd","yyyy"],"/"],lt:[["yyyy","mm","dd"],"-"],fr:[["dd","mm","yyyy"],"/"],sp:[["dd","mm","yyyy"],"/"],it:[["dd","mm","yyyy"],"/"],de:[["dd","mm","yyyy"],"/"],pt:[["dd","mm","yyyy"],"/"],hu:[["dd","mm","yyyy"],"/"],nl:[["dd","mm","yyyy"],"/"],dk:[["dd","mm","yyyy"],"/"],no:[["dd","mm","yyyy"],"/"],lv:[["dd","mm","yyyy"],"/"],ja:[["yyyy","mm","dd"],"-"],fi:[["dd","mm","yyyy"],"."],ro:[["dd","mm","yyyy"],"/"],zh:[["yyyy","mm","dd"],"-"],sv:[["dd","mm","yyyy"],"/"],pl:[["yyyy","mm","dd"],"-"]}),_todayDate:new Date,_currentDate:null,_clickCallback:Prototype.emptyFunction,_cellCallback:Prototype.emptyFunction,_dateFilter:new DatePickerFilter,_id_datepicker:null,_topOffset:30,_leftOffset:0,_isPositionned:!1,_relativePosition:!0,_setPositionTop:0,_setPositionLeft:0,_bodyAppend:!1,_showEffect:"appear",_showDuration:.2,_enableShowEffect:!0,_closeEffect:"fade",_closeEffectDuration:.2,_enableCloseEffect:!0,_closeTimer:null,_enableCloseOnBlur:!1,_afterClose:Prototype.emptyFunction,getMonthLocale:function(e){return this._language_month.get(this._language)[e]},getLocaleClose:function(){return this._language_close.get(this._language)},_initCurrentDate:function(){this._dateFormat||(this._dateFormat=this._language_date_format.get(this._language)),this._df=new DatePickerFormatter(this._dateFormat[0],this._dateFormat[1]),this._currentDate=$F(this._relative),this._df.match(this._currentDate)||(this._currentDate=this._df.currentDate(),this._keepFieldEmpty||($(this._relative).value=this._currentDate));var e=this._df.match(this._currentDate);this._currentYear=Number(e[0]),this._currentMonth=Number(e[1])-1,this._currentDay=Number(e[2])},initialize:function(e){this._relative=e.relative,e.language&&(this._language=e.language),this._zindex=e.zindex?parseInt(Number(e.zindex)):1,Object.isUndefined(e.keepFieldEmpty)||(this._keepFieldEmpty=e.keepFieldEmpty),Object.isFunction(e.clickCallback)&&(this._clickCallback=e.clickCallback),Object.isUndefined(e.leftOffset)||(this._leftOffset=parseInt(e.leftOffset)),Object.isUndefined(e.topOffset)||(this._topOffset=parseInt(e.topOffset)),Object.isUndefined(e.relativePosition)||(this._relativePosition=e.relativePosition),Object.isUndefined(e.showEffect)||(this._showEffect=e.showEffect),Object.isUndefined(e.enableShowEffect)||(this._enableShowEffect=e.enableShowEffect),Object.isUndefined(e.showDuration)||(this._showDuration=e.showDuration),Object.isUndefined(e.closeEffect)||(this._closeEffect=e.closeEffect),Object.isUndefined(e.enableCloseEffect)||(this._enableCloseEffect=e.enableCloseEffect),Object.isUndefined(e.closeEffectDuration)||(this._closeEffectDuration=e.closeEffectDuration),Object.isFunction(e.afterClose)&&(this._afterClose=e.afterClose),Object.isUndefined(e.externalControl)||(this._externalControl=e.externalControl),Object.isUndefined(e.dateFormat)||(this._dateFormat=e.dateFormat),Object.isFunction(e.cellCallback)&&(this._cellCallback=e.cellCallback),this._setPositionTop=e.setPositionTop?parseInt(Number(e.setPositionTop)):0,this._setPositionLeft=e.setPositionLeft?parseInt(Number(e.setPositionLeft)):0,!Object.isUndefined(e.enableCloseOnBlur)&&e.enableCloseOnBlur&&(this._enableCloseOnBlur=!0),!Object.isUndefined(e.dateFilter)&&e.dateFilter&&(this._dateFilter=e.dateFilter),!Object.isUndefined(e.disablePastDate)&&e.disablePastDate?this._dateFilter.append(DatePickerUtils.noDatesBefore(0)):!Object.isUndefined(e.disableFutureDate)&&e.disableFutureDate&&this._dateFilter.append(DatePickerUtils.noDatesAfter(0)),this._id_datepicker="datepicker-"+this._relative,this._id_datepicker_prev=this._id_datepicker+"-prev",this._id_datepicker_next=this._id_datepicker+"-next",this._id_datepicker_hdr=this._id_datepicker+"-header",this._id_datepicker_ftr=this._id_datepicker+"-footer",this._div=new Element("div",{id:this._id_datepicker,className:"datepicker",style:"display: none; z-index:"+this._zindex}),this._div.innerHTML='<table><thead><tr><th width="10px" id="'+this._id_datepicker_prev+'" style="cursor: pointer;">&nbsp;&lt;&lt;&nbsp;</th><th id="'+this._id_datepicker_hdr+'" colspan="5"></th><th width="10px" id="'+this._id_datepicker_next+'" style="cursor: pointer;">&nbsp;&gt;&gt;&nbsp;</th></tr></thead><tbody id="'+this._id_datepicker+'-tbody"></tbody><tfoot><tr><td colspan="7" id="'+this._id_datepicker_ftr+'"></td></tr></tfoot></table>',Event.observe(this._relative,"click",this.click.bindAsEventListener(this),!1),document.observe("dom:loaded",this.load.bindAsEventListener(this),!1),this._enableCloseOnBlur&&(Event.observe(this._relative,"blur",function(){this._closeTimer||(this._closeTimer=this.close.bind(this).delay(1))}.bindAsEventListener(this)),Event.observe(this._div,"click",function(){Field.focus(this._relative),this.checkClose.bind(this).delay(.1)}.bindAsEventListener(this)))},load:function(){if(this._externalControl&&Event.observe(this._externalControl,"click",this.click.bindAsEventListener(this),!1),this._relativeAppend)$(this._relative).parentNode&&(this._div.innerHTML=this._wrap_in_iframe(this._div.innerHTML),$(this._relative).parentNode.appendChild(this._div));else{var e=document.getElementsByTagName("body").item(0);if(e&&(this._div.innerHTML=this._wrap_in_iframe(this._div.innerHTML),e.appendChild(this._div)),this._relativePosition){var t=Element.cumulativeOffset($(this._relative));this.setPosition(t[1],t[0])}else(this._setPositionTop||this._setPositionLeft)&&this.setPosition(this._setPositionTop,this._setPositionLeft)}this._initCurrentDate(),$(this._id_datepicker_ftr).innerHTML=this.getLocaleClose(),Event.observe($(this._id_datepicker_prev),"click",this.prevMonth.bindAsEventListener(this),!1),Event.observe($(this._id_datepicker_next),"click",this.nextMonth.bindAsEventListener(this),!1),Event.observe($(this._id_datepicker_ftr),"click",this.close.bindAsEventListener(this),!1),Event.observe($(document),"click",this.documentClick.bindAsEventListener(this),!1)},_wrap_in_iframe:function(e){return Prototype.Browser.IE?"<div style='height:167px;width:185px;background-color:white;align:left'><iframe width='100%' height='100%' marginwidth='0' marginheight='0' frameborder='0' src='about:blank' style='filter:alpha(Opacity=50);'></iframe><div style='position:absolute;background-color:white;top:2px;left:2px;width:180px'>"+e+"</div></div>":e},visible:function(){return $(this._id_datepicker).visible()},click:function(){if(null==$(this._id_datepicker)&&this.load(),!this._isPositionned&&this._relativePosition){var a_lt=Element.cumulativeOffset($(this._relative));$(this._id_datepicker).setStyle({left:Number(a_lt[0]+this._leftOffset)+"px",top:Number(a_lt[1]+this._topOffset)+"px"}),this._isPositionned=!0}this.visible()||(this._initCurrentDate(),this._redrawCalendar()),eval(this._clickCallback()),this._enableShowEffect?new Effect.toggle(this._id_datepicker,this._showEffect,{duration:this._showDuration}):$(this._id_datepicker).show()},close:function(){if(this.visible()){if(this.checkClose(),this._enableCloseEffect)switch(this._closeEffect){case"puff":new Effect.Puff(this._id_datepicker,{duration:this._closeEffectDuration});break;case"blindUp":new Effect.BlindUp(this._id_datepicker,{duration:this._closeEffectDuration});break;case"dropOut":new Effect.DropOut(this._id_datepicker,{duration:this._closeEffectDuration});break;case"switchOff":new Effect.SwitchOff(this._id_datepicker,{duration:this._closeEffectDuration});break;case"squish":new Effect.Squish(this._id_datepicker,{duration:this._closeEffectDuration});break;case"fold":new Effect.Fold(this._id_datepicker,{duration:this._closeEffectDuration});break;case"shrink":new Effect.Shrink(this._id_datepicker,{duration:this._closeEffectDuration});break;default:new Effect.Fade(this._id_datepicker,{duration:this._closeEffectDuration})}else $(this._id_datepicker).hide();eval(this._afterClose())}},checkClose:function(){this._closeTimer&&(window.clearTimeout(this._closeTimer),this._closeTimer=null)},documentClick:function(e){var t=e.element();t==this._div||t==$(this._relative)||t==$(this._externalControl)||t.descendantOf(this._div)||this.close()},setDateFormat:function(e,t){Object.isUndefined(e)&&(e=this._dateFormat[0]),Object.isUndefined(t)&&(t=this._dateFormat[1]),this._dateFormat=[e,t]},setPosition:function(e,t){var n={top:"0px",left:"0px"};Object.isUndefined(e)||(n.top=Number(e)+this._topOffset+"px"),Object.isUndefined(t)||(n.left=Number(t)+this._leftOffset+"px"),$(this._id_datepicker).setStyle(n),this._isPositionned=!0},_buildCalendar:function(){var e=$(this._id_datepicker+"-tbody");try{for(;e.hasChildNodes();)e.removeChild(e.childNodes[0])}catch(t){}var n=new Element("tr");this._language_day.get(this._language).each(function(e){var t=new Element("td");t.innerHTML=e,t.className="wday",n.appendChild(t)}),e.appendChild(n);for(var i=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],o=this._currentMonth,r=this._currentYear,s=new Date(r,o,1,12),a=(s.getDay()+6)%7,l=DatePickerUtils.getMonthDays(r,o),c=1,u=this._dateFilter.badDates?this._dateFilter.badDates(r,o):[],h=a;7>h;h++)i[0][h]={d:c,m:o,y:r,b:u[c]},c++;for(var d=this._prevMonthYear(),p=DatePickerUtils.getMonthDays(d[1],d[0]),h=0;a>h;h++)i[0][h]={d:Number(p-a+h+1),m:Number(d[0]),y:d[1],c:"outbound",b:!0};for(var f=!1,m=1;6>m;m++)for(var h=0;7>h;h++)i[m][h]={d:c,m:o,y:r,c:f?"outbound":c==this._todayDate.getDate()&&o==this._todayDate.getMonth()&&r==this._todayDate.getFullYear()?"today":null,b:f||u[c]},c++,c>l&&(c=1,f=!0,this._currentMonth+1>11?(o=0,r+=1):o+=1);for(var m=0;6>m;m++){for(var g=new Element("tr"),h=0;7>h;h++){var v=i[m][h],y=new Element("td"),b=$A([this._relative,this._df.dateToString(v.y,v.m+1,v.d,"-")]).join("-");y.setAttribute("id",b),v.c&&(y.className=v.c),this._bindCellOnClick(y,v.b,v.c),y.innerHTML=v.d,g.appendChild(y)}e.appendChild(g)}return e},_bindCellOnClick:function(e,t,n){if(t)e.className=n?"nclick_"+n:"nclick";else{var i=this;e.onclick=function(){$(i._relative).value=String($(this).readAttribute("id")).replace(i._relative+"-","").replace(/-/g,i._df.separator),i._cellCallback&&i._cellCallback(this),i.close()}}},_nextMonthYear:function(){var e=this._currentMonth,t=this._currentYear;return e+1>11?(e=0,t+=1):e+=1,[e,t]},nextMonth:function(){this._maybeRedrawMonth(this._nextMonthYear())},_prevMonthYear:function(){var e=this._currentMonth,t=this._currentYear;return 0>e-1?(e=11,t-=1):e-=1,[e,t]},prevMonth:function(){this._maybeRedrawMonth(this._prevMonthYear())},_maybeRedrawMonth:function(e){var t=e[0],n=e[1];(!this._dateFilter.validMonthP||this._dateFilter.validMonthP(n,t))&&(this._currentMonth=t,this._currentYear=n,this._redrawCalendar())},_redrawCalendar:function(){this._setLocaleHdr(),this._buildCalendar()},_setLocaleHdr:function(){var e=this._nextMonthYear();$(this._id_datepicker_next).setAttribute("title",this.getMonthLocale(e[0])+" "+e[1]);var t=this._prevMonthYear();$(this._id_datepicker_prev).setAttribute("title",this.getMonthLocale(t[0])+" "+t[1]),$(this._id_datepicker_hdr).update("&nbsp;&nbsp;&nbsp;"+this.getMonthLocale(this._currentMonth)+"&nbsp;"+this._currentYear+"&nbsp;&nbsp;&nbsp;")}},Object.isUndefined(Effect))throw"dragdrop.js requires including script.aculo.us' effects.js library";var Droppables={drops:[],remove:function(e){this.drops=this.drops.reject(function(t){return t.element==$(e)})},add:function(e){e=$(e);var t=Object.extend({greedy:!0,hoverclass:null,tree:!1},arguments[1]||{});if(t.containment){t._containers=[];var n=t.containment;Object.isArray(n)?n.each(function(e){t._containers.push($(e))}):t._containers.push($(n))}t.accept&&(t.accept=[t.accept].flatten()),Element.makePositioned(e),t.element=e,this.drops.push(t)},findDeepestChild:function(e){for(deepest=e[0],i=1;i<e.length;++i)Element.isParent(e[i].element,deepest.element)&&(deepest=e[i]);return deepest},isContained:function(e,t){var n;return n=t.tree?e.treeNode:e.parentNode,t._containers.detect(function(e){return n==e})},isAffected:function(e,t,n){return n.element!=t&&(!n._containers||this.isContained(t,n))&&(!n.accept||Element.classNames(t).detect(function(e){return n.accept.include(e)}))&&Position.within(n.element,e[0],e[1])},deactivate:function(e){e.hoverclass&&Element.removeClassName(e.element,e.hoverclass),this.last_active=null},activate:function(e){e.hoverclass&&Element.addClassName(e.element,e.hoverclass),this.last_active=e},show:function(e,t){if(this.drops.length){var n,i=[];this.drops.each(function(n){Droppables.isAffected(e,t,n)&&i.push(n)}),i.length>0&&(n=Droppables.findDeepestChild(i)),this.last_active&&this.last_active!=n&&this.deactivate(this.last_active),n&&(Position.within(n.element,e[0],e[1]),n.onHover&&n.onHover(t,n.element,Position.overlap(n.overlap,n.element)),n!=this.last_active&&Droppables.activate(n))}},fire:function(e,t){return this.last_active?(Position.prepare(),this.isAffected([Event.pointerX(e),Event.pointerY(e)],t,this.last_active)&&this.last_active.onDrop?(this.last_active.onDrop(t,this.last_active.element,e),!0):void 0):void 0},reset:function(){this.last_active&&this.deactivate(this.last_active)}},Draggables={drags:[],observers:[],register:function(e){0==this.drags.length&&(this.eventMouseUp=this.endDrag.bindAsEventListener(this),this.eventMouseMove=this.updateDrag.bindAsEventListener(this),this.eventKeypress=this.keyPress.bindAsEventListener(this),Event.observe(document,"mouseup",this.eventMouseUp),Event.observe(document,"mousemove",this.eventMouseMove),Event.observe(document,"keypress",this.eventKeypress)),this.drags.push(e)},unregister:function(e){this.drags=this.drags.reject(function(t){return t==e}),0==this.drags.length&&(Event.stopObserving(document,"mouseup",this.eventMouseUp),Event.stopObserving(document,"mousemove",this.eventMouseMove),Event.stopObserving(document,"keypress",this.eventKeypress))},activate:function(e){e.options.delay?this._timeout=setTimeout(function(){Draggables._timeout=null,window.focus(),Draggables.activeDraggable=e}.bind(this),e.options.delay):(window.focus(),this.activeDraggable=e)},deactivate:function(){this.activeDraggable=null},updateDrag:function(e){if(this.activeDraggable){var t=[Event.pointerX(e),Event.pointerY(e)];this._lastPointer&&this._lastPointer.inspect()==t.inspect()||(this._lastPointer=t,this.activeDraggable.updateDrag(e,t))}},endDrag:function(e){this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this.activeDraggable&&(this._lastPointer=null,this.activeDraggable.endDrag(e),this.activeDraggable=null)},keyPress:function(e){this.activeDraggable&&this.activeDraggable.keyPress(e)},addObserver:function(e){this.observers.push(e),this._cacheObserverCallbacks()},removeObserver:function(e){this.observers=this.observers.reject(function(t){return t.element==e}),this._cacheObserverCallbacks()},notify:function(e,t,n){this[e+"Count"]>0&&this.observers.each(function(i){i[e]&&i[e](e,t,n)}),t.options[e]&&t.options[e](t,n)},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(e){Draggables[e+"Count"]=Draggables.observers.select(function(t){return t[e]}).length})}},Draggable=Class.create({initialize:function(e){var t={handle:!1,reverteffect:function(e,t,n){var i=.02*Math.sqrt(Math.abs(2^t)+Math.abs(2^n));new Effect.Move(e,{x:-n,y:-t,duration:i,queue:{scope:"_draggable",position:"end"}})},endeffect:function(e){var t=Object.isNumber(e._opacity)?e._opacity:1;new Effect.Opacity(e,{duration:.2,from:.7,to:t,queue:{scope:"_draggable",position:"end"},afterFinish:function(){Draggable._dragging[e]=!1}})},zindex:1e3,revert:!1,quiet:!1,scroll:!1,scrollSensitivity:20,scrollSpeed:15,snap:!1,delay:0};(!arguments[1]||Object.isUndefined(arguments[1].endeffect))&&Object.extend(t,{starteffect:function(e){e._opacity=Element.getOpacity(e),Draggable._dragging[e]=!0,new Effect.Opacity(e,{duration:.2,from:e._opacity,to:.7})}});var n=Object.extend(t,arguments[1]||{});this.element=$(e),n.handle&&Object.isString(n.handle)&&(this.handle=this.element.down("."+n.handle,0)),this.handle||(this.handle=$(n.handle)),this.handle||(this.handle=this.element),!n.scroll||n.scroll.scrollTo||n.scroll.outerHTML||(n.scroll=$(n.scroll),this._isScrollChild=Element.childOf(this.element,n.scroll)),Element.makePositioned(this.element),this.options=n,this.dragging=!1,this.eventMouseDown=this.initDrag.bindAsEventListener(this),Event.observe(this.handle,"mousedown",this.eventMouseDown),Draggables.register(this)},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown),Draggables.unregister(this)},currentDelta:function(){return[parseInt(Element.getStyle(this.element,"left")||"0"),parseInt(Element.getStyle(this.element,"top")||"0")]},initDrag:function(e){if((Object.isUndefined(Draggable._dragging[this.element])||!Draggable._dragging[this.element])&&Event.isLeftClick(e)){var t=Event.element(e);if((tag_name=t.tagName.toUpperCase())&&("INPUT"==tag_name||"SELECT"==tag_name||"OPTION"==tag_name||"BUTTON"==tag_name||"TEXTAREA"==tag_name))return;var n=[Event.pointerX(e),Event.pointerY(e)],i=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(e){return n[e]-i[e]}),Draggables.activate(this),Event.stop(e)}},startDrag:function(e){if(this.dragging=!0,this.delta||(this.delta=this.currentDelta()),this.options.zindex&&(this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0),this.element.style.zIndex=this.options.zindex),this.options.ghosting&&(this._clone=this.element.cloneNode(!0),this._originallyAbsolute="absolute"==this.element.getStyle("position"),this._originallyAbsolute||Position.absolutize(this.element),this.element.parentNode.insertBefore(this._clone,this.element)),this.options.scroll)if(this.options.scroll==window){var t=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=t.left,this.originalScrollTop=t.top}else this.originalScrollLeft=this.options.scroll.scrollLeft,this.originalScrollTop=this.options.scroll.scrollTop;Draggables.notify("onStart",this,e),this.options.starteffect&&this.options.starteffect(this.element)},updateDrag:function(event,pointer){if(this.dragging||this.startDrag(event),this.options.quiet||(Position.prepare(),Droppables.show(pointer,this.element)),Draggables.notify("onDrag",this,event),this.draw(pointer),this.options.change&&this.options.change(this),this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window)with(this._getWindowScroll(this.options.scroll))p=[left,top,left+width,top+height];else p=Position.page(this.options.scroll),p[0]+=this.options.scroll.scrollLeft+Position.deltaX,p[1]+=this.options.scroll.scrollTop+Position.deltaY,p.push(p[0]+this.options.scroll.offsetWidth),p.push(p[1]+this.options.scroll.offsetHeight);var speed=[0,0];pointer[0]<p[0]+this.options.scrollSensitivity&&(speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity)),pointer[1]<p[1]+this.options.scrollSensitivity&&(speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity)),pointer[0]>p[2]-this.options.scrollSensitivity&&(speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity)),pointer[1]>p[3]-this.options.scrollSensitivity&&(speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity)),this.startScrolling(speed)}Prototype.Browser.WebKit&&window.scrollBy(0,0),Event.stop(event)},finishDrag:function(e,t){if(this.dragging=!1,this.options.quiet){Position.prepare();var n=[Event.pointerX(e),Event.pointerY(e)];Droppables.show(n,this.element)}this.options.ghosting&&(this._originallyAbsolute||Position.relativize(this.element),delete this._originallyAbsolute,Element.remove(this._clone),this._clone=null);var i=!1;t&&(i=Droppables.fire(e,this.element),i||(i=!1)),i&&this.options.onDropped&&this.options.onDropped(this.element),Draggables.notify("onEnd",this,e);var o=this.options.revert;o&&Object.isFunction(o)&&(o=o(this.element));var r=this.currentDelta();o&&this.options.reverteffect?(0==i||"failure"!=o)&&this.options.reverteffect(this.element,r[1]-this.delta[1],r[0]-this.delta[0]):this.delta=r,this.options.zindex&&(this.element.style.zIndex=this.originalZ),this.options.endeffect&&this.options.endeffect(this.element),Draggables.deactivate(this),Droppables.reset()},keyPress:function(e){e.keyCode==Event.KEY_ESC&&(this.finishDrag(e,!1),Event.stop(e))},endDrag:function(e){this.dragging&&(this.stopScrolling(),this.finishDrag(e,!0),Event.stop(e))},draw:function(e){var t=Position.cumulativeOffset(this.element);if(this.options.ghosting){var n=Position.realOffset(this.element);t[0]+=n[0]-Position.deltaX,t[1]+=n[1]-Position.deltaY}var i=this.currentDelta();t[0]-=i[0],t[1]-=i[1],this.options.scroll&&this.options.scroll!=window&&this._isScrollChild&&(t[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft,t[1]-=this.options.scroll.scrollTop-this.originalScrollTop);var o=[0,1].map(function(n){return e[n]-t[n]-this.offset[n]}.bind(this));this.options.snap&&(o=Object.isFunction(this.options.snap)?this.options.snap(o[0],o[1],this):o.map(Object.isArray(this.options.snap)?function(e,t){return(e/this.options.snap[t]).round()*this.options.snap[t]}.bind(this):function(e){return(e/this.options.snap).round()*this.options.snap}.bind(this)));var r=this.element.style;this.options.constraint&&"horizontal"!=this.options.constraint||(r.left=o[0]+"px"),this.options.constraint&&"vertical"!=this.options.constraint||(r.top=o[1]+"px"),"hidden"==r.visibility&&(r.visibility="")},stopScrolling:function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=null,Draggables._lastScrollPointer=null)},startScrolling:function(e){(e[0]||e[1])&&(this.scrollSpeed=[e[0]*this.options.scrollSpeed,e[1]*this.options.scrollSpeed],this.lastScrolled=new Date,this.scrollInterval=setInterval(this.scroll.bind(this),10))},scroll:function(){var current=new Date,delta=current-this.lastScrolled;if(this.lastScrolled=current,this.options.scroll==window){with(this._getWindowScroll(this.options.scroll))if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1e3;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1])}}else this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1e3,this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1e3;Position.prepare(),Droppables.show(Draggables._lastPointer,this.element),Draggables.notify("onDrag",this),this._isScrollChild&&(Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer),Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1e3,Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1e3,Draggables._lastScrollPointer[0]<0&&(Draggables._lastScrollPointer[0]=0),Draggables._lastScrollPointer[1]<0&&(Draggables._lastScrollPointer[1]=0),this.draw(Draggables._lastScrollPointer)),this.options.change&&this.options.change(this)},_getWindowScroll:function(w){var T,L,W,H;with(w.document)w.document.documentElement&&documentElement.scrollTop?(T=documentElement.scrollTop,L=documentElement.scrollLeft):w.document.body&&(T=body.scrollTop,L=body.scrollLeft),w.innerWidth?(W=w.innerWidth,H=w.innerHeight):w.document.documentElement&&documentElement.clientWidth?(W=documentElement.clientWidth,H=documentElement.clientHeight):(W=body.offsetWidth,H=body.offsetHeight);return{top:T,left:L,width:W,height:H}}});Draggable._dragging={};var SortableObserver=Class.create({initialize:function(e,t){this.element=$(e),this.observer=t,this.lastValue=Sortable.serialize(this.element)},onStart:function(){this.lastValue=Sortable.serialize(this.element)},onEnd:function(){Sortable.unmark(),this.lastValue!=Sortable.serialize(this.element)&&this.observer(this.element)}}),Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(e){for(;"BODY"!=e.tagName.toUpperCase();){if(e.id&&Sortable.sortables[e.id])return e;e=e.parentNode}},options:function(e){return(e=Sortable._findRootElement($(e)))?Sortable.sortables[e.id]:void 0},destroy:function(e){e=$(e);var t=Sortable.sortables[e.id];t&&(Draggables.removeObserver(t.element),t.droppables.each(function(e){Droppables.remove(e)}),t.draggables.invoke("destroy"),delete Sortable.sortables[t.element.id])},create:function(e){e=$(e);var t=Object.extend({element:e,tag:"li",dropOnEmpty:!1,tree:!1,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:e,handle:!1,only:!1,delay:0,hoverclass:null,ghosting:!1,quiet:!1,scroll:!1,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:!1,handles:!1,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(e);var n={revert:!0,quiet:t.quiet,scroll:t.scroll,scrollSpeed:t.scrollSpeed,scrollSensitivity:t.scrollSensitivity,delay:t.delay,ghosting:t.ghosting,constraint:t.constraint,handle:t.handle};t.starteffect&&(n.starteffect=t.starteffect),t.reverteffect?n.reverteffect=t.reverteffect:t.ghosting&&(n.reverteffect=function(e){e.style.top=0,e.style.left=0}),t.endeffect&&(n.endeffect=t.endeffect),t.zindex&&(n.zindex=t.zindex);var i={overlap:t.overlap,containment:t.containment,tree:t.tree,hoverclass:t.hoverclass,onHover:Sortable.onHover},o={onHover:Sortable.onEmptyHover,overlap:t.overlap,containment:t.containment,hoverclass:t.hoverclass};Element.cleanWhitespace(e),t.draggables=[],t.droppables=[],(t.dropOnEmpty||t.tree)&&(Droppables.add(e,o),t.droppables.push(e)),(t.elements||this.findElements(e,t)||[]).each(function(o,r){var s=t.handles?$(t.handles[r]):t.handle?$(o).select("."+t.handle)[0]:o;t.draggables.push(new Draggable(o,Object.extend(n,{handle:s}))),Droppables.add(o,i),t.tree&&(o.treeNode=e),t.droppables.push(o)}),t.tree&&(Sortable.findTreeElements(e,t)||[]).each(function(n){Droppables.add(n,o),n.treeNode=e,t.droppables.push(n)}),this.sortables[e.id]=t,Draggables.addObserver(new SortableObserver(e,t.onUpdate))},findElements:function(e,t){return Element.findChildren(e,t.only,t.tree?!0:!1,t.tag)},findTreeElements:function(e,t){return Element.findChildren(e,t.only,t.tree?!0:!1,t.treeTag)},onHover:function(e,t,n){if(!(Element.isParent(t,e)||n>.33&&.66>n&&Sortable.options(t).tree))if(n>.5){if(Sortable.mark(t,"before"),t.previousSibling!=e){var i=e.parentNode;e.style.visibility="hidden",t.parentNode.insertBefore(e,t),t.parentNode!=i&&Sortable.options(i).onChange(e),Sortable.options(t.parentNode).onChange(e)}}else{Sortable.mark(t,"after");var o=t.nextSibling||null;if(o!=e){var i=e.parentNode;e.style.visibility="hidden",t.parentNode.insertBefore(e,o),t.parentNode!=i&&Sortable.options(i).onChange(e),Sortable.options(t.parentNode).onChange(e)}}},onEmptyHover:function(e,t,n){var i=e.parentNode,o=Sortable.options(t);if(!Element.isParent(t,e)){var r,s=Sortable.findElements(t,{tag:o.tag,only:o.only}),a=null;if(s){var l=Element.offsetSize(t,o.overlap)*(1-n);for(r=0;r<s.length;r+=1){if(!(l-Element.offsetSize(s[r],o.overlap)>=0)){if(l-Element.offsetSize(s[r],o.overlap)/2>=0){a=r+1<s.length?s[r+1]:null;break}a=s[r];break}l-=Element.offsetSize(s[r],o.overlap)}}t.insertBefore(e,a),Sortable.options(i).onChange(e),o.onChange(e)}},unmark:function(){Sortable._marker&&Sortable._marker.hide()},mark:function(e,t){var n=Sortable.options(e.parentNode);if(!n||n.ghosting){Sortable._marker||(Sortable._marker=($("dropmarker")||Element.extend(document.createElement("DIV"))).hide().addClassName("dropmarker").setStyle({position:"absolute"}),document.getElementsByTagName("body").item(0).appendChild(Sortable._marker));var i=Position.cumulativeOffset(e);Sortable._marker.setStyle({left:i[0]+"px",top:i[1]+"px"}),"after"==t&&Sortable._marker.setStyle("horizontal"==n.overlap?{left:i[0]+e.clientWidth+"px"}:{top:i[1]+e.clientHeight+"px"}),Sortable._marker.show()}},_tree:function(e,t,n){for(var i=Sortable.findElements(e,t)||[],o=0;o<i.length;++o){var r=i[o].id.match(t.format);if(r){var s={id:encodeURIComponent(r?r[1]:null),element:e,parent:n,children:[],position:n.children.length,container:$(i[o]).down(t.treeTag)};s.container&&this._tree(s.container,t,s),n.children.push(s)}}return n},tree:function(e){e=$(e);var t=this.options(e),n=Object.extend({tag:t.tag,treeTag:t.treeTag,only:t.only,name:e.id,format:t.format},arguments[1]||{}),i={id:null,parent:null,children:[],container:e,position:0};return Sortable._tree(e,n,i)},_constructIndex:function(e){var t="";do e.id&&(t="["+e.position+"]"+t);while(null!=(e=e.parent));return t},sequence:function(e){e=$(e);var t=Object.extend(this.options(e),arguments[1]||{});return $(this.findElements(e,t)||[]).map(function(e){return e.id.match(t.format)?e.id.match(t.format)[1]:""})},setSequence:function(e,t){e=$(e);var n=Object.extend(this.options(e),arguments[2]||{}),i={};this.findElements(e,n).each(function(e){e.id.match(n.format)&&(i[e.id.match(n.format)[1]]=[e,e.parentNode]),e.parentNode.removeChild(e)}),t.each(function(e){var t=i[e];t&&(t[1].appendChild(t[0]),delete i[e])})},serialize:function(e){e=$(e);var t=Object.extend(Sortable.options(e),arguments[1]||{}),n=encodeURIComponent(arguments[1]&&arguments[1].name?arguments[1].name:e.id);return t.tree?Sortable.tree(e,arguments[1]).children.map(function(e){return[n+Sortable._constructIndex(e)+"[id]="+encodeURIComponent(e.id)].concat(e.children.map(arguments.callee))
}).flatten().join("&"):Sortable.sequence(e,arguments[1]).map(function(e){return n+"[]="+encodeURIComponent(e)}).join("&")}};Element.isParent=function(e,t){return e.parentNode&&e!=t?e.parentNode==t?!0:Element.isParent(e.parentNode,t):!1},Element.findChildren=function(e,t,n,i){if(!e.hasChildNodes())return null;i=i.toUpperCase(),t&&(t=[t].flatten());var o=[];return $A(e.childNodes).each(function(e){if(!e.tagName||e.tagName.toUpperCase()!=i||t&&!Element.classNames(e).detect(function(e){return t.include(e)})||o.push(e),n){var r=Element.findChildren(e,t,n,i);r&&o.push(r)}}),o.length>0?o.flatten():[]},Element.offsetSize=function(e,t){return e["offset"+("vertical"==t||"height"==t?"Height":"Width")]},/*
 * File:        jquery.dataTables.min.js
 * Version:     1.8.2
 * Author:      Allan Jardine (www.sprymedia.co.uk)
 * Info:        www.datatables.net
 * 
 * Copyright 2008-2011 Allan Jardine, all rights reserved.
 *
 * This source file is free software, under either the GPL v2 license or a
 * BSD style license, as supplied with this software.
 * 
 * This source file is distributed in the hope that it will be useful, but 
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY 
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 */
function(i,za,p){i.fn.dataTableSettings=[];var D=i.fn.dataTableSettings;i.fn.dataTableExt={};var n=i.fn.dataTableExt;n.sVersion="1.8.2",n.sErrMode="alert",n.iApiIndex=0,n.oApi={},n.afnFiltering=[],n.aoFeatures=[],n.ofnSearch={},n.afnSortData=[],n.oStdClasses={sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next",sPageJUINext:"",sPageJUIPrev:"",sPageButton:"paginate_button",sPageButtonActive:"paginate_active",sPageButtonStaticDisabled:"paginate_button paginate_button_disabled",sPageFirst:"first",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:""},n.oJUIClasses={sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w",sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"fg-button ui-button ui-state-default ui-state-disabled",sPageButtonStaticDisabled:"fg-button ui-button ui-state-default ui-state-disabled",sPageFirst:"first ui-corner-tl ui-corner-bl",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last ui-corner-tr ui-corner-br",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"ui-state-default",sSortDesc:"ui-state-default",sSortable:"ui-state-default",sSortableAsc:"ui-state-default",sSortableDesc:"ui-state-default",sSortableNone:"ui-state-default",sSortColumn:"sorting_",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead ui-state-default",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot ui-state-default",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:"ui-state-default"},n.oPagination={two_button:{fnInit:function(e,t,n){var o,r,s;e.bJUI?(o=p.createElement("a"),r=p.createElement("a"),s=p.createElement("span"),s.className=e.oClasses.sPageJUINext,r.appendChild(s),s=p.createElement("span"),s.className=e.oClasses.sPageJUIPrev,o.appendChild(s)):(o=p.createElement("div"),r=p.createElement("div")),o.className=e.oClasses.sPagePrevDisabled,r.className=e.oClasses.sPageNextDisabled,o.title=e.oLanguage.oPaginate.sPrevious,r.title=e.oLanguage.oPaginate.sNext,t.appendChild(o),t.appendChild(r),i(o).bind("click.DT",function(){e.oApi._fnPageChange(e,"previous")&&n(e)}),i(r).bind("click.DT",function(){e.oApi._fnPageChange(e,"next")&&n(e)}),i(o).bind("selectstart.DT",function(){return!1}),i(r).bind("selectstart.DT",function(){return!1}),""!==e.sTableId&&"undefined"==typeof e.aanFeatures.p&&(t.setAttribute("id",e.sTableId+"_paginate"),o.setAttribute("id",e.sTableId+"_previous"),r.setAttribute("id",e.sTableId+"_next"))},fnUpdate:function(e){if(e.aanFeatures.p)for(var t=e.aanFeatures.p,n=0,i=t.length;i>n;n++)0!==t[n].childNodes.length&&(t[n].childNodes[0].className=0===e._iDisplayStart?e.oClasses.sPagePrevDisabled:e.oClasses.sPagePrevEnabled,t[n].childNodes[1].className=e.fnDisplayEnd()==e.fnRecordsDisplay()?e.oClasses.sPageNextDisabled:e.oClasses.sPageNextEnabled)}},iFullNumbersShowPages:5,full_numbers:{fnInit:function(e,t,n){var o=p.createElement("span"),r=p.createElement("span"),s=p.createElement("span"),a=p.createElement("span"),l=p.createElement("span");o.innerHTML=e.oLanguage.oPaginate.sFirst,r.innerHTML=e.oLanguage.oPaginate.sPrevious,a.innerHTML=e.oLanguage.oPaginate.sNext,l.innerHTML=e.oLanguage.oPaginate.sLast;var c=e.oClasses;o.className=c.sPageButton+" "+c.sPageFirst,r.className=c.sPageButton+" "+c.sPagePrevious,a.className=c.sPageButton+" "+c.sPageNext,l.className=c.sPageButton+" "+c.sPageLast,t.appendChild(o),t.appendChild(r),t.appendChild(s),t.appendChild(a),t.appendChild(l),i(o).bind("click.DT",function(){e.oApi._fnPageChange(e,"first")&&n(e)}),i(r).bind("click.DT",function(){e.oApi._fnPageChange(e,"previous")&&n(e)}),i(a).bind("click.DT",function(){e.oApi._fnPageChange(e,"next")&&n(e)}),i(l).bind("click.DT",function(){e.oApi._fnPageChange(e,"last")&&n(e)}),i("span",t).bind("mousedown.DT",function(){return!1}).bind("selectstart.DT",function(){return!1}),""!==e.sTableId&&"undefined"==typeof e.aanFeatures.p&&(t.setAttribute("id",e.sTableId+"_paginate"),o.setAttribute("id",e.sTableId+"_first"),r.setAttribute("id",e.sTableId+"_previous"),a.setAttribute("id",e.sTableId+"_next"),l.setAttribute("id",e.sTableId+"_last"))},fnUpdate:function(e,t){if(e.aanFeatures.p){var o,r=n.oPagination.iFullNumbersShowPages,s=Math.floor(r/2),a=Math.ceil(e.fnRecordsDisplay()/e._iDisplayLength),l=Math.ceil(e._iDisplayStart/e._iDisplayLength)+1,c="",u=e.oClasses;for(r>a?(s=1,o=a):s>=l?(s=1,o=r):l>=a-s?(s=a-r+1,o=a):(s=l-Math.ceil(r/2)+1,o=s+r-1),r=s;o>=r;r++)c+=l!=r?'<span class="'+u.sPageButton+'">'+r+"</span>":'<span class="'+u.sPageButtonActive+'">'+r+"</span>";o=e.aanFeatures.p;var h,d=function(n){e._iDisplayStart=(1*this.innerHTML-1)*e._iDisplayLength,t(e),n.preventDefault()},p=function(){return!1};for(r=0,s=o.length;s>r;r++)0!==o[r].childNodes.length&&(h=i("span:eq(2)",o[r]),h.html(c),i("span",h).bind("click.DT",d).bind("mousedown.DT",p).bind("selectstart.DT",p),h=o[r].getElementsByTagName("span"),h=[h[0],h[1],h[h.length-2],h[h.length-1]],i(h).removeClass(u.sPageButton+" "+u.sPageButtonActive+" "+u.sPageButtonStaticDisabled),1==l?(h[0].className+=" "+u.sPageButtonStaticDisabled,h[1].className+=" "+u.sPageButtonStaticDisabled):(h[0].className+=" "+u.sPageButton,h[1].className+=" "+u.sPageButton),0===a||l==a||-1==e._iDisplayLength?(h[2].className+=" "+u.sPageButtonStaticDisabled,h[3].className+=" "+u.sPageButtonStaticDisabled):(h[2].className+=" "+u.sPageButton,h[3].className+=" "+u.sPageButton))}}}},n.oSort={"string-asc":function(e,t){return"string"!=typeof e&&(e=""),"string"!=typeof t&&(t=""),e=e.toLowerCase(),t=t.toLowerCase(),t>e?-1:e>t?1:0},"string-desc":function(e,t){return"string"!=typeof e&&(e=""),"string"!=typeof t&&(t=""),e=e.toLowerCase(),t=t.toLowerCase(),t>e?1:e>t?-1:0},"html-asc":function(e,t){return e=e.replace(/<.*?>/g,"").toLowerCase(),t=t.replace(/<.*?>/g,"").toLowerCase(),t>e?-1:e>t?1:0},"html-desc":function(e,t){return e=e.replace(/<.*?>/g,"").toLowerCase(),t=t.replace(/<.*?>/g,"").toLowerCase(),t>e?1:e>t?-1:0},"date-asc":function(e,t){return e=Date.parse(e),t=Date.parse(t),(isNaN(e)||""===e)&&(e=Date.parse("01/01/1970 00:00:00")),(isNaN(t)||""===t)&&(t=Date.parse("01/01/1970 00:00:00")),e-t},"date-desc":function(e,t){return e=Date.parse(e),t=Date.parse(t),(isNaN(e)||""===e)&&(e=Date.parse("01/01/1970 00:00:00")),(isNaN(t)||""===t)&&(t=Date.parse("01/01/1970 00:00:00")),t-e},"numeric-asc":function(e,t){return("-"==e||""===e?0:1*e)-("-"==t||""===t?0:1*t)},"numeric-desc":function(e,t){return("-"==t||""===t?0:1*t)-("-"==e||""===e?0:1*e)}},n.aTypes=[function(e){if("number"==typeof e)return"numeric";if("string"!=typeof e)return null;var t,n=!1;if(t=e.charAt(0),-1=="0123456789-".indexOf(t))return null;for(var i=1;i<e.length;i++){if(t=e.charAt(i),-1=="0123456789.".indexOf(t))return null;if("."==t){if(n)return null;n=!0}}return"numeric"},function(e){var t=Date.parse(e);return null!==t&&!isNaN(t)||"string"==typeof e&&0===e.length?"date":null},function(e){return"string"==typeof e&&-1!=e.indexOf("<")&&-1!=e.indexOf(">")?"html":null}],n.fnVersionCheck=function(e){var t=function(e,t){for(;e.length<t;)e+="0";return e},i=n.sVersion.split(".");e=e.split(".");for(var o="",r="",s=0,a=e.length;a>s;s++)o+=t(i[s],3),r+=t(e[s],3);return parseInt(o,10)>=parseInt(r,10)},n._oExternConfig={iNextUnique:0},i.fn.dataTable=function(g){function l(){this.fnRecordsTotal=function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsTotal,10):this.aiDisplayMaster.length},this.fnRecordsDisplay=function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsDisplay,10):this.aiDisplay.length},this.fnDisplayEnd=function(){return this.oFeatures.bServerSide?this.oFeatures.bPaginate===!1||-1==this._iDisplayLength?this._iDisplayStart+this.aiDisplay.length:Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay):this._iDisplayEnd},this.sInstance=this.oInstance=null,this.oFeatures={bPaginate:!0,bLengthChange:!0,bFilter:!0,bSort:!0,bInfo:!0,bAutoWidth:!0,bProcessing:!1,bSortClasses:!0,bStateSave:!1,bServerSide:!1,bDeferRender:!1},this.oScroll={sX:"",sXInner:"",sY:"",bCollapse:!1,bInfinite:!1,iLoadGap:100,iBarWidth:0,bAutoCss:!0},this.aanFeatures=[],this.oLanguage={sProcessing:"Processing...",sLengthMenu:"Show _MENU_ entries",sZeroRecords:"No matching records found",sEmptyTable:"No data available in table",sLoadingRecords:"Loading...",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sSearch:"Search:",sUrl:"",oPaginate:{sFirst:"First",sPrevious:"Previous",sNext:"Next",sLast:"Last"},fnInfoCallback:null},this.aoData=[],this.aiDisplay=[],this.aiDisplayMaster=[],this.aoColumns=[],this.aoHeader=[],this.aoFooter=[],this.iNextId=0,this.asDataSearch=[],this.oPreviousSearch={sSearch:"",bRegex:!1,bSmart:!0},this.aoPreSearchCols=[],this.aaSorting=[[0,"asc",0]],this.aaSortingFixed=null,this.asStripeClasses=[],this.asDestroyStripes=[],this.sDestroyWidth=0,this.fnFooterCallback=this.fnHeaderCallback=this.fnRowCallback=null,this.aoDrawCallback=[],this.fnInitComplete=this.fnPreDrawCallback=null,this.sTableId="",this.nTableWrapper=this.nTBody=this.nTFoot=this.nTHead=this.nTable=null,this.bInitialised=this.bDeferLoading=!1,this.aoOpenRows=[],this.sDom="lfrtip",this.sPaginationType="two_button",this.iCookieDuration=7200,this.sCookiePrefix="SpryMedia_DataTables_",this.fnCookieCallback=null,this.aoStateSave=[],this.aoStateLoad=[],this.sAjaxSource=this.oLoadedState=null,this.sAjaxDataProp="aaData",this.bAjaxDataGet=!0,this.jqXHR=null,this.fnServerData=function(e,t,n,o){o.jqXHR=i.ajax({url:e,data:t,success:function(e){i(o.oInstance).trigger("xhr",o),n(e)},dataType:"json",cache:!1,error:function(e,t){"parsererror"==t&&alert("DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})},this.aoServerParams=[],this.fnFormatNumber=function(e){if(1e3>e)return e;var t=e+"";e=t.split("");var n="";t=t.length;for(var i=0;t>i;i++)i%3===0&&0!==i&&(n=this.oLanguage.sInfoThousands+n),n=e[t-i-1]+n;return n},this.aLengthMenu=[10,25,50,100],this.bDrawing=this.iDraw=0,this.iDrawError=-1,this._iDisplayLength=10,this._iDisplayStart=0,this._iDisplayEnd=10,this._iRecordsDisplay=this._iRecordsTotal=0,this.bJUI=!1,this.oClasses=n.oStdClasses,this.bSortCellsTop=this.bSorted=this.bFiltered=!1,this.oInit=null,this.aoDestroyCallback=[]}function s(e){return function(){var t=[A(this[n.iApiIndex])].concat(Array.prototype.slice.call(arguments));return n.oApi[e].apply(this,t)}}function t(e){var n,i,o=e.iInitDisplayStart;if(e.bInitialised===!1)setTimeout(function(){t(e)},200);else{for(Aa(e),X(e),M(e,e.aoHeader),e.nTFoot&&M(e,e.aoFooter),K(e,!0),e.oFeatures.bAutoWidth&&ga(e),n=0,i=e.aoColumns.length;i>n;n++)null!==e.aoColumns[n].sWidth&&(e.aoColumns[n].nTh.style.width=q(e.aoColumns[n].sWidth));e.oFeatures.bSort?R(e):e.oFeatures.bFilter?N(e,e.oPreviousSearch):(e.aiDisplay=e.aiDisplayMaster.slice(),E(e),C(e)),null===e.sAjaxSource||e.oFeatures.bServerSide?e.oFeatures.bServerSide||(K(e,!1),w(e)):(i=[],ha(e,i),e.fnServerData.call(e.oInstance,e.sAjaxSource,i,function(t){var i=t;for(""!==e.sAjaxDataProp&&(i=aa(e.sAjaxDataProp)(t)),n=0;n<i.length;n++)v(e,i[n]);e.iInitDisplayStart=o,e.oFeatures.bSort?R(e):(e.aiDisplay=e.aiDisplayMaster.slice(),E(e),C(e)),K(e,!1),w(e,t)},e))}}function w(e,t){e._bInitComplete=!0,"function"==typeof e.fnInitComplete&&("undefined"!=typeof t?e.fnInitComplete.call(e.oInstance,e,t):e.fnInitComplete.call(e.oInstance,e))}function y(e,n,r){e.oLanguage=i.extend(!0,e.oLanguage,n),"undefined"==typeof n.sEmptyTable&&"undefined"!=typeof n.sZeroRecords&&o(e.oLanguage,n,"sZeroRecords","sEmptyTable"),"undefined"==typeof n.sLoadingRecords&&"undefined"!=typeof n.sZeroRecords&&o(e.oLanguage,n,"sZeroRecords","sLoadingRecords"),r&&t(e)}function F(e,t){var n=e.aoColumns.length;t={sType:null,_bAutoType:!0,bVisible:!0,bSearchable:!0,bSortable:!0,asSorting:["asc","desc"],sSortingClass:e.oClasses.sSortable,sSortingClassJUI:e.oClasses.sSortJUI,sTitle:t?t.innerHTML:"",sName:"",sWidth:null,sWidthOrig:null,sClass:null,fnRender:null,bUseRendered:!0,iDataSort:n,mDataProp:n,fnGetData:null,fnSetData:null,sSortDataType:"std",sDefaultContent:null,sContentPadding:"",nTh:t?t:p.createElement("th"),nTf:null},e.aoColumns.push(t),"undefined"==typeof e.aoPreSearchCols[n]||null===e.aoPreSearchCols[n]?e.aoPreSearchCols[n]={sSearch:"",bRegex:!1,bSmart:!0}:("undefined"==typeof e.aoPreSearchCols[n].bRegex&&(e.aoPreSearchCols[n].bRegex=!0),"undefined"==typeof e.aoPreSearchCols[n].bSmart&&(e.aoPreSearchCols[n].bSmart=!0)),x(e,n,null)}function x(e,t,n){t=e.aoColumns[t],"undefined"!=typeof n&&null!==n&&("undefined"!=typeof n.sType&&(t.sType=n.sType,t._bAutoType=!1),o(t,n,"bVisible"),o(t,n,"bSearchable"),o(t,n,"bSortable"),o(t,n,"sTitle"),o(t,n,"sName"),o(t,n,"sWidth"),o(t,n,"sWidth","sWidthOrig"),o(t,n,"sClass"),o(t,n,"fnRender"),o(t,n,"bUseRendered"),o(t,n,"iDataSort"),o(t,n,"mDataProp"),o(t,n,"asSorting"),o(t,n,"sSortDataType"),o(t,n,"sDefaultContent"),o(t,n,"sContentPadding")),t.fnGetData=aa(t.mDataProp),t.fnSetData=Ba(t.mDataProp),e.oFeatures.bSort||(t.bSortable=!1),!t.bSortable||-1==i.inArray("asc",t.asSorting)&&-1==i.inArray("desc",t.asSorting)?(t.sSortingClass=e.oClasses.sSortableNone,t.sSortingClassJUI=""):t.bSortable||-1==i.inArray("asc",t.asSorting)&&-1==i.inArray("desc",t.asSorting)?(t.sSortingClass=e.oClasses.sSortable,t.sSortingClassJUI=e.oClasses.sSortJUI):-1!=i.inArray("asc",t.asSorting)&&-1==i.inArray("desc",t.asSorting)?(t.sSortingClass=e.oClasses.sSortableAsc,t.sSortingClassJUI=e.oClasses.sSortJUIAscAllowed):-1==i.inArray("asc",t.asSorting)&&-1!=i.inArray("desc",t.asSorting)&&(t.sSortingClass=e.oClasses.sSortableDesc,t.sSortingClassJUI=e.oClasses.sSortJUIDescAllowed)}function v(e,t){var n;n=i.isArray(t)?t.slice():i.extend(!0,{},t),t=e.aoData.length;var o={nTr:null,_iId:e.iNextId++,_aData:n,_anHidden:[],_sRowStripe:""};e.aoData.push(o);for(var r,s=0,a=e.aoColumns.length;a>s;s++)n=e.aoColumns[s],"function"==typeof n.fnRender&&n.bUseRendered&&null!==n.mDataProp&&O(e,t,s,n.fnRender({iDataRow:t,iDataColumn:s,aData:o._aData,oSettings:e})),n._bAutoType&&"string"!=n.sType&&(r=G(e,t,s,"type"),null!==r&&""!==r&&(r=ia(r),null===n.sType?n.sType=r:n.sType!=r&&"html"!=n.sType&&(n.sType="string")));return e.aiDisplayMaster.push(t),e.oFeatures.bDeferRender||z(e,t),t}function z(e,t){var n,o=e.aoData[t];if(null===o.nTr){o.nTr=p.createElement("tr"),"undefined"!=typeof o._aData.DT_RowId&&o.nTr.setAttribute("id",o._aData.DT_RowId),"undefined"!=typeof o._aData.DT_RowClass&&i(o.nTr).addClass(o._aData.DT_RowClass);for(var r=0,s=e.aoColumns.length;s>r;r++){var a=e.aoColumns[r];n=p.createElement("td"),n.innerHTML="function"!=typeof a.fnRender||a.bUseRendered&&null!==a.mDataProp?G(e,t,r,"display"):a.fnRender({iDataRow:t,iDataColumn:r,aData:o._aData,oSettings:e}),null!==a.sClass&&(n.className=a.sClass),a.bVisible?(o.nTr.appendChild(n),o._anHidden[r]=null):o._anHidden[r]=n}}}function $(e){var t,n,o,r,s,a,l,c,u;if(e.bDeferLoading||null===e.sAjaxSource)for(l=e.nTBody.childNodes,t=0,n=l.length;n>t;t++)if("TR"==l[t].nodeName.toUpperCase())for(c=e.aoData.length,e.aoData.push({nTr:l[t],_iId:e.iNextId++,_aData:[],_anHidden:[],_sRowStripe:""}),e.aiDisplayMaster.push(c),a=l[t].childNodes,o=s=0,r=a.length;r>o;o++)u=a[o].nodeName.toUpperCase(),("TD"==u||"TH"==u)&&(O(e,c,s,i.trim(a[o].innerHTML)),s++);for(l=ba(e),a=[],t=0,n=l.length;n>t;t++)for(o=0,r=l[t].childNodes.length;r>o;o++)s=l[t].childNodes[o],u=s.nodeName.toUpperCase(),("TD"==u||"TH"==u)&&a.push(s);for(a.length!=l.length*e.aoColumns.length&&J(e,1,"Unexpected number of TD elements. Expected "+l.length*e.aoColumns.length+" and got "+a.length+". DataTables does not support rowspan / colspan in the table body, and there must be one cell for each row/column combination."),o=0,r=e.aoColumns.length;r>o;o++){null===e.aoColumns[o].sTitle&&(e.aoColumns[o].sTitle=e.aoColumns[o].nTh.innerHTML),l=e.aoColumns[o]._bAutoType,u="function"==typeof e.aoColumns[o].fnRender,s=null!==e.aoColumns[o].sClass,c=e.aoColumns[o].bVisible;var h,d;if(l||u||s||!c)for(t=0,n=e.aoData.length;n>t;t++)h=a[t*r+o],l&&"string"!=e.aoColumns[o].sType&&(d=G(e,t,o,"type"),""!==d&&(d=ia(d),null===e.aoColumns[o].sType?e.aoColumns[o].sType=d:e.aoColumns[o].sType!=d&&"html"!=e.aoColumns[o].sType&&(e.aoColumns[o].sType="string"))),u&&(d=e.aoColumns[o].fnRender({iDataRow:t,iDataColumn:o,aData:e.aoData[t]._aData,oSettings:e}),h.innerHTML=d,e.aoColumns[o].bUseRendered&&O(e,t,o,d)),s&&(h.className+=" "+e.aoColumns[o].sClass),c?e.aoData[t]._anHidden[o]=null:(e.aoData[t]._anHidden[o]=h,h.parentNode.removeChild(h))}}function X(e){var t,n,o;if(e.nTHead.getElementsByTagName("tr"),0!==e.nTHead.getElementsByTagName("th").length)for(t=0,o=e.aoColumns.length;o>t;t++)n=e.aoColumns[t].nTh,null!==e.aoColumns[t].sClass&&i(n).addClass(e.aoColumns[t].sClass),e.aoColumns[t].sTitle!=n.innerHTML&&(n.innerHTML=e.aoColumns[t].sTitle);else{var r=p.createElement("tr");for(t=0,o=e.aoColumns.length;o>t;t++)n=e.aoColumns[t].nTh,n.innerHTML=e.aoColumns[t].sTitle,null!==e.aoColumns[t].sClass&&i(n).addClass(e.aoColumns[t].sClass),r.appendChild(n);i(e.nTHead).html("")[0].appendChild(r),Y(e.aoHeader,e.nTHead)}if(e.bJUI)for(t=0,o=e.aoColumns.length;o>t;t++){n=e.aoColumns[t].nTh,r=p.createElement("div"),r.className=e.oClasses.sSortJUIWrapper,i(n).contents().appendTo(r);var s=p.createElement("span");s.className=e.oClasses.sSortIcon,r.appendChild(s),n.appendChild(r)}if(o=function(){return this.onselectstart=function(){return!1},!1},e.oFeatures.bSort)for(t=0;t<e.aoColumns.length;t++)e.aoColumns[t].bSortable!==!1?(ja(e,e.aoColumns[t].nTh,t),i(e.aoColumns[t].nTh).bind("mousedown.DT",o)):i(e.aoColumns[t].nTh).addClass(e.oClasses.sSortableNone);if(""!==e.oClasses.sFooterTH&&i(e.nTFoot).children("tr").children("th").addClass(e.oClasses.sFooterTH),null!==e.nTFoot)for(n=S(e,null,e.aoFooter),t=0,o=e.aoColumns.length;o>t;t++)"undefined"!=typeof n[t]&&(e.aoColumns[t].nTf=n[t])}function M(e,t,n){var i,o,r,s=[],a=[],l=e.aoColumns.length;for("undefined"==typeof n&&(n=!1),i=0,o=t.length;o>i;i++){for(s[i]=t[i].slice(),s[i].nTr=t[i].nTr,r=l-1;r>=0;r--)!e.aoColumns[r].bVisible&&!n&&s[i].splice(r,1);a.push([])}for(i=0,o=s.length;o>i;i++){if(s[i].nTr)for(e=0,r=s[i].nTr.childNodes.length;r>e;e++)s[i].nTr.removeChild(s[i].nTr.childNodes[0]);for(r=0,t=s[i].length;t>r;r++)if(l=n=1,"undefined"==typeof a[i][r]){for(s[i].nTr.appendChild(s[i][r].cell),a[i][r]=1;"undefined"!=typeof s[i+n]&&s[i][r].cell==s[i+n][r].cell;)a[i+n][r]=1,n++;for(;"undefined"!=typeof s[i][r+l]&&s[i][r].cell==s[i][r+l].cell;){for(e=0;n>e;e++)a[i+e][r+l]=1;l++}s[i][r].cell.rowSpan=n,s[i][r].cell.colSpan=l}}}function C(e){var t,n,o=[],r=0,s=!1;if(t=e.asStripeClasses.length,n=e.aoOpenRows.length,null===e.fnPreDrawCallback||e.fnPreDrawCallback.call(e.oInstance,e)!==!1){if(e.bDrawing=!0,"undefined"!=typeof e.iInitDisplayStart&&-1!=e.iInitDisplayStart&&(e._iDisplayStart=e.oFeatures.bServerSide?e.iInitDisplayStart:e.iInitDisplayStart>=e.fnRecordsDisplay()?0:e.iInitDisplayStart,e.iInitDisplayStart=-1,E(e)),e.bDeferLoading)e.bDeferLoading=!1,e.iDraw++;else if(e.oFeatures.bServerSide){if(!e.bDestroying&&!Ca(e))return}else e.iDraw++;if(0!==e.aiDisplay.length){var a=e._iDisplayStart,l=e._iDisplayEnd;for(e.oFeatures.bServerSide&&(a=0,l=e.aoData.length),a=a;l>a;a++){var c=e.aoData[e.aiDisplay[a]];null===c.nTr&&z(e,e.aiDisplay[a]);var u=c.nTr;if(0!==t){var h=e.asStripeClasses[r%t];c._sRowStripe!=h&&(i(u).removeClass(c._sRowStripe).addClass(h),c._sRowStripe=h)}if("function"==typeof e.fnRowCallback&&(u=e.fnRowCallback.call(e.oInstance,u,e.aoData[e.aiDisplay[a]]._aData,r,a),u||s||(J(e,0,"A node was not returned by fnRowCallback"),s=!0)),o.push(u),r++,0!==n)for(c=0;n>c;c++)u==e.aoOpenRows[c].nParent&&o.push(e.aoOpenRows[c].nTr)}}else o[0]=p.createElement("tr"),"undefined"!=typeof e.asStripeClasses[0]&&(o[0].className=e.asStripeClasses[0]),s=e.oLanguage.sZeroRecords.replace("_MAX_",e.fnFormatNumber(e.fnRecordsTotal())),1!=e.iDraw||null===e.sAjaxSource||e.oFeatures.bServerSide?"undefined"!=typeof e.oLanguage.sEmptyTable&&0===e.fnRecordsTotal()&&(s=e.oLanguage.sEmptyTable):s=e.oLanguage.sLoadingRecords,t=p.createElement("td"),t.setAttribute("valign","top"),t.colSpan=Z(e),t.className=e.oClasses.sRowEmpty,t.innerHTML=s,o[r].appendChild(t);if("function"==typeof e.fnHeaderCallback&&e.fnHeaderCallback.call(e.oInstance,i(e.nTHead).children("tr")[0],ca(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay),"function"==typeof e.fnFooterCallback&&e.fnFooterCallback.call(e.oInstance,i(e.nTFoot).children("tr")[0],ca(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay),r=p.createDocumentFragment(),t=p.createDocumentFragment(),e.nTBody){if(s=e.nTBody.parentNode,t.appendChild(e.nTBody),!e.oScroll.bInfinite||!e._bInitComplete||e.bSorted||e.bFiltered)for(n=e.nTBody.childNodes,t=n.length-1;t>=0;t--)n[t].parentNode.removeChild(n[t]);for(t=0,n=o.length;n>t;t++)r.appendChild(o[t]);e.nTBody.appendChild(r),null!==s&&s.appendChild(e.nTBody)}for(t=e.aoDrawCallback.length-1;t>=0;t--)e.aoDrawCallback[t].fn.call(e.oInstance,e);i(e.oInstance).trigger("draw",e),e.bSorted=!1,e.bFiltered=!1,e.bDrawing=!1,e.oFeatures.bServerSide&&(K(e,!1),"undefined"==typeof e._bInitComplete&&w(e))}}function da(e){e.oFeatures.bSort?R(e,e.oPreviousSearch):e.oFeatures.bFilter?N(e,e.oPreviousSearch):(E(e),C(e))}function Ca(e){if(e.bAjaxDataGet){e.iDraw++,K(e,!0);var t=Da(e);return ha(e,t),e.fnServerData.call(e.oInstance,e.sAjaxSource,t,function(t){Ea(e,t)},e),!1}return!0}function Da(e){var t,n,i=e.aoColumns.length,o=[];for(o.push({name:"sEcho",value:e.iDraw}),o.push({name:"iColumns",value:i}),o.push({name:"sColumns",value:ka(e)}),o.push({name:"iDisplayStart",value:e._iDisplayStart}),o.push({name:"iDisplayLength",value:e.oFeatures.bPaginate!==!1?e._iDisplayLength:-1}),n=0;i>n;n++)t=e.aoColumns[n].mDataProp,o.push({name:"mDataProp_"+n,value:"function"==typeof t?"function":t});if(e.oFeatures.bFilter!==!1)for(o.push({name:"sSearch",value:e.oPreviousSearch.sSearch}),o.push({name:"bRegex",value:e.oPreviousSearch.bRegex}),n=0;i>n;n++)o.push({name:"sSearch_"+n,value:e.aoPreSearchCols[n].sSearch}),o.push({name:"bRegex_"+n,value:e.aoPreSearchCols[n].bRegex}),o.push({name:"bSearchable_"+n,value:e.aoColumns[n].bSearchable});if(e.oFeatures.bSort!==!1){t=null!==e.aaSortingFixed?e.aaSortingFixed.length:0;var r=e.aaSorting.length;for(o.push({name:"iSortingCols",value:t+r}),n=0;t>n;n++)o.push({name:"iSortCol_"+n,value:e.aaSortingFixed[n][0]}),o.push({name:"sSortDir_"+n,value:e.aaSortingFixed[n][1]});for(n=0;r>n;n++)o.push({name:"iSortCol_"+(n+t),value:e.aaSorting[n][0]}),o.push({name:"sSortDir_"+(n+t),value:e.aaSorting[n][1]});for(n=0;i>n;n++)o.push({name:"bSortable_"+n,value:e.aoColumns[n].bSortable})}return o}function ha(e,t){for(var n=0,i=e.aoServerParams.length;i>n;n++)e.aoServerParams[n].fn.call(e.oInstance,t)}function Ea(e,t){if("undefined"!=typeof t.sEcho){if(1*t.sEcho<e.iDraw)return;e.iDraw=1*t.sEcho}(!e.oScroll.bInfinite||e.oScroll.bInfinite&&(e.bSorted||e.bFiltered))&&la(e),e._iRecordsTotal=t.iTotalRecords,e._iRecordsDisplay=t.iTotalDisplayRecords;var n=ka(e);if(n="undefined"!=typeof t.sColumns&&""!==n&&t.sColumns!=n)var i=Fa(e,t.sColumns);t=aa(e.sAjaxDataProp)(t);for(var o=0,r=t.length;r>o;o++)if(n){for(var s=[],a=0,l=e.aoColumns.length;l>a;a++)s.push(t[o][i[a]]);v(e,s)}else v(e,t[o]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,C(e),e.bAjaxDataGet=!0,K(e,!1)}function Aa(e){var t=p.createElement("div");e.nTable.parentNode.insertBefore(t,e.nTable),e.nTableWrapper=p.createElement("div"),e.nTableWrapper.className=e.oClasses.sWrapper,""!==e.sTableId&&e.nTableWrapper.setAttribute("id",e.sTableId+"_wrapper"),e.nTableReinsertBefore=e.nTable.nextSibling;for(var i,o,r,s,a,l,c,u=e.nTableWrapper,h=e.sDom.split(""),d=0;d<h.length;d++){if(o=0,r=h[d],"<"==r){if(s=p.createElement("div"),a=h[d+1],"'"==a||'"'==a){for(l="",c=2;h[d+c]!=a;)l+=h[d+c],c++;"H"==l?l="fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix":"F"==l&&(l="fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"),-1!=l.indexOf(".")?(a=l.split("."),s.setAttribute("id",a[0].substr(1,a[0].length-1)),s.className=a[1]):"#"==l.charAt(0)?s.setAttribute("id",l.substr(1,l.length-1)):s.className=l,d+=c}u.appendChild(s),u=s}else if(">"==r)u=u.parentNode;else if("l"==r&&e.oFeatures.bPaginate&&e.oFeatures.bLengthChange)i=Ga(e),o=1;else if("f"==r&&e.oFeatures.bFilter)i=Ha(e),o=1;else if("r"==r&&e.oFeatures.bProcessing)i=Ia(e),o=1;else if("t"==r)i=Ja(e),o=1;else if("i"==r&&e.oFeatures.bInfo)i=Ka(e),o=1;else if("p"==r&&e.oFeatures.bPaginate)i=La(e),o=1;else if(0!==n.aoFeatures.length)for(s=n.aoFeatures,c=0,a=s.length;a>c;c++)if(r==s[c].cFeature){(i=s[c].fnInit(e))&&(o=1);break}1==o&&null!==i&&("object"!=typeof e.aanFeatures[r]&&(e.aanFeatures[r]=[]),e.aanFeatures[r].push(i),u.appendChild(i))}t.parentNode.replaceChild(e.nTableWrapper,t)}function Ja(e){if(""===e.oScroll.sX&&""===e.oScroll.sY)return e.nTable;var t=p.createElement("div"),o=p.createElement("div"),r=p.createElement("div"),s=p.createElement("div"),a=p.createElement("div"),l=p.createElement("div"),c=e.nTable.cloneNode(!1),u=e.nTable.cloneNode(!1),h=e.nTable.getElementsByTagName("thead")[0],d=0===e.nTable.getElementsByTagName("tfoot").length?null:e.nTable.getElementsByTagName("tfoot")[0],f="undefined"!=typeof g.bJQueryUI&&g.bJQueryUI?n.oJUIClasses:n.oStdClasses;for(o.appendChild(r),a.appendChild(l),s.appendChild(e.nTable),t.appendChild(o),t.appendChild(s),r.appendChild(c),c.appendChild(h),null!==d&&(t.appendChild(a),l.appendChild(u),u.appendChild(d)),t.className=f.sScrollWrapper,o.className=f.sScrollHead,r.className=f.sScrollHeadInner,s.className=f.sScrollBody,a.className=f.sScrollFoot,l.className=f.sScrollFootInner,e.oScroll.bAutoCss&&(o.style.overflow="hidden",o.style.position="relative",a.style.overflow="hidden",s.style.overflow="auto"),o.style.border="0",o.style.width="100%",a.style.border="0",r.style.width="150%",c.removeAttribute("id"),c.style.marginLeft="0",e.nTable.style.marginLeft="0",null!==d&&(u.removeAttribute("id"),u.style.marginLeft="0"),r=i(e.nTable).children("caption"),l=0,u=r.length;u>l;l++)c.appendChild(r[l]);return""!==e.oScroll.sX&&(o.style.width=q(e.oScroll.sX),s.style.width=q(e.oScroll.sX),null!==d&&(a.style.width=q(e.oScroll.sX)),i(s).scroll(function(){o.scrollLeft=this.scrollLeft,null!==d&&(a.scrollLeft=this.scrollLeft)})),""!==e.oScroll.sY&&(s.style.height=q(e.oScroll.sY)),e.aoDrawCallback.push({fn:Ma,sName:"scrolling"}),e.oScroll.bInfinite&&i(s).scroll(function(){e.bDrawing||i(this).scrollTop()+i(this).height()>i(e.nTable).height()-e.oScroll.iLoadGap&&e.fnDisplayEnd()<e.fnRecordsDisplay()&&(ma(e,"next"),E(e),C(e))}),e.nScrollHead=o,e.nScrollFoot=a,t}function Ma(e){var t,n,o,r,s,a,l,c,u=e.nScrollHead.getElementsByTagName("div")[0],h=u.getElementsByTagName("table")[0],d=e.nTable.parentNode,p=[],f=null!==e.nTFoot?e.nScrollFoot.getElementsByTagName("div")[0]:null,m=null!==e.nTFoot?f.getElementsByTagName("table")[0]:null,g=i.browser.msie&&i.browser.version<=7;o=e.nTable.getElementsByTagName("thead"),o.length>0&&e.nTable.removeChild(o[0]),null!==e.nTFoot&&(s=e.nTable.getElementsByTagName("tfoot"),s.length>0&&e.nTable.removeChild(s[0])),o=e.nTHead.cloneNode(!0),e.nTable.insertBefore(o,e.nTable.childNodes[0]),null!==e.nTFoot&&(s=e.nTFoot.cloneNode(!0),e.nTable.insertBefore(s,e.nTable.childNodes[1])),""===e.oScroll.sX&&(d.style.width="100%",u.parentNode.style.width="100%");var v=S(e,o);for(t=0,n=v.length;n>t;t++)l=Na(e,t),v[t].style.width=e.aoColumns[l].sWidth;null!==e.nTFoot&&P(function(e){e.style.width=""},s.getElementsByTagName("tr")),t=i(e.nTable).outerWidth(),""===e.oScroll.sX?(e.nTable.style.width="100%",g&&(d.scrollHeight>d.offsetHeight||"scroll"==i(d).css("overflow-y"))&&(e.nTable.style.width=q(i(e.nTable).outerWidth()-e.oScroll.iBarWidth))):""!==e.oScroll.sXInner?e.nTable.style.width=q(e.oScroll.sXInner):t==i(d).width()&&i(d).height()<i(e.nTable).height()?(e.nTable.style.width=q(t-e.oScroll.iBarWidth),i(e.nTable).outerWidth()>t-e.oScroll.iBarWidth&&(e.nTable.style.width=q(t))):e.nTable.style.width=q(t),t=i(e.nTable).outerWidth(),n=e.nTHead.getElementsByTagName("tr"),o=o.getElementsByTagName("tr"),P(function(e,t){a=e.style,a.paddingTop="0",a.paddingBottom="0",a.borderTopWidth="0",a.borderBottomWidth="0",a.height=0,c=i(e).width(),t.style.width=q(c),p.push(c)},o,n),i(o).height(0),null!==e.nTFoot&&(r=s.getElementsByTagName("tr"),s=e.nTFoot.getElementsByTagName("tr"),P(function(e,t){a=e.style,a.paddingTop="0",a.paddingBottom="0",a.borderTopWidth="0",a.borderBottomWidth="0",a.height=0,c=i(e).width(),t.style.width=q(c),p.push(c)},r,s),i(r).height(0)),P(function(e){e.innerHTML="",e.style.width=q(p.shift())},o),null!==e.nTFoot&&P(function(e){e.innerHTML="",e.style.width=q(p.shift())},r),i(e.nTable).outerWidth()<t?(r=d.scrollHeight>d.offsetHeight||"scroll"==i(d).css("overflow-y")?t+e.oScroll.iBarWidth:t,g&&(d.scrollHeight>d.offsetHeight||"scroll"==i(d).css("overflow-y"))&&(e.nTable.style.width=q(r-e.oScroll.iBarWidth)),d.style.width=q(r),u.parentNode.style.width=q(r),null!==e.nTFoot&&(f.parentNode.style.width=q(r)),""===e.oScroll.sX?J(e,1,"The table cannot fit into the current element which will cause column misalignment. The table has been drawn at its minimum possible width."):""!==e.oScroll.sXInner&&J(e,1,"The table cannot fit into the current element which will cause column misalignment. Increase the sScrollXInner value or remove it to allow automatic calculation")):(d.style.width=q("100%"),u.parentNode.style.width=q("100%"),null!==e.nTFoot&&(f.parentNode.style.width=q("100%"))),""===e.oScroll.sY&&g&&(d.style.height=q(e.nTable.offsetHeight+e.oScroll.iBarWidth)),""!==e.oScroll.sY&&e.oScroll.bCollapse&&(d.style.height=q(e.oScroll.sY),g=""!==e.oScroll.sX&&e.nTable.offsetWidth>d.offsetWidth?e.oScroll.iBarWidth:0,e.nTable.offsetHeight<d.offsetHeight&&(d.style.height=q(i(e.nTable).height()+g))),g=i(e.nTable).outerWidth(),h.style.width=q(g),u.style.width=q(g+e.oScroll.iBarWidth),null!==e.nTFoot&&(f.style.width=q(e.nTable.offsetWidth+e.oScroll.iBarWidth),m.style.width=q(e.nTable.offsetWidth)),(e.bSorted||e.bFiltered)&&(d.scrollTop=0)}function ea(e){if(e.oFeatures.bAutoWidth===!1)return!1;ga(e);for(var t=0,n=e.aoColumns.length;n>t;t++)e.aoColumns[t].nTh.style.width=e.aoColumns[t].sWidth}function Ha(e){var t=e.oLanguage.sSearch;t=-1!==t.indexOf("_INPUT_")?t.replace("_INPUT_",'<input type="text" />'):""===t?'<input type="text" />':t+' <input type="text" />';var n=p.createElement("div");return n.className=e.oClasses.sFilter,n.innerHTML="<label>"+t+"</label>",""!==e.sTableId&&"undefined"==typeof e.aanFeatures.f&&n.setAttribute("id",e.sTableId+"_filter"),t=i("input",n),t.val(e.oPreviousSearch.sSearch.replace('"',"&quot;")),t.bind("keyup.DT",function(){for(var t=e.aanFeatures.f,n=0,o=t.length;o>n;n++)t[n]!=i(this).parents("div.dataTables_filter")[0]&&i("input",t[n]).val(this.value);
this.value!=e.oPreviousSearch.sSearch&&N(e,{sSearch:this.value,bRegex:e.oPreviousSearch.bRegex,bSmart:e.oPreviousSearch.bSmart})}),t.bind("keypress.DT",function(e){return 13==e.keyCode?!1:void 0}),n}function N(e,t,o){for(Oa(e,t.sSearch,o,t.bRegex,t.bSmart),t=0;t<e.aoPreSearchCols.length;t++)Pa(e,e.aoPreSearchCols[t].sSearch,t,e.aoPreSearchCols[t].bRegex,e.aoPreSearchCols[t].bSmart);0!==n.afnFiltering.length&&Qa(e),e.bFiltered=!0,i(e.oInstance).trigger("filter",e),e._iDisplayStart=0,E(e),C(e),oa(e,0)}function Qa(e){for(var t=n.afnFiltering,i=0,o=t.length;o>i;i++)for(var r=0,s=0,a=e.aiDisplay.length;a>s;s++){var l=e.aiDisplay[s-r];t[i](e,fa(e,l,"filter"),l)||(e.aiDisplay.splice(s-r,1),r++)}}function Pa(e,t,n,i,o){if(""!==t){var r=0;for(t=pa(t,i,o),i=e.aiDisplay.length-1;i>=0;i--)o=qa(G(e,e.aiDisplay[i],n,"filter"),e.aoColumns[n].sType),t.test(o)||(e.aiDisplay.splice(i,1),r++)}}function Oa(e,t,i,o,r){var s=pa(t,o,r);if(("undefined"==typeof i||null===i)&&(i=0),0!==n.afnFiltering.length&&(i=1),t.length<=0)e.aiDisplay.splice(0,e.aiDisplay.length),e.aiDisplay=e.aiDisplayMaster.slice();else if(e.aiDisplay.length==e.aiDisplayMaster.length||e.oPreviousSearch.sSearch.length>t.length||1==i||0!==t.indexOf(e.oPreviousSearch.sSearch))for(e.aiDisplay.splice(0,e.aiDisplay.length),oa(e,1),i=0;i<e.aiDisplayMaster.length;i++)s.test(e.asDataSearch[i])&&e.aiDisplay.push(e.aiDisplayMaster[i]);else{var a=0;for(i=0;i<e.asDataSearch.length;i++)s.test(e.asDataSearch[i])||(e.aiDisplay.splice(i-a,1),a++)}e.oPreviousSearch.sSearch=t,e.oPreviousSearch.bRegex=o,e.oPreviousSearch.bSmart=r}function oa(e,t){if(!e.oFeatures.bServerSide){e.asDataSearch.splice(0,e.asDataSearch.length),t="undefined"!=typeof t&&1==t?e.aiDisplayMaster:e.aiDisplay;for(var n=0,i=t.length;i>n;n++)e.asDataSearch[n]=ra(e,fa(e,t[n],"filter"))}}function ra(e,t){var n="";"undefined"==typeof e.__nTmpFilter&&(e.__nTmpFilter=p.createElement("div"));for(var i=e.__nTmpFilter,o=0,r=e.aoColumns.length;r>o;o++)e.aoColumns[o].bSearchable&&(n+=qa(t[o],e.aoColumns[o].sType)+"  ");return-1!==n.indexOf("&")&&(i.innerHTML=n,n=i.textContent?i.textContent:i.innerText,n=n.replace(/\n/g," ").replace(/\r/g,"")),n}function pa(e,t,n){return n?(e=t?e.split(" "):sa(e).split(" "),e="^(?=.*?"+e.join(")(?=.*?")+").*$",new RegExp(e,"i")):(e=t?e:sa(e),new RegExp(e,"i"))}function qa(e,t){return"function"==typeof n.ofnSearch[t]?n.ofnSearch[t](e):"html"==t?e.replace(/\n/g," ").replace(/<.*?>/g,""):"string"==typeof e?e.replace(/\n/g," "):null===e?"":e}function R(e,t){var o,r,s,a,l=[],c=[],u=n.oSort;r=e.aoData;var h=e.aoColumns;if(!e.oFeatures.bServerSide&&(0!==e.aaSorting.length||null!==e.aaSortingFixed)){for(l=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),o=0;o<l.length;o++){var d=l[o][0];if(s=ta(e,d),a=e.aoColumns[d].sSortDataType,"undefined"!=typeof n.afnSortData[a]){var p=n.afnSortData[a](e,d,s);for(s=0,a=r.length;a>s;s++)O(e,s,d,p[s])}}for(o=0,r=e.aiDisplayMaster.length;r>o;o++)c[e.aiDisplayMaster[o]]=o;var f=l.length;e.aiDisplayMaster.sort(function(t,n){var i,r;for(o=0;f>o;o++)if(i=h[l[o][0]].iDataSort,r=h[i].sType,i=u[(r?r:"string")+"-"+l[o][1]](G(e,t,i,"sort"),G(e,n,i,"sort")),0!==i)return i;return u["numeric-asc"](c[t],c[n])})}"undefined"!=typeof t&&!t||e.oFeatures.bDeferRender||V(e),e.bSorted=!0,i(e.oInstance).trigger("sort",e),e.oFeatures.bFilter?N(e,e.oPreviousSearch,1):(e.aiDisplay=e.aiDisplayMaster.slice(),e._iDisplayStart=0,E(e),C(e))}function ja(e,t,n,o){i(t).bind("click.DT",function(t){if(e.aoColumns[n].bSortable!==!1){var i=function(){var i,o;if(t.shiftKey){for(var r=!1,s=0;s<e.aaSorting.length;s++)if(e.aaSorting[s][0]==n){r=!0,i=e.aaSorting[s][0],o=e.aaSorting[s][2]+1,"undefined"==typeof e.aoColumns[i].asSorting[o]?e.aaSorting.splice(s,1):(e.aaSorting[s][1]=e.aoColumns[i].asSorting[o],e.aaSorting[s][2]=o);break}r===!1&&e.aaSorting.push([n,e.aoColumns[n].asSorting[0],0])}else 1==e.aaSorting.length&&e.aaSorting[0][0]==n?(i=e.aaSorting[0][0],o=e.aaSorting[0][2]+1,"undefined"==typeof e.aoColumns[i].asSorting[o]&&(o=0),e.aaSorting[0][1]=e.aoColumns[i].asSorting[o],e.aaSorting[0][2]=o):(e.aaSorting.splice(0,e.aaSorting.length),e.aaSorting.push([n,e.aoColumns[n].asSorting[0],0]));R(e)};e.oFeatures.bProcessing?(K(e,!0),setTimeout(function(){i(),e.oFeatures.bServerSide||K(e,!1)},0)):i(),"function"==typeof o&&o(e)}})}function V(e){var t,n,o,r,s,a=e.aoColumns.length,l=e.oClasses;for(t=0;a>t;t++)e.aoColumns[t].bSortable&&i(e.aoColumns[t].nTh).removeClass(l.sSortAsc+" "+l.sSortDesc+" "+e.aoColumns[t].sSortingClass);for(r=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),t=0;t<e.aoColumns.length;t++)if(e.aoColumns[t].bSortable){for(s=e.aoColumns[t].sSortingClass,o=-1,n=0;n<r.length;n++)if(r[n][0]==t){s="asc"==r[n][1]?l.sSortAsc:l.sSortDesc,o=n;break}i(e.aoColumns[t].nTh).addClass(s),e.bJUI&&(n=i("span",e.aoColumns[t].nTh),n.removeClass(l.sSortJUIAsc+" "+l.sSortJUIDesc+" "+l.sSortJUI+" "+l.sSortJUIAscAllowed+" "+l.sSortJUIDescAllowed),n.addClass(-1==o?e.aoColumns[t].sSortingClassJUI:"asc"==r[o][1]?l.sSortJUIAsc:l.sSortJUIDesc))}else i(e.aoColumns[t].nTh).addClass(e.aoColumns[t].sSortingClass);if(s=l.sSortColumn,e.oFeatures.bSort&&e.oFeatures.bSortClasses){if(o=Q(e),e.oFeatures.bDeferRender)i(o).removeClass(s+"1 "+s+"2 "+s+"3");else if(o.length>=a)for(t=0;a>t;t++)if(-1!=o[t].className.indexOf(s+"1"))for(n=0,e=o.length/a;e>n;n++)o[a*n+t].className=i.trim(o[a*n+t].className.replace(s+"1",""));else if(-1!=o[t].className.indexOf(s+"2"))for(n=0,e=o.length/a;e>n;n++)o[a*n+t].className=i.trim(o[a*n+t].className.replace(s+"2",""));else if(-1!=o[t].className.indexOf(s+"3"))for(n=0,e=o.length/a;e>n;n++)o[a*n+t].className=i.trim(o[a*n+t].className.replace(" "+s+"3",""));l=1;var c;for(t=0;t<r.length;t++){for(c=parseInt(r[t][0],10),n=0,e=o.length/a;e>n;n++)o[a*n+c].className+=" "+s+l;3>l&&l++}}}function La(e){if(e.oScroll.bInfinite)return null;var t=p.createElement("div");return t.className=e.oClasses.sPaging+e.sPaginationType,n.oPagination[e.sPaginationType].fnInit(e,t,function(e){E(e),C(e)}),"undefined"==typeof e.aanFeatures.p&&e.aoDrawCallback.push({fn:function(e){n.oPagination[e.sPaginationType].fnUpdate(e,function(e){E(e),C(e)})},sName:"pagination"}),t}function ma(e,t){var n=e._iDisplayStart;return"first"==t?e._iDisplayStart=0:"previous"==t?(e._iDisplayStart=e._iDisplayLength>=0?e._iDisplayStart-e._iDisplayLength:0,e._iDisplayStart<0&&(e._iDisplayStart=0)):"next"==t?e._iDisplayLength>=0?e._iDisplayStart+e._iDisplayLength<e.fnRecordsDisplay()&&(e._iDisplayStart+=e._iDisplayLength):e._iDisplayStart=0:"last"==t?e._iDisplayLength>=0?(t=parseInt((e.fnRecordsDisplay()-1)/e._iDisplayLength,10)+1,e._iDisplayStart=(t-1)*e._iDisplayLength):e._iDisplayStart=0:J(e,0,"Unknown paging action: "+t),i(e.oInstance).trigger("page",e),n!=e._iDisplayStart}function Ka(e){var t=p.createElement("div");return t.className=e.oClasses.sInfo,"undefined"==typeof e.aanFeatures.i&&(e.aoDrawCallback.push({fn:Ra,sName:"information"}),""!==e.sTableId&&t.setAttribute("id",e.sTableId+"_info")),t}function Ra(e){if(e.oFeatures.bInfo&&0!==e.aanFeatures.i.length){var t=e._iDisplayStart+1,n=e.fnDisplayEnd(),o=e.fnRecordsTotal(),r=e.fnRecordsDisplay(),s=e.fnFormatNumber(t),a=e.fnFormatNumber(n),l=e.fnFormatNumber(o),c=e.fnFormatNumber(r);for(e.oScroll.bInfinite&&(s=e.fnFormatNumber(1)),s=0===e.fnRecordsDisplay()&&e.fnRecordsDisplay()==e.fnRecordsTotal()?e.oLanguage.sInfoEmpty+e.oLanguage.sInfoPostFix:0===e.fnRecordsDisplay()?e.oLanguage.sInfoEmpty+" "+e.oLanguage.sInfoFiltered.replace("_MAX_",l)+e.oLanguage.sInfoPostFix:e.fnRecordsDisplay()==e.fnRecordsTotal()?e.oLanguage.sInfo.replace("_START_",s).replace("_END_",a).replace("_TOTAL_",c)+e.oLanguage.sInfoPostFix:e.oLanguage.sInfo.replace("_START_",s).replace("_END_",a).replace("_TOTAL_",c)+" "+e.oLanguage.sInfoFiltered.replace("_MAX_",e.fnFormatNumber(e.fnRecordsTotal()))+e.oLanguage.sInfoPostFix,null!==e.oLanguage.fnInfoCallback&&(s=e.oLanguage.fnInfoCallback(e,t,n,o,r,s)),e=e.aanFeatures.i,t=0,n=e.length;n>t;t++)i(e[t]).html(s)}}function Ga(e){if(e.oScroll.bInfinite)return null;var t,n,o='<select size="1" '+(""===e.sTableId?"":'name="'+e.sTableId+'_length"')+">";if(2==e.aLengthMenu.length&&"object"==typeof e.aLengthMenu[0]&&"object"==typeof e.aLengthMenu[1])for(t=0,n=e.aLengthMenu[0].length;n>t;t++)o+='<option value="'+e.aLengthMenu[0][t]+'">'+e.aLengthMenu[1][t]+"</option>";else for(t=0,n=e.aLengthMenu.length;n>t;t++)o+='<option value="'+e.aLengthMenu[t]+'">'+e.aLengthMenu[t]+"</option>";o+="</select>";var r=p.createElement("div");return""!==e.sTableId&&"undefined"==typeof e.aanFeatures.l&&r.setAttribute("id",e.sTableId+"_length"),r.className=e.oClasses.sLength,r.innerHTML="<label>"+e.oLanguage.sLengthMenu.replace("_MENU_",o)+"</label>",i('select option[value="'+e._iDisplayLength+'"]',r).attr("selected",!0),i("select",r).bind("change.DT",function(){var o=i(this).val(),r=e.aanFeatures.l;for(t=0,n=r.length;n>t;t++)r[t]!=this.parentNode&&i("select",r[t]).val(o);e._iDisplayLength=parseInt(o,10),E(e),e.fnDisplayEnd()==e.fnRecordsDisplay()&&(e._iDisplayStart=e.fnDisplayEnd()-e._iDisplayLength,e._iDisplayStart<0&&(e._iDisplayStart=0)),-1==e._iDisplayLength&&(e._iDisplayStart=0),C(e)}),r}function Ia(e){var t=p.createElement("div");return""!==e.sTableId&&"undefined"==typeof e.aanFeatures.r&&t.setAttribute("id",e.sTableId+"_processing"),t.innerHTML=e.oLanguage.sProcessing,t.className=e.oClasses.sProcessing,e.nTable.parentNode.insertBefore(t,e.nTable),t}function K(e,t){if(e.oFeatures.bProcessing){e=e.aanFeatures.r;for(var n=0,i=e.length;i>n;n++)e[n].style.visibility=t?"visible":"hidden"}}function Na(e,t){for(var n=-1,i=0;i<e.aoColumns.length;i++)if(e.aoColumns[i].bVisible===!0&&n++,n==t)return i;return null}function ta(e,t){for(var n=-1,i=0;i<e.aoColumns.length;i++)if(e.aoColumns[i].bVisible===!0&&n++,i==t)return e.aoColumns[i].bVisible===!0?n:null;return null}function W(e,t){var n,i;for(n=e._iDisplayStart,i=e._iDisplayEnd;i>n;n++)if(e.aoData[e.aiDisplay[n]].nTr==t)return e.aiDisplay[n];for(n=0,i=e.aoData.length;i>n;n++)if(e.aoData[n].nTr==t)return n;return null}function Z(e){for(var t=0,n=0;n<e.aoColumns.length;n++)e.aoColumns[n].bVisible===!0&&t++;return t}function E(e){e._iDisplayEnd=e.oFeatures.bPaginate===!1?e.aiDisplay.length:e._iDisplayStart+e._iDisplayLength>e.aiDisplay.length||-1==e._iDisplayLength?e.aiDisplay.length:e._iDisplayStart+e._iDisplayLength}function Sa(e,t){if(!e||null===e||""===e)return 0;"undefined"==typeof t&&(t=p.getElementsByTagName("body")[0]);var n=p.createElement("div");return n.style.width=q(e),t.appendChild(n),e=n.offsetWidth,t.removeChild(n),e}function ga(e){var t,n,o=0,r=0,s=e.aoColumns.length,a=i("th",e.nTHead);for(n=0;s>n;n++)e.aoColumns[n].bVisible&&(r++,null!==e.aoColumns[n].sWidth&&(t=Sa(e.aoColumns[n].sWidthOrig,e.nTable.parentNode),null!==t&&(e.aoColumns[n].sWidth=q(t)),o++));if(s==a.length&&0===o&&r==s&&""===e.oScroll.sX&&""===e.oScroll.sY)for(n=0;n<e.aoColumns.length;n++)t=i(a[n]).width(),null!==t&&(e.aoColumns[n].sWidth=q(t));else{for(o=e.nTable.cloneNode(!1),n=e.nTHead.cloneNode(!0),r=p.createElement("tbody"),t=p.createElement("tr"),o.removeAttribute("id"),o.appendChild(n),null!==e.nTFoot&&(o.appendChild(e.nTFoot.cloneNode(!0)),P(function(e){e.style.width=""},o.getElementsByTagName("tr"))),o.appendChild(r),r.appendChild(t),r=i("thead th",o),0===r.length&&(r=i("tbody tr:eq(0)>td",o)),a=S(e,n),n=r=0;s>n;n++){var l=e.aoColumns[n];l.bVisible&&null!==l.sWidthOrig&&""!==l.sWidthOrig?a[n-r].style.width=q(l.sWidthOrig):l.bVisible?a[n-r].style.width="":r++}for(n=0;s>n;n++)e.aoColumns[n].bVisible&&(r=Ta(e,n),null!==r&&(r=r.cloneNode(!0),""!==e.aoColumns[n].sContentPadding&&(r.innerHTML+=e.aoColumns[n].sContentPadding),t.appendChild(r)));if(s=e.nTable.parentNode,s.appendChild(o),""!==e.oScroll.sX&&""!==e.oScroll.sXInner?o.style.width=q(e.oScroll.sXInner):""!==e.oScroll.sX?(o.style.width="",i(o).width()<s.offsetWidth&&(o.style.width=q(s.offsetWidth))):""!==e.oScroll.sY&&(o.style.width=q(s.offsetWidth)),o.style.visibility="hidden",Ua(e,o),s=i("tbody tr:eq(0)",o).children(),0===s.length&&(s=S(e,i("thead",o)[0])),""!==e.oScroll.sX){for(n=r=t=0;n<e.aoColumns.length;n++)e.aoColumns[n].bVisible&&(t+=null===e.aoColumns[n].sWidthOrig?i(s[r]).outerWidth():parseInt(e.aoColumns[n].sWidth.replace("px",""),10)+(i(s[r]).outerWidth()-i(s[r]).width()),r++);o.style.width=q(t),e.nTable.style.width=q(t)}for(n=r=0;n<e.aoColumns.length;n++)e.aoColumns[n].bVisible&&(t=i(s[r]).width(),null!==t&&t>0&&(e.aoColumns[n].sWidth=q(t)),r++);e.nTable.style.width=q(i(o).outerWidth()),o.parentNode.removeChild(o)}}function Ua(e,t){""===e.oScroll.sX&&""!==e.oScroll.sY?(i(t).width(),t.style.width=q(i(t).outerWidth()-e.oScroll.iBarWidth)):""!==e.oScroll.sX&&(t.style.width=q(i(t).outerWidth()))}function Ta(e,t){var n=Va(e,t);if(0>n)return null;if(null===e.aoData[n].nTr){var i=p.createElement("td");return i.innerHTML=G(e,n,t,""),i}return Q(e,n)[t]}function Va(e,t){for(var n=-1,i=-1,o=0;o<e.aoData.length;o++){var r=G(e,o,t,"display")+"";r=r.replace(/<.*?>/g,""),r.length>n&&(n=r.length,i=o)}return i}function q(e){if(null===e)return"0px";if("number"==typeof e)return 0>e?"0px":e+"px";var t=e.charCodeAt(e.length-1);return 48>t||t>57?e:e+"px"}function Za(e,t){if(e.length!=t.length)return 1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return 2;return 0}function ia(e){for(var t=n.aTypes,i=t.length,o=0;i>o;o++){var r=t[o](e);if(null!==r)return r}return"string"}function A(e){for(var t=0;t<D.length;t++)if(D[t].nTable==e)return D[t];return null}function ca(e){for(var t=[],n=e.aoData.length,i=0;n>i;i++)t.push(e.aoData[i]._aData);return t}function ba(e){for(var t=[],n=0,i=e.aoData.length;i>n;n++)null!==e.aoData[n].nTr&&t.push(e.aoData[n].nTr);return t}function Q(e,t){var n,i,o,r,s,a=[];i=0;var l=e.aoData.length;for("undefined"!=typeof t&&(i=t,l=t+1),i=i;l>i;i++)if(s=e.aoData[i],null!==s.nTr){for(t=[],o=0,r=s.nTr.childNodes.length;r>o;o++)n=s.nTr.childNodes[o].nodeName.toLowerCase(),("td"==n||"th"==n)&&t.push(s.nTr.childNodes[o]);for(o=n=0,r=e.aoColumns.length;r>o;o++)e.aoColumns[o].bVisible?a.push(t[o-n]):(a.push(s._anHidden[o]),n++)}return a}function sa(e){return e.replace(new RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\|\\$|\\^)","g"),"\\$1")}function ua(e,t){for(var n=-1,i=0,o=e.length;o>i;i++)e[i]==t?n=i:e[i]>t&&e[i]--;-1!=n&&e.splice(n,1)}function Fa(e,t){t=t.split(",");for(var n=[],i=0,o=e.aoColumns.length;o>i;i++)for(var r=0;o>r;r++)if(e.aoColumns[i].sName==t[r]){n.push(r);break}return n}function ka(e){for(var t="",n=0,i=e.aoColumns.length;i>n;n++)t+=e.aoColumns[n].sName+",";return t.length==i?"":t.slice(0,-1)}function J(e,t,i){if(e=""===e.sTableId?"DataTables warning: "+i:"DataTables warning (table id = '"+e.sTableId+"'): "+i,0===t){if("alert"!=n.sErrMode)throw e;alert(e)}else"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log(e)}function la(e){e.aoData.splice(0,e.aoData.length),e.aiDisplayMaster.splice(0,e.aiDisplayMaster.length),e.aiDisplay.splice(0,e.aiDisplay.length),E(e)}function va(e){if(e.oFeatures.bStateSave&&"undefined"==typeof e.bDestroying){var t,n,i,o="{";for(o+='"iCreate":'+(new Date).getTime()+",",o+='"iStart":'+(e.oScroll.bInfinite?0:e._iDisplayStart)+",",o+='"iEnd":'+(e.oScroll.bInfinite?e._iDisplayLength:e._iDisplayEnd)+",",o+='"iLength":'+e._iDisplayLength+",",o+='"sFilter":"'+encodeURIComponent(e.oPreviousSearch.sSearch)+'",',o+='"sFilterEsc":'+!e.oPreviousSearch.bRegex+",",o+='"aaSorting":[ ',t=0;t<e.aaSorting.length;t++)o+="["+e.aaSorting[t][0]+',"'+e.aaSorting[t][1]+'"],';for(o=o.substring(0,o.length-1),o+="],",o+='"aaSearchCols":[ ',t=0;t<e.aoPreSearchCols.length;t++)o+='["'+encodeURIComponent(e.aoPreSearchCols[t].sSearch)+'",'+!e.aoPreSearchCols[t].bRegex+"],";for(o=o.substring(0,o.length-1),o+="],",o+='"abVisCols":[ ',t=0;t<e.aoColumns.length;t++)o+=e.aoColumns[t].bVisible+",";for(o=o.substring(0,o.length-1),o+="]",t=0,n=e.aoStateSave.length;n>t;t++)i=e.aoStateSave[t].fn(e,o),""!==i&&(o=i);o+="}",Wa(e.sCookiePrefix+e.sInstance,o,e.iCookieDuration,e.sCookiePrefix,e.fnCookieCallback)}}function Xa(a,b){if(a.oFeatures.bStateSave){var c,d,f;if(d=wa(a.sCookiePrefix+a.sInstance),null!==d&&""!==d){try{c="function"==typeof i.parseJSON?i.parseJSON(d.replace(/'/g,'"')):eval("("+d+")")}catch(e){return}for(d=0,f=a.aoStateLoad.length;f>d;d++)if(!a.aoStateLoad[d].fn(a,c))return;if(a.oLoadedState=i.extend(!0,{},c),a._iDisplayStart=c.iStart,a.iInitDisplayStart=c.iStart,a._iDisplayEnd=c.iEnd,a._iDisplayLength=c.iLength,a.oPreviousSearch.sSearch=decodeURIComponent(c.sFilter),a.aaSorting=c.aaSorting.slice(),a.saved_aaSorting=c.aaSorting.slice(),"undefined"!=typeof c.sFilterEsc&&(a.oPreviousSearch.bRegex=!c.sFilterEsc),"undefined"!=typeof c.aaSearchCols)for(d=0;d<c.aaSearchCols.length;d++)a.aoPreSearchCols[d]={sSearch:decodeURIComponent(c.aaSearchCols[d][0]),bRegex:!c.aaSearchCols[d][1]};if("undefined"!=typeof c.abVisCols)for(b.saved_aoColumns=[],d=0;d<c.abVisCols.length;d++)b.saved_aoColumns[d]={},b.saved_aoColumns[d].bVisible=c.abVisCols[d]}}}function Wa(a,b,c,d,f){var e=new Date;e.setTime(e.getTime()+1e3*c),c=za.location.pathname.split("/"),a=a+"_"+c.pop().replace(/[\/:]/g,"").toLowerCase();var h;if(null!==f?(h="function"==typeof i.parseJSON?i.parseJSON(b):eval("("+b+")"),b=f(a,h,e.toGMTString(),c.join("/")+"/")):b=a+"="+encodeURIComponent(b)+"; expires="+e.toGMTString()+"; path="+c.join("/")+"/",f="",e=9999999999999,(null!==wa(a)?p.cookie.length:b.length+p.cookie.length)+10>4096){a=p.cookie.split(";");for(var j=0,k=a.length;k>j;j++)if(-1!=a[j].indexOf(d)){var m=a[j].split("=");try{h=eval("("+decodeURIComponent(m[1])+")")}catch(u){continue}"undefined"!=typeof h.iCreate&&h.iCreate<e&&(f=m[0],e=h.iCreate)}""!==f&&(p.cookie=f+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+c.join("/")+"/")}p.cookie=b}function wa(e){var t=za.location.pathname.split("/");e=e+"_"+t[t.length-1].replace(/[\/:]/g,"").toLowerCase()+"=",t=p.cookie.split(";");for(var n=0;n<t.length;n++){for(var i=t[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return decodeURIComponent(i.substring(e.length,i.length))}return null}function Y(e,t){t=i(t).children("tr");var n,o,r,s,a,l,c,u,h=function(e,t,n){for(;"undefined"!=typeof e[t][n];)n++;return n};for(e.splice(0,e.length),o=0,l=t.length;l>o;o++)e.push([]);for(o=0,l=t.length;l>o;o++)for(r=0,c=t[o].childNodes.length;c>r;r++)if(n=t[o].childNodes[r],"TD"==n.nodeName.toUpperCase()||"TH"==n.nodeName.toUpperCase()){var d=1*n.getAttribute("colspan"),p=1*n.getAttribute("rowspan");for(d=d&&0!==d&&1!==d?d:1,p=p&&0!==p&&1!==p?p:1,u=h(e,o,0),a=0;d>a;a++)for(s=0;p>s;s++)e[o+s][u+a]={cell:n,unique:1==d?!0:!1},e[o+s].nTr=t[o]}}function S(e,t,n){var i=[];"undefined"==typeof n&&(n=e.aoHeader,"undefined"!=typeof t&&(n=[],Y(n,t))),t=0;for(var o=n.length;o>t;t++)for(var r=0,s=n[t].length;s>r;r++)!n[t][r].unique||"undefined"!=typeof i[r]&&e.bSortCellsTop||(i[r]=n[t][r].cell);return i}function Ya(){var e=p.createElement("p"),t=e.style;t.width="100%",t.height="200px",t.padding="0px";var n=p.createElement("div");return t=n.style,t.position="absolute",t.top="0px",t.left="0px",t.visibility="hidden",t.width="200px",t.height="150px",t.padding="0px",t.overflow="hidden",n.appendChild(e),p.body.appendChild(n),t=e.offsetWidth,n.style.overflow="scroll",e=e.offsetWidth,t==e&&(e=n.clientWidth),p.body.removeChild(n),t-e}function P(e,t,n){for(var i=0,o=t.length;o>i;i++)for(var r=0,s=t[i].childNodes.length;s>r;r++)1==t[i].childNodes[r].nodeType&&("undefined"!=typeof n?e(t[i].childNodes[r],n[i].childNodes[r]):e(t[i].childNodes[r]))}function o(e,t,n,i){"undefined"==typeof i&&(i=n),"undefined"!=typeof t[n]&&(e[i]=t[n])}function fa(e,t,n){for(var i=[],o=0,r=e.aoColumns.length;r>o;o++)i.push(G(e,t,o,n));return i}function G(e,t,n,i){var o=e.aoColumns[n];if(void 0===(n=o.fnGetData(e.aoData[t]._aData)))return e.iDrawError!=e.iDraw&&null===o.sDefaultContent&&(J(e,0,"Requested unknown parameter '"+o.mDataProp+"' from the data source for row "+t),e.iDrawError=e.iDraw),o.sDefaultContent;if(null===n&&null!==o.sDefaultContent)n=o.sDefaultContent;else if("function"==typeof n)return n();return"display"==i&&null===n?"":n}function O(e,t,n,i){e.aoColumns[n].fnSetData(e.aoData[t]._aData,i)}function aa(e){if(null===e)return function(){return null};if("function"==typeof e)return function(t){return e(t)};if("string"==typeof e&&-1!=e.indexOf(".")){var t=e.split(".");return 2==t.length?function(e){return e[t[0]][t[1]]}:3==t.length?function(e){return e[t[0]][t[1]][t[2]]}:function(e){for(var n=0,i=t.length;i>n;n++)e=e[t[n]];return e}}return function(t){return t[e]}}function Ba(e){if(null===e)return function(){};if("function"==typeof e)return function(t,n){return e(t,n)};if("string"==typeof e&&-1!=e.indexOf(".")){var t=e.split(".");return 2==t.length?function(e,n){e[t[0]][t[1]]=n}:3==t.length?function(e,n){e[t[0]][t[1]][t[2]]=n}:function(e,n){for(var i=0,o=t.length-1;o>i;i++)e=e[t[i]];e[t[t.length-1]]=n}}return function(t,n){t[e]=n}}this.oApi={},this.fnDraw=function(e){var t=A(this[n.iApiIndex]);"undefined"!=typeof e&&e===!1?(E(t),C(t)):da(t)},this.fnFilter=function(e,t,o,r,s){var a=A(this[n.iApiIndex]);if(a.oFeatures.bFilter)if("undefined"==typeof o&&(o=!1),"undefined"==typeof r&&(r=!0),"undefined"==typeof s&&(s=!0),"undefined"==typeof t||null===t){if(N(a,{sSearch:e,bRegex:o,bSmart:r},1),s&&"undefined"!=typeof a.aanFeatures.f)for(t=a.aanFeatures.f,o=0,r=t.length;r>o;o++)i("input",t[o]).val(e)}else a.aoPreSearchCols[t].sSearch=e,a.aoPreSearchCols[t].bRegex=o,a.aoPreSearchCols[t].bSmart=r,N(a,a.oPreviousSearch,1)},this.fnSettings=function(){return A(this[n.iApiIndex])},this.fnVersionCheck=n.fnVersionCheck,this.fnSort=function(e){var t=A(this[n.iApiIndex]);t.aaSorting=e,R(t)},this.fnSortListener=function(e,t,i){ja(A(this[n.iApiIndex]),e,t,i)},this.fnAddData=function(e,t){if(0===e.length)return[];var i,o=[],r=A(this[n.iApiIndex]);if("object"==typeof e[0])for(var s=0;s<e.length;s++){if(i=v(r,e[s]),-1==i)return o;o.push(i)}else{if(i=v(r,e),-1==i)return o;o.push(i)}return r.aiDisplay=r.aiDisplayMaster.slice(),("undefined"==typeof t||t)&&da(r),o},this.fnDeleteRow=function(e,t,o){var r=A(this[n.iApiIndex]);e="object"==typeof e?W(r,e):e;var s=r.aoData.splice(e,1),a=i.inArray(e,r.aiDisplay);return r.asDataSearch.splice(a,1),ua(r.aiDisplayMaster,e),ua(r.aiDisplay,e),"function"==typeof t&&t.call(this,r,s),r._iDisplayStart>=r.aiDisplay.length&&(r._iDisplayStart-=r._iDisplayLength,r._iDisplayStart<0&&(r._iDisplayStart=0)),("undefined"==typeof o||o)&&(E(r),C(r)),s},this.fnClearTable=function(e){var t=A(this[n.iApiIndex]);la(t),("undefined"==typeof e||e)&&C(t)},this.fnOpen=function(e,t,o){var r=A(this[n.iApiIndex]);this.fnClose(e);var s=p.createElement("tr"),a=p.createElement("td");return s.appendChild(a),a.className=o,a.colSpan=Z(r),"undefined"!=typeof t.jquery||"object"==typeof t?a.appendChild(t):a.innerHTML=t,t=i("tr",r.nTBody),-1!=i.inArray(e,t)&&i(s).insertAfter(e),r.aoOpenRows.push({nTr:s,nParent:e}),s},this.fnClose=function(e){for(var t=A(this[n.iApiIndex]),i=0;i<t.aoOpenRows.length;i++)if(t.aoOpenRows[i].nParent==e)return(e=t.aoOpenRows[i].nTr.parentNode)&&e.removeChild(t.aoOpenRows[i].nTr),t.aoOpenRows.splice(i,1),0;return 1},this.fnGetData=function(e,t){var i=A(this[n.iApiIndex]);return"undefined"!=typeof e?(e="object"==typeof e?W(i,e):e,"undefined"!=typeof t?G(i,e,t,""):"undefined"!=typeof i.aoData[e]?i.aoData[e]._aData:null):ca(i)},this.fnGetNodes=function(e){var t=A(this[n.iApiIndex]);return"undefined"!=typeof e?"undefined"!=typeof t.aoData[e]?t.aoData[e].nTr:null:ba(t)},this.fnGetPosition=function(e){var t=A(this[n.iApiIndex]),i=e.nodeName.toUpperCase();if("TR"==i)return W(t,e);if("TD"==i||"TH"==i){i=W(t,e.parentNode);for(var o=Q(t,i),r=0;r<t.aoColumns.length;r++)if(o[r]==e)return[i,ta(t,r),r]}return null},this.fnUpdate=function(e,t,o,r,s){var a=A(this[n.iApiIndex]);if(t="object"==typeof t?W(a,t):t,i.isArray(e)&&"object"==typeof e)for(a.aoData[t]._aData=e.slice(),o=0;o<a.aoColumns.length;o++)this.fnUpdate(G(a,t,o),t,o,!1,!1);else if(null!==e&&"object"==typeof e)for(a.aoData[t]._aData=i.extend(!0,{},e),o=0;o<a.aoColumns.length;o++)this.fnUpdate(G(a,t,o),t,o,!1,!1);else e=e,O(a,t,o,e),null!==a.aoColumns[o].fnRender&&(e=a.aoColumns[o].fnRender({iDataRow:t,iDataColumn:o,aData:a.aoData[t]._aData,oSettings:a}),a.aoColumns[o].bUseRendered&&O(a,t,o,e)),null!==a.aoData[t].nTr&&(Q(a,t)[o].innerHTML=e);return o=i.inArray(t,a.aiDisplay),a.asDataSearch[o]=ra(a,fa(a,t,"filter")),("undefined"==typeof s||s)&&ea(a),("undefined"==typeof r||r)&&da(a),0},this.fnSetColumnVis=function(e,t,i){var o,r,s=A(this[n.iApiIndex]);r=s.aoColumns.length;var a,l;if(s.aoColumns[e].bVisible!=t){if(t){for(o=l=0;e>o;o++)s.aoColumns[o].bVisible&&l++;if(l=l>=Z(s),!l)for(o=e;r>o;o++)if(s.aoColumns[o].bVisible){a=o;break}for(o=0,r=s.aoData.length;r>o;o++)null!==s.aoData[o].nTr&&(l?s.aoData[o].nTr.appendChild(s.aoData[o]._anHidden[e]):s.aoData[o].nTr.insertBefore(s.aoData[o]._anHidden[e],Q(s,o)[a]))}else for(o=0,r=s.aoData.length;r>o;o++)null!==s.aoData[o].nTr&&(a=Q(s,o)[e],s.aoData[o]._anHidden[e]=a,a.parentNode.removeChild(a));for(s.aoColumns[e].bVisible=t,M(s,s.aoHeader),s.nTFoot&&M(s,s.aoFooter),o=0,r=s.aoOpenRows.length;r>o;o++)s.aoOpenRows[o].nTr.colSpan=Z(s);("undefined"==typeof i||i)&&(ea(s),C(s)),va(s)}},this.fnPageChange=function(e,t){var i=A(this[n.iApiIndex]);ma(i,e),E(i),("undefined"==typeof t||t)&&C(i)},this.fnDestroy=function(){var e,t,o=A(this[n.iApiIndex]),r=o.nTableWrapper.parentNode,s=o.nTBody;for(o.bDestroying=!0,e=0,t=o.aoDestroyCallback.length;t>e;e++)o.aoDestroyCallback[e].fn();for(e=0,t=o.aoColumns.length;t>e;e++)o.aoColumns[e].bVisible===!1&&this.fnSetColumnVis(e,!0);for(i(o.nTableWrapper).find("*").andSelf().unbind(".DT"),i("tbody>tr>td."+o.oClasses.sRowEmpty,o.nTable).parent().remove(),o.nTable!=o.nTHead.parentNode&&(i(o.nTable).children("thead").remove(),o.nTable.appendChild(o.nTHead)),o.nTFoot&&o.nTable!=o.nTFoot.parentNode&&(i(o.nTable).children("tfoot").remove(),o.nTable.appendChild(o.nTFoot)),o.nTable.parentNode.removeChild(o.nTable),i(o.nTableWrapper).remove(),o.aaSorting=[],o.aaSortingFixed=[],V(o),i(ba(o)).removeClass(o.asStripeClasses.join(" ")),o.bJUI?(i("th",o.nTHead).removeClass([n.oStdClasses.sSortable,n.oJUIClasses.sSortableAsc,n.oJUIClasses.sSortableDesc,n.oJUIClasses.sSortableNone].join(" ")),i("th span."+n.oJUIClasses.sSortIcon,o.nTHead).remove(),i("th",o.nTHead).each(function(){var e=i("div."+n.oJUIClasses.sSortJUIWrapper,this),t=e.contents();i(this).append(t),e.remove()})):i("th",o.nTHead).removeClass([n.oStdClasses.sSortable,n.oStdClasses.sSortableAsc,n.oStdClasses.sSortableDesc,n.oStdClasses.sSortableNone].join(" ")),o.nTableReinsertBefore?r.insertBefore(o.nTable,o.nTableReinsertBefore):r.appendChild(o.nTable),e=0,t=o.aoData.length;t>e;e++)null!==o.aoData[e].nTr&&s.appendChild(o.aoData[e].nTr);for(o.oFeatures.bAutoWidth===!0&&(o.nTable.style.width=q(o.sDestroyWidth)),i(s).children("tr:even").addClass(o.asDestroyStripes[0]),i(s).children("tr:odd").addClass(o.asDestroyStripes[1]),e=0,t=D.length;t>e;e++)D[e]==o&&D.splice(e,1);o=null},this.fnAdjustColumnSizing=function(e){var t=A(this[n.iApiIndex]);ea(t),"undefined"==typeof e||e?this.fnDraw(!1):(""!==t.oScroll.sX||""!==t.oScroll.sY)&&this.oApi._fnScrollDraw(t)};for(var xa in n.oApi)xa&&(this[xa]=s(xa));this.oApi._fnExternApiFunc=s,this.oApi._fnInitialise=t,this.oApi._fnInitComplete=w,this.oApi._fnLanguageProcess=y,this.oApi._fnAddColumn=F,this.oApi._fnColumnOptions=x,this.oApi._fnAddData=v,this.oApi._fnCreateTr=z,this.oApi._fnGatherData=$,this.oApi._fnBuildHead=X,this.oApi._fnDrawHead=M,this.oApi._fnDraw=C,this.oApi._fnReDraw=da,this.oApi._fnAjaxUpdate=Ca,this.oApi._fnAjaxParameters=Da,this.oApi._fnAjaxUpdateDraw=Ea,this.oApi._fnServerParams=ha,this.oApi._fnAddOptionsHtml=Aa,this.oApi._fnFeatureHtmlTable=Ja,this.oApi._fnScrollDraw=Ma,this.oApi._fnAdjustColumnSizing=ea,this.oApi._fnFeatureHtmlFilter=Ha,this.oApi._fnFilterComplete=N,this.oApi._fnFilterCustom=Qa,this.oApi._fnFilterColumn=Pa,this.oApi._fnFilter=Oa,this.oApi._fnBuildSearchArray=oa,this.oApi._fnBuildSearchRow=ra,this.oApi._fnFilterCreateSearch=pa,this.oApi._fnDataToSearch=qa,this.oApi._fnSort=R,this.oApi._fnSortAttachListener=ja,this.oApi._fnSortingClasses=V,this.oApi._fnFeatureHtmlPaginate=La,this.oApi._fnPageChange=ma,this.oApi._fnFeatureHtmlInfo=Ka,this.oApi._fnUpdateInfo=Ra,this.oApi._fnFeatureHtmlLength=Ga,this.oApi._fnFeatureHtmlProcessing=Ia,this.oApi._fnProcessingDisplay=K,this.oApi._fnVisibleToColumnIndex=Na,this.oApi._fnColumnIndexToVisible=ta,this.oApi._fnNodeToDataIndex=W,this.oApi._fnVisbleColumns=Z,this.oApi._fnCalculateEnd=E,this.oApi._fnConvertToWidth=Sa,this.oApi._fnCalculateColumnWidths=ga,this.oApi._fnScrollingWidthAdjust=Ua,this.oApi._fnGetWidestNode=Ta,this.oApi._fnGetMaxLenString=Va,this.oApi._fnStringToCss=q,this.oApi._fnArrayCmp=Za,this.oApi._fnDetectType=ia,this.oApi._fnSettingsFromNode=A,this.oApi._fnGetDataMaster=ca,this.oApi._fnGetTrNodes=ba,this.oApi._fnGetTdNodes=Q,this.oApi._fnEscapeRegex=sa,this.oApi._fnDeleteIndex=ua,this.oApi._fnReOrderIndex=Fa,this.oApi._fnColumnOrdering=ka,this.oApi._fnLog=J,this.oApi._fnClearTable=la,this.oApi._fnSaveState=va,this.oApi._fnLoadState=Xa,this.oApi._fnCreateCookie=Wa,this.oApi._fnReadCookie=wa,this.oApi._fnDetectHeader=Y,this.oApi._fnGetUniqueThs=S,this.oApi._fnScrollBarWidth=Ya,this.oApi._fnApplyToChildren=P,this.oApi._fnMap=o,this.oApi._fnGetRowData=fa,this.oApi._fnGetCellData=G,this.oApi._fnSetCellData=O,this.oApi._fnGetObjectDataFn=aa,this.oApi._fnSetObjectDataFn=Ba;var ya=this;return this.each(function(){var e,r,s,a,c=0;for(c=0,e=D.length;e>c;c++){if(D[c].nTable==this){if("undefined"==typeof g||"undefined"!=typeof g.bRetrieve&&g.bRetrieve===!0)return D[c].oInstance;if("undefined"!=typeof g.bDestroy&&g.bDestroy===!0){D[c].oInstance.fnDestroy();break}return void J(D[c],0,"Cannot reinitialise DataTable.\n\nTo retrieve the DataTables object for this table, please pass either no arguments to the dataTable() function, or set bRetrieve to true. Alternatively, to destory the old table and create a new one, set bDestroy to true (note that a lot of changes to the configuration can be made through the API which is usually much faster).")}if(""!==D[c].sTableId&&D[c].sTableId==this.getAttribute("id")){D.splice(c,1);break}}var u=new l;D.push(u);var h=!1,d=!1;if(c=this.getAttribute("id"),null!==c?(u.sTableId=c,u.sInstance=c):u.sInstance=n._oExternConfig.iNextUnique++,"table"!=this.nodeName.toLowerCase())J(u,0,"Attempted to initialise DataTables on a node which is not a table: "+this.nodeName);else{for(u.nTable=this,u.oInstance=1==ya.length?ya:i(this).dataTable(),u.oApi=ya.oApi,u.sDestroyWidth=i(this).width(),"undefined"!=typeof g&&null!==g?(u.oInit=g,o(u.oFeatures,g,"bPaginate"),o(u.oFeatures,g,"bLengthChange"),o(u.oFeatures,g,"bFilter"),o(u.oFeatures,g,"bSort"),o(u.oFeatures,g,"bInfo"),o(u.oFeatures,g,"bProcessing"),o(u.oFeatures,g,"bAutoWidth"),o(u.oFeatures,g,"bSortClasses"),o(u.oFeatures,g,"bServerSide"),o(u.oFeatures,g,"bDeferRender"),o(u.oScroll,g,"sScrollX","sX"),o(u.oScroll,g,"sScrollXInner","sXInner"),o(u.oScroll,g,"sScrollY","sY"),o(u.oScroll,g,"bScrollCollapse","bCollapse"),o(u.oScroll,g,"bScrollInfinite","bInfinite"),o(u.oScroll,g,"iScrollLoadGap","iLoadGap"),o(u.oScroll,g,"bScrollAutoCss","bAutoCss"),o(u,g,"asStripClasses","asStripeClasses"),o(u,g,"asStripeClasses"),o(u,g,"fnPreDrawCallback"),o(u,g,"fnRowCallback"),o(u,g,"fnHeaderCallback"),o(u,g,"fnFooterCallback"),o(u,g,"fnCookieCallback"),o(u,g,"fnInitComplete"),o(u,g,"fnServerData"),o(u,g,"fnFormatNumber"),o(u,g,"aaSorting"),o(u,g,"aaSortingFixed"),o(u,g,"aLengthMenu"),o(u,g,"sPaginationType"),o(u,g,"sAjaxSource"),o(u,g,"sAjaxDataProp"),o(u,g,"iCookieDuration"),o(u,g,"sCookiePrefix"),o(u,g,"sDom"),o(u,g,"bSortCellsTop"),o(u,g,"oSearch","oPreviousSearch"),o(u,g,"aoSearchCols","aoPreSearchCols"),o(u,g,"iDisplayLength","_iDisplayLength"),o(u,g,"bJQueryUI","bJUI"),o(u.oLanguage,g,"fnInfoCallback"),"function"==typeof g.fnDrawCallback&&u.aoDrawCallback.push({fn:g.fnDrawCallback,sName:"user"}),"function"==typeof g.fnServerParams&&u.aoServerParams.push({fn:g.fnServerParams,sName:"user"}),"function"==typeof g.fnStateSaveCallback&&u.aoStateSave.push({fn:g.fnStateSaveCallback,sName:"user"}),"function"==typeof g.fnStateLoadCallback&&u.aoStateLoad.push({fn:g.fnStateLoadCallback,sName:"user"}),u.oFeatures.bServerSide&&u.oFeatures.bSort&&u.oFeatures.bSortClasses?u.aoDrawCallback.push({fn:V,sName:"server_side_sort_classes"}):u.oFeatures.bDeferRender&&u.aoDrawCallback.push({fn:V,sName:"defer_sort_classes"}),"undefined"!=typeof g.bJQueryUI&&g.bJQueryUI&&(u.oClasses=n.oJUIClasses,"undefined"==typeof g.sDom&&(u.sDom='<"H"lfr>t<"F"ip>')),(""!==u.oScroll.sX||""!==u.oScroll.sY)&&(u.oScroll.iBarWidth=Ya()),"undefined"!=typeof g.iDisplayStart&&"undefined"==typeof u.iInitDisplayStart&&(u.iInitDisplayStart=g.iDisplayStart,u._iDisplayStart=g.iDisplayStart),"undefined"!=typeof g.bStateSave&&(u.oFeatures.bStateSave=g.bStateSave,Xa(u,g),u.aoDrawCallback.push({fn:va,sName:"state_save"})),"undefined"!=typeof g.iDeferLoading&&(u.bDeferLoading=!0,u._iRecordsTotal=g.iDeferLoading,u._iRecordsDisplay=g.iDeferLoading),"undefined"!=typeof g.aaData&&(d=!0),"undefined"!=typeof g&&"undefined"!=typeof g.aoData&&(g.aoColumns=g.aoData),"undefined"!=typeof g.oLanguage&&("undefined"!=typeof g.oLanguage.sUrl&&""!==g.oLanguage.sUrl?(u.oLanguage.sUrl=g.oLanguage.sUrl,i.getJSON(u.oLanguage.sUrl,null,function(e){y(u,e,!0)
}),h=!0):y(u,g.oLanguage,!1))):g={},"undefined"==typeof g.asStripClasses&&"undefined"==typeof g.asStripeClasses&&(u.asStripeClasses.push(u.oClasses.sStripeOdd),u.asStripeClasses.push(u.oClasses.sStripeEven)),r=!1,s=i(this).children("tbody").children("tr"),c=0,e=u.asStripeClasses.length;e>c;c++)if(s.filter(":lt(2)").hasClass(u.asStripeClasses[c])){r=!0;break}r&&(u.asDestroyStripes=["",""],i(s[0]).hasClass(u.oClasses.sStripeOdd)&&(u.asDestroyStripes[0]+=u.oClasses.sStripeOdd+" "),i(s[0]).hasClass(u.oClasses.sStripeEven)&&(u.asDestroyStripes[0]+=u.oClasses.sStripeEven),i(s[1]).hasClass(u.oClasses.sStripeOdd)&&(u.asDestroyStripes[1]+=u.oClasses.sStripeOdd+" "),i(s[1]).hasClass(u.oClasses.sStripeEven)&&(u.asDestroyStripes[1]+=u.oClasses.sStripeEven),s.removeClass(u.asStripeClasses.join(" "))),r=[];var f;if(c=this.getElementsByTagName("thead"),0!==c.length&&(Y(u.aoHeader,c[0]),r=S(u)),"undefined"==typeof g.aoColumns)for(f=[],c=0,e=r.length;e>c;c++)f.push(null);else f=g.aoColumns;for(c=0,e=f.length;e>c;c++)"undefined"!=typeof g.saved_aoColumns&&g.saved_aoColumns.length==e&&(null===f[c]&&(f[c]={}),f[c].bVisible=g.saved_aoColumns[c].bVisible),F(u,r?r[c]:null);if("undefined"!=typeof g.aoColumnDefs)for(c=g.aoColumnDefs.length-1;c>=0;c--){var m=g.aoColumnDefs[c].aTargets;for(i.isArray(m)||J(u,1,"aTargets must be an array of targets, not a "+typeof m),r=0,s=m.length;s>r;r++)if("number"==typeof m[r]&&m[r]>=0){for(;u.aoColumns.length<=m[r];)F(u);x(u,m[r],g.aoColumnDefs[c])}else if("number"==typeof m[r]&&m[r]<0)x(u,u.aoColumns.length+m[r],g.aoColumnDefs[c]);else if("string"==typeof m[r])for(e=0,a=u.aoColumns.length;a>e;e++)("_all"==m[r]||i(u.aoColumns[e].nTh).hasClass(m[r]))&&x(u,e,g.aoColumnDefs[c])}if("undefined"!=typeof f)for(c=0,e=f.length;e>c;c++)x(u,c,f[c]);for(c=0,e=u.aaSorting.length;e>c;c++)for(u.aaSorting[c][0]>=u.aoColumns.length&&(u.aaSorting[c][0]=0),f=u.aoColumns[u.aaSorting[c][0]],"undefined"==typeof u.aaSorting[c][2]&&(u.aaSorting[c][2]=0),"undefined"==typeof g.aaSorting&&"undefined"==typeof u.saved_aaSorting&&(u.aaSorting[c][1]=f.asSorting[0]),r=0,s=f.asSorting.length;s>r;r++)if(u.aaSorting[c][1]==f.asSorting[r]){u.aaSorting[c][2]=r;break}if(V(u),c=i(this).children("thead"),0===c.length&&(c=[p.createElement("thead")],this.appendChild(c[0])),u.nTHead=c[0],c=i(this).children("tbody"),0===c.length&&(c=[p.createElement("tbody")],this.appendChild(c[0])),u.nTBody=c[0],c=i(this).children("tfoot"),c.length>0&&(u.nTFoot=c[0],Y(u.aoFooter,u.nTFoot)),d)for(c=0;c<g.aaData.length;c++)v(u,g.aaData[c]);else $(u);u.aiDisplay=u.aiDisplayMaster.slice(),u.bInitialised=!0,h===!1&&t(u)}})}}(jQuery,window,document),/*

Live searching of shelves, as used in, e.g., the shelf menu of the 'want to
read' button.

NOTE: This is a parallel (read: duplicate) solution to the same problem solved
by type_to_filter.js. This version here searches through all element text,
while type_to_filter searches through specified data- attributes. Also, this
version treats the search query as a shelf name and does exact matching;
type_to_filter does fuzzy matching.

Adapted from:

https://github.com/nakajima/jquery-livesearch

(c) Copyright 2009 Pat Nakajima

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
*/
function(e){function t(t){return(val=this.val())?e(t).filter(':containsi("'+val+'")'):!1}jQuery.expr[":"].containsi=jQuery.expr.createPseudo(function(e){return function(t){return toShelfName(jQuery(t).text()).toUpperCase().indexOf(toShelfName(e).toUpperCase())>=0}});var n=function(e){this.callbacks={},e(this)};n.prototype.all=function(e){this.callbacks.all=e},n.prototype.reset=function(e){this.callbacks.reset=e},n.prototype.empty=function(e){this.callbacks.empty=e},n.prototype.results=function(e){this.callbacks.results=e},e.fn.search=function i(o,r){function s(){if(result=t.call(e(this),o)){a.all&&a.all.call(this,result);var n=result.size()>0?"results":"empty";return a[n]&&a[n].call(this,result)}return a.all&&a.all.call(this,e(o)),a.reset&&a.reset.call(this)}var i=new n(r),a=i.callbacks;e(document).on("keyup click",this.selector,s)}}(jQuery),function(e,t,n){function i(e){var t={},i=/^jQuery\d+$/;return n.each(e.attributes,function(e,n){n.specified&&!i.test(n.name)&&(t[n.name]=n.value)}),t}function o(e,i){var o=this,r=n(o);if(o.value==r.attr("placeholder")&&r.hasClass("placeholder"))if(r.data("placeholder-password")){if(r=r.hide().next().show().attr("id",r.removeAttr("id").data("placeholder-id")),e===!0)return r[0].value=i;r.focus()}else o.value="",r.removeClass("placeholder"),o==t.activeElement&&o.select()}function r(){var e,t=this,r=n(t),s=this.id;if(""==t.value){if("password"==t.type){if(!r.data("placeholder-textinput")){try{e=r.clone().attr({type:"text"})}catch(a){e=n("<input>").attr(n.extend(i(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":s}).bind("focus.placeholder",o),r.data({"placeholder-textinput":e,"placeholder-id":s}).before(e)}r=r.removeAttr("id").hide().prev().attr("id",s).show()}r.addClass("placeholder"),r[0].value=r.attr("placeholder")}else r.removeClass("placeholder")}var s,a,l="placeholder"in t.createElement("input"),c="placeholder"in t.createElement("textarea"),u=n.fn,h=n.valHooks;l&&c?(a=u.placeholder=function(){return this},a.input=a.textarea=!0):(a=u.placeholder=function(){var e=this;return e.filter((l?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":o,"blur.placeholder":r}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},a.input=l,a.textarea=c,s={get:function(e){var t=n(e);return t.data("placeholder-enabled")&&t.hasClass("placeholder")?"":e.value},set:function(e,i){var s=n(e);return s.data("placeholder-enabled")?(""==i?(e.value=i,e!=t.activeElement&&r.call(e)):s.hasClass("placeholder")?o.call(e,!0,i)||(e.value=i):e.value=i,s):e.value=i}},l||(h.input=s),c||(h.textarea=s),n(function(){n(t).delegate("form","submit.placeholder",function(){var e=n(".placeholder",this).each(o);setTimeout(function(){e.each(r)},10)})}),n(e).bind("beforeunload.placeholder",function(){n(".placeholder").each(function(){this.value=""})}))}(this,document,jQuery);var Lightbox={lightboxType:null,lightboxCurrentContentID:null,savePreviousContent:!1,hiddenSelects:[],keepPreviousBox:function(){var e=$("boxContents");if(this.savePreviousContent){var t=$("boxContentsLeftovers");e.childElements().each(function(e){t.appendChild(e)})}},showBoxString:function(e,t,n){this.setLightboxDimensions(t,n),this.lightboxType="string";var i=$("boxContents");return this.keepPreviousBox(),i.update(e),this.showBox(),!1},showBoxImage:function(e,t,n){this.lightboxType="image",this.setLightboxDimensions(t,n);var i=$("boxContents");i.update("");var o=document.createElement("img");return o.setAttribute("id","lightboxImage"),i.appendChild(o),imgPreload=new Image,imgPreload.onload=function(){o.src=e,Lightbox.showBox()},imgPreload.src=e,!1},showBoxByID:function(e,t,n){this.lightboxType="id",this.lightboxCurrentContentID=e,this.setLightboxDimensions(t,n);var i=$(e),o=$("boxContents");return this.keepPreviousBox(),o.update(i),i.show(),this.showBox(arguments[arguments.length-1]),this.savePreviousContent=!0,!1},showBoxByAJAX:function(e,t,n){this.lightboxType="ajax",this.setLightboxDimensions(t,n);var i=$("boxContents");this.keepPreviousBox();new Ajax.Updater(i,e,{method:"get"});return this.showBox(),!1},setLightboxDimensions:function(e,t){var n=this.getPageDimensions();e&&($("box").style.width=e<n[0]?e+"px":n[0]-50+"px"),t&&$("box").setStyle(t<n[1]?{"min-height":t+"px"}:{"min-height":n[1]-50+"px"})},showBox:function(e){this.savePreviousContent=!1;var t=$("box").fire("Lightbox:showBox");return t.stopped?!1:(Prototype.Browser.IE&&this.hideSelects(),Element.show("overlay"),this.center("box"),"function"==typeof e&&e(this),$gr.shared.reviewDraftDataCollection.attachTo(".js-reviewUserText"),!1)},hideSelects:function(){$$("select").invoke("setStyle",{visibility:"hidden"}),$$("select").invoke("addClassName","hiddenForLightBox"),$$("#box select").invoke("setStyle",{visibility:"visible"}),$$("#box select").invoke("removeClassName","hiddenForLightBox")},restoreSelects:function(){$$(".hiddenForLightBox").invoke("setStyle",{visibility:"visible"})},hideBox:function(e){var t=$("box").fire("Lightbox:hideBox");if(t.stopped)return!1;$j("#box").removeClass("extraLightboxClass");$("boxContents");return"squish"==e?Effect.Squish("box"):"dropout"==e?Effect.DropOut("box",{afterFinish:function(){$j("#box").trigger("ui.modal.hideComplete")}}):Element.hide("box"),Element.hide("overlay"),Prototype.Browser.IE&&this.restoreSelects(),!1},getPageDimensions:function(){var e,t;window.innerHeight&&window.scrollMaxY?(e=document.body.scrollWidth,t=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(e=document.body.scrollWidth,t=document.body.scrollHeight):(e=document.body.offsetWidth,t=document.body.offsetHeight);var n,i;return self.innerHeight?(n=self.innerWidth,i=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(n=document.documentElement.clientWidth,i=document.documentElement.clientHeight):document.body&&(n=document.body.clientWidth,i=document.body.clientHeight),pageHeight=i>t?i:t,pageWidth=n>e?n:e,arrayPageSize=new Array(n,i,pageWidth,pageHeight)},center:function(e){try{e=document.getElementById(e)}catch(t){return}var n=this.getPageDimensions(),i=n[0],o=n[1];$("overlay").style.height=n[3]+"px",e.style.position="absolute",e.style.zIndex=100089;var r=0;document.documentElement&&document.documentElement.scrollTop?r=document.documentElement.scrollTop:document.body&&document.body.scrollTop?r=document.body.scrollTop:window.pageYOffset?r=window.pageYOffset:window.scrollY&&(r=window.scrollY);var s=Element.getDimensions(e),a=(i-s.width)/2,l=(o-s.height)/2+r;a=0>a?0:a,l=0>l?0:l,e.style.left=a+"px",e.style.top=l+"px",Element.show(e),n=this.getPageDimensions(),$("overlay").style.height=n[3]+"px"}};$j(document).on("click","[data-lightbox=true]",function(e){var t=$j(e.target),n=e.target.href.match(/#(.*)/)[1];Lightbox.showBoxByID(n,t.data("width"),t.data("height"),Boolean(t.data("no-close-link"))),e.preventDefault()});/*
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.1 Copyright (C) Paul Johnston 1999 - 2002.
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */
var hexcase=0,b64pad="",chrsz=8;/*
 * Modernizr v1.6
 * http://www.modernizr.com
 *
 * Developed by: 
 * - Faruk Ates  http://farukat.es/
 * - Paul Irish  http://paulirish.com/
 *
 * Copyright (c) 2009-2010
 * Dual-licensed under the BSD or MIT licenses.
 * http://www.modernizr.com/license/
 */
window.Modernizr=function(e,t,n){function i(e,t){return-1!==(""+e).indexOf(t)}function o(e,t){for(var i in e)if(d[e[i]]!==n&&(!t||t(e[i],h)))return!0}function r(e,t){var n=e.charAt(0).toUpperCase()+e.substr(1);return n=(e+" "+v.join(n+" ")+n).split(" "),!!o(n,t)}function s(){c.input=function(e){for(var t=0,n=e.length;n>t;t++)_[e[t]]=!!(e[t]in p);return _}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),c.inputtypes=function(e){for(var i,o=0,r=e.length;r>o;o++)p.setAttribute("type",e[o]),(i="text"!==p.type)&&(p.value=f,/^range$/.test(p.type)&&p.style.WebkitAppearance!==n?(u.appendChild(p),i=t.defaultView,i=i.getComputedStyle&&"textfield"!==i.getComputedStyle(p,null).WebkitAppearance&&0!==p.offsetHeight,u.removeChild(p)):/^(search|tel)$/.test(p.type)||(i=/^(url|email)$/.test(p.type)?p.checkValidity&&p.checkValidity()===!1:p.value!=f)),w[e[o]]=!!i;return w}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var a,l,c={},u=t.documentElement,h=t.createElement("modernizr"),d=h.style,p=t.createElement("input"),f=":)",m=Object.prototype.toString,g=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),v="Webkit Moz O ms Khtml".split(" "),y={svg:"http://www.w3.org/2000/svg"},b={},w={},_={},C=[],S=function(e){var n=document.createElement("style"),i=t.createElement("div");return n.textContent=e+"{#modernizr{height:3px}}",(t.head||t.getElementsByTagName("head")[0]).appendChild(n),i.id="modernizr",u.appendChild(i),e=3===i.offsetHeight,n.parentNode.removeChild(n),i.parentNode.removeChild(i),!!e},x=function(){var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(t,i){i=i||document.createElement(e[t]||"div"),t="on"+t;var o=t in i;return o||(i.setAttribute||(i=document.createElement("div")),i.setAttribute&&i.removeAttribute&&(i.setAttribute(t,""),o="function"==typeof i[t],"undefined"!=typeof i[t]&&(i[t]=n),i.removeAttribute(t))),o}}(),E={}.hasOwnProperty;l="undefined"!=typeof E&&"undefined"!=typeof E.call?function(e,t){return E.call(e,t)}:function(e,t){return t in e&&"undefined"==typeof e.constructor.prototype[t]},b.flexbox=function(){var e=t.createElement("div"),n=t.createElement("div");!function(e,t,n,i){t+=":",e.style.cssText=(t+g.join(n+";"+t)).slice(0,-t.length)+(i||"")}(e,"display","box","width:42px;padding:0;"),n.style.cssText=g.join("box-flex:1;")+"width:10px;",e.appendChild(n),u.appendChild(e);var i=42===n.offsetWidth;return e.removeChild(n),u.removeChild(e),i},b.canvas=function(){var e=t.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},b.canvastext=function(){return!(!c.canvas||"function"!=typeof t.createElement("canvas").getContext("2d").fillText)},b.webgl=function(){var e=t.createElement("canvas");try{if(e.getContext("webgl"))return!0}catch(n){}try{if(e.getContext("experimental-webgl"))return!0}catch(i){}return!1},b.touch=function(){return"ontouchstart"in e||S("@media ("+g.join("touch-enabled),(")+"modernizr)")},b.geolocation=function(){return!!navigator.geolocation},b.postmessage=function(){return!!e.postMessage},b.websqldatabase=function(){return!!e.openDatabase},b.indexedDB=function(){for(var t=-1,n=v.length;++t<n;){var i=v[t].toLowerCase();if(e[i+"_indexedDB"]||e[i+"IndexedDB"])return!0}return!1},b.hashchange=function(){return x("hashchange",e)&&(document.documentMode===n||document.documentMode>7)},b.history=function(){return!(!e.history||!history.pushState)},b.draganddrop=function(){return x("drag")&&x("dragstart")&&x("dragenter")&&x("dragover")&&x("dragleave")&&x("dragend")&&x("drop")},b.websockets=function(){return"WebSocket"in e},b.rgba=function(){return d.cssText="background-color:rgba(150,255,150,.5)",i(d.backgroundColor,"rgba")},b.hsla=function(){return d.cssText="background-color:hsla(120,40%,100%,.5)",i(d.backgroundColor,"rgba")||i(d.backgroundColor,"hsla")},b.multiplebgs=function(){return d.cssText="background:url(//:),url(//:),red url(//:)",/(url\s*\(.*?){3}/.test(d.background)},b.backgroundsize=function(){return r("backgroundSize")},b.borderimage=function(){return r("borderImage")},b.borderradius=function(){return r("borderRadius","",function(e){return i(e,"orderRadius")})},b.boxshadow=function(){return r("boxShadow")},b.textshadow=function(){return""===t.createElement("div").style.textShadow},b.opacity=function(){var e=g.join("opacity:.5;")+"";return d.cssText=e,i(d.opacity,"0.5")},b.cssanimations=function(){return r("animationName")},b.csscolumns=function(){return r("columnCount")},b.cssgradients=function(){var e=("background-image:"+g.join("gradient(linear,left top,right bottom,from(#9f9),to(white));background-image:")+g.join("linear-gradient(left top,#9f9, white);background-image:")).slice(0,-17);return d.cssText=e,i(d.backgroundImage,"gradient")},b.cssreflections=function(){return r("boxReflect")},b.csstransforms=function(){return!!o(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])},b.csstransforms3d=function(){var e=!!o(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);return e&&(e=S("@media ("+g.join("transform-3d),(")+"modernizr)")),e},b.csstransitions=function(){return r("transitionProperty")},b.fontface=function(){var e,n=t.head||t.getElementsByTagName("head")[0]||u,i=t.createElement("style"),o=t.implementation||{hasFeature:function(){return!1}};return i.type="text/css",n.insertBefore(i,n.firstChild),e=i.sheet||i.styleSheet,n=o.hasFeature("CSS2","")?function(t){if(!e||!t)return!1;var n=!1;try{e.insertRule(t,0),n=!/unknown/i.test(e.cssRules[0].cssText),e.deleteRule(e.cssRules.length-1)}catch(i){}return n}:function(t){return e&&t?(e.cssText=t,0!==e.cssText.length&&!/unknown/i.test(e.cssText)&&0===e.cssText.replace(/\r+|\n+/g,"").indexOf(t.split(" ")[0])):!1},c._fontfaceready=function(e){e(c.fontface)},n('@font-face { font-family: "font"; src: "font.ttf"; }')},b.video=function(){var e=t.createElement("video"),n=!!e.canPlayType;return n&&(n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"'),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"')),n},b.audio=function(){var e=t.createElement("audio"),n=!!e.canPlayType;return n&&(n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"'),n.mp3=e.canPlayType("audio/mpeg;"),n.wav=e.canPlayType('audio/wav; codecs="1"'),n.m4a=e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")),n},b.localstorage=function(){try{return"localStorage"in e&&null!==e.localStorage}catch(t){return!1}},b.sessionstorage=function(){try{return"sessionStorage"in e&&null!==e.sessionStorage}catch(t){return!1}},b.webWorkers=function(){return!!e.Worker},b.applicationcache=function(){return!!e.applicationCache},b.svg=function(){return!!t.createElementNS&&!!t.createElementNS(y.svg,"svg").createSVGRect},b.inlinesvg=function(){var e=document.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==y.svg},b.smil=function(){return!!t.createElementNS&&/SVG/.test(m.call(t.createElementNS(y.svg,"animate")))},b.svgclippaths=function(){return!!t.createElementNS&&/SVG/.test(m.call(t.createElementNS(y.svg,"clipPath")))};for(var k in b)l(b,k)&&(a=k.toLowerCase(),c[a]=b[k](),C.push((c[a]?"":"no-")+a));return c.input||s(),c.crosswindowmessaging=c.postmessage,c.historymanagement=c.history,c.addTest=function(e,t){return e=e.toLowerCase(),c[e]?void 0:(t=!!t(),u.className+=" "+(t?"":"no-")+e,c[e]=t,c)},d.cssText="",h=p=null,e.attachEvent&&function(){var e=t.createElement("div");return e.innerHTML="<elem></elem>",1!==e.childNodes.length}()&&function(e,t){function n(e){for(var t=-1;++t<r;)e.createElement(o[t])}function i(e,t){for(var n,o=e.length,r=-1,s=[];++r<o;)n=e[r],t=n.media||t,s.push(i(n.imports,t)),s.push(n.cssText);return s.join("")}var o="abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video".split("|"),r=o.length,s=RegExp("<(/*)(abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video)","gi"),a=RegExp("\\b(abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video)\\b(?!.*[;}])","gi"),l=t.createDocumentFragment(),c=t.documentElement,u=c.firstChild,h=t.createElement("style"),d=t.createElement("body");h.media="all",n(t),n(l),e.attachEvent("onbeforeprint",function(){for(var e=-1;++e<r;)for(var n=t.getElementsByTagName(o[e]),p=n.length,f=-1;++f<p;)n[f].className.indexOf("iepp_")<0&&(n[f].className+=" iepp_"+o[e]);u.insertBefore(h,u.firstChild),h.styleSheet.cssText=i(t.styleSheets,"all").replace(a,".iepp_$1"),l.appendChild(t.body),c.appendChild(d),d.innerHTML=l.firstChild.innerHTML.replace(s,"<$1bdo")}),e.attachEvent("onafterprint",function(){d.innerHTML="",c.removeChild(d),u.removeChild(h),c.appendChild(l.firstChild)})}(this,document),c._enableHTML5=!0,c._version="1.6",u.className=u.className.replace(/\bno-js\b/,"")+" js",u.className+=" "+C.join(" "),c}(this,this.document);//  Copyright (c) 2008-2009 Nick Stakenburg (http://www.nickstakenburg.com)
var Prototip={Version:"2.2.0.1"},Tips={options:{paths:{images:"/assets/prototip/",javascript:"/javascripts/"},zIndex:6e3}};eval(function(e,t,n,i,o,r){if(o=function(e){return(t>e?"":o(parseInt(e/t)))+((e%=t)>35?String.fromCharCode(e+29):e.toString(36))},!"".replace(/^/,String)){for(;n--;)r[o(n)]=i[n]||o(n);i=[function(e){return r[e]}],o=function(){return"\\w+"},n=1}for(;n--;)i[n]&&(e=e.replace(new RegExp("\\b"+o(n)+"\\b","g"),i[n]));return e}('M.10(11,{4p:"1.6.1",2I:{24:!!X.4q("24").3q},3r:p(a){4r{X.4s("<2g 3s=\'3t/1y\' 1C=\'"+a+"\'><\\/2g>")}4t(b){$$("4u")[0].J(I G("2g",{1C:a,3s:"3t/1y"}))}},3u:p(){3.3v("2J");q a=/1D([\\w\\d-2K.]+)?\\.3w(.*)/;3.2L=(($$("2g[1C]").4v(p(b){K b.1C.25(a)})||{}).1C||"").2M(a,"");s.26=(p(b){K{T:(/^(3x?:\\/\\/|\\/)/.3y(b.T))?b.T:3.2L+b.T,1y:(/^(3x?:\\/\\/|\\/)/.3y(b.1y))?b.1y:3.2L+b.1y}}.1d(3))(s.9.26);3.3r(s.26.1y+"3z.3w");o(!3.2I.24){o(X.4w>=8&&!X.3A.2h){X.3A.2N("2h","4x:4y-4z-4A:4B","#2i#3B")}Y{X.1a("3C:2O",p(){q b=X.4C();b.4D="2h\\\\:*{4E:2P(#2i#3B)}"})}}s.2j();G.1a(2Q,"2R",3.2R)},3v:p(a){o((4F 2Q[a]=="4G")||(3.2S(2Q[a].4H)<3.2S(3["3D"+a]))){3E("11 4I "+a+" >= "+3["3D"+a]);}},2S:p(a){q b=a.2M(/2K.*|\\./g,"");b=4J(b+"0".4K(4-b.1Q));K a.4L("2K")>-1?b-1:b},2T:p(a){K(a>0)?(-1*a):(a).4M()},2R:p(){s.3F()}});M.10(s,(p(){p a(b){o(!b){K}b.3G();o(b.13){b.E.1E();o(s.1i){b.1l.1E()}}s.1m=s.1m.3H(b)}K{1m:[],15:[],2j:p(){3.2k=3.1n},27:{B:"2U",2U:"B",u:"1o",1o:"u",1R:"1R",1b:"1e",1e:"1b"},3I:{H:"1b",F:"1e"},2V:p(b){K!!1S[1]?3.27[b]:b},1i:(p(c){q b=I 4N("4O ([\\\\d.]+)").4P(c);K b?(3J(b[1])<7):U})(4Q.4R),2W:(2J.4S.4T&&!X.4U),2N:p(b){3.1m.28(b)},1E:p(d){q g,e=[];1T(q c=0,b=3.1m.1Q;c<b;c++){q f=3.1m[c];o(!g&&f.C==$(d)){g=f}Y{o(!f.C.3K){e.28(f)}}}a(g);1T(q c=0,b=e.1Q;c<b;c++){q f=e[c];a(f)}d.1D=29},3F:p(){1T(q c=0,b=3.1m.1Q;c<b;c++){a(3.1m[c])}},2l:p(d){o(d==3.3L){K}o(3.15.1Q===0){3.2k=3.9.1n;1T(q c=0,b=3.1m.1Q;c<b;c++){3.1m[c].E.r({1n:3.9.1n})}}d.E.r({1n:3.2k++});o(d.Q){d.Q.r({1n:3.2k})}3.3L=d},3M:p(b){3.2X(b);3.15.28(b)},2X:p(b){3.15=3.15.3H(b)},3N:p(){s.15.1F("S")},V:p(c,g){c=$(c),g=$(g);q l=M.10({1c:{x:0,y:0},N:U},1S[2]||{});q e=l.1t||g.2m();e.B+=l.1c.x;e.u+=l.1c.y;q d=l.1t?[0,0]:g.3O(),b=X.1z.2n(),h=l.1t?"1U":"17";e.B+=(-1*(d[0]-b[0]));e.u+=(-1*(d[1]-b[1]));o(l.1t){q f=[0,0];f.H=0;f.F=0}q j={C:c.1V()},k={C:M.2a(e)};j[h]=l.1t?f:g.1V();k[h]=M.2a(e);1T(q i 3P k){3Q(l[i]){R"4V":R"4W":k[i].B+=j[i].H;18;R"4X":k[i].B+=(j[i].H/2);18;R"4Y":k[i].B+=j[i].H;k[i].u+=(j[i].F/2);18;R"4Z":R"51":k[i].u+=j[i].F;18;R"52":R"53":k[i].B+=j[i].H;k[i].u+=j[i].F;18;R"54":k[i].B+=(j[i].H/2);k[i].u+=j[i].F;18;R"55":k[i].u+=(j[i].F/2);18}}e.B+=-1*(k.C.B-k[h].B);e.u+=-1*(k.C.u-k[h].u);o(l.N){c.r({B:e.B+"v",u:e.u+"v"})}K e}}})());s.2j();q 56=57.3R({2j:p(c,e){3.C=$(c);o(!3.C){3E("11: G 58 59, 5a 3R a 13.");K}s.1E(3.C);q a=(M.2o(e)||M.2Y(e)),b=a?1S[2]||[]:e;3.1p=a?e:29;o(b.1W){b=M.10(M.2a(11.2Z[b.1W]),b)}3.9=M.10(M.10({1j:U,1f:0,30:"#5b",1k:0,L:s.9.L,19:s.9.5c,1u:!(b.W&&b.W=="1X")?0.14:U,1q:U,1g:"1G",3S:U,V:b.V,1c:b.V?{x:0,y:0}:{x:16,y:16},1H:(b.V&&!b.V.1t)?1h:U,W:"2p",D:U,1W:"2i",17:3.C,12:U,1z:(b.V&&!b.V.1t)?U:1h,H:U},11.2Z["2i"]),b);3.17=$(3.9.17);3.1k=3.9.1k;3.1f=(3.1k>3.9.1f)?3.1k:3.9.1f;o(3.9.T){3.T=3.9.T.3T("://")?3.9.T:s.26.T+3.9.T}Y{3.T=s.26.T+"3z/"+(3.9.1W||"")+"/"}o(!3.T.5d("/")){3.T+="/"}o(M.2o(3.9.D)){3.9.D={N:3.9.D}}o(3.9.D.N){3.9.D=M.10(M.2a(11.2Z[3.9.1W].D)||{},3.9.D);3.9.D.N=[3.9.D.N.25(/[a-z]+/)[0].2q(),3.9.D.N.25(/[A-Z][a-z]+/)[0].2q()];3.9.D.1A=["B","2U"].5e(3.9.D.N[0])?"1b":"1e";3.1r={1b:U,1e:U}}o(3.9.1j){3.9.1j.9=M.10({31:2J.5f},3.9.1j.9||{})}o(3.9.V.1t){q d=3.9.V.1s.25(/[a-z]+/)[0].2q();3.1U=s.27[d]+s.27[3.9.V.1s.25(/[A-Z][a-z]+/)[0].2q()].2r()}3.3U=(s.2W&&3.1k);3.3V();s.2N(3);3.3W();11.10(3)},3V:p(){3.E=I G("P",{L:"1D"}).r({1n:s.9.1n});o(3.3U){3.E.S=p(){3.r("B:-3X;u:-3X;1I:2s;");K 3};3.E.O=p(){3.r("1I:15");K 3};3.E.15=p(){K(3.32("1I")=="15"&&3J(3.32("u").2M("v",""))>-5g)}}3.E.S();o(s.1i){3.1l=I G("5h",{L:"1l",1C:"1y:U;",5i:0}).r({2t:"2b",1n:s.9.1n-1,5j:0})}o(3.9.1j){3.1Y=3.1Y.33(3.34)}3.1s=I G("P",{L:"1p"});3.12=I G("P",{L:"12"}).S();o(3.9.19||(3.9.1g.C&&3.9.1g.C=="19")){3.19=I G("P",{L:"2c"}).1Z(3.T+"2c.2u")}},2v:p(){o(X.2O){3.35();3.3Y=1h;K 1h}Y{o(!3.3Y){X.1a("3C:2O",3.35);K U}}},35:p(){$(X.36).J(3.E);o(s.1i){$(X.36).J(3.1l)}o(3.9.1j){$(X.36).J(3.Q=I G("P",{L:"5k"}).1Z(3.T+"Q.5l").S())}q g="E";o(3.9.D.N){3.D=I G("P",{L:"5m"}).r({F:3.9.D[3.9.D.1A=="1e"?"F":"H"]+"v"});q b=3.9.D.1A=="1b";3[g].J(3.37=I G("P",{L:"5n 2w"}).J(3.3Z=I G("P",{L:"5o 2w"})));3.D.J(3.1J=I G("P",{L:"5p"}).r({F:3.9.D[b?"H":"F"]+"v",H:3.9.D[b?"F":"H"]+"v"}));o(s.1i&&!3.9.D.N[1].40().3T("5q")){3.1J.r({2t:"5r"})}g="3Z"}o(3.1f){q d=3.1f,f;3[g].J(3.20=I G("5s",{L:"20"}).J(3.21=I G("38",{L:"21 39"}).r("F: "+d+"v").J(I G("P",{L:"2x 5t"}).J(I G("P",{L:"22"}))).J(f=I G("P",{L:"5u"}).r({F:d+"v"}).J(I G("P",{L:"41"}).r({1v:"0 "+d+"v",F:d+"v"}))).J(I G("P",{L:"2x 5v"}).J(I G("P",{L:"22"})))).J(3.3a=I G("38",{L:"3a 39"}).J(3.3b=I G("P",{L:"3b"}).r("2y: 0 "+d+"v"))).J(3.42=I G("38",{L:"42 39"}).r("F: "+d+"v").J(I G("P",{L:"2x 5w"}).J(I G("P",{L:"22"}))).J(f.5x(1h)).J(I G("P",{L:"2x 5y"}).J(I G("P",{L:"22"})))));g="3b";q c=3.20.3c(".22");$w("5z 5A 5B 5C").43(p(j,h){o(3.1k>0){11.44(c[h],j,{1K:3.9.30,1f:d,1k:3.9.1k})}Y{c[h].2z("45")}c[h].r({H:d+"v",F:d+"v"}).2z("22"+j.2r())}.1d(3));3.20.3c(".41",".3a",".45").1F("r",{1K:3.9.30})}3[g].J(3.13=I G("P",{L:"13 "+3.9.L}).J(3.23=I G("P",{L:"23"}).J(3.12)));o(3.9.H){q e=3.9.H;o(M.5D(e)){e+="v"}3.13.r("H:"+e)}o(3.D){q a={};a[3.9.D.1A=="1b"?"u":"1o"]=3.D;3.E.J(a);3.2e()}3.13.J(3.1s);o(!3.9.1j){3.3d({12:3.9.12,1p:3.1p})}},3d:p(e){q a=3.E.32("1I");3.E.r("F:1L;H:1L;1I:2s").O();o(3.1f){3.21.r("F:0");3.21.r("F:0")}o(e.12){3.12.O().46(e.12);3.23.O()}Y{o(!3.19){3.12.S();3.23.S()}}o(M.2Y(e.1p)){e.1p.O()}o(M.2o(e.1p)||M.2Y(e.1p)){3.1s.46(e.1p)}3.13.r({H:3.13.47()+"v"});3.E.r("1I:15").O();3.13.O();q c=3.13.1V(),b={H:c.H+"v"},d=[3.E];o(s.1i){d.28(3.1l)}o(3.19){3.12.O().J({u:3.19});3.23.O()}o(e.12||3.19){3.23.r("H: 3e%")}b.F=29;3.E.r({1I:a});3.1s.2z("2w");o(e.12||3.19){3.12.2z("2w")}o(3.1f){3.21.r("F:"+3.1f+"v");3.21.r("F:"+3.1f+"v");b="H: "+(c.H+2*3.1f)+"v";d.28(3.20)}d.1F("r",b);o(3.D){3.2e();o(3.9.D.1A=="1b"){3.E.r({H:3.E.47()+3.9.D.F+"v"})}}3.E.S()},3W:p(){3.3f=3.1Y.1w(3);3.48=3.S.1w(3);o(3.9.1H&&3.9.W=="2p"){3.9.W="3g"}o(3.9.W&&3.9.W==3.9.1g){3.1M=3.49.1w(3);3.C.1a(3.9.W,3.1M)}o(3.19){3.19.1a("3g",p(d){d.1Z(3.T+"5E.2u")}.1d(3,3.19)).1a("3h",p(d){d.1Z(3.T+"2c.2u")}.1d(3,3.19))}q c={C:3.1M?[]:[3.C],17:3.1M?[]:[3.17],1s:3.1M?[]:[3.E],19:[],2b:[]},a=3.9.1g.C;3.3i=a||(!3.9.1g?"2b":"C");3.1N=c[3.3i];o(!3.1N&&a&&M.2o(a)){3.1N=3.1s.3c(a)}$w("O S").43(p(g){q f=g.2r(),d=(3.9[g+"4a"].5F||3.9[g+"4a"]);o(d=="3g"){d=="3j"}Y{o(d=="3h"){d=="1G"}}3[g+"5G"]=d}.1d(3));o(!3.1M&&3.9.W){3.C.1a(3.9.W,3.3f)}o(3.1N&&3.9.1g){3.1N.1F("1a",3.5H,3.48)}o(!3.9.1H&&3.9.W=="1X"){3.2A=3.N.1w(3);3.C.1a("2p",3.2A)}3.4b=3.S.33(p(f,e){q d=e.5I(".2c");o(d){d.5J();e.5K();f(e)}}).1w(3);o(3.19||(3.9.1g&&(3.9.1g.C==".2c"))){3.E.1a("1X",3.4b)}o(3.9.W!="1X"&&(3.3i!="C")){3.2B=p(){3.1B("O")}.1w(3);3.C.1a("1G",3.2B)}o(3.9.1g||3.9.1q){q b=[3.C,3.E];3.3k=p(){s.2l(3);3.2C()}.1w(3);3.3l=3.1q.1w(3);b.1F("1a","3j",3.3k).1F("1a","1G",3.3l)}o(3.9.1j&&3.9.W!="1X"){3.2D=3.4c.1w(3);3.C.1a("1G",3.2D)}},3G:p(){o(3.9.W&&3.9.W==3.9.1g){3.C.1x(3.9.W,3.1M)}Y{o(3.9.W){3.C.1x(3.9.W,3.3f)}o(3.1N&&3.9.1g){3.1N.1F("1x")}}o(3.2A){3.C.1x("2p",3.2A)}o(3.2B){3.C.1x("3h",3.2B)}3.E.1x();o(3.9.1g||3.9.1q){3.C.1x("3j",3.3k).1x("1G",3.3l)}o(3.2D){3.C.1x("1G",3.2D)}},34:p(c,b){o(!3.13){o(!3.2v()){K}}3.N(b);o(3.2E){K}Y{o(3.4d){c(b);K}}3.2E=1h;q e=b.5L(),d={2f:{1O:e.x,1P:e.y}};q a=M.2a(3.9.1j.9);a.31=a.31.33(p(g,f){3.3d({12:3.9.12,1p:f.5M});3.N(d);(p(){g(f);q h=(3.Q&&3.Q.15());o(3.Q){3.1B("Q");3.Q.1E();3.Q=29}o(h){3.O()}3.4d=1h;3.2E=29}.1d(3)).1u(0.6)}.1d(3));3.5N=G.O.1u(3.9.1u,3.Q);3.E.S();3.2E=1h;3.Q.O();3.5O=(p(){I 5P.5Q(3.9.1j.2P,a)}.1d(3)).1u(3.9.1u);K U},4c:p(){3.1B("Q")},1Y:p(a){o(!3.13){o(!3.2v()){K}}3.N(a);o(3.E.15()){K}3.1B("O");3.5R=3.O.1d(3).1u(3.9.1u)},1B:p(a){o(3[a+"4e"]){5S(3[a+"4e"])}},O:p(){o(3.E.15()){K}o(s.1i){3.1l.O()}o(3.9.3S){s.3N()}s.3M(3);3.13.O();3.E.O();o(3.D){3.D.O()}3.C.4f("1D:5T")},1q:p(a){o(3.9.1j){o(3.Q&&3.9.W!="1X"){3.Q.S()}}o(!3.9.1q){K}3.2C();3.5U=3.S.1d(3).1u(3.9.1q)},2C:p(){o(3.9.1q){3.1B("1q")}},S:p(){3.1B("O");3.1B("Q");o(!3.E.15()){K}3.4g()},4g:p(){o(s.1i){3.1l.S()}o(3.Q){3.Q.S()}3.E.S();(3.20||3.13).O();s.2X(3);3.C.4f("1D:2s")},49:p(a){o(3.E&&3.E.15()){3.S(a)}Y{3.1Y(a)}},2e:p(){q c=3.9.D,b=1S[0]||3.1r,d=s.2V(c.N[0],b[c.1A]),f=s.2V(c.N[1],b[s.27[c.1A]]),a=3.1k||0;3.1J.1Z(3.T+d+f+".2u");o(c.1A=="1b"){q e=(d=="B")?c.F:0;3.37.r("B: "+e+"v;");3.1J.r({"2F":d});3.D.r({B:0,u:(f=="1o"?"3e%":f=="1R"?"50%":0),5V:(f=="1o"?-1*c.H:f=="1R"?-0.5*c.H:0)+(f=="1o"?-1*a:f=="u"?a:0)+"v"})}Y{3.37.r(d=="u"?"1v: 0; 2y: "+c.F+"v 0 0 0;":"2y: 0; 1v: 0 0 "+c.F+"v 0;");3.D.r(d=="u"?"u: 0; 1o: 1L;":"u: 1L; 1o: 0;");3.1J.r({1v:0,"2F":f!="1R"?f:"2b"});o(f=="1R"){3.1J.r("1v: 0 1L;")}Y{3.1J.r("1v-"+f+": "+a+"v;")}o(s.2W){o(d=="1o"){3.D.r({N:"4h",5W:"5X",u:"1L",1o:"1L","2F":"B",H:"3e%",1v:(-1*c.F)+"v 0 0 0"});3.D.1W.2t="4i"}Y{3.D.r({N:"4j","2F":"2b",1v:0})}}}3.1r=b},N:p(b){o(!3.13){o(!3.2v()){K}}s.2l(3);o(s.1i){q a=3.E.1V();o(!3.2G||3.2G.F!=a.F||3.2G.H!=a.H){3.1l.r({H:a.H+"v",F:a.F+"v"})}3.2G=a}o(3.9.V){q j,h;o(3.1U){q k=X.1z.2n(),c=b.2f||{};q g,i=2;3Q(3.1U.40()){R"5Y":R"5Z":g={x:0-i,y:0-i};18;R"60":g={x:0,y:0-i};18;R"61":R"62":g={x:i,y:0-i};18;R"63":g={x:i,y:0};18;R"64":R"65":g={x:i,y:i};18;R"66":g={x:0,y:i};18;R"67":R"68":g={x:0-i,y:i};18;R"69":g={x:0-i,y:0};18}g.x+=3.9.1c.x;g.y+=3.9.1c.y;j=M.10({1c:g},{C:3.9.V.1s,1U:3.1U,1t:{u:c.1P||2H.1P(b)-k.u,B:c.1O||2H.1O(b)-k.B}});h=s.V(3.E,3.17,j);o(3.9.1z){q n=3.3m(h),m=n.1r;h=n.N;h.B+=m.1e?2*11.2T(g.x-3.9.1c.x):0;h.u+=m.1e?2*11.2T(g.y-3.9.1c.y):0;o(3.D&&(3.1r.1b!=m.1b||3.1r.1e!=m.1e)){3.2e(m)}}h={B:h.B+"v",u:h.u+"v"};3.E.r(h)}Y{j=M.10({1c:3.9.1c},{C:3.9.V.1s,17:3.9.V.17});h=s.V(3.E,3.17,M.10({N:1h},j));h={B:h.B+"v",u:h.u+"v"}}o(3.Q){q e=s.V(3.Q,3.17,M.10({N:1h},j))}o(s.1i){3.1l.r(h)}}Y{q f=3.17.2m(),c=b.2f||{},h={B:((3.9.1H)?f[0]:c.1O||2H.1O(b))+3.9.1c.x,u:((3.9.1H)?f[1]:c.1P||2H.1P(b))+3.9.1c.y};o(!3.9.1H&&3.C!==3.17){q d=3.C.2m();h.B+=-1*(d[0]-f[0]);h.u+=-1*(d[1]-f[1])}o(!3.9.1H&&3.9.1z){q n=3.3m(h),m=n.1r;h=n.N;o(3.D&&(3.1r.1b!=m.1b||3.1r.1e!=m.1e)){3.2e(m)}}h={B:h.B+"v",u:h.u+"v"};3.E.r(h);o(3.Q){3.Q.r(h)}o(s.1i){3.1l.r(h)}}},3m:p(c){q e={1b:U,1e:U},d=3.E.1V(),b=X.1z.2n(),a=X.1z.1V(),g={B:"H",u:"F"};1T(q f 3P g){o((c[f]+d[g[f]]-b[f])>a[g[f]]){c[f]=c[f]-(d[g[f]]+(2*3.9.1c[f=="B"?"x":"y"]));o(3.D){e[s.3I[g[f]]]=1h}}}K{N:c,1r:e}}});M.10(11,{44:p(d,g){q j=1S[2]||3.9,f=j.1k,c=j.1f,e={u:(g.4k(0)=="t"),B:(g.4k(1)=="l")};o(3.2I.24){q b=I G("24",{L:"6a"+g.2r(),H:c+"v",F:c+"v"});d.J(b);q i=b.3q("2d");i.6b=j.1K;i.6c((e.B?f:c-f),(e.u?f:c-f),f,0,6d.6e*2,1h);i.6f();i.4l((e.B?f:0),0,c-f,c);i.4l(0,(e.u?f:0),c,c-f)}Y{q h;d.J(h=I G("P").r({H:c+"v",F:c+"v",1v:0,2y:0,2t:"4i",N:"4h",6g:"2s"}));q a=I G("2h:6h",{6i:j.1K,6j:"6k",6l:j.1K,6m:(f/c*0.5).6n(2)}).r({H:2*c-1+"v",F:2*c-1+"v",N:"4j",B:(e.B?0:(-1*c))+"v",u:(e.u?0:(-1*c))+"v"});h.J(a);a.4m=a.4m}}});G.6o({1Z:p(c,b){c=$(c);q a=M.10({4n:"u B",3n:"6p-3n",3o:"6q",1K:""},1S[2]||{});c.r(s.1i?{6r:"6s:6t.6u.6v(1C=\'"+b+"\'\', 3o=\'"+a.3o+"\')"}:{6w:a.1K+" 2P("+b+") "+a.4n+" "+a.3n});K c}});11.3p={4o:p(a){o(a.C&&!a.C.3K){K 1h}K U},O:p(){o(11.3p.4o(3)){K}s.2l(3);3.2C();q d={};o(3.9.V){d.2f={1O:0,1P:0}}Y{q a=3.17.2m(),c=3.17.3O(),b=X.1z.2n();a.B+=(-1*(c[0]-b[0]));a.u+=(-1*(c[1]-b[1]));d.2f={1O:a.B,1P:a.u}}o(3.9.1j){3.34(d)}Y{3.1Y(d)}3.1q()}};11.10=p(a){a.C.1D={};M.10(a.C.1D,{O:11.3p.O.1d(a),S:a.S.1d(a),1E:s.1E.1d(s,a.C)})};11.3u();',62,405,"|||this||||||options|||||||||||||||if|function|var|setStyle|Tips||top|px||||||left|element|stem|wrapper|height|Element|width|new|insert|return|className|Object|position|show|div|loader|case|hide|images|false|hook|showOn|document|else||extend|Prototip|title|tooltip||visible||target|break|closeButton|observe|horizontal|offset|bind|vertical|border|hideOn|true|fixIE|ajax|radius|iframeShim|tips|zIndex|bottom|content|hideAfter|stemInverse|tip|mouse|delay|margin|bindAsEventListener|stopObserving|javascript|viewport|orientation|clearTimer|src|prototip|remove|invoke|mouseleave|fixed|visibility|stemImage|backgroundColor|auto|eventToggle|hideTargets|pointerX|pointerY|length|middle|arguments|for|mouseHook|getDimensions|style|click|showDelayed|setPngBackground|borderFrame|borderTop|prototip_Corner|toolbar|canvas|match|paths|_inverse|push|null|clone|none|close||positionStem|fakePointer|script|ns_vml|default|initialize|zIndexTop|raise|cumulativeOffset|getScrollOffsets|isString|mousemove|toLowerCase|capitalize|hidden|display|png|build|clearfix|prototip_CornerWrapper|padding|addClassName|eventPosition|eventCheckDelay|cancelHideAfter|ajaxHideEvent|ajaxContentLoading|float|iframeShimDimensions|Event|support|Prototype|_|path|replace|add|loaded|url|window|unload|convertVersionString|toggleInt|right|inverseStem|WebKit419|removeVisible|isElement|Styles|borderColor|onComplete|getStyle|wrap|ajaxShow|_build|body|stemWrapper|li|borderRow|borderMiddle|borderCenter|select|_update|100|eventShow|mouseover|mouseout|hideElement|mouseenter|activityEnter|activityLeave|getPositionWithinViewport|repeat|sizingMethod|Methods|getContext|insertScript|type|text|start|require|js|https|test|styles|namespaces|VML|dom|REQUIRED_|throw|removeAll|deactivate|without|_stemTranslation|parseFloat|parentNode|_highest|addVisibile|hideAll|cumulativeScrollOffset|in|switch|create|hideOthers|include|fixSafari2|setup|activate|9500px|_isBuilding|stemBox|toUpperCase|prototip_Between|borderBottom|each|createCorner|prototip_Fill|update|getWidth|eventHide|toggle|On|buttonEvent|ajaxHide|ajaxContentLoaded|Timer|fire|afterHide|relative|block|absolute|charAt|fillRect|outerHTML|align|hold|REQUIRED_Prototype|createElement|try|write|catch|head|find|documentMode|urn|schemas|microsoft|com|vml|createStyleSheet|cssText|behavior|typeof|undefined|Version|requires|parseInt|times|indexOf|abs|RegExp|MSIE|exec|navigator|userAgent|Browser|WebKit|evaluate|topRight|rightTop|topMiddle|rightMiddle|bottomLeft||leftBottom|bottomRight|rightBottom|bottomMiddle|leftMiddle|Tip|Class|not|available|cannot|000000|closeButtons|endsWith|member|emptyFunction|9500|iframe|frameBorder|opacity|prototipLoader|gif|prototip_Stem|prototip_StemWrapper|prototip_StemBox|prototip_StemImage|MIDDLE|inline|ul|prototip_CornerWrapperTopLeft|prototip_BetweenCorners|prototip_CornerWrapperTopRight|prototip_CornerWrapperBottomLeft|cloneNode|prototip_CornerWrapperBottomRight|tl|tr|bl|br|isNumber|close_hover|event|Action|hideAction|findElement|blur|stop|pointer|responseText|loaderTimer|ajaxTimer|Ajax|Request|showTimer|clearTimeout|shown|hideAfterTimer|marginTop|clear|both|LEFTTOP|TOPLEFT|TOPMIDDLE|TOPRIGHT|RIGHTTOP|RIGHTMIDDLE|RIGHTBOTTOM|BOTTOMRIGHT|BOTTOMMIDDLE|BOTTOMLEFT|LEFTBOTTOM|LEFTMIDDLE|cornerCanvas|fillStyle|arc|Math|PI|fill|overflow|roundrect|fillcolor|strokeWeight|1px|strokeColor|arcSize|toFixed|addMethods|no|scale|filter|progid|DXImageTransform|Microsoft|AlphaImageLoader|background".split("|"),0,{})),Array.prototype.map||(Array.prototype.map=function(e,t){for(var n=this.length,i=new Array(n),o=0;n>o;o++)o in this&&(i[o]=e.call(t,this[o],o,this));return i}),Array.prototype.filter||(Array.prototype.filter=function(e,t){for(var n=this.length,i=new Array,o=0;n>o;o++)if(o in this){var r=this[o];e.call(t,r,o,this)&&i.push(r)}return i}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=this.length>>>0,i=0;n>i;i++)i in this&&e.call(t,this[i],i,this)}),Array.prototype.reduce||(Array.prototype.reduce=function(e,t){var n=this.length;if(!n&&1==arguments.length)throw new Error("reduce: empty array, no initial value");var i=0;if(arguments.length<2)for(;;){if(i in this){t=this[i++];break}if(++i>=n)throw new Error("reduce: no values, no initial value")}for(;n>i;i++)i in this&&(t=e(t,this[i],i,this));return t}),Date.__parse__=Date.parse,Date.parse=function(e,t){if(1==arguments.length)return Date.__parse__(e);var n=1970,i=0,o=1,r=0,s=0,a=0,l=[function(){}];t=t.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&"),t=t.replace(/%[a-zA-Z0-9]/g,function(e){switch(e){case"%b":return l.push(function(e){i={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[e]}),"([A-Za-z]+)";case"%h":case"%B":return l.push(function(e){i={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11}[e]}),"([A-Za-z]+)";case"%e":case"%d":return l.push(function(e){o=e}),"([0-9]+)";case"%H":return l.push(function(e){r=e}),"([0-9]+)";case"%m":return l.push(function(e){i=e-1}),"([0-9]+)";case"%M":return l.push(function(e){s=e}),"([0-9]+)";case"%S":return l.push(function(e){a=e}),"([0-9]+)";case"%y":return l.push(function(e){e=Number(e),n=e+(e>=0&&69>e?2e3:e>=69&&100>e?1900:0)}),"([0-9]+)";case"%Y":return l.push(function(e){n=e}),"([0-9]+)";case"%%":return l.push(function(){}),"%"}return e});var c=e.match(t);return c&&c.forEach(function(e,t){l[t](e)}),new Date(n,i,o,r,s,a)},Date.prototype.format=Date.prototype.toLocaleFormat?Date.prototype.toLocaleFormat:function(e){function t(e,t){return 10>e?(t||"0")+e:e}var n=this;return e.replace(/%[a-zA-Z0-9]/g,function(e){switch(e){case"%a":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][n.getDay()];case"%A":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][n.getDay()];case"%h":case"%b":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n.getMonth()];case"%B":return["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()];case"%c":return n.toLocaleString();case"%C":return t(Math.floor(n.getFullYear()/100)%100);case"%d":return t(n.getDate());case"%x":case"%D":return t(n.getMonth()+1)+"/"+t(n.getDate())+"/"+t(n.getFullYear()%100);case"%e":return t(n.getDate()," ");case"%H":return t(n.getHours());case"%I":var i=n.getHours()%12;return i?t(i):12;case"%m":return t(n.getMonth()+1);case"%M":return t(n.getMinutes());case"%n":return"\n";case"%p":return n.getHours()<12?"AM":"PM";case"%T":case"%X":case"%r":var i=n.getHours()%12;return(i?t(i):12)+":"+t(n.getMinutes())+":"+t(n.getSeconds())+" "+(n.getHours()<12?"AM":"PM");case"%R":return t(n.getHours())+":"+t(n.getMinutes());case"%S":return t(n.getSeconds());case"%t":return"	";case"%u":var o=n.getDay();return o?o:1;case"%w":return n.getDay();case"%y":return t(n.getFullYear()%100);case"%Y":return n.getFullYear();case"%%":return"%"}return e})};var pv=function(){function map(e,t){var n={};return t?e.map(function(e,i){return n.index=i,t.call(n,e)}):e.slice()}function argv(e){for(var t=[];e;)t.push(e.scene[e.index].data),e=e.parent;return t}var pv={};pv.extend=function(e){function t(){}return t.prototype=e.prototype||e,new t};try{eval("pv.parse = function(x) x;")}catch(e){pv.parse=function(e){for(var t,n,i=new RegExp("function(\\s+\\w+)?\\([^)]*\\)\\s*","mg"),o=0,r="";t=i.exec(e);){var s=t.index+t[0].length;if("{"!=e.charAt(s--)){r+=e.substring(o,s)+"{return ",o=s;for(var a=0;a>=0&&s<e.length;s++){var l=e.charAt(s);switch(l){case'"':case"'":for(;++s<e.length&&(n=e.charAt(s))!=l;)"\\"==n&&s++;break;case"[":case"(":a++;break;case"]":case")":a--;break;case";":case",":0==a&&a--}}r+=pv.parse(e.substring(o,--s))+";}",o=s}i.lastIndex=s}return r+=e.substring(o)}}pv.identity=function(e){return e},pv.index=function(){return this.index},pv.child=function(){return this.childIndex},pv.parent=function(){return this.parent.index},pv.range=function(e,t,n){if(1==arguments.length&&(t=e,e=0),void 0==n)n=1;else if(!n)throw new Error("step must be non-zero");var i,o=[],r=0;if(0>n)for(;(i=e+n*r++)>t;)o.push(i);else for(;(i=e+n*r++)<t;)o.push(i);return o},pv.random=function(e,t,n){return 1==arguments.length&&(t=e,e=0),void 0==n&&(n=1),n?Math.floor(Math.random()*(t-e)/n)*n+e:Math.random()*(t-e)+e},pv.repeat=function(e,t){return 1==arguments.length&&(t=2),pv.blend(pv.range(t).map(function(){return e}))},pv.cross=function(e,t){for(var n=[],i=0,o=e.length,r=t.length;o>i;i++)for(var s=0,a=e[i];r>s;s++)n.push([a,t[s]]);return n},pv.blend=function(e){return Array.prototype.concat.apply([],e)},pv.transpose=function(e){var t=e.length,n=pv.max(e,function(e){return e.length});if(n>t){e.length=n;for(var i=t;n>i;i++)e[i]=new Array(t);for(var i=0;t>i;i++)for(var o=i+1;n>o;o++){var r=e[i][o];e[i][o]=e[o][i],e[o][i]=r}}else{for(var i=0;n>i;i++)e[i].length=t;for(var i=0;t>i;i++)for(var o=0;i>o;o++){var r=e[i][o];e[i][o]=e[o][i],e[o][i]=r}}e.length=n;for(var i=0;n>i;i++)e[i].length=t;return e},pv.keys=function(e){var t=[];for(var n in e)t.push(n);return t},pv.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},pv.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},pv.normalize=function(e,t){for(var n=map(e,t),i=pv.sum(n),o=0;o<n.length;o++)n[o]/=i;return n},pv.sum=function(e,t){var n={};return e.reduce(t?function(e,i,o){return n.index=o,e+t.call(n,i)}:function(e,t){return e+t},0)},pv.max=function(e,t){return t==pv.index?e.length-1:Math.max.apply(null,t?map(e,t):e)},pv.max.index=function(e,t){if(t==pv.index)return e.length-1;t||(t=pv.identity);for(var n=-1,i=-1/0,o={},r=0;r<e.length;r++){o.index=r;var s=t.call(o,e[r]);s>i&&(i=s,n=r)}return n},pv.min=function(e,t){return t==pv.index?0:Math.min.apply(null,t?map(e,t):e)},pv.min.index=function(e,t){if(t==pv.index)return 0;t||(t=pv.identity);for(var n=-1,i=1/0,o={},r=0;r<e.length;r++){o.index=r;var s=t.call(o,e[r]);i>s&&(i=s,n=r)}return n},pv.mean=function(e,t){return pv.sum(e,t)/e.length},pv.median=function(e,t){if(t==pv.index)return(e.length-1)/2;if(e=map(e,t).sort(pv.naturalOrder),e.length%2)return e[Math.floor(e.length/2)];var n=e.length/2;return(e[n-1]+e[n])/2},pv.dict=function(e,t){for(var n={},i={},o=0;o<e.length;o++)if(o in e){var r=e[o];i.index=o,n[r]=t.call(i,r)}return n},pv.permute=function(e,t,n){n||(n=pv.identity);var i=new Array(t.length),o={};return t.forEach(function(t,r){o.index=t,i[r]=n.call(o,e[t])}),i},pv.numerate=function(e,t){t||(t=pv.identity);var n={},i={};return e.forEach(function(e,o){i.index=o,n[t.call(i,e)]=o}),n},pv.naturalOrder=function(e,t){return t>e?-1:e>t?1:0},pv.reverseOrder=function(e,t){return e>t?-1:t>e?1:0},pv.css=function(e,t){return window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue(t):e.currentStyle[t]},pv.ns={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink"},pv.version={major:3,minor:1},pv.error=function(e){"undefined"==typeof console?alert(e):console.error(e)},pv.listen=function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},pv.log=function(e,t){return Math.log(e)/Math.log(t)},pv.logSymmetric=function(e,t){return 0==e?0:0>e?-pv.log(-e,t):pv.log(e,t)},pv.logAdjusted=function(e,t){var n=0>e;return t>e&&(e+=(t-e)/t),n?-pv.log(e,t):pv.log(e,t)},pv.logFloor=function(e,t){return e>0?Math.pow(t,Math.floor(pv.log(e,t))):-Math.pow(t,-Math.floor(-pv.log(-e,t)))},pv.logCeil=function(e,t){return e>0?Math.pow(t,Math.ceil(pv.log(e,t))):-Math.pow(t,-Math.ceil(-pv.log(-e,t)))},pv.search=function(e,t,n){n||(n=pv.identity);for(var i=0,o=e.length-1;o>=i;){var r=i+o>>1,s=n(e[r]);if(t>s)i=r+1;else{if(!(s>t))return r;o=r-1}}return-i-1},pv.search.index=function(e,t,n){var i=pv.search(e,t,n);return 0>i?-i-1:i},pv.tree=function(e){return new pv.Tree(e)},pv.Tree=function(e){this.array=e},pv.Tree.prototype.keys=function(e){return this.k=e,this},pv.Tree.prototype.value=function(e){return this.v=e,this},pv.Tree.prototype.map=function(){for(var e={},t={},n=0;n<this.array.length;n++){t.index=n;for(var i=this.array[n],o=this.k.call(t,i),r=e,s=0;s<o.length-1;s++)r=r[o[s]]||(r[o[s]]={});r[o[s]]=this.v?this.v.call(t,i):i}return e},pv.nest=function(e){return new pv.Nest(e)},pv.Nest=function(e){this.array=e,this.keys=[]},pv.Nest.prototype.key=function(e){return this.keys.push(e),this},pv.Nest.prototype.sortKeys=function(e){return this.keys[this.keys.length-1].order=e||pv.naturalOrder,this},pv.Nest.prototype.sortValues=function(e){return this.order=e||pv.naturalOrder,this},pv.Nest.prototype.map=function(){for(var e,t={},n=[],i=0;i<this.array.length;i++){var o=this.array[i],r=t;for(e=0;e<this.keys.length-1;e++){var s=this.keys[e](o);r[s]||(r[s]={}),r=r[s]}if(s=this.keys[e](o),!r[s]){var a=[];n.push(a),r[s]=a}r[s].push(o)}if(this.order)for(var e=0;e<n.length;e++)n[e].sort(this.order);return t},pv.Nest.prototype.entries=function(){function e(t){var n=[];for(var i in t){var o=t[i];n.push({key:i,values:o instanceof Array?o:e(o)})}return n}function t(e,n){var i=this.keys[n].order;if(i&&e.sort(function(e,t){return i(e.key,t.key)}),++n<this.keys.length)for(var o=0;o<e.length;o++)t.call(this,e[o].values,n);return e}return t.call(this,e(this.map()),0)},pv.Nest.prototype.rollup=function(e){function t(n){for(var i in n){var o=n[i];o instanceof Array?n[i]=e(o):t(o)}return n}return t(this.map())},pv.flatten=function(e){return new pv.Flatten(e)},pv.Flatten=function(e){this.map=e,this.keys=[]},pv.Flatten.prototype.key=function(e,t){return this.keys.push({name:e,value:t}),this},pv.Flatten.prototype.array=function(){function e(o,r){if(r<i.length-1)for(var s in o)n.push(s),e(o[s],r+1),n.pop();else t.push(n.concat(o))}var t=[],n=[],i=this.keys;return e(this.map,0),t.map(function(e){for(var t={},n=0;n<i.length;n++){var o=i[n],r=e[n];t[o.name]=o.value?o.value.call(null,r):r}return t})},pv.vector=function(e,t){return new pv.Vector(e,t)},pv.Vector=function(e,t){this.x=e,this.y=t},pv.Vector.prototype.perp=function(){return new pv.Vector(-this.y,this.x)},pv.Vector.prototype.norm=function(){var e=this.length();return this.times(e?1/e:1)},pv.Vector.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},pv.Vector.prototype.times=function(e){return new pv.Vector(this.x*e,this.y*e)},pv.Vector.prototype.plus=function(e,t){return 1==arguments.length?new pv.Vector(this.x+e.x,this.y+e.y):new pv.Vector(this.x+e,this.y+t)},pv.Vector.prototype.minus=function(e,t){return 1==arguments.length?new pv.Vector(this.x-e.x,this.y-e.y):new pv.Vector(this.x-e,this.y-t)},pv.Vector.prototype.dot=function(e,t){return 1==arguments.length?this.x*e.x+this.y*e.y:this.x*e+this.y*t},pv.Scale=function(){},pv.Scale.interpolator=function(e,t){return"number"==typeof e?function(n){return n*(t-e)+e}:(e=pv.color(e).rgb(),t=pv.color(t).rgb(),function(n){var i=e.a*(1-n)+t.a*n;return 1e-5>i&&(i=0),0==e.a?pv.rgb(t.r,t.g,t.b,i):0==t.a?pv.rgb(e.r,e.g,e.b,i):pv.rgb(Math.round(e.r*(1-n)+t.r*n),Math.round(e.g*(1-n)+t.g*n),Math.round(e.b*(1-n)+t.b*n),i)})},pv.Scale.linear=function(){function e(e){var n=pv.search(t,e);return 0>n&&(n=-n-2),n=Math.max(0,Math.min(i.length-1,n)),i[n]((e-t[n])/(t[n+1]-t[n]))}var t=[0,1],n=[0,1],i=[pv.identity],o=0;return e.domain=function(e,n,i){return arguments.length?(e instanceof Array?(arguments.length<2&&(n=pv.identity),arguments.length<3&&(i=n),t=[pv.min(e,n),pv.max(e,i)]):t=Array.prototype.slice.call(arguments),this):t},e.range=function(){if(arguments.length){n=Array.prototype.slice.call(arguments),i=[];for(var e=0;e<n.length-1;e++)i.push(pv.Scale.interpolator(n[e],n[e+1]));return this}return n},e.invert=function(e){var o=pv.search(n,e);return 0>o&&(o=-o-2),o=Math.max(0,Math.min(i.length-1,o)),(e-n[o])/(n[o+1]-n[o])*(t[o+1]-t[o])+t[o]},e.ticks=function(){var e=t[0],n=t[t.length-1],i=n-e,r=pv.logCeil(i/10,10);2>i/r?r/=5:5>i/r&&(r/=2);var s=Math.ceil(e/r)*r,a=Math.floor(n/r)*r;return o=Math.max(0,-Math.floor(pv.log(r,10)+.01)),pv.range(s,a+r,r)},e.tickFormat=function(e){return e.toFixed(o)},e.nice=function(){var e=t[0],n=t[t.length-1],i=Math.pow(10,Math.round(Math.log(n-e)/Math.log(10))-1);return t=[Math.floor(e/i)*i,Math.ceil(n/i)*i],this},e.by=function(t){function n(){return e(t.apply(this,arguments))}for(var i in e)n[i]=e[i];return n},e.domain.apply(e,arguments),e},pv.Scale.log=function(){function e(e){var o=pv.search(n,e);return 0>o&&(o=-o-2),o=Math.max(0,Math.min(s.length-1,o)),s[o]((t(e)-i[o])/(i[o+1]-i[o]))}function t(e){return pv.logSymmetric(e,o)}var n=[1,10],i=[0,1],o=10,r=[0,1],s=[pv.identity];return e.domain=function(e,o,r){return arguments.length?(e instanceof Array?(arguments.length<2&&(o=pv.identity),arguments.length<3&&(r=o),n=[pv.min(e,o),pv.max(e,r)]):n=Array.prototype.slice.call(arguments),i=n.map(t),this):n},e.range=function(){if(arguments.length){r=Array.prototype.slice.call(arguments),s=[];for(var e=0;e<r.length-1;e++)s.push(pv.Scale.interpolator(r[e],r[e+1]));return this}return r},e.invert=function(e){var t=pv.search(r,e);0>t&&(t=-t-2),t=Math.max(0,Math.min(s.length-1,t));var a=i[t]+(e-r[t])/(r[t+1]-r[t])*(i[t+1]-i[t]);return n[t]<0?-Math.pow(o,-a):Math.pow(o,a)},e.ticks=function(){for(var e=Math.floor(i[0]),t=Math.ceil(i[1]),r=[],s=e;t>s;s++){var a=Math.pow(o,s);n[0]<0&&(a=-a);for(var l=1;o>l;l++)r.push(a*l)}return r.push(Math.pow(o,t)),r[0]<n[0]&&r.shift(),r[r.length-1]>n[1]&&r.pop(),r},e.tickFormat=function(e){return e.toPrecision(1)},e.nice=function(){return n=[pv.logFloor(n[0],o),pv.logCeil(n[1],o)],i=n.map(t),this},e.base=function(e){return arguments.length?(o=e,i=n.map(t),this):o},e.by=function(t){function n(){return e(t.apply(this,arguments))}for(var i in e)n[i]=e[i];return n},e.domain.apply(e,arguments),e},pv.Scale.ordinal=function(){function e(e){return e in n||(n[e]=t.push(e)-1),i[n[e]%i.length]}var t=[],n={},i=[];return e.domain=function(e,i){if(arguments.length){e=e instanceof Array?arguments.length>1?map(e,i):e:Array.prototype.slice.call(arguments),t=[];for(var o={},r=0;r<e.length;r++){var s=e[r];s in o||(o[s]=!0,t.push(s))}return n=pv.numerate(t),this}return t},e.range=function(e,t){return arguments.length?(i=e instanceof Array?arguments.length>1?map(e,t):e:Array.prototype.slice.call(arguments),"string"==typeof i[0]&&(i=i.map(pv.color)),this):i},e.split=function(e,t){var n=(t-e)/this.domain().length;return i=pv.range(e+n/2,t,n),this},e.splitFlush=function(e,t){var n=this.domain().length,o=(t-e)/(n-1);return i=1==n?[(e+t)/2]:pv.range(e,t+o/2,o),this},e.splitBanded=function(e,t,n){if(arguments.length<3&&(n=1),0>n){var o=this.domain().length,r=-n*o,s=t-e-r,a=s/(o+1);i=pv.range(e+a,t,a-n),i.band=-n}else{var l=(t-e)/(this.domain().length+(1-n));i=pv.range(e+l*(1-n),t,l),i.band=l*n}return this},e.by=function(t){function n(){return e(t.apply(this,arguments))}for(var i in e)n[i]=e[i];return n},e.domain.apply(e,arguments),e},pv.color=function(e){function t(e){var t=parseFloat(e);return"%"==e[e.length-1]?Math.round(2.55*t):t}if(!e||"transparent"==e)return pv.rgb(0,0,0,0);if(e instanceof pv.Color)return e;var n=/([a-z]+)\((.*)\)/i.exec(e);if(n){var i=n[2].split(","),o=1;switch(n[1]){case"hsla":case"rgba":o=parseFloat(i[3])}switch(n[1]){case"hsla":case"hsl":var r=parseFloat(i[0]),s=parseFloat(i[1])/100,a=parseFloat(i[2])/100;return new pv.Color.Hsl(r,s,a,o).rgb();case"rgba":case"rgb":var l=t(i[0]),c=t(i[1]),u=t(i[2]);return pv.rgb(l,c,u,o)}}if(e=pv.Color.names[e]||e,"#"==e.charAt(0)){var l,c,u;return 4==e.length?(l=e.charAt(1),l+=l,c=e.charAt(2),c+=c,u=e.charAt(3),u+=u):7==e.length&&(l=e.substring(1,3),c=e.substring(3,5),u=e.substring(5,7)),pv.rgb(parseInt(l,16),parseInt(c,16),parseInt(u,16),1)}return new pv.Color(e,1)},pv.Color=function(e,t){this.color=e,this.opacity=t},pv.Color.prototype.brighter=function(e){return this.rgb().brighter(e)},pv.Color.prototype.darker=function(e){return this.rgb().darker(e)},pv.rgb=function(e,t,n,i){return new pv.Color.Rgb(e,t,n,4==arguments.length?i:1)},pv.Color.Rgb=function(e,t,n,i){pv.Color.call(this,i?"rgb("+e+","+t+","+n+")":"none",i),this.r=e,this.g=t,this.b=n,this.a=i},pv.Color.Rgb.prototype=pv.extend(pv.Color),pv.Color.Rgb.prototype.red=function(e){return pv.rgb(e,this.g,this.b,this.a)},pv.Color.Rgb.prototype.green=function(e){return pv.rgb(this.r,e,this.b,this.a)},pv.Color.Rgb.prototype.blue=function(e){return pv.rgb(this.r,this.g,e,this.a)},pv.Color.Rgb.prototype.alpha=function(e){return pv.rgb(this.r,this.g,this.b,e)},pv.Color.Rgb.prototype.rgb=function(){return this},pv.Color.Rgb.prototype.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,i=this.b,o=30;return t||n||i?(t&&o>t&&(t=o),n&&o>n&&(n=o),i&&o>i&&(i=o),pv.rgb(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(i/e)),this.a)):pv.rgb(o,o,o,this.a)},pv.Color.Rgb.prototype.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),pv.rgb(Math.max(0,Math.floor(e*this.r)),Math.max(0,Math.floor(e*this.g)),Math.max(0,Math.floor(e*this.b)),this.a)},pv.hsl=function(e,t,n,i){return new pv.Color.Hsl(e,t,n,4==arguments.length?i:1)},pv.Color.Hsl=function(e,t,n,i){pv.Color.call(this,"hsl("+e+","+100*t+"%,"+100*n+"%)",i),this.h=e,this.s=t,this.l=n,this.a=i},pv.Color.Hsl.prototype=pv.extend(pv.Color),pv.Color.Hsl.prototype.hue=function(e){return pv.hsl(e,this.s,this.l,this.a)
},pv.Color.Hsl.prototype.saturation=function(e){return pv.hsl(this.h,e,this.l,this.a)},pv.Color.Hsl.prototype.lightness=function(e){return pv.hsl(this.h,this.s,e,this.a)},pv.Color.Hsl.prototype.alpha=function(e){return pv.hsl(this.h,this.s,this.l,e)},pv.Color.Hsl.prototype.rgb=function(){function e(e){return e>360?e-=360:0>e&&(e+=360),60>e?s+(r-s)*e/60:180>e?r:240>e?s+(r-s)*(240-e)/60:s}function t(t){return Math.round(255*e(t))}var n=this.h,i=this.s,o=this.l;n%=360,0>n&&(n+=360),i=Math.max(0,Math.min(i,1)),o=Math.max(0,Math.min(o,1));var r=.5>=o?o*(1+i):o+i-o*i,s=2*o-r;return pv.rgb(t(n+120),t(n),t(n-120),this.a)},pv.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},pv.colors=function(){var e=pv.Scale.ordinal();return e.range.apply(e,arguments),e},pv.Colors={},pv.Colors.category10=function(){var e=pv.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");return e.domain.apply(e,arguments),e},pv.Colors.category20=function(){var e=pv.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");return e.domain.apply(e,arguments),e},pv.Colors.category19=function(){var e=pv.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");return e.domain.apply(e,arguments),e},pv.ramp=function(){var e=pv.Scale.linear();return e.range.apply(e,arguments),e},pv.Scene=pv.SvgScene={},pv.SvgScene.updateAll=function(e){if(e.length){if(e[0].reverse&&"line"!=e.type&&"area"!=e.type){for(var t=pv.extend(e),n=0,i=e.length-1;i>=0;n++,i--)t[n]=e[i];e=t}this.removeSiblings(this[e.type](e))}},pv.SvgScene.create=function(e){return document.createElementNS(pv.ns.svg,e)},pv.SvgScene.expect=function(e,t){if(!t)return this.create(e);if("a"==t.tagName&&(t=t.firstChild),t.tagName==e)return t;var n=this.create(e);return t.parentNode.replaceChild(n,t),n},pv.SvgScene.append=function(e,t,n){return e.$scene={scenes:t,index:n},e=this.title(e,t[n]),e.parentNode||t.$g.appendChild(e),e.nextSibling},pv.SvgScene.title=function(e,t){var n=e.parentNode,i=String(t.title);return n&&"a"!=n.tagName&&(n=null),i?(n||(n=this.create("a"),e.parentNode&&e.parentNode.replaceChild(n,e),n.appendChild(e)),n.setAttributeNS(pv.ns.xlink,"title",i),n):(n&&n.parentNode.replaceChild(e,n),e)},pv.SvgScene.dispatch=function(e){var t=e.target.$scene;t&&(t.scenes.mark.dispatch(e.type,t.scenes,t.index),e.preventDefault())},pv.SvgScene.removeSiblings=function(e){for(;e;){var t=e.nextSibling;e.parentNode.removeChild(e),e=t}},pv.SvgScene.area=function(e){var t=e.$g.firstChild;if(!e.length)return t;var n=e[0];if(n.segmented)return this.areaSegment(e);if(!n.visible)return t;var i=pv.color(n.fillStyle),o=pv.color(n.strokeStyle);if(!i.opacity&&!o.opacity)return t;for(var r="",s="",a=0,l=e.length-1;l>=0;a++,l--){var c=e[a],u=e[l];if(r+=c.left+","+c.top+" ",s+=u.left+u.width+","+(u.top+u.height)+" ",a<e.length-1){var h=e[a+1],d=e[l-1];switch(n.interpolate){case"step-before":r+=c.left+","+h.top+" ",s+=d.left+d.width+","+(u.top+u.height)+" ";break;case"step-after":r+=h.left+","+c.top+" ",s+=u.left+u.width+","+(d.top+d.height)+" "}}}t=this.expect("polygon",t),t.setAttribute("cursor",n.cursor),t.setAttribute("points",r+s);var i=pv.color(n.fillStyle);t.setAttribute("fill",i.color),t.setAttribute("fill-opacity",i.opacity);var o=pv.color(n.strokeStyle);return t.setAttribute("stroke",o.color),t.setAttribute("stroke-opacity",o.opacity),t.setAttribute("stroke-width",n.lineWidth),this.append(t,e,0)},pv.SvgScene.areaSegment=function(e){for(var t=e.$g.firstChild,n=0,i=e.length-1;i>n;n++){var o=e[n],r=e[n+1];if(o.visible&&r.visible){var s=pv.color(o.fillStyle),a=pv.color(o.strokeStyle);if(s.opacity||a.opacity){var l=o.left+","+o.top+" "+r.left+","+r.top+" "+(r.left+r.width)+","+(r.top+r.height)+" "+(o.left+o.width)+","+(o.top+o.height);t=this.expect("polygon",t),t.setAttribute("cursor",o.cursor),t.setAttribute("points",l),t.setAttribute("fill",s.color),t.setAttribute("fill-opacity",s.opacity),t.setAttribute("stroke",a.color),t.setAttribute("stroke-opacity",a.opacity),t.setAttribute("stroke-width",o.lineWidth),t=this.append(t,e,n)}}}return t},pv.SvgScene.bar=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var i=e[n];if(i.visible){var o=pv.color(i.fillStyle),r=pv.color(i.strokeStyle);(o.opacity||r.opacity)&&(t=this.expect("rect",t),t.setAttribute("cursor",i.cursor),t.setAttribute("x",i.left),t.setAttribute("y",i.top),t.setAttribute("width",Math.max(1e-10,i.width)),t.setAttribute("height",Math.max(1e-10,i.height)),t.setAttribute("fill",o.color),t.setAttribute("fill-opacity",o.opacity),t.setAttribute("stroke",r.color),t.setAttribute("stroke-opacity",r.opacity),t.setAttribute("stroke-width",i.lineWidth),t=this.append(t,e,n))}}return t},pv.SvgScene.dot=function(e){function t(e){return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}for(var n=e.$g.firstChild,i=0;i<e.length;i++){var o=e[i];if(o.visible){var r=pv.color(o.fillStyle),s=pv.color(o.strokeStyle);if(r.opacity||s.opacity){var a=Math.sqrt(o.size),l="",c="";switch(o.shape){case"cross":l="M"+-a+","+-a+"L"+a+","+a+"M"+a+","+-a+"L"+-a+","+a;break;case"triangle":var u=a,h=2*a/Math.sqrt(3);l="M0,"+u+"L"+h+","+-u+" "+-h+","+-u+"Z";break;case"diamond":a*=Math.sqrt(2),l="M0,"+-a+"L"+a+",0 0,"+a+" "+-a+",0Z";break;case"square":l="M"+-a+","+-a+"L"+a+","+-a+" "+a+","+a+" "+-a+","+a+"Z";break;case"tick":l="M0,0L0,"+-o.size;break;default:o.lineWidth/2>a&&(c=t(o.lineWidth)),l=t(a)}var d="translate("+o.left+","+o.top+")"+(o.angle?" rotate("+180*o.angle/Math.PI+")":"");n=this.expect("path",n),n.setAttribute("d",l),n.setAttribute("transform",d),n.setAttribute("fill",r.color),n.setAttribute("fill-opacity",r.opacity),n.setAttribute("cursor",o.cursor),c?n.setAttribute("stroke","none"):(n.setAttribute("stroke",s.color),n.setAttribute("stroke-opacity",s.opacity),n.setAttribute("stroke-width",o.lineWidth)),n=this.append(n,e,i),c&&(n=this.expect("path",n),n.setAttribute("d",c),n.setAttribute("transform",d),n.setAttribute("fill",s.color),n.setAttribute("fill-opacity",s.opacity),n.setAttribute("cursor",o.cursor),n=this.append(n,e,i))}}}return n},pv.SvgScene.image=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var i=e[n];i.visible&&(t=this.fill(t,e,n),t=this.expect("image",t),t.setAttribute("preserveAspectRatio","none"),t.setAttribute("x",i.left),t.setAttribute("y",i.top),t.setAttribute("width",i.width),t.setAttribute("height",i.height),t.setAttribute("cursor",i.cursor),t.setAttributeNS(pv.ns.xlink,"href",i.url),t=this.append(t,e,n),t=this.stroke(t,e,n))}return t},pv.SvgScene.label=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var i=e[n];if(i.visible){var o=pv.color(i.textStyle);if(o.opacity){var r=0,s=0,a=0,l="start";switch(i.textBaseline){case"middle":a=".35em";break;case"top":a=".71em",s=i.textMargin;break;case"bottom":s="-"+i.textMargin}switch(i.textAlign){case"right":l="end",r="-"+i.textMargin;break;case"center":l="middle";break;case"left":r=i.textMargin}t=this.expect("text",t),t.setAttribute("pointer-events","none"),t.setAttribute("x",r),t.setAttribute("y",s),t.setAttribute("dy",a),t.setAttribute("text-anchor",l),t.setAttribute("transform","translate("+i.left+","+i.top+")"+(i.textAngle?" rotate("+180*i.textAngle/Math.PI+")":"")),t.setAttribute("fill",o.color),t.setAttribute("fill-opacity",o.opacity),t.style.font=i.font,t.style.textShadow=i.textShadow,t.firstChild?t.firstChild.nodeValue=i.text:t.appendChild(document.createTextNode(i.text)),t=this.append(t,e,n)}}}return t},pv.SvgScene.line=function(e){var t=e.$g.firstChild;if(e.length<2)return t;var n=e[0];if(n.segmented)return this.lineSegment(e);if(!n.visible)return t;var i=pv.color(n.fillStyle),o=pv.color(n.strokeStyle);if(!i.opacity&&!o.opacity)return t;for(var r="",s=0;s<e.length;s++){var a=e[s];if(r+=a.left+","+a.top+" ",s<e.length-1){var l=e[s+1];switch(n.interpolate){case"step-before":r+=a.left+","+l.top+" ";break;case"step-after":r+=l.left+","+a.top+" "}}}return t=this.expect("polyline",t),t.setAttribute("cursor",n.cursor),t.setAttribute("points",r),t.setAttribute("fill",i.color),t.setAttribute("fill-opacity",i.opacity),t.setAttribute("stroke",o.color),t.setAttribute("stroke-opacity",o.opacity),t.setAttribute("stroke-width",n.lineWidth),this.append(t,e,0)},pv.SvgScene.lineSegment=function(e){function t(e,t,n,i){return e.plus(t.times(n.minus(e).dot(i.perp())/t.dot(i.perp())))}for(var n=e.$g.firstChild,i=0,o=e.length-1;o>i;i++){var r=e[i],s=e[i+1];if(r.visible&&s.visible){var a=pv.color(r.strokeStyle);if(a.opacity){var l=pv.vector(r.left,r.top),c=pv.vector(s.left,s.top),u=c.minus(l),h=u.perp().norm(),d=h.times(r.lineWidth/2),p=l.plus(d),f=c.plus(d),m=c.minus(d),g=l.minus(d);if(i>0){var v=e[i-1];if(v.visible){var y=l.minus(v.left,v.top).perp().norm().plus(h);g=t(l,y,g,u),p=t(l,y,p,u)}}if(o-1>i){var b=e[i+2];if(b.visible){var w=pv.vector(b.left,b.top).minus(c).perp().norm().plus(h);m=t(c,w,m,u),f=t(c,w,f,u)}}var u=p.x+","+p.y+" "+f.x+","+f.y+" "+m.x+","+m.y+" "+g.x+","+g.y;n=this.expect("polygon",n),n.setAttribute("cursor",r.cursor),n.setAttribute("points",u),n.setAttribute("fill",a.color),n.setAttribute("fill-opacity",a.opacity),n=this.append(n,e,i)}}}return n};var guid=0;pv.SvgScene.panel=function(e){for(var t=e.$g,n=t&&t.firstChild,i=0;i<e.length;i++){var o=e[i];if(o.visible){if(e.parent||(o.canvas.style.display="inline-block",t=o.canvas.firstChild,t||(t=o.canvas.appendChild(this.create("svg")),t.onclick=t.onmousedown=t.onmouseup=t.onmousemove=t.onmouseout=t.onmouseover=pv.SvgScene.dispatch),e.$g=t,t.setAttribute("width",o.width+o.left+o.right),t.setAttribute("height",o.height+o.top+o.bottom),"undefined"==typeof n&&(n=t.firstChild)),"hidden"==o.overflow){var r=this.expect("g",n),s=(guid++).toString(36);r.setAttribute("clip-path","url(#"+s+")"),r.parentNode||t.appendChild(r),e.$g=t=r,n=r.firstChild,n=this.expect("clipPath",n),n.setAttribute("id",s);var a=n.firstChild||n.appendChild(this.create("rect"));a.setAttribute("x",o.left),a.setAttribute("y",o.top),a.setAttribute("width",o.width),a.setAttribute("height",o.height),n.parentNode||t.appendChild(n),n=n.nextSibling}n=this.fill(n,e,i);for(var l=0;l<o.children.length;l++)o.children[l].$g=n=this.expect("g",n),n.setAttribute("transform","translate("+o.left+","+o.top+")"),this.updateAll(o.children[l]),n.parentNode||t.appendChild(n),n=n.nextSibling;n=this.stroke(n,e,i),"hidden"==o.overflow&&(e.$g=t=r.parentNode,n=r.nextSibling)}}return n},pv.SvgScene.fill=function(e,t,n){var i=t[n],o=pv.color(i.fillStyle);return o.opacity&&(e=this.expect("rect",e),e.setAttribute("x",i.left),e.setAttribute("y",i.top),e.setAttribute("width",i.width),e.setAttribute("height",i.height),e.setAttribute("cursor",i.cursor),e.setAttribute("fill",o.color),e.setAttribute("fill-opacity",o.opacity),e=this.append(e,t,n)),e},pv.SvgScene.stroke=function(e,t,n){var i=t[n],o=pv.color(i.strokeStyle);return o.opacity&&(e=this.expect("rect",e),e.setAttribute("x",i.left),e.setAttribute("y",i.top),e.setAttribute("width",Math.max(1e-10,i.width)),e.setAttribute("height",Math.max(1e-10,i.height)),e.setAttribute("cursor",i.cursor),e.setAttribute("fill","none"),e.setAttribute("stroke",o.color),e.setAttribute("stroke-opacity",o.opacity),e.setAttribute("stroke-width",i.lineWidth),e=this.append(e,t,n)),e},pv.SvgScene.rule=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var i=e[n];if(i.visible){var o=pv.color(i.strokeStyle);o.opacity&&(t=this.expect("line",t),t.setAttribute("cursor",i.cursor),t.setAttribute("x1",i.left),t.setAttribute("y1",i.top),t.setAttribute("x2",i.left+i.width),t.setAttribute("y2",i.top+i.height),t.setAttribute("stroke",o.color),t.setAttribute("stroke-opacity",o.opacity),t.setAttribute("stroke-width",i.lineWidth),t=this.append(t,e,n))}}return t},pv.SvgScene.wedge=function(e){for(var t=e.$g.firstChild,n=0;n<e.length;n++){var i=e[n];if(i.visible){var o=pv.color(i.fillStyle),r=pv.color(i.strokeStyle);if(o.opacity||r.opacity){var s,a=i.innerRadius,l=i.outerRadius,c=Math.abs(i.angle);if(c>=2*Math.PI)s=a?"M0,"+l+"A"+l+","+l+" 0 1,1 0,"+-l+"A"+l+","+l+" 0 1,1 0,"+l+"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"Z":"M0,"+l+"A"+l+","+l+" 0 1,1 0,"+-l+"A"+l+","+l+" 0 1,1 0,"+l+"Z";else{var u=Math.min(i.startAngle,i.endAngle),h=Math.max(i.startAngle,i.endAngle),d=Math.cos(u),p=Math.cos(h),f=Math.sin(u),m=Math.sin(h);s=a?"M"+l*d+","+l*f+"A"+l+","+l+" 0 "+(c<Math.PI?"0":"1")+",1 "+l*p+","+l*m+"L"+a*p+","+a*m+"A"+a+","+a+" 0 "+(c<Math.PI?"0":"1")+",0 "+a*d+","+a*f+"Z":"M"+l*d+","+l*f+"A"+l+","+l+" 0 "+(c<Math.PI?"0":"1")+",1 "+l*p+","+l*m+"L0,0Z"}t=this.expect("path",t),t.setAttribute("fill-rule","evenodd"),t.setAttribute("cursor",i.cursor),t.setAttribute("transform","translate("+i.left+","+i.top+")"),t.setAttribute("d",s),t.setAttribute("fill",o.color),t.setAttribute("fill-opacity",o.opacity),t.setAttribute("stroke",r.color),t.setAttribute("stroke-opacity",r.opacity),t.setAttribute("stroke-width",i.lineWidth),t=this.append(t,e,n)}}}return t},pv.Mark=function(){this.$properties=[]},pv.Mark.prototype.properties={},pv.Mark.prototype.property=function(e){return this.hasOwnProperty("properties")||(this.properties=pv.extend(this.properties)),this.properties[e]=!0,pv.Mark.prototype[e]=function(t){return arguments.length?(this.$properties.push({name:e,type:"function"==typeof t?3:2,value:t}),this):this.scene[this.index][e]},this},pv.Mark.prototype.property("data").property("visible").property("left").property("right").property("top").property("bottom").property("cursor").property("title").property("reverse"),pv.Mark.prototype.childIndex=-1,pv.Mark.prototype.index=-1,pv.Mark.prototype.defaults=(new pv.Mark).data(function(e){return[e]}).visible(!0).reverse(!1).cursor("").title("");var defaultFillStyle=pv.Colors.category20().by(pv.parent),defaultStrokeStyle=pv.Colors.category10().by(pv.parent);pv.Mark.prototype.extend=function(e){return this.proto=e,this},pv.Mark.prototype.add=function(e){return this.parent.add(e).extend(this)},pv.Mark.prototype.def=function(e,t){return this.$properties.push({name:e,type:"function"==typeof t?1:0,value:t}),this},pv.Mark.prototype.anchor=function(e){var t=(new pv.Anchor).extend(this).name(e);return t.parent=this.parent,t},pv.Mark.prototype.anchorTarget=function(){for(var e=this;!(e instanceof pv.Anchor);)if(e=e.proto,!e)return null;return e.proto},pv.Mark.prototype.first=function(){return this.scene[0]},pv.Mark.prototype.last=function(){return this.scene[this.scene.length-1]},pv.Mark.prototype.sibling=function(){return 0==this.index?null:this.scene[this.index-1]},pv.Mark.prototype.cousin=function(){var e=this.parent,t=e&&e.sibling();return t&&t.children?t.children[this.childIndex][this.index]:null},pv.Mark.prototype.render=function(){this.bind(),this.build(),pv.Scene.updateAll(this.scene)},pv.Mark.prototype.bind=function(){function e(e){do for(var t=e.$properties,s=t.length-1;s>=0;s--){var a=t[s];if(!(a.name in o))switch(o[a.name]=1,a.name){case"data":n=a;break;case"visible":i=a;break;default:r[a.type].push(a)}}while(e=e.proto)}function t(e){return function(t){var n=this.scene.defs;return arguments.length?(void 0==t?delete n.locked[e]:n.locked[e]=!0,n.values[e]=t,this):n.values[e]}}var n,i,o={},r=[[],[],[],[]];e(this),e(this.defaults),r[1].reverse(),r[3].reverse();var s=this;do for(var a in s.properties)a in o||(o[a]=1,r[2].push({name:a,type:2,value:null}));while(s=s.proto);for(var l=r[0].concat(r[1]),c=0;c<l.length;c++){var u=l[c];this[u.name]=t(u.name)}this.binds={data:n,visible:i,defs:l,properties:pv.blend(r)}},pv.Mark.prototype.build=function(){var e=this.scene;e||(e=this.scene=[],e.mark=this,e.type=this.type,e.childIndex=this.childIndex,this.parent&&(e.parent=this.parent.scene,e.parentIndex=this.parent.index));var t=this.root.scene.data;if(t||(this.root.scene.data=t=argv(this.parent)),this.binds.defs.length){var n=e.defs;n||(e.defs=n={values:{},locked:{}});for(var i=0;i<this.binds.defs.length;i++){var o=this.binds.defs[i];if(!(o.name in n.locked)){var r=o.value;1==o.type&&(property=o.name,r=r.apply(this,t)),n.values[o.name]=r}}}var s=this.binds.data;switch(s.type){case 0:case 1:s=n.values.data;break;case 2:s=s.value;break;case 3:property="data",s=s.value.apply(this,t)}t.unshift(null),e.length=s.length;for(var i=0;i<s.length;i++){pv.Mark.prototype.index=this.index=i;var a=e[i];a||(e[i]=a={}),a.data=t[0]=s[i];var l=this.binds.visible;switch(l.type){case 0:case 1:l=n.values.visible;break;case 2:l=l.value;break;case 3:property="visible",l=l.value.apply(this,t)}(a.visible=l)&&this.buildInstance(a)}return t.shift(),delete this.index,pv.Mark.prototype.index=-1,this.parent||(e.data=null),this},pv.Mark.prototype.buildProperties=function(e,t){for(var n=0,i=t.length;i>n;n++){var o=t[n],r=o.value;switch(o.type){case 0:case 1:r=this.scene.defs.values[o.name];break;case 3:property=o.name,r=r.apply(this,this.root.scene.data)}e[o.name]=r}},pv.Mark.prototype.buildInstance=function(e){this.buildProperties(e,this.binds.properties),this.buildImplied(e)},pv.Mark.prototype.buildImplied=function(e){var t=e.left,n=e.right,i=e.top,o=e.bottom,r=this.properties,s=r.width?e.width:0,a=r.height?e.height:0,l=this.parent?this.parent.width():s+t+n;null==s?s=l-(n=n||0)-(t=t||0):null==n?n=l-s-(t=t||0):null==t&&(t=l-s-(n=n||0));var c=this.parent?this.parent.height():a+i+o;null==a?a=c-(i=i||0)-(o=o||0):null==o?o=c-a-(i=i||0):null==i&&(i=c-a-(o=o||0)),e.left=t,e.right=n,e.top=i,e.bottom=o,r.width&&(e.width=s),r.height&&(e.height=a)};var property,pageX=0,pageY=0;pv.listen(window,"mousemove",function(e){pageX=e.pageX,pageY=e.pageY}),pv.Mark.prototype.mouse=function(){var e=0,t=0,n=this instanceof pv.Panel?this:this.parent;do e+=n.left(),t+=n.top();while(n=n.parent);var i=this.root.canvas();do e+=i.offsetLeft,t+=i.offsetTop;while(i=i.offsetParent);return pv.vector(pageX-e,pageY-t)},pv.Mark.prototype.event=function(e,t){return this.$handlers||(this.$handlers={}),this.$handlers[e]=t,this},pv.Mark.prototype.dispatch=function(e,t,n){var i=this.$handlers&&this.$handlers[e];if(!i)return void(this.parent&&this.parent.dispatch(e,t.parent,t.parentIndex));try{var o=this;do o.index=n,o.scene=t,n=t.parentIndex,t=t.parent;while(o=o.parent);try{o=i.apply(this,this.root.scene.data=argv(this))}finally{this.root.scene.data=null}o instanceof pv.Mark&&o.render()}finally{var o=this;do o.parent&&delete o.scene,delete o.index;while(o=o.parent)}},pv.Anchor=function(){pv.Mark.call(this)},pv.Anchor.prototype=pv.extend(pv.Mark).property("name"),pv.Area=function(){pv.Mark.call(this)},pv.Area.prototype=pv.extend(pv.Mark).property("width").property("height").property("lineWidth").property("strokeStyle").property("fillStyle").property("segmented").property("interpolate"),pv.Area.prototype.type="area",pv.Area.prototype.defaults=(new pv.Area).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(defaultFillStyle).interpolate("linear"),pv.Area.prototype.anchor=function(e){var t=this;return pv.Mark.prototype.anchor.call(this,e).left(function(){switch(this.name()){case"bottom":case"top":case"center":return t.left()+t.width()/2;case"right":return t.left()+t.width()}return null}).right(function(){switch(this.name()){case"bottom":case"top":case"center":return t.right()+t.width()/2;case"left":return t.right()+t.width()}return null}).top(function(){switch(this.name()){case"left":case"right":case"center":return t.top()+t.height()/2;case"bottom":return t.top()+t.height()}return null}).bottom(function(){switch(this.name()){case"left":case"right":case"center":return t.bottom()+t.height()/2;case"top":return t.bottom()+t.height()}return null}).textAlign(function(){switch(this.name()){case"bottom":case"top":case"center":return"center";case"right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"top"}return"bottom"})},pv.Area.prototype.buildImplied=function(e){null==e.height&&(e.height=0),null==e.width&&(e.width=0),pv.Mark.prototype.buildImplied.call(this,e)};var pv_Area_specials={left:1,top:1,right:1,bottom:1,width:1,height:1,name:1};pv.Area.prototype.bind=function(){pv.Mark.prototype.bind.call(this);for(var e=this.binds,t=e.properties,n=e.specials=[],i=0,o=t.length;o>i;i++){var r=t[i];r.name in pv_Area_specials&&n.push(r)}},pv.Area.prototype.buildInstance=function(e){this.index&&!this.scene[0].segmented?(this.buildProperties(e,this.binds.specials),this.buildImplied(e)):pv.Mark.prototype.buildInstance.call(this,e)},pv.Bar=function(){pv.Mark.call(this)},pv.Bar.prototype=pv.extend(pv.Mark).property("width").property("height").property("lineWidth").property("strokeStyle").property("fillStyle"),pv.Bar.prototype.type="bar",pv.Bar.prototype.defaults=(new pv.Bar).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(defaultFillStyle),pv.Bar.prototype.anchor=function(e){var t=this;return pv.Mark.prototype.anchor.call(this,e).left(function(){switch(this.name()){case"bottom":case"top":case"center":return t.left()+(this.properties.width?0:t.width()/2);case"right":return t.left()+t.width()}return null}).right(function(){switch(this.name()){case"bottom":case"top":case"center":return t.right()+(this.properties.width?0:t.width()/2);case"left":return t.right()+t.width()}return null}).top(function(){switch(this.name()){case"left":case"right":case"center":return t.top()+(this.properties.height?0:t.height()/2);case"bottom":return t.top()+t.height()}return null}).bottom(function(){switch(this.name()){case"left":case"right":case"center":return t.bottom()+(this.properties.height?0:t.height()/2);case"top":return t.bottom()+t.height()}return null}).textAlign(function(){switch(this.name()){case"bottom":case"top":case"center":return"center";case"right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"top"}return"bottom"})},pv.Dot=function(){pv.Mark.call(this)},pv.Dot.prototype=pv.extend(pv.Mark).property("size").property("shape").property("angle").property("lineWidth").property("strokeStyle").property("fillStyle"),pv.Dot.prototype.type="dot",pv.Dot.prototype.defaults=(new pv.Dot).extend(pv.Mark.prototype.defaults).size(20).shape("circle").lineWidth(1.5).strokeStyle(defaultStrokeStyle),pv.Dot.prototype.anchor=function(e){var t=this;return pv.Mark.prototype.anchor.call(this,e).left(function(){switch(this.name()){case"bottom":case"top":case"center":return t.left();case"right":return t.left()+t.radius()}return null}).right(function(){switch(this.name()){case"bottom":case"top":case"center":return t.right();case"left":return t.right()+t.radius()}return null}).top(function(){switch(this.name()){case"left":case"right":case"center":return t.top();case"bottom":return t.top()+t.radius()}return null}).bottom(function(){switch(this.name()){case"left":case"right":case"center":return t.bottom();case"top":return t.bottom()+t.radius()}return null}).textAlign(function(){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"bottom":return"top"}return"bottom"})},pv.Dot.prototype.radius=function(){return Math.sqrt(this.size())},pv.Label=function(){pv.Mark.call(this)},pv.Label.prototype=pv.extend(pv.Mark).property("text").property("font").property("textAngle").property("textStyle").property("textAlign").property("textBaseline").property("textMargin").property("textShadow"),pv.Label.prototype.type="label",pv.Label.prototype.defaults=(new pv.Label).extend(pv.Mark.prototype.defaults).text(pv.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3),pv.Line=function(){pv.Mark.call(this)},pv.Line.prototype=pv.extend(pv.Mark).property("lineWidth").property("strokeStyle").property("fillStyle").property("segmented").property("interpolate"),pv.Line.prototype.type="line",pv.Line.prototype.defaults=(new pv.Line).extend(pv.Mark.prototype.defaults).lineWidth(1.5).strokeStyle(defaultStrokeStyle).interpolate("linear");var pv_Line_specials={left:1,top:1,right:1,bottom:1,name:1};return pv.Line.prototype.bind=function(){pv.Mark.prototype.bind.call(this);for(var e=this.binds,t=e.properties,n=e.specials=[],i=0,o=t.length;o>i;i++){var r=t[i];r.name in pv_Line_specials&&n.push(r)}},pv.Line.prototype.buildInstance=function(e){this.index&&!this.scene[0].segmented?(this.buildProperties(e,this.binds.specials),this.buildImplied(e)):pv.Mark.prototype.buildInstance.call(this,e)},pv.Rule=function(){pv.Mark.call(this)},pv.Rule.prototype=pv.extend(pv.Mark).property("width").property("height").property("lineWidth").property("strokeStyle"),pv.Rule.prototype.type="rule",pv.Rule.prototype.defaults=(new pv.Rule).extend(pv.Mark.prototype.defaults).lineWidth(1).strokeStyle("black"),pv.Rule.prototype.anchor=function(e){return pv.Bar.prototype.anchor.call(this,e).textAlign(function(){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center";case"right":return"left"}}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"bottom";case"bottom":return"top"}})},pv.Rule.prototype.buildImplied=function(e){{var t=e.left,n=e.right;e.top,e.bottom}null!=e.width||null==t&&null==n||null!=n&&null!=t?e.height=0:e.width=0,pv.Mark.prototype.buildImplied.call(this,e)},pv.Panel=function(){pv.Bar.call(this),this.children=[],this.root=this,this.$dom=pv.Panel.$dom},pv.Panel.prototype=pv.extend(pv.Bar).property("canvas").property("overflow"),pv.Panel.prototype.type="panel",pv.Panel.prototype.defaults=(new pv.Panel).extend(pv.Bar.prototype.defaults).fillStyle(null).overflow("visible"),pv.Panel.prototype.anchor=function(e){function t(){return 0}t.prototype=this,t.prototype.left=t.prototype.right=t.prototype.top=t.prototype.bottom=t;var n=pv.Bar.prototype.anchor.call(new t,e).data(function(e){return[e]});return n.parent=this,n},pv.Panel.prototype.add=function(e){var t=new e;return t.parent=this,t.root=this.root,t.childIndex=this.children.length,this.children.push(t),t},pv.Panel.prototype.bind=function(){pv.Mark.prototype.bind.call(this);for(var e=0;e<this.children.length;e++)this.children[e].bind()},pv.Panel.prototype.buildInstance=function(e){pv.Bar.prototype.buildInstance.call(this,e),e.children||(e.children=[]);for(var t=0;t<this.children.length;t++)this.children[t].scene=e.children[t],this.children[t].build();for(var t=0;t<this.children.length;t++)e.children[t]=this.children[t].scene,delete this.children[t].scene;e.children.length=this.children.length},pv.Panel.prototype.buildImplied=function(e){function t(){for(var e=document.body;e.lastChild&&e.lastChild.tagName;)e=e.lastChild;return e==document.body?e:e.parentNode}if(!this.parent){var n=e.canvas;if(n){"string"==typeof n&&(n=document.getElementById(n)),n.$panel!=this&&(n.$panel=this,n.innerHTML="");var i,o;null==e.width&&(i=parseFloat(pv.css(n,"width")),e.width=i-e.left-e.right),null==e.height&&(o=parseFloat(pv.css(n,"height")),e.height=o-e.top-e.bottom)}else e.$canvas?n=e.$canvas:(n=e.$canvas=document.createElement("span"),this.$dom?this.$dom.parentNode.insertBefore(n,this.$dom):t().appendChild(n));e.canvas=n}pv.Bar.prototype.buildImplied.call(this,e)},pv.Image=function(){pv.Bar.call(this)},pv.Image.prototype=pv.extend(pv.Bar).property("url"),pv.Image.prototype.type="image",pv.Image.prototype.defaults=(new pv.Image).extend(pv.Bar.prototype.defaults).fillStyle(null),pv.Wedge=function(){pv.Mark.call(this)},pv.Wedge.prototype=pv.extend(pv.Mark).property("startAngle").property("endAngle").property("angle").property("innerRadius").property("outerRadius").property("lineWidth").property("strokeStyle").property("fillStyle"),pv.Wedge.prototype.type="wedge",pv.Wedge.prototype.defaults=(new pv.Wedge).extend(pv.Mark.prototype.defaults).startAngle(function(){var e=this.sibling();return e?e.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(defaultFillStyle.by(pv.index)),pv.Wedge.prototype.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2},pv.Wedge.prototype.midAngle=function(){return(this.startAngle()+this.endAngle())/2},pv.Wedge.prototype.anchor=function(e){var t=this;return pv.Mark.prototype.anchor.call(this,e).left(function(){switch(this.name()){case"outer":return t.left()+t.outerRadius()*Math.cos(t.midAngle());case"inner":return t.left()+t.innerRadius()*Math.cos(t.midAngle());case"start":return t.left()+t.midRadius()*Math.cos(t.startAngle());case"center":return t.left()+t.midRadius()*Math.cos(t.midAngle());case"end":return t.left()+t.midRadius()*Math.cos(t.endAngle())}}).right(function(){switch(this.name()){case"outer":return t.right()+t.outerRadius()*Math.cos(t.midAngle());case"inner":return t.right()+t.innerRadius()*Math.cos(t.midAngle());case"start":return t.right()+t.midRadius()*Math.cos(t.startAngle());case"center":return t.right()+t.midRadius()*Math.cos(t.midAngle());case"end":return t.right()+t.midRadius()*Math.cos(t.endAngle())}}).top(function(){switch(this.name()){case"outer":return t.top()+t.outerRadius()*Math.sin(t.midAngle());case"inner":return t.top()+t.innerRadius()*Math.sin(t.midAngle());case"start":return t.top()+t.midRadius()*Math.sin(t.startAngle());case"center":return t.top()+t.midRadius()*Math.sin(t.midAngle());case"end":return t.top()+t.midRadius()*Math.sin(t.endAngle())}}).bottom(function(){switch(this.name()){case"outer":return t.bottom()+t.outerRadius()*Math.sin(t.midAngle());case"inner":return t.bottom()+t.innerRadius()*Math.sin(t.midAngle());case"start":return t.bottom()+t.midRadius()*Math.sin(t.startAngle());case"center":return t.bottom()+t.midRadius()*Math.sin(t.midAngle());
case"end":return t.bottom()+t.midRadius()*Math.sin(t.endAngle())}}).textAlign(function(){switch(this.name()){case"outer":return pv.Wedge.upright(t.midAngle())?"right":"left";case"inner":return pv.Wedge.upright(t.midAngle())?"left":"right"}return"center"}).textBaseline(function(){switch(this.name()){case"start":return pv.Wedge.upright(t.startAngle())?"top":"bottom";case"end":return pv.Wedge.upright(t.endAngle())?"bottom":"top"}return"middle"}).textAngle(function(){var e=0;switch(this.name()){case"center":case"inner":case"outer":e=t.midAngle();break;case"start":e=t.startAngle();break;case"end":e=t.endAngle()}return pv.Wedge.upright(e)?e:e+Math.PI})},pv.Wedge.upright=function(e){return e%=2*Math.PI,e=0>e?2*Math.PI+e:e,e<Math.PI/2||e>3*Math.PI/2},pv.Wedge.prototype.buildImplied=function(e){pv.Mark.prototype.buildImplied.call(this,e),null==e.endAngle&&(e.endAngle=e.startAngle+e.angle),null==e.angle&&(e.angle=e.endAngle-e.startAngle)},pv.Layout={},pv.Layout.grid=function(e){function t(){return this.parent.width()/o}function n(){return this.parent.height()/i}var i=e.length,o=e[0].length;return(new pv.Mark).data(pv.blend(e)).left(function(){return t.call(this)*(this.index%o)}).top(function(){return n.call(this)*Math.floor(this.index/o)}).width(t).height(n)},pv.Layout.stack=function(){function e(){for(var e,n,i=this.parent.index;i-->0&&!n;)e=this.parent.scene[i],e.visible&&(n=e.children[this.childIndex][this.index]);if(n)switch(property){case"bottom":return n.bottom+n.height;case"top":return n.top+n.height;case"left":return n.left+n.width;case"right":return n.right+n.width}return t.apply(this,arguments)}var t=function(){return 0};return e.offset=function(e){return t=e instanceof Function?e:function(){return e},this},e},pv.Layout.icicle=function(e){function t(e){var n={size:0,children:[],keys:a.slice()};for(var i in e){var o=e[i],r=l(o);a.push(i),o=isNaN(r)?t(o):{size:r,data:o,keys:a.slice()},n.children.push(o),n.size+=o.size,a.pop()}return n.children.sort(function(e,t){return t.size-e.size}),n}function n(e,t){return t=t?t+1:1,e.children?pv.max(e.children,function(e){return n(e,t)}):t}function i(e){if(e.children){o(e);for(var t=0;t<e.children.length;t++)i(e.children[t])}}function o(e){for(var t=e.left,n=0;n<e.children.length;n++){var i=e.children[n],r=i.size/e.size*e.width;i.left=t,i.top=e.top+e.height,i.width=r,i.height=e.height,i.depth=e.depth+1,t+=r,i.children&&o(i)}}function r(e,t){if(e.children)for(var n=0;n<e.children.length;n++)r(e.children[n],t);return t.push(e),t}function s(){var o=t(e);return o.top=0,o.left=0,o.width=this.parent.width(),o.height=this.parent.height()/n(o),o.depth=0,i(o),r(o,[]).reverse()}var a=[],l=Number,c=(new pv.Mark).data(s).left(function(e){return e.left}).top(function(e){return e.top}).width(function(e){return e.width}).height(function(e){return e.height});return c.root=function(e){return a=[e],this},c.size=function(e){return l=e,this},c},pv.Layout.sunburst=function(e){function t(e){var n={size:0,children:[],keys:u.slice()};for(var i in e){var o=e[i],r=h(o);u.push(i),o=isNaN(r)?t(o):{size:r,data:o,keys:u.slice()},n.children.push(o),n.size+=o.size,u.pop()}return n.children.sort(function(e,t){return t.size-e.size}),n}function n(e,t){return t=t?t+1:1,e.children?pv.max(e.children,function(e){return n(e,t)}):t}function i(e){if(e.children){o(e);for(var t=0;t<e.children.length;t++)i(e.children[t])}}function o(e){for(var t=e.startAngle,n=0;n<e.children.length;n++){var i=e.children[n],r=i.size/e.size*e.angle;i.startAngle=t,i.angle=r,i.endAngle=t+r,i.depth=e.depth+1,i.left=a/2,i.top=l/2,i.innerRadius=Math.max(0,i.depth-.5)*c,i.outerRadius=(i.depth+.5)*c,t+=r,i.children&&o(i)}}function r(e,t){if(e.children)for(var n=0;n<e.children.length;n++)r(e.children[n],t);return t.push(e),t}function s(){var o=t(e);return a=this.parent.width(),l=this.parent.height(),c=Math.min(a,l)/2/(n(o)-.5),o.left=a/2,o.top=l/2,o.startAngle=0,o.angle=2*Math.PI,o.endAngle=2*Math.PI,o.innerRadius=0,o.outerRadius=c,o.depth=0,i(o),r(o,[]).reverse()}var a,l,c,u=[],h=Number,d=(new pv.Mark).data(s).left(function(e){return e.left}).top(function(e){return e.top}).startAngle(function(e){return e.startAngle}).angle(function(e){return e.angle}).innerRadius(function(e){return e.innerRadius}).outerRadius(function(e){return e.outerRadius});return d.root=function(e){return u=[e],this},d.size=function(e){return h=e,this},d},pv.Layout.treemap=function(e){function t(e){return c?Math.round(e):e}function n(e){var t={size:0,children:[],keys:h.slice()};for(var i in e){var o=e[i],r=d(o);h.push(i),o=isNaN(r)?n(o):{size:r,data:o,keys:h.slice()},t.children.push(o),t.size+=o.size,h.pop()}return t.children.sort(function(e,t){return e.size-t.size}),t}function i(e,t){if(e.size*=t,e.children)for(var n=0;n<e.children.length;n++)i(e.children[n],t)}function o(e,t){for(var n=-1/0,i=1/0,o=0,r=0;r<e.length;r++){var s=e[r].size;i>s&&(i=s),s>n&&(n=s),o+=s}return o*=o,t*=t,Math.max(t*n/o,o/(t*i))}function r(e){function n(e){for(var n=pv.sum(e,function(e){return e.size}),i=0==d?0:t(n/d),o=0,r=0;o<e.length;o++){var s=e[o],u=t(s.size/i);c==d?(s.left=a+r,s.top=l,s.width=u,s.height=i):(s.left=a,s.top=l+r,s.width=i,s.height=u),r+=u}c==d?(s&&(s.width+=c-r),l+=i,h-=i):(s&&(s.height+=h-r),a+=i,c-=i),d=Math.min(c,h)}var r=[],s=1/0,a=e.left+(u?u.left:0),l=e.top+(u?u.top:0),c=e.width-(u?u.left+u.right:0),h=e.height-(u?u.top+u.bottom:0),d=Math.min(c,h);i(e,c*h/e.size);for(var p=e.children.slice();p.length>0;){var f=p[p.length-1];if(f.size<=0)p.pop();else{r.push(f);var m=o(r,d);s>=m?(p.pop(),s=m):(r.pop(),n(r),r.length=0,s=1/0)}}if(r.length>0&&n(r),c==d)for(var g=0;g<r.length;g++)r[g].width+=c;else for(var g=0;g<r.length;g++)r[g].height+=h}function s(e){if(e.children){r(e);for(var t=0;t<e.children.length;t++){var n=e.children[t];n.depth=e.depth+1,s(n)}}}function a(e,t){if(e.children)for(var n=0;n<e.children.length;n++)a(e.children[n],t);return(u||!e.children)&&t.push(e),t}function l(){var t=n(e);return t.left=0,t.top=0,t.width=this.parent.width(),t.height=this.parent.height(),t.depth=0,s(t),a(t,[]).reverse()}var c,u,h=[],d=Number,p=(new pv.Mark).data(l).left(function(e){return e.left}).top(function(e){return e.top}).width(function(e){return e.width}).height(function(e){return e.height});return p.round=function(e){return c=e,this},p.inset=function(e,t,n,i){return 1==arguments.length&&(t=n=i=e),u={top:e,right:t,bottom:n,left:i},this},p.root=function(e){return h=[e],this},p.size=function(e){return d=e,this},p},pv}();if(pv.listen(window,"load",function(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var n=e[t];if("text/javascript+protovis"==n.type){try{pv.Panel.$dom=n,window.eval(pv.parse(n.textContent||n.innerHTML))}catch(i){pv.error(i)}delete pv.Panel.$dom}}}),/*!
 * string_score.js: String Scoring Algorithm 0.1.10
 *
 * http://joshaven.com/string_score
 * https://github.com/joshaven/string_score
 *
 * Copyright (C) 2009-2011 Joshaven Potter <yourtech@gmail.com>
 * Special thanks to all of the contributors listed here https://github.com/joshaven/string_score
 * MIT license: http://www.opensource.org/licenses/mit-license.php
 *
 * Date: Tue Mar 1 2011
*/
String.prototype.score=function(e,t){if(this==e)return 1;if(""==e)return 0;for(var n,i,o,r,s,a,l,c,u,h=0,d=e.length,p=this,f=p.length,m=1,g=0;d>g;++g){if(a=e.charAt(g),l=p.indexOf(a.toLowerCase()),c=p.indexOf(a.toUpperCase()),u=Math.min(l,c),s=u>-1?u:Math.max(l,c),-1===s){if(t){m+=1-t;continue}return 0}r=.1,p[s]===a&&(r+=.1),0===s?(r+=.6,0===g&&(n=1)):" "===p.charAt(s-1)&&(r+=.8),p=p.substring(s+1,f),h+=r}return i=h/d,o=(i*(d/f)+i)/2,o/=m,n&&1>o+.15&&(o+=.15),o},"undefined"==typeof deconcept)var deconcept={};"undefined"==typeof deconcept.util&&(deconcept.util={}),"undefined"==typeof deconcept.SWFObjectUtil&&(deconcept.SWFObjectUtil={}),deconcept.SWFObject=function(e,t,n,i,o,r,s,a,l,c){if(document.getElementById){this.DETECT_KEY=c?c:"detectflash",this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY),this.params={},this.variables={},this.attributes=[],e&&this.setAttribute("swf",e),t&&this.setAttribute("id",t),n&&this.setAttribute("width",n),i&&this.setAttribute("height",i),o&&this.setAttribute("version",new deconcept.PlayerVersion(o.toString().split("."))),this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion(),!window.opera&&document.all&&this.installedVer.major>7&&(deconcept.unloadSet||(deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){},window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)},window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload),deconcept.unloadSet=!0)),r&&this.addParam("bgcolor",r);var u=s?s:"high";this.addParam("quality",u),this.setAttribute("useExpressInstall",!1),this.setAttribute("doExpressInstall",!1);var h=a?a:window.location;this.setAttribute("xiRedirectUrl",h),this.setAttribute("redirectUrl",""),l&&this.setAttribute("redirectUrl",l)}},deconcept.SWFObject.prototype={useExpressInstall:function(e){this.xiSWFPath=e?e:"expressinstall.swf",this.setAttribute("useExpressInstall",!0)},setAttribute:function(e,t){this.attributes[e]=t},getAttribute:function(e){return this.attributes[e]||""},addParam:function(e,t){this.params[e]=t},getParams:function(){return this.params},addVariable:function(e,t){this.variables[e]=t},getVariable:function(e){return this.variables[e]||""},getVariables:function(){return this.variables},getVariablePairs:function(){var e,t=[],n=this.getVariables();for(e in n)t[t.length]=e+"="+n[e];return t},getSWFHTML:function(){var e="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType","PlugIn"),this.setAttribute("swf",this.xiSWFPath)),e='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+(this.getAttribute("style")||"")+'"',e+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var t=this.getParams();for(var n in t)e+=[n]+'="'+t[n]+'" ';var i=this.getVariablePairs().join("&");i.length>0&&(e+='flashvars="'+i+'"'),e+="/>"}else{this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType","ActiveX"),this.setAttribute("swf",this.xiSWFPath)),e='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+(this.getAttribute("style")||"")+'">',e+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var o=this.getParams();for(var n in o)e+='<param name="'+n+'" value="'+o[n]+'" />';var r=this.getVariablePairs().join("&");r.length>0&&(e+='<param name="flashvars" value="'+r+'" />'),e+="</object>"}return e},write:function(e){if(this.getAttribute("useExpressInstall")){var t=new deconcept.PlayerVersion([6,0,65]);this.installedVer.versionIsValid(t)&&!this.installedVer.versionIsValid(this.getAttribute("version"))&&(this.setAttribute("doExpressInstall",!0),this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl"))),document.title=document.title.slice(0,47)+" - Flash Player Installation",this.addVariable("MMdoctitle",document.title))}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var n="string"==typeof e?document.getElementById(e):e;return n.innerHTML=this.getSWFHTML(),!0}return""!=this.getAttribute("redirectUrl")&&document.location.replace(this.getAttribute("redirectUrl")),!1}},deconcept.SWFObjectUtil.getPlayerVersion=function(){var e=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var t=navigator.plugins["Shockwave Flash"];t&&t.description&&(e=new deconcept.PlayerVersion(t.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")))}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0)for(var n=1,i=3;n;)try{i++,n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+i),e=new deconcept.PlayerVersion([i,0,0])}catch(o){n=null}else{try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(o){try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");e=new deconcept.PlayerVersion([6,0,21]),n.AllowScriptAccess="always"}catch(o){if(6==e.major)return e}try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(o){}}null!=n&&(e=new deconcept.PlayerVersion(n.GetVariable("$version").split(" ")[1].split(",")))}return e},deconcept.PlayerVersion=function(e){this.major=null!=e[0]?parseInt(e[0]):0,this.minor=null!=e[1]?parseInt(e[1]):0,this.rev=null!=e[2]?parseInt(e[2]):0},deconcept.PlayerVersion.prototype.versionIsValid=function(e){return this.major<e.major?!1:this.major>e.major?!0:this.minor<e.minor?!1:this.minor>e.minor?!0:this.rev<e.rev?!1:!0},deconcept.util={getRequestParameter:function(e){var t=document.location.search||document.location.hash;if(null==e)return t;if(t)for(var n=t.substring(1).split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return n[i].substring(n[i].indexOf("=")+1);return""}},deconcept.SWFObjectUtil.cleanupSWFs=function(){for(var e=document.getElementsByTagName("OBJECT"),t=e.length-1;t>=0;t--){e[t].style.display="none";for(var n in e[t])"function"==typeof e[t][n]&&(e[t][n]=function(){})}},!document.getElementById&&document.all&&(document.getElementById=function(e){return document.all[e]});var getQueryParamValue=deconcept.util.getRequestParameter,FlashObject=deconcept.SWFObject,SWFObject=deconcept.SWFObject;!function(e,t,n){function i(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function o(e,n,o,r,a,l){var c,u,d=t.createElement("script");r=r||h.errorTimeout,d.src=e;for(u in o)d.setAttribute(u,o[u]);n=l?s:n||y,d.onreadystatechange=d.onload=function(){!c&&i(d.readyState)&&(c=1,n(),d.onload=d.onreadystatechange=null)},p(function(){c||(c=1,n(1))},r),R(),a?d.onload():f.parentNode.insertBefore(d,f)}function r(e,n,i,o,r,a){var l,c=t.createElement("link");o=o||h.errorTimeout,n=a?s:n||y,c.href=e,c.rel="stylesheet",c.type="text/css";for(l in i)c.setAttribute(l,i[l]);r||(R(),f.parentNode.insertBefore(c,f),p(n,0))}function s(){var e=g.shift();v=1,e?e.t?p(function(){("c"==e.t?h.injectCss:h.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),s()):v=0}function a(e,n,o,r,a,l,c){function u(t){if(!m&&i(d.readyState)&&(b.r=m=1,!v&&s(),t)){"img"!=e&&p(function(){_.removeChild(d)},50);for(var o in N[n])N[n].hasOwnProperty(o)&&N[n][o].onload();d.onload=d.onreadystatechange=null}}c=c||h.errorTimeout;var d=t.createElement(e),m=0,y=0,b={t:o,s:n,e:a,a:l,x:c};1===N[n]&&(y=1,N[n]=[]),"object"==e?(d.data=n,d.setAttribute("type","text/css")):(d.src=n,d.type=e),d.width=d.height="0",d.onerror=d.onload=d.onreadystatechange=function(){u.call(this,y)},g.splice(r,0,b),"img"!=e&&(y||2===N[n]?(R(),_.insertBefore(d,w?null:f),p(u,c)):N[n].push(d))}function l(e,t,n,i,o){return v=0,t=t||"j",M(e)?a("c"==t?k:E,e,t,this.i++,n,i,o):(g.splice(this.i++,0,e),1==g.length&&s()),this}function c(){var e=h;return e.loader={load:l,i:0},e}var u,h,d=t.documentElement,p=e.setTimeout,f=t.getElementsByTagName("script")[0],m={}.toString,g=[],v=0,y=function(){},b="MozAppearance"in d.style,w=b&&!!t.createRange().compareNode,_=w?d:f.parentNode,C=e.opera&&"[object Opera]"==m.call(e.opera),S=!!t.attachEvent&&!C,x="webkitAppearance"in d.style&&!("async"in t.createElement("script")),E=b?"object":S||x?"script":"img",k=S?"script":x?"img":E,T=Array.isArray||function(e){return"[object Array]"==m.call(e)},D=function(e){return Object(e)===e},M=function(e){return"string"==typeof e},j=function(e){return"[object Function]"==m.call(e)},R=function(){f&&f.parentNode||(f=t.getElementsByTagName("script")[0])},A=[],N={},P={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};h=function(e){function t(e){var t,n,i,o=e.split("!"),r=A.length,s=o.pop(),a=o.length,l={url:s,origUrl:s,prefixes:o};for(n=0;a>n;n++)i=o[n].split("="),t=P[i.shift()],t&&(l=t(l,i));for(n=0;r>n;n++)l=A[n](l);return l}function i(e){var t=e.split("?")[0];return t.substr(t.lastIndexOf(".")+1)}function o(e,o,r,s,a){{var l=t(e),u=l.autoCallback;i(l.url)}if(!l.bypass)return o&&(o=j(o)?o:o[e]||o[s]||o[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,o,r,s,a):(N[l.url]&&l.reexecute!==!0?l.noexec=!0:N[l.url]=1,e&&r.load(l.url,l.forceCSS||!l.forceJS&&"css"==i(l.url)?"c":n,l.noexec,l.attrs,l.timeout),(j(o)||j(u))&&r.load(function(){c(),o&&o(l.origUrl,a,s),u&&u(l.origUrl,a,s),N[l.url]=2}),void 0)}function r(e,t){function n(e,n){if(""===e||e){if(M(e))n||(c=function(){var e=[].slice.call(arguments);u.apply(this,e),h()}),o(e,c,t,0,s);else if(D(e)){i=function(){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}();for(r in e)e.hasOwnProperty(r)&&(n||--i||(j(c)?c=function(){var e=[].slice.call(arguments);u.apply(this,e),h()}:c[r]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),h()}}(u[r])),o(e[r],c,t,r,s))}}else!n&&h()}var i,r,s=!!e.test,a=s?e.yep:e.nope,l=e.load||e.both,c=e.callback||y,u=c,h=e.complete||y;n(a,!!l||!!e.complete),l&&n(l),!l&&!!e.complete&&n("")}var s,a,l=this.yepnope.loader;if(M(e))o(e,0,l,0);else if(T(e))for(s=0;s<e.length;s++)a=e[s],M(a)?o(a,0,l,0):T(a)?h(a):D(a)&&r(a,l);else D(e)&&r(e,l)},h.addPrefix=function(e,t){P[e]=t},h.addFilter=function(e){A.push(e)},h.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",u=function(){t.removeEventListener("DOMContentLoaded",u,0),t.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=s,e.yepnope.injectJs=o,e.yepnope.injectCss=r}(this,document),function(e){e.addPrefix("css",function(e){return e.forceCSS=!0,e})}(this.yepnope);var gr={};reverseMerge=function(e,t){for(var n in t)void 0==e[n]&&(e[n]=t[n])},Element.parent=function(e){return e.ancestors()[0]},Element.addMethods({parent:Element.parent}),$j(document).on("click",".brown_comment .unblock",function(e){var t=$j(this).parents(".xhr_blocked");t.next("span").show(),t.hide(),e.preventDefault()}),$j(document).on("change",".sharingToggle.twitter",function(){$j(this).toggleClass("checked",$j(this).children("input[type=checkbox]").is(":checked"))}),$j(document).on("click",".acceptMessage",function(e){$j("#comment_form").show(),$j(".author_warning_message").hide(),e.preventDefault()}),$j(document).on("click",".jsShowSpoiler",function(e){var t=$j(e.target);e.preventDefault(),t.next(".spoilerContainer").show(),t.hide()}),$j(document).on("click",".jsHideSpoiler",function(e){var t=$j(e.target);e.preventDefault(),t.parent().prev(".jsShowSpoiler").show(),t.parent(".spoilerContainer").hide()});var SubmitShelfButtonHandler=Class.create();SubmitShelfButtonHandler.prototype={initialize:function(e,t,n,i,o,r){this.book_id=e,this.unique_id=o?o:e,this.url_params=r?r:{},this.signed_in=n,this.button=$("to_read_link_"+o),this.wtr_arrow=$("wtr_arrow_"+o),this.check_img_id=i,this.check_img=$(i),this.turn_off="none"!=this.check_img.style.display,this.shelf_name=t,this.button_text=null!=this.button?this.button.innerHTML:""},sendRequest:function(){if(!this.button||!this.button.hasClassName("ignored")){var e="/shelf/add_to_shelf?no_content=true&";this.turn_off&&(e="/shelf/remove_book?"),this.url_params.book_id=this.book_id,this.url_params.name=this.shelf_name,this.signed_in?new Ajax.Request(e,{asynchronous:!0,evalScripts:!0,parameters:this.url_params,onComplete:function(){this.button&&(this.button.update(this.button_text),check_img=$(this.check_img_id),this.turn_off?(this.button.removeClassName("minor"),check_img.hide(),this.wtr_arrow&&this.wtr_arrow.show(),this.button.title="Add to your "+this.shelf_name+" shelf."):(this.button.addClassName("minor"),check_img.show(),this.button.title="Remove from your "+this.shelf_name+" shelf."))}.bind(this),onLoading:function(){this.button.update("saving..."),this.wtr_arrow&&this.wtr_arrow.hide()}.bind(this)}):document.location=e}}};var YahooOauthPopup={open:function(){var e="/import/yahoo_login";return window.open(e,"yahoo_oauth","width=475,height=435"),!1},close:function(e){window.opener.location.href=e,window.close()}},YouTubeEntry={isEmbeddable:function(e){return!e.ye$noembed},thumbnailURL:function(e){return e.media$group.media$thumbnail[0].url},videoId:function(e){return this.videoURL(e).match(/videos\/([\w_-]+)/).last()},videoURL:function(e){return e.id.$t},videoTitle:function(e){return e.media$group.media$title.$t},videoDescription:function(e){return e.media$group.media$description.$t},videoTags:function(e){return e.media$group.media$keywords.$t},flashURL:function(e){var t=e.media$group.media$content,n=null;if(t)var n=t.find(function(e){return"application/x-shockwave-flash"==e.type});return n&&n.url}},Video={viewInline:function(e,t,n,i,o){$(e).writeAttribute("onclick","return false"),$("play_icon_"+e).hide(),("youtube"==t||"youtube_new"==t)&&YouTube.addPlayer(e,n,i);var r=parseInt(e.match(/\d+/)[0]);if(0!=o){var s=this.buildRateVideoMarkup("Video.addVote("+r+")","ratingResult"+r);$(e).up().appendChild(s)}this._updateViewCount(r)},buildRateVideoMarkup:function(e,t){var n=new Element("div"),i=new Element("span",{style:"font-style: italic;"}).update("Did you like this video?&nbsp;&nbsp;&nbsp;");n.appendChild(i);var o=new Element("span",{id:t});n.appendChild(o);var r=new Element("a",{href:"#",id:"addVoteLink"+t,title:"Vote for this video",style:"color: #006699;"}).update("vote");return Prototype.Browser.IE?r.onclick=new Function("evt",e+"; return false;"):r.writeAttribute("onclick",e+"; return false;"),o.appendChild(r),n},addVote:function(e){var t="/rating/new_video";new Ajax.Updater("ratingResult"+e,t,{method:"post",parameters:{rating:1,resource_id:e}})},_updateViewCount:function(e){new Ajax.Request("/videos/update_views/"+e.toString())},updateUserChallenge:function(e){var t="/user_challenges/watched_video";new Ajax.Updater("",t,{method:"post",parameters:{id:e}})}},YouTube={PLAYER_ID:"youtubePlayerContainer",WIDTH:"300",HEIGHT:"247",VERSION:"8",PLAYER_TEMPLATE:new Template('<iframe id="ytplayer" type="text/html" width="#{width}" height="#{height}"src="#{video_href}" frameborder="0"/>'),CAN_ADD:!1,addPlayer:function(e,t,n){n=Object.extend({enableAPI:!1,autoplay:!1},n||{}),n.width||(n.width=this.WIDTH),n.height||(n.height=this.HEIGHT),n.autoplay&&(t+="&autoplay=1&rel=0"),n.enableAPI&&(t+="&enablejsapi=1");var i=new SWFObject(t,null,n.width,n.height,this.VERSION);i.addParam("wmode","transparent"),i.write(e)},play:function(e,t,n,i,o){if(t){this.addPlayer(this.PLAYER_ID,t);var r=YouTube._rateVideoMarkup(e,n,i,o);if($(this.PLAYER_ID).appendChild(r),this.CAN_ADD){var s="YouTube.addForAuthor("+e+", '"+n+"', '"+i+"', '"+o+"')";$(this.PLAYER_ID).insert({bottom:'<a class="button" href="#" onclick="'+s+"; return false;\">add to author's page</a>"})}location.href="#player"}},_rateVideoMarkup:function(e,t,n,i){var o="YouTube.addVote("+e+", '"+t+"', '"+n+"', '"+i+"')";return Video.buildRateVideoMarkup(o,"sidebarRatingResult")},addForAuthor:function(e,t,n,i){new Ajax.Request("/videos/new_author",{method:"post",parameters:{id:e,"video[source]":"youtube","video[video_id]":t,"video[title]":unescape(n),"video[tags_string]":unescape(i)},onSuccess:function(e){$("addForAuthorSidebar").writeAttribute("class","").update(e.responseText)}})},addVote:function(e,t,n,i){var o="/rating/new_youtube_video";new Ajax.Updater("sidebarRatingResult",o,{asynchronous:!0,evalScripts:!0,parameters:{rating:1,author_id:e,video_id:t,video_title:unescape(n),video_tags:unescape(i)},onComplete:function(){$("addVoteLink").setStyle({color:"#d7d7d7"})}})},buildSearchResults:function(e,t){var n=new Element("ul",{style:"list-style-type: none;"});return e.each(function(e){var i=new Element("li",{style:"margin: 5px 0;"});i.appendChild(YouTube._buildEntryMarkup(e,t)),n.appendChild(i)}),n},_buildEntryMarkup:function(e,t){var n=new Element("div"),i="YouTube.play("+t+", '"+e.get("flashURL")+"', '"+e.get("videoId")+"', '"+escape(e.get("videoTitle"))+"', '"+escape(e.get("videoTags"))+"'); return false;",o=new Element("div",{style:"float: left; width: 130px;"}),r=new Element("img",{src:e.get("thumbnailURL"),style:"cursor: pointer; width: 130px;"});Prototype.Browser.IE?r.onclick=new Function("evt",i):r.writeAttribute("onclick",i),o.appendChild(r);var s=new Element("div",{style:"float: left; width: 150px; margin-left: 10px;"}),a=new Element("a",{href:"#",onclick:i}).update(e.get("videoTitle"));s.appendChild(a);var l=new Element("a",{href:"#",className:"greyText",onclick:"$(this).next().toggle(); return false;",style:"display: block; margin-top: 10px;"}).update("view description");s.appendChild(l);var c=new Element("p",{style:"display: none;"}).update(e.get("videoDesc"));return s.appendChild(c),n.appendChild(o),n.appendChild(s),n.appendChild(new Element("div",{style:"clear: left;"})),n}},Popover=Class.create({initialize:function(e,t){this.targetID=e,this.containerID=t,$(e).observe("click",this.togglePopover.bindAsEventListener(this)),Popover.popovers.push(this)},openPopover:function(){return $(this.targetID).addClassName("active"),$(this.containerID).show(),Prototype.Browser.IE&&$(this.targetID).up("form").descendants().each(function(e){e.match("select")&&e.hide()}),Event.observe(document,"click",Popover.handleOpenPopoverClicks),!1},closePopover:function(){return $(this.targetID).removeClassName("active"),$(this.containerID).hide(),Prototype.Browser.IE&&$(this.targetID).up("form").descendants().each(function(e){e.match("select")&&e.show()}),Event.stopObserving(document,"click",Popover.handleOpenPopoverClicks),!1},togglePopover:function(){return $(this.targetID).hasClassName("active")?this.closePopover():this.openPopover(),!1}});Popover.popovers=[],Popover.closePopovers=function(){for(var e=Popover.popovers.length-1;e>=0;e--)Popover.popovers[e].closePopover();return!1},Popover.handleOpenPopoverClicks=function(e){return e.target.hasClassName("popoverTarget")||e.target.hasClassName("popoverContainer")||null!=e.target.up(".popoverTarget")||null!=e.target.up(".popoverContainer")||Popover.closePopovers(),!1},function(){var e={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|mouse(?:down|up|over|move|out))$/},t={pointerX:0,pointerY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0};Event.simulate=function(n,i){var o,r=Object.extend(t,arguments[2]||{}),s=null;n=$(n);for(var a in e)if(e[a].test(i)){s=a;break}if(!s)throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");return document.createEvent?(o=document.createEvent(s),"HTMLEvents"==s?o.initEvent(i,r.bubbles,r.cancelable):o.initMouseEvent(i,r.bubbles,r.cancelable,document.defaultView,r.button,r.pointerX,r.pointerY,r.pointerX,r.pointerY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,n),n.dispatchEvent(o)):(r.clientX=r.pointerX,r.clientY=r.pointerY,o=Object.extend(document.createEventObject(),r),n.fireEvent("on"+i,o)),n},Element.addMethods({simulate:Event.simulate})}(),function(){Element.scaleToMaxWidth=function(e,t){e=$(e);var n=e.width,i=e.height;return e.width>t&&(e.width=t,e.height=i/n*t),e},Element.scaleToMaxHeight=function(e,t){e=$(e);var n=e.width,i=e.height;return e.height>t&&(e.height=t,e.width=n/i*t),e},Element.addMethods({scaleToMaxWidth:Element.scaleToMaxWidth}),Element.addMethods({scaleToMaxHeight:Element.scaleToMaxHeight})}(),function(){Element.slideToggle=function(e,t){return e.visible()?e.slideUp(t):e.slideDown(t),e},Element.addMethods({slideToggle:Element.slideToggle})}(),function(){Element.showFloatingBox=function(e){return e.visible()||($$(".floatingBox").invoke("hideFloatingBox"),e.show()),document.observe("click",FloatingBox.handleFloatingBoxClicks),e},Element.hideFloatingBox=function(e){return $(e).visible()?(e.hide(),document.stopObserving("click",FloatingBox.handleFloatingBoxClicks),e):void 0},Element.toggleFloatingBox=function(e){return e.visible()?e.hideFloatingBox():e.showFloatingBox(),e},Element.addMethods({showFloatingBox:Element.showFloatingBox}),Element.addMethods({hideFloatingBox:Element.hideFloatingBox}),Element.addMethods({toggleFloatingBox:Element.toggleFloatingBox})}(),function(){FloatingBox={},FloatingBox.handleFloatingBoxClicks=function(e){var t=e.element();t.hasClassName("floatingBox")||t.hasClassName("floatingBoxLink")||null!=t.up(".floatingBox")||($$(".floatingBox").invoke("hideFloatingBox"),document.stopObserving("click",ShelfChooser.handleShelfChooserClicks))}}(),function(){Element.toggleInnerHTML=function(e,t,n){return e.innerHTML=e.innerHTML==t?n:t,e},Element.addMethods({toggleInnerHTML:Element.toggleInnerHTML})}();var ShelfChooser=Class.create({initialize:function(e,t,n,i){this.options=Object.extend(i||{},this.defaultOptions),this.element=e,"string"==typeof this.element&&(this.element=$(this.element)),this.shelfNames=n,this.entryCount=n.length,this.bookId=t,this.chosen=this.options.chosen||[],this.chosen.sort(),this.exclusive=this.options.exclusive||[],this.url=this.options.url,this.onEsc=this.options.onEsc,this.afterChoose=this.options.afterChoose,this.setupMarkup();var o="keydown";(Prototype.Browser.Gecko||Prototype.Browser.Opera)&&(o="keypress"),Event.observe(this.element,o,this.onKeyPress.bindAsEventListener(this)),ShelfChooser.registry.push(this)},setupMarkup:function(){this.element.addClassName("shelfChooserInput"),this.element.setAttribute("autocomplete","off"),this.wrapper=this.element.wrap("div",{id:this.wrapperId(),"class":"shelfChooser uitext"});this.wrapper;this.chooseButton=new Element("a",{href:"#","class":"actionLinkLite chooseShelvesLink"}).update("choose shelves..."),this.wrapper.insert({top:this.chooseButton}),this.chooseButton.observe("click",this.toggle.bindAsEventListener(this)),this.chooserWrapper=this.element.wrap("div",{id:this.domId("chooser"),"class":"shelfChooserWrapper"}),this.chooserWrapper.hide();var e=new Element("a",{href:"#","class":"greyText"}).update("choose shelves...");this.chooserWrapper.insert({top:e}),e.observe("click",this.close.bindAsEventListener(this)),e=new Element("a",{href:"#","class":"right greyText"}).update("close"),this.chooserWrapper.insert({top:e}),e.observe("click",this.close.bindAsEventListener(this)),this.shelvesWrapper=new Element("ul",{"class":"shelves"}),this.chooserWrapper.insert(this.shelvesWrapper);for(var t=0;t<this.shelfNames.length;t++)this.shelvesWrapper.insert(this.buildShelfLi(this.shelfNames[t]));if(this.selectChosen(),this.newShelfButton=new Element("a",{href:"#","class":"actionLinkLite newShelfButton"}).update("Add <span>new</span> shelf"),this.newShelfButtonLi=new Element("li",{"class":"visible newShelfButtonLi",alt:"_NEWSHELFBUTTON"}),this.newShelfButtonLi.observe("click",this.addNewShelf.bindAsEventListener(this)),this.newShelfButtonLi.appendChild(this.newShelfButton),this.newShelfField=new Element("div"),this.newShelfFieldSubmit=new Element("a",{href:"#","class":"button smallButton"}).update("Add"),this.newShelfFieldSubmit.observe("click",function(e){return this.addNewShelf(),e.stop(),!1}.bindAsEventListener(this)),this.newShelfInput=new Element("input",{type:"text"}),this.newShelfInput.observe("keypress",function(e){return e.keyCode==Event.KEY_RETURN?(this.addNewShelf(e),e.stop(),!1):void 0}.bindAsEventListener(this)),this.newShelfField.appendChild(this.newShelfInput),this.newShelfField.appendChild(this.newShelfFieldSubmit),this.newShelfButtonLi.appendChild(this.newShelfField),this.newShelfField.hide(),this.newShelfWrapper=new Element("ul"),this.newShelfWrapper.insert(this.newShelfButtonLi),"undefined"!=typeof FB_COG_READ&&FB_COG_READ||"undefined"!=typeof FB_NONCONNECTED_SHOW_ICON&&FB_NONCONNECTED_SHOW_ICON){if(this.facebookToggleLabel=new Element("label",{"class":"facebookToggle right"}),this.facebookToggleCheckbox=new Element("input",{type:"checkbox",name:"cog_explicit",value:1}),FB_COG_READ&&this.facebookToggleCheckbox.setAttribute("checked","checked"),this.facebookToggleLogo=new Element("img",{src:"/assets/fb-icon.png",alt:"Facebook"}),FB_NONCONNECTED_SHOW_ICON)this.facebookToggleLabel.addClassName("disabled"),this.facebookToggleLogo.setAttribute("src","/assets/fb-icon-gray.png"),this.facebookToggleLogo.setAttribute("data-enabled-src","/assets/fb-icon.png");else{new Tip(this.facebookToggleLabel,'Check this box to post to your Facebook<br>\ntimeline when you shelve a book.<br>\n<a href="/user/edit?tab=apps">change your default</a>\n',{style:"goodreads",stem:"bottomLeft",hook:{tip:"bottomLeft",target:"topMiddle"},offset:{x:5,y:5},hideOn:!1,hideAfter:.05})}this.facebookToggleLabel.appendChild(this.facebookToggleCheckbox),this.facebookToggleLabel.appendChild(this.facebookToggleLogo),this.chooserWrapper.insert(this.facebookToggleLabel)}this.chooserWrapper.insert(this.newShelfWrapper),$j(document).on("touchstart",".shelfChooserWrapper > .shelves",function(e){this.shelfMenuScrollStartPos=$j(this).scrollTop()+e.originalEvent.touches[0].pageY}),$j(document).on("touchmove",".shelfChooserWrapper > .shelves",function(e){this.scrollTop=this.shelfMenuScrollStartPos-e.originalEvent.touches[0].pageY,e.preventDefault()}),(EnvironmentDetection.android.isICS()||EnvironmentDetection.android.isHC())&&$j(".shelfChooserWrapper > .shelves").css("overflow-y","hidden"),this.close()},toggle:function(e){return this.chooserWrapper.visible()?this.close(e):this.open(e)},open:function(e){return this.chooseButton.hide(),$$(".floatingBox").invoke("hide"),this.chooserWrapper.show(),this.chooserWrapper.addClassName("open floatingBox"),this.element.focus(),document.observe("click",ShelfChooser.handleShelfChooserClicks),"undefined"!=typeof e&&e.stop(),!1},close:function(e){return this.chooseButton.show(),this.chooserWrapper.removeClassName("open floatingBox"),this.chooserWrapper.hide(),this.element.clear(),this.unChooseShelf(),this.onObserverEvent(),this.newShelfButton.show(),this.newShelfField.hide(),document.stopObserving("click",ShelfChooser.handleShelfChooserClicks),this.options.afterClose&&this.options.afterClose(this),"undefined"!=typeof e&&e.stop(),!1},addNewShelf:function(e){var t=this.element.value||"";if(this.newShelfField.visible()||0==t.strip().length||this.shelfNames.indexOf(t)>=0)var t=this.newShelfField.down("input[type=text]").value||"";if(t=toShelfName(t),this.newShelfField.visible()&&this.shelfNames.indexOf(t)>=0)return this.chooseShelf(t,{submit:!1}),this.hideNewShelfForm(),!1;if(""==t.strip()||this.shelfNames.indexOf(t)>=0)return this.showNewShelfForm(),"undefined"!=typeof e&&e.stop(),!1;this.hideNewShelfForm(),this.shelfNames.push(t),this.shelfNames.sort();var n,i=this.buildShelfLi(t),o=this.shelfNames.indexOf(t)-1;if(0>o)n=this.shelvesWrapper.select("li.exclusive").last();else{do{var r=this.shelfNames[o],n=this.getShelfLi(r);o--}while(null!=n&&n.hasClassName("exclusive"));null==n&&(n=this.shelvesWrapper.select("li.exclusive").last())}return n.insert({after:i}),this.chooseShelf(t),this.markCurrent(),this.element.focus(),this.element.clear(),"undefined"!=typeof e&&e.stop(),!1},showNewShelfForm:function(){this.facebookToggleLabel&&this.facebookToggleLabel.hide(),this.newShelfButton.hide(),this.newShelfField.show(),this.newShelfField.down("input[type=text]").focus()},hideNewShelfForm:function(){this.facebookToggleLabel&&this.facebookToggleLabel.show(),this.newShelfButton.show(),this.newShelfField.hide(),this.newShelfField.down("input[type=text]").value=""},onKeyPress:function(e){switch(e.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry(),Event.stop(e);break;case Event.KEY_ESC:return this.chooserWrapper.hasClassName("open")&&this.close(),"function"==typeof this.onEsc&&this.onEsc(),void Event.stop(e);case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:return this.markPrevious(),this.render(),void Event.stop(e);case Event.KEY_DOWN:return this.markNext(),this.render(),void Event.stop(e);default:if(this.currentShelfName=null,e.keyCode==Event.KEY_TAB||e.keyCode==Event.KEY_RETURN||Prototype.Browser.WebKit>0&&0==e.keyCode)return!1}return this.observer&&clearTimeout(this.observer),this.observer=setTimeout(this.onObserverEvent.bind(this),1e3*this.options.frequency),!1},markNext:function(){var e=this.getCurrentEntry().next(".visible");if("undefined"==typeof e&&this.getCurrentEntry()!==this.newShelfButtonLi&&(e=this.newShelfButtonLi),e){var t=e.readAttribute("alt");this.currentShelfName=t,e.addClassName("hover"),this.shelvesWrapper.scrollTop+this.shelvesWrapper.getHeight()<e.offsetTop&&(this.shelvesWrapper.scrollTop+=e.getHeight())}},markPrevious:function(){var e=this.getCurrentEntry().previous(".visible");"undefined"==typeof e&&this.getCurrentEntry()===this.newShelfButtonLi&&(e=this.shelvesWrapper.select(".visible").last()),e&&(this.currentShelfName=e.readAttribute("alt"),e.addClassName("hover"),this.shelvesWrapper.scrollTop>e.offsetTop&&(this.shelvesWrapper.scrollTop-=e.getHeight()))},markCurrent:function(){var e=this.getCurrentEntry();e&&(this.render(),this.shelvesWrapper.scrollTop=e.offsetTop)},getCurrentEntry:function(){if(this.currentShelfName)return this.getShelfLi(this.currentShelfName);var e=this.shelvesWrapper.down("li.visible");return e?this.currentShelfName=e.readAttribute("alt"):(this.currentShelfName=this.shelfNames[0],e=this.getShelfLi(this.currentShelfName)),e},getShelfLi:function(e){return"_NEWSHELFBUTTON"==e?this.newShelfButton.up("li"):document.getElementById(this.domId("shelf_"+e))},selectEntry:function(){switch(this.currentShelfName){case"_NEWSHELFBUTTON":return this.addNewShelf(),!1;default:this.toggleShelf(this.getCurrentEntry().readAttribute("alt")),this.element.clear()}},selectChosen:function(){if("undefined"!=typeof this.chosen){for(var e=0;e<this.chosen.length;e++)this.chooseShelf(this.chosen[e],{submit:!1});this.currentShelfName=null}},unChooseAll:function(){for(var e=0;e<this.shelfNames.length;e++)this.unChooseShelf(this.shelfNames[e],{submit:!1,onlyUpdateUI:!0});this.currentShelfName=null},render:function(){this.shelvesWrapper.select("li").invoke("removeClassName","hover"),this.newShelfButtonLi.removeClassName("hover");var e=this.getCurrentEntry();e&&e.addClassName("hover")},onObserverEvent:function(){for(var e,t,n=toShelfName(this.element.value),i=this.shelfNames.length-1;i>=0;i--)e=this.shelfNames[i],t=this.getShelfLi(e),t.fastRemoveClassName("hover"),0==e.indexOf(n)?(t.fastAddClassName("visible"),t.show()):(t.fastRemoveClassName("visible"),t.hide());""==n.strip()||this.shelfNames.indexOf(n)>-1?this.newShelfButton.down("span").update("new"):(this.newShelfField.hide(),this.newShelfButton.show(),this.newShelfButton.down("span").update('<b>"'+n+'"</b>')),this.markCurrent()},wrapperId:function(){return"undefined"==typeof this.wrapper||this.wrapper.id.empty()?"shelfChooser"+this.bookId:this.wrapper.id},domId:function(e){return this.wrapperId()+(e||"")},buildShelfLi:function(e,t){var t=t||{},n=new Element("li",{id:this.domId("shelf_"+e),alt:e,"class":"visible"}),i=new Element("span");return i.update(e),n.observe("click",this.toggleShelf.bind(this,e,t)),this.exclusive.indexOf(e)>-1&&n.addClassName("exclusive"),n.insert(i),n},chooseShelf:function(e,t){if("_NEWSHELFBUTTON"==e)return!1;var t=Object.extend({submit:!0},t||{}),n=this.getShelfLi(e);if(n&&(n.hasClassName("exclusive")?(this.shelvesWrapper.select(".exclusive").invoke("removeClassName","exclusive_chosen"),n.addClassName("exclusive_chosen")):n.addClassName("chosen"),n.show()),this.currentShelfName=e,this.chooserWrapper.visible()&&this.element.focus(),this.chosen.indexOf(e)<0&&(this.chosen.push(e),this.chosen.sort()),this.exclusive.indexOf(e)>-1)for(var i=this.exclusive.length-1;i>=0;i--){var o=this.exclusive[i];if(o!=e){var r=this.chosen.indexOf(o);r>-1&&this.chosen.splice(r,1)}}return this.options.cacheChosen&&this.cacheChosen(),t.submit&&this.submitShelf(e),this.options.afterChoose&&this.options.afterChoose(e,this),!1},unChooseShelf:function(e,t){var t=Object.extend({submit:!0},t||{}),n=this.getShelfLi(e);
if(null==n||n.hasClassName("exclusive_chosen"))return!1;if(n.removeClassName("chosen"),!t.onlyUpdateUI){var i=this.chosen.indexOf(e);i>-1&&this.chosen.splice(i,1)}return this.options.cacheChosen&&!t.onlyUpdateUI&&this.cacheChosen(),t.submit&&this.submitShelf(e,{remove:!0}),this.options.afterChoose&&this.options.afterChoose(e,this),!1},toggleShelf:function(e,t){var n=this.getShelfLi(e);return n.hasClassName("chosen")||n.hasClassName("exclusive_chosen")?this.unChooseShelf(e,t):this.chooseShelf(e,t)},submitShelf:function(e,t){if("_NEWSHELFBUTTON"==e)return!1;var n=$j(this.facebookToggleCheckbox).prop("checked");n="undefined"!=typeof n?n?1:0:null;var t=Object.extend({remove:!1},t||{}),i=Object.extend(this.options.ajaxOptions||{},{parameters:{book_id:this.bookId,name:e,explicit:n,a:t.remove?"remove":""}});new Ajax.Request(this.url,i)},summon:function(e,t){var n=Event.findElement(e),t=t||{};if(t.bookId&&(this.bookId=t.bookId),t.chosen)this.unChooseAll(),this.chosenByBookId&&this.chosenByBookId[this.bookId]?this.chosen=this.chosenByBookId[this.bookId]:(this.chosen=t.chosen,this.options.cacheChosen&&this.cacheChosen()),0==this.chosen.intersect(this.exclusive).length&&(this.chosen.push("read"),this.chosen.sort()),this.selectChosen();else{this.chosen=[],this.unChooseAll();var i=this.wrapper.down(".exclusive_chosen");i&&i.removeClassName("exclusive_chosen")}n.summon(this.wrapper),this.open(e)},cacheChosen:function(){return 0==this.chosen.length?!1:("undefined"==typeof this.chosenByBookId&&(this.chosenByBookId={}),void(this.chosenByBookId[this.bookId]=this.chosen.clone()))},defaultOptions:{url:"/shelf/add_to_shelf",frequency:.15}});!function(){ShelfChooser.registry=[],ShelfChooser.handleShelfChooserClicks=function(e){e.element().hasClassName("shelfChooser")||e.element().hasClassName("shelfChooserLink")||null!=e.element().up(".shelfChooser")||ShelfChooser.registry.invoke("close")}}(),function(){Element.shelfChooser=function(e,t,n,i){new ShelfChooser(e,t,n,i)},Element.addMethods({shelfChooser:Element.shelfChooser})}(),function(){Element.fastHasClassName=function(e,t){return e.className==t?!0:e.className.indexOf(t)>=0},Element.fastAddClassName=function(e,t){return e.fastHasClassName(t)?e:(e.className+=" "+t,e)},Element.fastRemoveClassName=function(e,t){return e.fastHasClassName(t)?(e.className=e.className.replace(t,""),e):e},Element.addMethods({fastHasClassName:Element.fastHasClassName}),Element.addMethods({fastAddClassName:Element.fastAddClassName}),Element.addMethods({fastRemoveClassName:Element.fastRemoveClassName})}();var Popup=Class.create({initialize:function(e){this.options={url:"#",width:300,height:300},Object.extend(this.options,e||{}),window.open(this.options.url,"","width="+this.options.width+",height="+this.options.height)}}),GR_Twitter={callback:null,askToConnect:function(e){var t="true";e&&(this.callback=e,t="callback"),new Popup({url:"/user/twitter_sign_in?popup="+t,width:775,height:550})},callback:function(e){e?this.callback&&this.callback():InlineFlash.showError("Twitter failed to respond. Please try again.")},publish:function(e,t,n){new Ajax.Request("/twitter_users/tweet",{method:"post",parameters:{authenticity_token:window._token,status:e,status_url:t},onSuccess:function(){n||InlineFlash.showNotice("Your status has been updated!")},onError:function(){n||InlineFlash.showError("We had a problem updating your status. Please try again.")}})}},GR_Amazon={askToConnect:function(e){new Popup({url:e,width:900,height:540})}};!function(){Element.summon=function(e,t,n){e=$(e),t=$(t),$(e).addClassName("floatingBoxLink");var n=n||{},i=$(t).offsetLeft,o=$(t).offsetTop,r=$(t).visible(),s=t.style.width+"",a=t.style.height+"",l=0;if($(e).viewportOffset()[0]+$(t).getWidth()>document.viewport.getWidth())var l=-1*$(t).getWidth()+$(e).getWidth();return"function"==typeof n.beforeSummon&&n.beforeSummon(e,t),$(t).absolutize(),$(t).clonePosition(e,{setWidth:n.setWidth,setHeight:n.setHeight,offsetTop:$(e).getHeight()+2,offsetLeft:l}),n.setWidth||t.setStyle({width:s}),n.setHeight||t.setStyle({height:a}),r&&(n.toggle||$(t).offsetLeft==i&&$(t).offsetTop==o)?($(t).hideFloatingBox(),!0):($(t).showFloatingBox(),void("function"==typeof n.afterSummon&&n.afterSummon(e,t)))},Element.addMethods({summon:Element.summon})}();var Labelize={handleClick:function(e,t,n){if(window.justSorted)return window.justSorted=!1,e.stop(),!0;var n=n||{};return"INPUT"==e.target.tagName&&"checkbox"!=e.target.type||"TEXTAREA"==e.target.tagName||"SELECT"==e.target.tagName||"A"==e.target.tagName?!0:(e.target!=t&&(t.checked=!t.checked),t.checked?n.selectedClass&&this.fastAddClassName(n.selectedClass):n.selectedClass&&this.fastRemoveClassName(n.selectedClass),void(e.target!=t&&e.stop()))}};!function(){Element.labelize=function(e,t){var n=e.down("input"),t=t||{},i=t.cursor||"pointer";e.labelized()&&1!=t.force||(e.setStyle({cursor:i}),Labelize["_"+e.id+"_click"]=Labelize.handleClick.bindAsEventListener(e,n,t),e.observe("click",Labelize["_"+e.id+"_click"]))},Element.delabelize=function(e,t){if(e.labelized()){{e.down("input")}e.setStyle({cursor:"auto"}),Labelize["_"+e.id+"_click"]&&(e.stopObserving("click",Labelize["_"+e.id+"_click"]),Labelize["_"+e.id+"_click"]=null),t.selectedClass&&e.fastRemoveClassName(t.selectedClass)}},Element.labelized=function(e){return null!=Labelize["_"+e.id+"_click"]},Element.addMethods({labelize:Element.labelize,delabelize:Element.delabelize,labelized:Element.labelized})}(),function(){Element.dim=function(e){var t=$("dimElt");if(null==t){var t=new Element("div",{id:"dimElt"});document.body.appendChild(t),t.setStyle({position:"absolute",backgroundColor:"white",opacity:"0.5"}),t.hide()}t.clonePosition(e),t.appear()},Element.undim=function(){$("dimElt").fade()},Element.addMethods({dim:Element.dim})}(),function(){Element.bookTip=function(e,t){var n,i,t=t||{},o=t.bookid||e.getAttribute("rel"),r=t.attach||"bottomRight",s=e.hasClassName("interactive"),a="";switch(delete t.bookid,delete t.attach,e.hasAttribute("origin")&&(a=e.getAttribute("origin")),r){case"bottomRight":n={target:"bottomRight",tip:"topLeft"},i="topLeft";break;case"bottomLeft":n={target:"bottomLeft",tip:"topRight"},i="topRight";break;case"left":n={target:"leftMiddle",tip:"rightMiddle"},i="rightMiddle";break;default:n={target:"bottomRight",tip:"topLeft"},i="topLeft"}s&&reverseMerge(t,{hideOn:!1,hideAfter:1});var l="/book/tip/"+o+"?";if(s&&(l+="interactive=1&"),void 0!=a&&a.length>0&&(l+="origin="+a),reverseMerge(t,{delay:1,style:"goodreads",ajax:{url:l,options:{method:"get"}},width:450,hook:n,stem:i}),!(parseInt(o)>0))throw"You must specify a book ID in JS or in the element.";new Tip(e,t)},Element.addMethods({bookTip:Element.bookTip})}();var current_tabs={},changeTab=function(e,t){if(current_tab=current_tabs[e],$(current_tab+"Link")&&$(t+"Link")){var n=$(current_tab);n&&n.hide();var i=$(current_tab+"Link");i&&(i.removeClassName("selectedTab"),i.addClassName("tab"));var o=$(t);o&&o.show();var r=$(t+"Link");r&&(r.removeClassName("tab"),r.addClassName("selectedTab")),current_tab=current_tabs[e]=t}};$j(function(){$j(document).on("click",".js-dhtmlTab",function(e){e.preventDefault();var t=$j(e.target);t.hasClass("selectedTab")||changeTab(t.data("tab-set"),t.data("tab-name"))})}),String.prototype.ordinalize=function(){return parseInt(this).ordinalize()},Number.prototype.ordinalize=function(){for(var e="th",t=this;t>100;)t-=100;if(10>t||t>13)switch(t%10){case 1:e="st";break;case 2:e="nd";break;case 3:e="rd"}return new String(this+e)};var openSelectId=null,openContainerId=null;$j(function(){Modernizr.input.autofocus||$j("#emailForm input[autofocus]").focus(),$grfb.init.done(function(){"connected"!=this.auth.status&&"not_authorized"!=this.auth.status&&$j(".fb-facepile").hide()})});var InfiniteScroll={isLoading:!1,isDone:!1,lastY:0,start:function(e){if(this.options=Object.extend({page:1,url:window.location.href.replace("format=html","format=js")},e||{}),this.url=this.options.url,this.page=this.options.page,this.url.match(/[\?&]page=\d+/)){var t=this.url.match(/[\?&](page=(\d+)&?)/);this.page=parseInt(t[2]),this.url=this.url.replace(t[1],"")}this.url.match(/per_page=\d+/)&&(this.url=this.url.replace(/per_page=\d+&?/,"")),Event.observe(window,"scroll",function(){if(InfiniteScroll.lastY>window.pageYOffset+5)return void(InfiniteScroll.lastY=window.pageYOffset);InfiniteScroll.lastY=window.pageYOffset;var e=document.viewport.getScrollOffsets()[1]+document.viewport.getHeight();e>=document.body.scrollHeight-InfiniteScroll.getTriggerDistance()&&InfiniteScroll.load()});var n=document.viewport.getScrollOffsets()[1]+document.viewport.getHeight();n>=document.body.scrollHeight&&InfiniteScroll.load()},load:function(){return this.isLoading||this.isDone?!1:(this.isLoading=!0,void new Ajax.Request(this.url,{parameters:{page:InfiniteScroll.page+1},evalJS:!0,method:"get",onLoading:function(){return null==InfiniteScroll.options.loading?!0:void("function"==typeof InfiniteScroll.options.loading?InfiniteScroll.options.loading():$(InfiniteScroll.options.loading).show())},onComplete:function(e){InfiniteScroll.isLoading=!1,InfiniteScroll.page+=1,InfiniteScroll.options.loading&&"function"!=typeof InfiniteScroll.options.loading&&$(InfiniteScroll.options.loading)&&$(InfiniteScroll.options.loading).hide(),"function"==typeof InfiniteScroll.options.afterLoad&&InfiniteScroll.options.afterLoad(e)},on204:function(){InfiniteScroll.isDone=!0}}))},getTriggerDistance:function(){if(this.options.triggerDistance)return this.options.triggerDistance;var e=document.body.scrollHeight/2,t=3*document.viewport.getHeight();return e>t?t:e}};!function(){Element.modalDialog=function(e,t){e=$(e);var n=e.id+"_fader",i=$(n);if(i)$(i).update("").show();else{var i=$(n)||new Element("div",{id:e.id+"_fader","class":"modalDialogFader"});$(e).appendChild(i),$(i).absolutize(),Event.observe(window,"resize",function(){$(i).clonePosition(e)})}var o=new Element("div").setStyle({backgroundColor:"white",opacity:"0.8",width:"100%",height:"100%"});$(i).update(o),$(i).clonePosition(e);var r="string"==typeof t?new Element("div").update(t):$(t).show();$(i).appendChild(r),$(r).absoluteCenter()},Element.clearModalDialog=function(e){e=$(e),$(e.id+"_fader")&&$(e.id+"_fader").hide()},Element.absoluteCenter=function(e){var t=$(e).up();"absolute"!=t.getStyle("position")&&"relative"!=t.getStyle("position")&&t.setStyle("position","relative"),$(e).setStyle({position:"absolute",left:"50%",top:"50%",marginLeft:"-"+$(e).getWidth()/2+"px",marginTop:"-"+$(e).getHeight()/2+"px"})},Element.addMethods({modalDialog:Element.modalDialog}),Element.addMethods({clearModalDialog:Element.clearModalDialog}),Element.addMethods({absoluteCenter:Element.absoluteCenter})}();var BookAutocompleter=Class.create(Ajax.Autocompleter,{onKeyPress:function($super,e){this.active||e.keyCode!=Event.KEY_TAB&&e.keyCode!=Event.KEY_RETURN?$super(e):Event.stop(e)}}),BookSearchAutocompleter=Class.create(Ajax.Autocompleter,{selectEntry:function(){this.active=!1,this.index<0||this.updateElement(this.getCurrentEntry())},updateChoices:function(e){if(!this.changed&&this.hasFocus){if(this.update.innerHTML=e,Element.cleanWhitespace(this.update),Element.cleanWhitespace(this.update.down()),this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var t=0;t<this.entryCount;t++){var n=this.getEntry(t);n.autocompleteIndex=t,this.addObservers(n)}}else this.entryCount=0;this.stopIndicator(),this.index=-1,1==this.entryCount&&this.options.autoSelect?(this.selectEntry(),this.hide()):this.render()}},onKeyPress:function(e){if(this.active)switch(e.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:if(this.selectEntry(),!(this.index>-1))return;Event.stop(e);case Event.KEY_ESC:return this.hide(),this.active=!1,void Event.stop(e);case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:return this.markPrevious(),this.render(),void Event.stop(e);case Event.KEY_DOWN:return this.markNext(),this.render(),void Event.stop(e)}else if(e.keyCode==Event.KEY_TAB||e.keyCode==Event.KEY_RETURN||Prototype.Browser.WebKit>0&&0==e.keyCode)return;this.changed=!0,this.hasFocus=!0,this.observer&&clearTimeout(this.observer),this.observer=setTimeout(this.onObserverEvent.bind(this),1e3*this.options.frequency)}}),BookAutoCompleteField={setup:function(e,t,n){var i=BookAutoCompleteField.elementIds(e,t),n=n||{},o=n.url||"/book/auto_complete";n.url=null;var r=n.afterComplete;n.afterComplete=null;var s=n.autocompleterClass||BookAutocompleter;n.autocompleterClass=null;var a={afterUpdateElement:function(e,t){return""==t.id?void($(i.ac_field_id).value=""):($(i.ac_selected).show().down(".acItem").update(t.innerHTML),$(i.ac_wrapper).hide(),$(i.ac_target_id).value=t.id,void("function"==typeof r&&r(e,t)))},callback:function(){return"q="+$F(i.ac_field_id)},indicator:i.ac_loading_id,minChars:3};n=Object.extend(a,n),window[i.ac_autocompleter_name]=new s(i.ac_field_id,i.ac_autocomplete_id,o,n)},clear:function(e,t,n){var i=BookAutoCompleteField.elementIds(e,t),n=n||{};$(i.ac_selected).hide(),$(i.ac_wrapper).show(),$(i.ac_target_id).value="",$(i.ac_field_id).addClassName("greyText").value=n.field_tip||"Start typing the name of a book...","function"==typeof n.after&&n.after()},remove:function(e,t){var n=BookAutoCompleteField.elementIds(e,t);$(n.ac_target_id).value="",$(n.ac_selected).fade({to:.2}),$(n.ac_selected).down(".controls").setStyle({visibility:"hidden"})},elementIds:function(e,t){return{ac_field_id:e,ac_target_id:t,ac_loading_id:e+"_loading",ac_autocomplete_id:e+"_auto_complete",ac_autocompleter_name:e+"_auto_completer",ac_wrapper:e+"_wrapper",ac_selected:e+"_selected"}}},HeaderNav={handleClickOffs:function(e){var t=e.element();t.hasClassName("subnav")||t.hasClassName("subnavlink")||null!=t.up(".subnav")||null!=t.up(".subnavlink")||($$("#siteheader .subnav").invoke("removeClassName","selected"),document.stopObserving("click",HeaderNav.handleClickOffs))},toggleSubnav:function(e){var t=$(e.target).up("li").select(".subnav");(t.length<=0||!t[0].hasClassName("selected"))&&$$("#siteheader .subnav").invoke("removeClassName","selected");for(var n=0;n<t.length;n++)subnav=t[n],subnav.toggleClassName("selected"),subnav.hasClassName("selected")&&document.observe("click",HeaderNav.handleClickOffs)},searchHeaderAfterUpdateElement:function(e,t){if(""==t.id){var n=t.down("a#autocompleteSearchLink");return void(n&&(window.location.href=n.getAttribute("href")))}var i=$$("#"+t.id+" .title")[0];i&&(e.value=i.innerHTML.stripTags().strip()),$j.post("/track_conversion_action",{event:"autocomplete_suggestion_accepted",options:{experiments:"autocomplete_wildcard",multiple:!0}}),window.location="/book/show/"+t.id+"?ac=1"}};if(Element.activateAjaxPaginationLink=function(e){e.observe("click",function(e){new Ajax.Request(this.href,{method:"get",evalJS:!0});try{pageTracker._trackPageview(this.href)}catch(t){}e.stop()})},Element.activateAjaxPagination=function(e){e.select(".imagePaginationSm a").each(function(e){e.activateAjaxPaginationLink()})},Element.addMethods({activateAjaxPaginationLink:Element.activateAjaxPaginationLink}),Element.addMethods({activateAjaxPagination:Element.activateAjaxPagination}),document.observe("dom:loaded",function(){$$(".bookTipBottomRight").each(function(e){e.bookTip({attach:"bottomRight"})}),$$(".bookTipBottomLeft").each(function(e){e.bookTip({attach:"bottomLeft"})}),$$(".bookTipLeft").each(function(e){e.bookTip({attach:"left"})}),$$(".imagePaginationSm a").each(function(e){e.activateAjaxPaginationLink()})}),jQuery(document).ready(function(){if(jQuery("#pollForReload").length>0){var e=$j("#pollForReload").data("reload-link");setInterval(function(){jQuery.getScript(e)},1e4)}}),"undefined"==typeof $gr)var $gr={};$gr&&($gr.components={},$gr.communityQA={},$gr.giveaway={},$gr.shared={},$gr.user={}),$gr.touch=Modernizr.touch?"touchstart":"click",$gr.components.slide=function(e,t){this.containerClassName=".sliderContainer",this.containerWidth=e,this.contentClassName=".slider",this.sliderNav=".navButton",this.sliderPrev=".sliderPrev",this.sliderNext=".sliderNext",this.sliderWidth=t,this.maxLeft=0,this.minLeft=0,this.newWidthSet=!1;var n=this,i=500,o=$j(this.contentClassName);this.setNavVisibility=function(e){"undefined"==typeof e&&o.length&&(e=o.position().left),e>n.minLeft?$j(n.sliderNext).show():$j(n.sliderNext).hide(),e<n.maxLeft?$j(n.sliderPrev).show():$j(n.sliderPrev).hide()},this.singleSlide=function(e){var t;o.stop(),"prev"===e?t=$j(this.contentClassName).position().left+4*this.containerWidth/5:"next"===e&&(t=$j(this.contentClassName).position().left-4*this.containerWidth/5),t=Math.min(t,n.maxLeft),t=Math.max(t,n.minLeft),n.setNavVisibility(t),$j(this.contentClassName).animate({left:t},i)},this.setNewWidth=function(){var t=0;$j(".slider .cover").each(function(){t+=$j(this).outerWidth()}),n.sliderWidth=t;var i=30;n.minLeft=Math.min(e-n.sliderWidth-i,n.maxLeft),$j(".slider").width(t+50),n.newWidthSet=!0},this.toggleBackground=function(e){$j(n.sliderNext).toggleClass("sliderBackground",e),$j(n.sliderPrev).toggleClass("sliderBackground",e)},$j(this.containerClassName).on("click",this.sliderNav,function(){var e;this.hasClassName("sliderNext")?e="next":this.hasClassName("sliderPrev")&&(e="prev"),n.first?(n.singleSlide(e,!0),n.first=void 0):n.singleSlide(e)}),$j(document).on("mouseenter",this.containerClassName,function(){n.toggleBackground(!0),n.setNavVisibility()}).on("mouseleave",this.containerClassName,function(){n.toggleBackground(!1),n.setNavVisibility()}),window.onload=function(){0!==o.length&&(n.setNewWidth(),n.setNavVisibility(),n.toggleBackground(!1))}},$gr.components.headerDropDown=function(){var e=function(e,n,i){var o=e.parent(".dropDownContainer").find(".dropDown").eq(0);e.parents(".generalNotice").length>0&&(e.removeClass("noticeOn"),e.find("span.notification").hide()),$j("#siteheader .selected").not(e).removeClass("selected"),$j("#siteheader .dropDown").not(o).hide(),e.toggleClass("selected"),o.toggle(),$j(document).on("click","body",t),"undefined"!=typeof e.data("request-url")&&o.is(":visible")&&$j.get(e.data("request-url"),{format:"js"}).done(function(e){var t=o.find(".dropDownMenu");t.html(e),$scrollableSection=t.find(n),_.isNumber(i)&&$scrollableSection&&($scrollableSection.css("max-height",i+"px"),$scrollableSection.css("overflow-y","scroll"))}).fail(function(){window.location.href=e.data("request-url")})},t=function(e){var n=$j(e.target);n.hasClass("dropDown")||n.hasClass("dropDownOpener")||n.hasClass("notification")||0!==n.parents(".dropDown").length||($j("#siteheader .dropDown").hide(),$j("#siteheader .selected").removeClass("selected"),$j(document).off("click",t))};return{toggleDropDown:e}}(),$j(document).on("click","#siteheader .dropDownOpener",function(e){var t=".dropdownScroller",n=$j(e.target);n.hasClass("notification")&&(n=n.parent(".dropDownOpener")),$gr.components.headerDropDown.toggleDropDown(n,t,400),e.preventDefault()}),$gr.components.friendRequests=function(){var e=function(e){var t=e.parents(".dropDown").eq(0),n=t.siblings(".dropDownOpener").eq(0).find(".notification");n.html(Number(n.text())-1),0===Number(n.text())&&n.hide(),$notificationWrapper=e.parents(".notificationWrapper"),$notificationWrapper.addClass("hide"),$notificationWrapper.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend",$j.get("/friend/requests",{format:"js"}).done(function(e){t.find(".dropDownMenu").html(e)}))};return{reloadMenu:e}}(),$j(document).on("click",".friendsNotice .confirmRequest",function(e){$gr.components.friendRequests.reloadMenu($j(e.target)),e.preventDefault()}),$gr.components.stickyHeader=function(){var e,t,n=_.debounce(function(){e.toggleClass("scrolledPastWallpaper",t.scrollTop()>40)}),i=function(){$j(".home.stickyHeader").length>0&&(e=$j("body"),t=$j(document),$j(window).on("scroll",n))};return{init:i}}(),$gr.components.mentionInserter=function(){var e=function(e){this.textarea=e},t=function(e){n(this.textarea)?i(this.textarea,e):this.textarea.value+=e},n=function(e){return _.isNumber(e.selectionStart)},i=function(e,t){var n=e.selectionStart;o(t,e,n),r(t,e,n)},o=function(e,t,n){var i=t.value.substring(0,n),o=t.value.substring(n,t.value.length);t.value=i+e+o},r=function(e,t,n){var i=n+e.length;t.selectionStart=i,t.selectionEnd=i};return{setField:e,insertText:t}}(),$gr.components.explanationHighlighter=function(){var e,t=function(){var t=$j(this).data("term-name");e.find("."+t).addClass("highlighted")},n=function(){var t=$j(this).data("term-name");e.find("."+t).removeClass("highlighted")},i=function(i,o,r){e=$j("."+r),$j("."+o).find("."+i).hover(t,n)};return{init:i}}(),$gr.components.interstitialAd=function(){var e,t,n=function(){var n=($j("#interstitialAdContainer").data("ad_name"),20);t=$j(".content").height(),r(),e=setInterval(function(){$j("#adTimeout").html(n),0==n&&o(),n--},1e3)},i=function(){$j("#interstitialAdUnit").children("div").first().children(":hidden").length>0&&$j(window).load(function(){o()})},o=function(){clearInterval(e),$j(".content").height(t),$j(".content").css("overflow","auto"),$j("#interstitialAdContainer").remove()},r=function(){var e=$j(window).height();$j("#interstitialAdContainer").height(e),$j(window).load(function(){$j(".content").height(e),$j(".content").css("overflow","hidden")})};return{detectIfDFPDisplayedAdAndClose:i,hideAd:o,startTimer:n}}();var Cookies={get:function(e){var t=null;return jQuery.each(document.cookie.split("; "),function(n,i){var o=i.split("=");o[0]===e&&(t=o[1])}),t},set:function(e,t,n){n=n||365;var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="; expires="+i.toGMTString();document.cookie=e+"="+encodeURIComponent(t)+o+"; path=/"}},EnvironmentDetection=function(){var e=function(e){return null==navigator.userAgent.match(e)?!1:!0},t=function(){return e(/android 4\.0/i)},n=function(){return e(/android 3/i)},i=function(){for(var e,t=3,n=document.createElement("div"),i=n.getElementsByTagName("i");n.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",i[0];);return t>4?t:e};return{android:{isICS:t,isHC:n},ie:i}}(),grPopup={};grPopup.show=function(e,t){var n=EnvironmentDetection.ie();"function"!=typeof t&&(t=$j.fn.show),e.each(function(){var e=$j(this);e.is(":visible")||(t.call(e),e.offset().left<$j(window).scrollLeft()?e.offset({left:$j(window).scrollLeft()}):$j(window).scrollLeft()+$j(window).innerWidth()<e.offset().left+e.outerWidth()&&e.offset({left:$j(window).scrollLeft()+$j(window).innerWidth()-e.outerWidth()}),void 0!==n&&8>n&&(container=e.closest(".wtrButtonContainer"),container.css("z-index",container.css("z-index")+1e3)))})},grPopup.hide=function(e,t){var n=EnvironmentDetection.ie();"function"!=typeof t&&(t=$j.fn.hide),e.each(function(){var e=$j(this);e.is(":visible")&&e.queue(function(e){t.call($j(this)),e()}).queue(function(e){$j(this).css("left",""),e()}).queue(function(e){void 0!==n&&8>n&&(container=$j(this).closest(".wtrButtonContainer"),container.css("z-index",container.css("z-index")-1e3)),e()})})},HoverIntent={},HoverIntent.onEnterIntent=function(e,t,n,i){"undefined"==typeof n&&(n=e);try{clearTimeout(n.leaveTimeout)}catch(o){}"undefined"==typeof i&&(i=HoverIntent.hoverDelay),n.hoverTimeout=window.setTimeout(function(){t.call(e)},i)},HoverIntent.onLeaveIntent=function(e,t,n,i){"undefined"==typeof n&&(n=e);try{clearTimeout(n.hoverTimeout)}catch(o){}"undefined"==typeof i&&(i=HoverIntent.hoverDelay),n.leaveTimeout=window.setTimeout(function(){t.call(e)},i)},HoverIntent.hoverDelay=250,WantToRead={},$j(function(){var e,t;WantToRead.shelfMenu=function(){return"object"==typeof e&&0!==e.length?e:e=$j(".wtrShelfMenu").first()},WantToRead.exclusiveShelfButtons=function(){return"object"==typeof t&&0!==t.length?t:t=WantToRead.shelfMenu().children(".wtrShelfList").children(".wtrExclusiveShelves").children("li").children("button")},WantToRead.resetShelfMenuStored=function(){e=$j(".wtrShelfMenu").first()}}),WantToRead.submitFormViaAjax=function(e,t,n){var i=e.serializeArray();e.find("button").each(function(){i.push({name:$j(this).prop("name"),value:$j(this).attr("value")})}),i.push({name:"wtr_new",value:!0}),i.push({name:"wtr_button_id",value:e.closest(".wtrButtonContainer").prop("id")}),$j.ajax({type:"POST",url:e.prop("action"),data:i,dataType:"script"}).done(function(){"function"==typeof t&&t()}).fail(function(e){var t;if(e&&403===e.status){if(t=JSON.parse(e.responseText),t.redirect)return location.href=t.redirect,!0;alert("So sorry, but there was a problem completing your request. Please reload the page and try again.")}("function"!=typeof n||n(e)===!1)&&alert("So sorry, but there was a problem completing your request. Please reload the page and try again.")})},WantToRead.setupShelfVisibilityInMenu=function(e){var t=e.data("exclusive-shelf");if(WantToRead.shelfMenu().find("ul.wtrExclusiveShelves > li, ul.wtrNonExclusiveShelves > li").length>11?WantToRead.shelfMenu().find(".wtrShelfSearch").show():WantToRead.shelfMenu().find(".wtrShelfSearch").hide(),WantToRead.updateAddShelfReftags(WantToRead.shelfMenu()),WantToRead.exclusiveShelfButtons().show(),WantToRead.shelfMenu().find(".wtrNonExclusiveShelves input").prop("checked",!1),t){WantToRead.shelfMenu().find("button[value='"+t+"']").hide();var n=e.data("shelves");if(n)for(var i=n.split(","),o=0;o<i.length;o++)WantToRead.shelfMenu().find("input[value='"+i[o]+"']").prop("checked",!0)}},WantToRead.showShelfMenu=function(e){var t=e.find(".wtrRight");WantToRead.resetShelfSearch();var n=t.find(".wtrShelfMenu");n.length>0&&n.get(0)!==WantToRead.shelfMenu().get(0)&&n.remove(),0==t.find("form.wtrAddShelf").length&&t.append(WantToRead.shelfMenu()),WantToRead.setupShelfVisibilityInMenu(t),grPopup.show(WantToRead.shelfMenu(),function(){this.slideDown("fast"),EnvironmentDetection.android.isICS()||EnvironmentDetection.android.isHC()||this.css("overflow-y","auto")})},WantToRead.hideShelfMenu=function(){var e=WantToRead.shelfMenu().find("form.wtrAddShelf input[name=name]"),t=WantToRead.shelfMenu().find(".wtrShelfSearchField");e.is(":focus")||0!==t.length&&t.is(":focus")||(grPopup.hide(WantToRead.shelfMenu(),function(){this.slideUp("fast")}),""===e.val()&&WantToRead.hideAddShelfForm())},WantToRead.toggleAddShelfForm=function(){var e=WantToRead.shelfMenu().find("form.wtrAddShelf");e.is(":visible")?WantToRead.hideAddShelfForm(e):WantToRead.showAddShelfForm(e)},WantToRead.showAddShelfForm=function(e){var t,n=WantToRead.shelfMenu().children(".wtrOtherShelfOptions"),i=WantToRead.shelfMenu().children(".wtrShelfList");e||(e=WantToRead.shelfMenu().find("form.wtrAddShelf")),e.show(),t=e.height(),WantToRead.shelfMenu().children(".wtrOtherShelfOptions").children(".facebookToggle").hide(),n.css("height",n.height()+t),i.css("max-height",parseInt(i.css("max-height"),10)-t)},WantToRead.hideAddShelfForm=function(e){var t,n=WantToRead.shelfMenu().children(".wtrOtherShelfOptions"),i=WantToRead.shelfMenu().children(".wtrShelfList");e||(e=WantToRead.shelfMenu().find("form.wtrAddShelf")),e.is(":visible")&&(t=e.height(),e.hide(),WantToRead.shelfMenu().children(".wtrOtherShelfOptions").children(".facebookToggle").show(),n.css("height",n.height()-t),i.css("max-height",parseInt(i.css("max-height"),10)+t))},WantToRead.showShelfSearchAddShelf=function(){var e=WantToRead.shelfMenu().find(".wtrShelfSearch > .wtrShelfSearchField").val(),t=WantToRead.shelfMenu().children(".wtrShelfList").children(".wtrShelfSearchAddShelf"),n=t.find("button");e=toShelfName(e),WantToRead.shelfMenu().find(".wtrShelfSearchAddShelf button[name=name]").val(e),WantToRead.shelfMenu().find(".wtrShelfSearchAddShelf .wtrButtonLabelShelfName").text(e),"want-to-read"!=e&&""!=e&&0===WantToRead.shelfMenu().find("ul.wtrExclusiveShelves > li[data-shelf_name='"+e+"'], ul.wtrNonExclusiveShelves > li[data-shelf_name='"+e+"']").length?(t.css("display","block"),n.is(":hidden")&&n.css("display","block")):t.css("display","none"),WantToRead.hideAddShelfForm(),WantToRead.shelfMenu().children(".wtrOtherShelfOptions").children("label.wtrAddShelf").hide()},WantToRead.hideShelfSearchAddShelf=function(){WantToRead.shelfMenu().find(".wtrShelfSearchAddShelf").hide(),WantToRead.shelfMenu().children(".wtrOtherShelfOptions").children("label.wtrAddShelf").show()},WantToRead.resetShelfSearch=function(){WantToRead.shelfMenu().find(".wtrShelfSearchField").val(""),WantToRead.shelfMenu().find(".wtrShelfSearchEmptyResults").css("display","none"),WantToRead.hideShelfSearchAddShelf(),WantToRead.shelfMenu().find("ul.wtrExclusiveShelves > li, ul.wtrNonExclusiveShelves > li").css("display","block").removeClass("topShelfSearchResult")},WantToRead.thankForRating=function(e){grPopup.show(e.find(".wtrPrompt.ratingThanks"),function(){this.fadeIn()}),window.setTimeout(function(){grPopup.hide(e.find(".wtrPrompt.ratingThanks"),function(){$j(this).fadeOut()})},6e3)},WantToRead.showPromptToReview=function(){$j(this).hasClass("wtrHasReview")||grPopup.show($j(this).closest(".wtrButtonContainer").find(".wtrPrompt.wtrPromptToReview"),function(){this.fadeIn()})},WantToRead.hidePromptToReview=function(){grPopup.hide($j(this).closest(".wtrButtonContainer").find(".wtrPrompt.wtrPromptToReview"),function(){this.fadeOut()})},WantToRead.showPromptToEditReview=function(){grPopup.show($j(this).closest(".wtrButtonContainer").find(".wtrPrompt.wtrPromptToEditReview"),function(){this.fadeIn()})},WantToRead.hidePromptToEditReview=function(){grPopup.hide($j(this).closest(".wtrButtonContainer").find(".wtrPrompt.wtrPromptToEditReview"),function(){this.fadeOut()})},WantToRead.showUserStatusPrompt=function(){grPopup.show($j(this).closest(".wtrButtonContainer").find(".wtrPrompt.wtrUserStatusPrompt"),function(){this.fadeIn()})},WantToRead.hideUserStatusPrompt=function(e){null!=e&&e.jquery||(e=$j(".wtrButtonContainer")),grPopup.hide(e.find(".wtrPrompt.wtrUserStatusPrompt"),function(){this.fadeOut()})},WantToRead.showNewUserStatusForm=function(e){grPopup.show(e.find(".wtrNewUserStatus")),e.find('.wtrNewUserStatus input[type="text"]').select()},WantToRead.hideNewUserStatusForm=function(e){grPopup.hide(e.find(".wtrFloatingBox.wtrNewUserStatus"),function(){this.fadeOut()})},WantToRead.showFormProgress=function(e){e.is("input")&&(e=e.parent()),e.find(".progressTrigger").hide(),e.find(".progressIndicator").show()},WantToRead.hideFormProgress=function(e){e.find(".progressIndicator").hide(),e.find(".progressTrigger").show()},WantToRead.showUserStatusConfirmation=function(e,t){e.find(".wtrUserStatusConfirmation").replaceWith(t),confirmation=e.find(".wtrUserStatusConfirmation"),grPopup.show(confirmation,function(){this.fadeIn()}),confirmation.on("mouseleave.wtrShowUserStatusConfirmation",function(){confirmation.off("mouseleave.wtrShowUserStatusConfirmation"),grPopup.hide($j(this),function(){this.fadeOut()}),WantToRead.enablePrompts()})},WantToRead.showPromptToReorderShelf=function(){grPopup.show($j(this).closest(".wtrButtonContainer").find(".wtrPrompt.wtrReorderShelf"),function(){this.fadeIn()})},WantToRead.hidePromptToReorderShelf=function(){grPopup.hide($j(this).closest(".wtrButtonContainer").find(".wtrPrompt.wtrReorderShelf"),function(){this.fadeOut()})},WantToRead.activateReorderForm=function(e){e.find(".wtrPrompt.wtrReorderShelf").removeClass("wtrPrompt").addClass("wtrFloatingBox"),e.find(".saveShelfPosition").show(),e.find(".wtrReorderShelf .viewShelfLink").hide()},WantToRead.deactivateReorderForm=function(e){e.find(".wtrFloatingBox.wtrReorderShelf").removeClass("wtrFloatingBox").addClass("wtrPrompt"),e.find(".saveShelfPosition").hide(),e.find(".wtrReorderShelf .viewShelfLink").show()},WantToRead.enablePrompts=function(){WantToRead.disablePrompts(),$j(document).on({"mouseenter.wtrReviewPrompt":function(){HoverIntent.onEnterIntent(this,WantToRead.showPromptToReview)},"mouseleave.wtrReviewPrompt":function(){HoverIntent.onLeaveIntent(this,WantToRead.hidePromptToReview)}},".wtrLeft.wtrStatusRead, .wtrLeft.wtrStatusOtherShelf"),$j(document).on({"mouseenter.wtrReviewPrompt":function(){HoverIntent.onEnterIntent(this,WantToRead.showPromptToEditReview)},"mouseleave.wtrReviewPrompt":function(){HoverIntent.onLeaveIntent(this,WantToRead.hidePromptToEditReview)}},".wtrLeft.wtrStatusRead.wtrHasReview, .wtrLeft.wtrStatusOtherShelf.wtrHasReview"),$j(document).on({"mouseenter.wtrStatusPromptEvents":function(){HoverIntent.onEnterIntent(this,WantToRead.showUserStatusPrompt)},"mouseleave.wtrStatusPromptEvents":function(){HoverIntent.onLeaveIntent(this,WantToRead.hideUserStatusPrompt)}},".wtrButtonContainer .wtrLeft.wtrStatusReadingNow")},WantToRead.disablePrompts=function(){$j(document).off("mouseenter.wtrReviewPrompt mouseleave.wtrReviewPrompt",".wtrLeft.wtrStatusRead, .wtrLeft.wtrStatusOtherShelf"),$j(document).off("mouseenter.wtrReviewPrompt mouseleave.wtrReviewPrompt",".wtrLeft.wtrStatusRead.wtrHasReview, .wtrLeft.wtrStatusOtherShelf.wtrHasReview"),$j(document).off("mouseenter.wtrStatusPromptEvents mouseleave.wtrStatusPromptEvents",".wtrButtonContainer .wtrLeft.wtrStatusReadingNow")
},$j(function(){WantToRead.enablePrompts(),$j(".wtrButtonContainer input, .wtrButtonContainer textarea").placeholder(),$j(document).on("submit",".wtrButtonContainer form.wtrAddShelf, .wtrShelfSearchAddShelf > form",function(){var e=$j(this),t=e.closest(".wtrRight").find(".hiddenShelfForm"),n=t.find("[name='book_id']").val(),i=t.find("[name='unique_id']").val();e.find("[name='book_id']").val(n),e.find("[name='unique_id']").val(i),WantToRead.showFormProgress(e)}),$j(document).on("submit",".wtrButtonContainer form",function(e){e.preventDefault(),WantToRead.submitFormViaAjax($j(this),null,function(e){if(e&&403===e.status){var t=JSON.parse(e.responseText);if(t.redirect)return location.href=t.redirect,!0}return!1})}),$j(document).on("click",".wtrButtonContainer button.wtrUnshelve",function(e){e.preventDefault();var t=$j(this);window.confirm("Removing a book deletes your rating, review, etc. Remove this book from all your shelves?")&&(t.parents(".secondaryWtrButton").length>0?handleSecondaryWtrUnshelving(e):t.closest("form").submit())}),$j(document).on("click",".wtrButtonContainer button.wtrToRead",function(){WantToRead.showFormProgress($j(this).closest("form"))}),$j(document).on("mouseenter.wtrButton",".wtrButtonContainer .wtrRight",function(){HoverIntent.onEnterIntent(this,function(){WantToRead.showShelfMenu($j(this).closest(".wtrButtonContainer"))},WantToRead.shelfMenu())});var e=function(e){HoverIntent.onLeaveIntent(this,WantToRead.hideShelfMenu,WantToRead.shelfMenu(),e)};$j(document).on("mouseleave.wtrButton",".wtrButtonContainer .wtrRight",function(){var t=1e3,n=$j(this),i=n.find(".wtrShelfSearchField");(n.find("form.wtrAddShelf").is(":visible")||i.length>0&&i.val().length>0)&&(t=5e3),e(t)}),$j(document).on("click.wtrButton",".wtrButtonContainer button.wtrShelfButton",function(){WantToRead.shelfMenu().is(":animated")||(WantToRead.shelfMenu().is(":visible")?WantToRead.hideShelfMenu():WantToRead.showShelfMenu($j(this).closest(".wtrButtonContainer")))}),$j(".wtrShelfSearchField").search("ul.wtrExclusiveShelves > li > button, ul.wtrNonExclusiveShelves > li > label",function(e){var t="ul.wtrExclusiveShelves > li, ul.wtrNonExclusiveShelves > li";e.empty(function(){WantToRead.shelfMenu().find(t).css("display","none"),WantToRead.shelfMenu().find(".wtrShelfSearchEmptyResults").css("display","block"),WantToRead.showShelfSearchAddShelf()}),e.reset(function(){WantToRead.resetShelfSearch()}),e.results(function(e){WantToRead.shelfMenu().find(".wtrShelfSearchEmptyResults").css("display","none"),WantToRead.shelfMenu().find(t).css("display","none").removeClass("topShelfSearchResult"),e.parent().css("display","block"),(void 0===EnvironmentDetection.ie()||EnvironmentDetection.ie()>=9)&&e.not("button:hidden").first().parent().addClass("topShelfSearchResult"),WantToRead.showShelfSearchAddShelf()})}),(void 0===EnvironmentDetection.ie()||EnvironmentDetection.ie()>=9)&&$j(document).on("keydown",".wtrShelfMenu > .wtrShelfList > .wtrShelfSearch > .wtrShelfSearchField",function(e){13===e.which&&$j(this).val().length>0&&(e.preventDefault(),WantToRead.shelfMenu().find("ul.wtrExclusiveShelves > li > button:visible, ul.wtrNonExclusiveShelves > li > label > input:visible").first().click())}),$j(document).on("touchstart",".wtrShelfList",function(e){this.wtrScrollStartPos=$j(this).scrollTop()+e.originalEvent.touches[0].pageY}),$j(document).on("touchmove",".wtrShelfList",function(e){this.scrollTop=this.wtrScrollStartPos-e.originalEvent.touches[0].pageY,e.preventDefault()}),(EnvironmentDetection.android.isICS()||EnvironmentDetection.android.isHC())&&$j(".wtrButtonContainer .wtrShelfList").css("overflow-y","hidden"),$j(document).on({mouseenter:function(){HoverIntent.onEnterIntent(this,WantToRead.showPromptToReorderShelf)},mouseleave:function(){HoverIntent.onLeaveIntent(this,WantToRead.hidePromptToReorderShelf)}},".wtrButtonContainer .wtrLeft.wtrStatusToRead"),$j(document).on("click",".wtrButtonContainer .wtrReorderShelf form button[type=submit]",function(){WantToRead.showFormProgress($j(this).closest("form"))}),$j(document).on("click",".wtrExclusiveShelves button.wtrExclusiveShelf",function(){t($j(this))}),$j(document).on("change",".wtrNonExclusiveShelves input.wtrNonExclusiveShelf",function(){t($j(this),!0)});var t=function(e,t){WantToRead.showFormProgress(e);var n=e.val(),i=e.closest(".wtrButtonContainer").find(".hiddenShelfForm"),o=e.closest(".wtrNewUserStatus, .wtrShelfMenu").find("input[name=cog_explicit]");if(o.length>0&&$j("<input>").attr({type:"hidden",name:"explicit",value:o.is(":checked")?1:0}).appendTo(i),0===i.length)return void alert("We're sorry, but there was a problem completing your request. Please reload the page and try again.");if(i.find("[name=name]").val(n),t){var r=e.prop("checked");i.find("[name=a]").val(r?"":"remove"),WantToRead.setShelfTypeReftag(i,"wtrnes")}else WantToRead.setShelfTypeReftag(i,"wtres"),i.find("[name=a]").val("");WantToRead.submitFormViaAjax(i)};$j(document).on("click",".wtrButtonContainer label.wtrAddShelf",function(){WantToRead.toggleAddShelfForm()}),$j(document).on("focusin",".wtrButtonContainer .wtrPrompt.wtrUserStatusPrompt input[type=text]",function(){var e=$j(this).closest(".wtrButtonContainer");WantToRead.disablePrompts(),WantToRead.hideUserStatusPrompt(e),WantToRead.showNewUserStatusForm(e)}),$j(document).on("click",".wtrButtonContainer .wtrNewUserStatus form button[type=submit]",function(){WantToRead.showFormProgress($j(this).closest("form"))}),$j(document).on("click",".wtrButtonContainer div.wtrNewUserStatus form button[type=reset]",function(){buttonContainer=$j(this).closest(".wtrButtonContainer"),WantToRead.hideNewUserStatusForm(buttonContainer),WantToRead.enablePrompts()}),$j(document).on("click",".wtrButtonContainer .wtrNewUserStatusProgressTypeToggle",function(){var e=$j(this).closest(".wtrNewUserStatusProgress"),t=$j(this).closest(".wtrNewUserStatus").find(".wtrNewUserStatusProgress:hidden");e.find("input, button").prop("disabled",!0),e.hide(),t.find("input, button").prop("disabled",!1),t.show()}),$j(document).on("click",".wtrButtonContainer .wtrNewUserStatus button.wtrExclusiveShelf[value=read]",function(e){e.preventDefault(),window.confirm("Mark this book as read?")&&(t($j(this)),WantToRead.enablePrompts())}),$j(document).on("change",".wtrNewUserStatus .facebookToggle",function(){var e=$j(this).find("input[type=checkbox]").is(":checked");$j(this).closest(".wtrButtonContainer").each(function(){$j(this).find(".cogExplicitHidden").val(e?1:0)})}),$j(document).on("click",".facebookToggle.disabled",function(e){var t=$j(this).closest("label"),n=t.children("img");$grfb.ensurePublishPermission().done(function(){t.removeClass("disabled"),t.children("input").prop("checked",!0),n.attr("src",n.data("enabled-src"));// tip right away for users who are already connected -- sorry! We
new Tip(t.get(0),'Check this box to post to your Facebook<br>\ntimeline when you shelve a book.<br>\n<a href="/user/edit?tab=apps">change your default</a>\n',{style:"goodreads",stem:"bottomLeft",hook:{tip:"bottomLeft",target:"topMiddle"},offset:{x:5,y:5},hideOn:!1,hideAfter:.05})}),e.preventDefault()}),$j(document).on("focusin",".wtrButtonContainer input.shelfPosition",function(){$j(this).select(),WantToRead.activateReorderForm($j(this).closest(".wtrButtonContainer"))}),$j(document).on("click",".wtrButtonContainer div.wtrReorderShelf form button[type=reset]",function(){WantToRead.deactivateReorderForm($j(this).closest(".wtrButtonContainer"))})});var clearSecondaryWtrButton=function(e,t){var n=e.parents(".wtrButtonContainer").find(".wtrRight");n.data("exclusive-shelf",""),n.data("shelves",""),WantToRead.setupShelfVisibilityInMenu(n),n.removeClass("wtrDown"),n.addClass("wtrUp"),e.closest(".wtrLeft").replaceWith(t.wtr_button_left)},clearSecondaryRatingStars=function(e,t){var n=e.parents(".wtrButtonContainer").find(".ratingStars");n.replaceWith(t.rating_stars),n.removeClass("hasRating")},handleSecondaryWtrUnshelving=function(e){var t=$j(e.target),n=t.parents(".wtrButtonContainer").attr("id"),i=t.parents("form").attr("action"),o={format:"json",unique_id:n,use_secondary_wtr:!0};$j.ajax({url:i,type:"POST",dataType:"json",data:o,success:function(t){var n=$j(e.target);updateRateBooksHeaderAndFooter(t),clearSecondaryRatingStars(n,t),clearSecondaryWtrButton(n,t)}})};WantToRead.setShelfTypeReftag=function(e,t){var n=e.find(".wtrRefRightShelfMenu");n.length>0&&n.val(n.val().replace(/_wtr(es|nes)$/,"_"+t))},WantToRead.updateAddShelfReftags=function(e){var t=e.parents(".wtrButtonContainer"),n=t.find(".wtrRefRightShelfMenu").val();null!=n&&""!=n&&(e.find(".wtrShelfSearchAddRef").val(n.replace(/_wtres/,"_wtres")),e.find(".wtrAddSearchRef").val(n.replace(/_wtres/,"_wtrnes")),t.find(".wtrExisting").val(t.children(".wtrDown").length>0?"true":"false"))},$j(function(){var e=document.createElement("input");jQuery.support.placeholder=!1,"placeholder"in e&&(jQuery.support.placeholder=!0)}),function(e){"use strict";e(function(){e.support.placeholder||e("[placeholder]").focus(function(){var t=e(this);t.val()===t.attr("placeholder")&&t.val("").removeClass("placeholder")}).blur(function(){var t=e(this);(""===t.val()||t.val()===t.attr("placeholder"))&&t.addClass("placeholder").val(t.attr("placeholder"))}).blur().parents("form").submit(function(){e(this).find("[placeholder]").each(function(){var t=e(this);t.val()===t.attr("placeholder")&&t.val("")})})})}(jQuery),$j(document).ready(function(){$j(".aboutHeaderImage").slideshow(),$j(".jobsValuesButton").each(function(){$j(this).hoverSwitch()})}),function(){var e,t=function(){e=$j(this),n(e)},n=function(e){e.hover(function(){var t=$j(document).find(".jobsValues.js-hoverSwitchHelper-active"),n=$j(".jobsValues#"+e.attr("id"));n.length&&(t.removeClass("js-hoverSwitchHelper-active"),n.addClass("js-hoverSwitchHelper-active"))})};$j.fn.hoverSwitch=function(){return t.apply(this)}}($j),function(){var e,t,n=5e3,i=function(){e=$j(this),t=setTimeout(function(){o(e)},n)},o=function(e){var i,r=e.find("img.active");0==r.length&&(r=e.find("img:last")),i=r.next("img").length?r.next("img"):e.find("img:first"),r.addClass("last-active"),i.css({opacity:0}),i.addClass("active"),i.animate({opacity:1},n/4,function(){r.removeClass("active last-active"),t=setTimeout(function(){o(e)},n)})};$j.fn.slideshow=function(){return i.apply(this)}}($j),document.observe("dom:loaded",function(){$("usersCreatedRecently")&&($("selectButtons").show(),$("selectSuspicious").observe("click",function(){select_all_suspicious_users()}),$("selectNone").observe("click",function(){deselect_all_users()}))}),$j(function(){$j("#deleteShelvesFilter").search("#deleteShelvesList > li > label",function(e){e.empty(function(){$j("#deleteShelvesList > li").addClass("initiallyHidden")}),e.reset(function(){$j("#deleteShelvesList > li").removeClass("initiallyHidden")}),e.results(function(e){$j("#deleteShelvesList > li").addClass("initiallyHidden"),e.parent().removeClass("initiallyHidden")})}),$j(".spamResultItemCheckbox").change(function(){updateSpamResultItemStyling()}),$j(".spamSearchSelectAll").change(function(){$j(".spamResultItemCheckbox").prop("checked",this.checked),$j(".spamSearchSelectAll").prop("checked",this.checked),updateSpamResultItemStyling()}),$j("#spamDeletionForm").submit(function(){var e=$j(".spamResultItemCheckbox:checked").length,t="You are about to delete ";return t+=e,t+=1==e?" item":" items",1==confirm(t)}),updateSpamResultItemStyling()}),$j(document).on("click","#deleteUsersButton",function(e){var t="",n=$j(document.createElement("textarea")).attr("name","multi_delete_note").attr("rows","4").attr("id","multi_delete_note").attr("cols","45"),i=$j(document.createElement("input")).attr("type","button").attr("value","Delete Users").attr("id","submitMultiDelete").attr("class","button");return e.preventDefault(),0===$j(".jsUserDeletionCheckbox:checkbox:checked").length?void alert("No users selected."):void((0==$j(".jsToggleDeleteSpam:checkbox:checked").length||confirm("Please confirm that these are spam users, and you want to delete all content that they have created. Please also confirm that you are not deleting librarians using this tool."))&&($j(".jsUserDeletionCheckbox:checkbox:checked").each(function(e,n){t+=$j(n).attr("data_user_name")+", "}),t=t.slice(0,-2),Lightbox.showBoxString("<h2>Confirm Multi-User Deletion</h2><br><b>Please enter a deletion reason:</b><br><br>"+n[0].outerHTML+"<br><br><b>Users to delete:</b> "+t+"<br><br>"+i[0].outerHTML+"<br><br><a href='#' id='cancelMultiDeleteLightbox'>Cancel</a>",500)))}),$j(document).on("click","#cancelMultiDeleteLightbox",function(e){e.preventDefault(),Lightbox.hideBox()}),$j(document).on("click","#submitMultiDelete",function(){$j("#multi_delete_note").hide(),$j("#deleteUsersForm").append($j("#multi_delete_note")),$j("#deleteUsersForm").trigger("submit",[!0])}),$j(document).on("click",".jsUserDeletionCheckbox:checkbox",function(){var e=$j(".jsUserDeletionCheckbox:checkbox:checked").length;0===e?$j("#userSelectAllToDeleteCheckbox").prop("indeterminate",!1).attr("checked",!1):e===$j(".jsUserDeletionCheckbox").length?$j("#userSelectAllToDeleteCheckbox").prop("indeterminate",!1).attr("checked",!0):$j("#userSelectAllToDeleteCheckbox").prop("indeterminate",!0).attr("checked",!1)}),$j(document).on("click","#userSelectAllToDeleteCheckbox",function(){$j(".jsUserDeletionCheckbox:checkbox:checked").length===$j(".jsUserDeletionCheckbox:checkbox").length?($j(".jsUserDeletionCheckbox:checkbox").attr("checked",!1),$j("#userSelectAllToDeleteCheckbox").attr("checked",!1)):($j(".jsUserDeletionCheckbox:checkbox").attr("checked",!0),$j("#userSelectAllToDeleteCheckbox").attr("checked",!0))}),$j(document).on("change","input.jsToggleDeleteSpam",function(e){$j(e.target).attr("checked")?($j("table.adminRecords .deleteSingleUser").hide(),$j("table.adminRecords .deleteSingleSpamUser").show()):($j("table.adminRecords .deleteSingleSpamUser").hide(),$j("table.adminRecords .deleteSingleUser").show())}),$j(document).on("click",".js-notifyFlagger",function(){var e=$j(this).data("admin-action"),t=$j(this).data("queued-item-id"),n=$j(this).data("ui");"show"===n?$j("#message_field-"+e+"-"+t).show():"hide"===n?$j("#message_field-"+e+"-"+t).hide():$j("#message_field-"+e+"-"+t).toggle()}),$j(function(){if(0==window.location.pathname.search("/book_blogger_award")){disable_subcategories();var e=$j("#categories input:checked").val();e&&set_subcategory_for_category(e),$j("#categories input").change(function(e){set_subcategory_for_category($j(e.target).val())}),$j(".pagination").length>0&&($j(".pagination").hide(),InfiniteScroll.start({loading:"infiniteLoading",afterLoad:function(e){$j("#entries").append(e.responseText)}})),$j(document).delegate("a.castVote","click",function(e){handle_vote_click(e,!1)}),$j(document).delegate("a.changeVote","click",function(e){handle_vote_click(e,!0)}),$j("#awardWidgetMarkup").select()}});var grBookContextSelection={populateBookSelectForQuotes:function(){grBookContextSelection.populateBookSelectOptions("quote_author_name","bookSelect"),grBookContextSelection.clearOptionsFrom($j("#bookChapterSelect"))},populateBookSelectOptions:function(e,t){var n,i,o,r,s,a,l,c,u=$j("#"+t),h=u.find("select");n=$j("#"+e),i=n.val(),o=$j("#authorSelectedUrl").val()+"?author="+encodeURI(i),r=$j.get(o),r.done(function(e){grBookContextSelection.clearOptionsFrom(u),e&&0!==e.length?(l=1===e.length?"one book":e.length+" books",$j("#bookSearchResults").text("We found "+l+" by "+i+"."),s=new Option("Select",null),h.append(s),$j.each(e,function(e,t){c=t.title.length>40?t.title.substring(0,37)+"...":t.title,a=new Option(c,t.id),h.append(a)}),u.removeClass("initiallyHidden")):u.addClass("initiallyHidden")})},clearOptionsFrom:function(e){var t=e.find("select");t.children("option").remove(),e.addClass("initiallyHidden")},populateBookChapterSelectOptions:function(e){var t,n=$j("#bookChapterSelect"),i=n.find("select");grBookContextSelection.clearOptionsFrom(n),t=e.is("span")?e.attr("book_id"):e.val();var o=$j("#bookSelectedUrl").val()+"?book="+t,r=$j.get(o);r.done(function(e){if(0===e.length)n.addClass("initiallyHidden");else{var t=new Option("Select",null);i.append(t),$j.each(e,function(e,t){var n=new Option(t.chapter_name,t.percent);i.append(n)}),n.removeClass("initiallyHidden")}})},showBookAndBookChapterSelectFields:function(){$j("#bookIdSelect option").size()>1&&$j("#bookSelect").removeClass("initiallyHidden"),$j("#bookLocationSelect option").size()>1&&$j("#bookChapterSelect").removeClass("initiallyHidden")},populateBookChapterSelectForTopics:function(){var e=$j(".acItem.auto_complete_selected").children(".ac_book");grBookContextSelection.populateBookChapterSelectOptions(e)},clearBookChapterSelectOptionsForTopics:function(){grBookContextSelection.clearOptionsFrom($j("#bookChapterSelect"))}};$j(document).ready(function(){$j("#quote_body").focus(),grBookContextSelection.showBookAndBookChapterSelectFields();var e=$j(".sharingToggle"),t=e.children("input");$j("#bookIdSelect").on("change",function(){bookIdField=$j(this),grBookContextSelection.populateBookChapterSelectOptions(bookIdField);var n="None"===bookIdField.val()||null===bookIdField.val();e.toggleClass("disabled",n),t.attr("disabled",n)}),$j("#quote_author_name").change(function(){grBookContextSelection.populateBookSelectForQuotes()})});var refreshBookChapterEditButtons=function(){$j(".deleteExistingBookChapterButton").on("click",function(e){var t=$j(this);e.preventDefault();var n=$j.post(t.attr("href"),{_method:"delete"});n.done(function(){t.closest("tr").remove(),InlineFlash.showNotice("Chapter deleted")})}),$j(".deleteNewBookChapterButton").on("click",function(e){var t=$j(this);e.preventDefault();var n,i,o=t.closest("tr");o.hasClass("even")?(n="even",i="odd"):(n="odd",i="even");var r=o.nextAll(".chapter");r.removeClass("odd even"),r.filter(":even").addClass(n),r.filter(":odd").addClass(i),o.remove()})},enableAddBookChapterButton=function(){$j(".addNewBookChapterButton").on("click",function(){var e=$j("#chapterEditTable .chapter").length,t=$j("#chapterEditTable .newChapter"),n=t.clone(!0);lastRow=$j("#chapterEditTable tr.chapter").last(),t.addClass(lastRow.hasClass("even")?"odd":"even"),t.removeClass("newChapter hidden").addClass("chapter"),chapterRowId="chapterRow"+e,t.attr("id",chapterRowId),t.children("#chapterNumber").append(e),t.children("td").each(function(){var t=$j(this).children("input"),n=t.attr("name");newName="book_chapters["+e+"]["+n+"]",t.attr("name",newName)}),$j("#chapterEditTable .chapter:last").after(n)})},enableMakeDefaultChapterBookLink=function(){$j("#makeDefaultChapterBookLink").on("click",function(e){var t=$j(this);e.preventDefault();var n=$j.post(t.attr("href"),{_method:"post"});n.done(function(){t.replaceWith("This book's chapters are now the default for the associated work.")})})};$j(document).ready(function(){refreshBookChapterEditButtons(),enableAddBookChapterButton(),enableMakeDefaultChapterBookLink()}),$j(window).load(function(){$gr.shared.bookCarousel.attachTo(".bookCarousel")}),$j(function(){$gr.shared.newsfeedUpdateUI.attachTo(".js-newsfeed-container"),$gr.shared.attachNewsfeedComponents(),$gr.communityQA.readerQAForm.attachTo(".js-readerQAForm"),$gr.communityQA.shareToggle.attachTo(".js-shareToggle"),$gr.communityQA.facebookTimelinePoster.attachTo(".js-facebookTimelinePoster"),$gr.communityQA.editQAMessageForm.attachTo(".js-editQAMessageForm"),$gr.shared.notification.attachTo(".js-standalone-notification"),LoadMore.attachTo(".jsLoadMoreAnswered",{loadMoreContainerSelector:"#loadMoreContainerAnsweredQuestions",loadMoreActionSelector:".loadMoreActionAnsweredQuestions",loadMoreSelector:".jsLoadMoreAnswered"}),LoadMore.attachTo(".jsLoadMoreUnanswered",{loadMoreContainerSelector:"#loadMoreContainerUnansweredQuestions",loadMoreActionSelector:".loadMoreActionUnansweredQuestions",loadMoreSelector:"jsLoadMoreUnanswered"}),$gr.shared.toggleQaForm.attachTo(document),$gr.shared.authorDashboardQA.attachTo(".js-authorDashboardQA"),$gr.shared.editInPlaceController.attachTo(".communityAnswer.js-editInPlace",{editableElementSelector:".communityAnswerText",highlightElementSelector:".communityAnswerText",elementsToHideSelectors:".communityAnswererName, .communityAnswerText, .communityAnswerFooter"}),$gr.shared.editInPlaceController.attachTo("#helpBox.js-editInPlace",{editableElementSelector:".helpBoxTextContainer",highlightElementSelector:".helpBoxTextContainer",elementsToHideSelectors:".js-editInPlaceEnableAction"}),$gr.shared.dismissModuleUI.attachTo(".js-welcomeBanner",{dismissButtonSelector:".js-dismissWelcomeBanner",userPrefName:"show_welcome_banner",newPrefValue:0}),$gr.shared.editorialStoryForm.attachTo(".js-editorialStoryForm"),$gr.shared.audibleSampleButton.attachTo(window),$gr.shared.audibleExperiments.attachTo(".js-audible-experiments"),$gr.shared.amazonPurchasesBanner.attachTo(".js-amazonRateBooksHeader"),$gr.shared.twitterDialog.attachTo(".twitterDialog"),$gr.shared.twitterCallbacks.attachTo(".mainContentContainer"),$gr.shared.confirmModal.attachTo(".js-confirmModal"),$gr.shared.modal.attachTo(".js-modal"),$gr.shared.modalTrigger.attachTo(".js-modalTrigger"),$gr.shared.checkBoxForm.attachTo(".js-genresForm",{checkedClass:"genreButtonChecked",checkBoxContainerSelector:".genreButton"}),$gr.shared.newsfeedTracking.attachTo(document,{trackingContainerSelector:".newsfeedUpdates"}),$gr.shared.previewableNewsfeedStoryForm.attachTo(".js-previewableNewsfeedStoryForm"),$gr.shared.challenge.attachTo(".challengeSteps"),$gr.shared.dataStoreUserPreferences.attachTo(document),$gr.shared.formBoxChecker.attachTo(".js-formBoxChecker",{massCheckAll:!0}),$gr.shared.openGlidePopup.attachTo(".glideButton"),$gr.shared.favoriteGenre.attachTo(".js-favoriteGenre"),$gr.shared.reviewDraftDataCollection.attachTo(".js-reviewUserText"),$gr.shared.ratingDistTooltip.attachTo(".js-ratingDistTooltip")}),$j(document).on("lazyload:complete",function(){$gr.communityQA.readerQAForm.attachTo(".js-readerQAForm"),$gr.communityQA.shareToggle.attachTo(".js-shareToggle")}),$j(document).ready(function(){LoadMore.attachTo(".jsLoadMore")}),$gr.shared.attachNewsfeedComponents=function(){$gr.shared.newsfeedNav.attachTo(".js-newsfeedNav"),$gr.shared.updateFiltersForm.attachTo(".js-updateFiltersForm"),$gr.shared.checkBoxForm.attachTo(".js-genresForm",{checkedClass:"genreButtonChecked",checkBoxContainerSelector:".genreButton"}),$gr.shared.relatedWorks.attachTo(".js-relatedWorksTrigger"),LoadMore.attachTo(".jsLoadMoreUpdates",{loadMoreContainerSelector:"#loadMoreContainerUpdates",loadMoreActionSelector:".loadMoreActionUpdates",loadMoreSelector:".jsLoadMoreUpdates"}),$gr.shared.newsfeedMenu.attachTo(".js-newsfeedStoryDropdown"),$gr.shared.tooltip.attachTo(".js-tooltipTrigger"),$gr.shared.dataTooltip.attachTo(".js-dataTooltip"),$gr.shared.modal.attachTo(".js-modal"),$gr.shared.modalTrigger.attachTo(".js-modalTrigger"),$gr.shared.followSuggestedAuthor.attachTo(".js-followSuggestedAuthor")};var EnableButtons={enableButtons:function(e){return e.observe("click",function(t){$(e).up().request(),t.stop()}),$(e)}};Element.addMethods(EnableButtons),Element.enableButtons=function(e){e.observe("click",function(t){$(e).up("form").request(),t.stop()})},Element.addMethods({enableButtons:Element.enableButtons}),document.observe("dom:loaded",function(){enableAll(".relatedVoteAction"),enableAll(".ignoreRelatedWorkAction"),enableAll(".userNotInterestedWorkAction")}),$j(document).ready(function(){$j(".eventResponseForm").bind("ajax:beforeSend",function(){$j(this).find(".loadingImage").show()}).bind("ajax:success",function(e,t){var n=$j(this);n.closest(".respondEvent").hide(),n.find(".loadingImage").hide(),n.closest(".respondEvent").parent().find(".respondEventStatus").html(t)})}),$j(function(){function e(e){var t=e.parent(),n=e.closest(".expandableContainer");t.hide(),t.hasClass("fullContent")?n.find(".truncatedContent").show():n.find(".fullContent").show()}$j(document).on("click",".jsHide, .jsShow",function(t){t.preventDefault(),e($j(t.target))})}),$grfb=function(){var e="email, user_likes, friends_likes, user_friends",t="publish_actions",n={grSession:!1,suppressAutoLogin:!1},i=$j.Deferred();window.fbAsyncInit=function(){FB.init({appId:n.appId,// This is what makes login work! The cookie contains a signed request;
cookie:"localhost"===location.hostname?" ":!0,// parse any social plugins on the page (misnomer! not related to XFBML!)
xfbml:!0,version:"v1.0"}),FB.getLoginStatus(function(e){$grfb.auth=e,i.resolveWith($grfb)}),FB.Event.subscribe("auth.authResponseChange",function(e){$grfb.auth=e})};var o=function(e){$j.extend(n,e),function(e,t,n){var i,o=e.getElementsByTagName(t)[0];e.getElementById(n)||(i=e.createElement(t),i.id=n,i.src="//connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(i,o))}(document,"script","facebook-jssdk")},r=function(o){o="object"==typeof o?o:{},o.withWritePermission=!0;var r,s,a=$j.Deferred(),c=e,u=n.publishEnabled;return o.withWritePermission&&(c+=","+t),FB.login(function(e){"object"==typeof e&&"connected"===e.status?a.resolve(e):a.reject(e)},{scope:c}),i.done(function(){"connected"!==this.auth.status||o.withWritePermission?n.publishEnabled=null:// Warning! This might not be good enough; this will fail if the user
a.resolve(this.auth)}),a.done(function(){o.hasOwnProperty("trackingId")&&(r=$j.post("/track/track",{tid:o.trackingId})),n.grSession&&o.withWritePermission&&u===!1&&(s=$j.Deferred(),l().fail(function(){s.resolve()}).done(function(){// they agreed! make sure the server knows
$j.post("/user/update_preferences",{user:{fb_cog_enabled:1},fb_connect_source:o.fbsource}).always(function(){s.resolve()})})),o.hasOwnProperty("redirect")&&$j.when(r,s).always(function(){window.location.href=o.redirect})}),a.promise()},s=function(){var e=$j.Deferred();return i.done(function(){"connected"===this.auth.status?FB.logout(function(){e.resolve()}):e.resolve()}),e.promise()},a=function(e){e="object"==typeof e?e:{};var t=$j.Deferred();if(n.publishEnabled===!0)t.resolve();else{var i={};i.withWritePermission=!0,i.fbsource=e.fbsource,r(i).always(function(){l().fail(function(){t.reject()}).done(function(){t.resolve()})})}return t.done(function(){e.hasOwnProperty("redirect")&&(window.location.href=e.redirect)}),t.promise()},l=function(){var e=$j.Deferred();return i.done(function(){"connected"===this.auth.status?n.publishEnabled===!0?e.resolve():n.publishEnabled===!1?e.reject():FB.api("/me/permissions",function(n){n.hasOwnProperty("data")&&n.data[0].hasOwnProperty(t)?e.resolve():e.reject()}):e.reject()}),e.done(function(){n.publishEnabled=!0}).fail(function(){n.publishEnabled=!1}),e.promise()},c=function(e,t){t="object"==typeof t?t:{};var n=$j.Deferred(),i=e.split(","),o={scope:e,return_scopes:!0,auth_type:"rerequest"},r=function(e){if(e.hasOwnProperty("authResponse")&&e.authResponse.hasOwnProperty("grantedScopes")){var t=e.authResponse.grantedScopes.split(","),o=!0;$j.each(i,function(e,n){$j.inArray(n,t)<=-1&&(o=!1)}),o?n.resolve():n.reject()}else n.reject()};return FB.login(r,o),n.done(function(){t.hasOwnProperty("redirect")&&(window.location.href=t.redirect)}),n.promise()},u=function(){var e=$j.Deferred();return i.done(function(){"connected"===this.auth.status?FB.api("/me/permissions","DELETE",function(t){t===!0?(FB.getLoginStatus(),n.publishEnabled=!1,$j.post("/facebook_users/destroy").done(function(){e.resolve()}).fail(function(){e.reject()})):e.reject()}):"not_authorized"===this.auth.status?$j.post("/facebook_users/destroy").done(function(){e.resolve()}).fail(function(){e.reject()}):e.reject()}),e.promise()},h=function(e){var t=$j.Deferred();return i.done(function(){e.method="feed",FB.ui(e,function(e){t.resolve(e)})}),t.done(function(t){if(t&&"object"==typeof t&&t.hasOwnProperty("post_id")){var n;n=e.hasOwnProperty("trackingId")?e.trackingId:"fb_"+e.resource_type+"_feed_form_opp",$j.post("/track/track",{tid:n})}}),t.promise()},d=function(e){var t=$j.Deferred();return i.done(function(){e.method="send",FB.ui(e,function(e){e&&"object"==typeof e&&e.hasOwnProperty("success")?t.resolve(e):t.reject(e)})}),t.promise()},p=function(e){var t=$j.Deferred();return i.done(function(){FB.ui({method:"pagetab"},function(n){if(n&&"object"==typeof n&&n.hasOwnProperty("tabs_added")&&0!==n.tabs_added.length){for(facebook_page_id in n.tabs_added)if(n.tabs_added.hasOwnProperty(facebook_page_id)&&"object"==typeof e){var i={"facebook_page[facebook_page_id]":facebook_page_id,"facebook_page[page_type]":e.pageType};"g"===e.pageType&&(i["facebook_page[group_id]"]=e.groupId),$j.post("/facebook/page_tab/create_via_js",i)}t.resolve(n)}else t.reject(n)})}),t.promise()};return i.done(function(){var e="mobile"!==window.Mobvious.device_type;n.grSession||n.suppressAutoLogin||"connected"===this.auth.status&&(e&&Lightbox.showBoxByID("fbSigninNotification"),$j.post("/track/track",{tid:"fb_auto_login"}).fail(function(){e&&Lightbox.hideBox()}).done(function(){location.reload()}))}),i.done(function(){n.publishEnabled=n.serverPublishEnabled}),i.done(function(){"not_authorized"===this.auth.status&&n.serverFBUser&&(n.brokenFbConnectionTracked||$j.post("/facebook_users/temp_track_broken_fb_connection"))}),i.done(function(){var e=$j.Deferred();"connected"===this.auth.status&&n.grSession&&!n.publishPermissionVerified&&(n.publishEnabled=null,l().done(function(){n.serverPublishEnabled?e.resolve():$j.post("/user/update_preferences",{user:{fb_cog_enabled:1},auto_repair:!0}).done(function(){e.resolve()})}).fail(function(){n.serverPublishEnabled?$j.post("/user/update_preferences",{user:{fb_cog_enabled:0},auto_repair:!0}).done(function(){e.resolve()}):e.resolve()})),e.done(function(){$j.post("/facebook_users/permissions_verified")}),i.done(function(){if("true"!==Cookies.get("fbl"))return!1;if("connected"===this.auth.status)return!1;var e="";"object"==typeof this.auth.authResponse&&(e=this.auth.authResponse.userID);var t=encodeURIComponent(JSON.stringify(e+"--"+JSON.stringify(this.auth.status)));$j.post("/user/sign_out?facebook_auto_logout=true&auth_log="+t).done(function(){var e=encodeURIComponent(location.pathname+location.search);window.location.href="/user/sign_in?returnurl="+e})})}),{init:i.promise(),initialize:o,login:r,logout:s,ensurePublishPermission:a,ensurePermission:c,checkPublishPermission:l,disconnect:u,feedDialog:h,sendDialog:d,pageTabDialog:p}}(),$j(document).on("click",".fbjsLogin",function(e){var t=$j(this),n=t.data();if(!n.hasOwnProperty("redirect")){var i=t.attr("href");""!==i&&(n.redirect=i)}$grfb.login(n),e.preventDefault()}),$j(document).on("click",".fbEnsurePermissions",function(e){var t=$j(this),n=t.data();if(!n.hasOwnProperty("redirect")){var i=t.attr("href");""!==i&&(n.redirect=i)}n.hasOwnProperty("permissions")?$grfb.ensurePermission(n.permissions,n):$grfb.login(n),e.preventDefault()}),$j(document).on("click",".fbjsLogout",function(e){var t=$grfb.logout(),n=$j(this).attr("href");""!==n&&t.done(function(){window.location.href=n}),e.preventDefault()}),$j(document).on("change",".fbjsPublishToggle",function(){var e=$j(this),t=e.children("input[type=checkbox]"),n=t.is(":checked");e.toggleClass("checked",n),n&&$grfb.ensurePublishPermission().fail(function(){e.removeClass("checked"),t.attr("checked",!1)})});var FacebookFriendsInviter=function(e){var t={numSearchResults:9,numFriendsPerPage:5,showGenres:!0,only_fb:!1},n={},i={},o=function(n){var i;e.extend(t,n),b(),d(),r(),changePhrase(0),setTimeout(function(){e(".doneAdding").fadeIn()},8e3),i=t.showGenres?function(){l()}:function(){a()},s(i)},r=function(){n={genreSection:_.template(e("#genreSectionTemplate").html()),friendLi:_.template(e("#inviteFbFriendLiTemplate").html()),invitedFriendLi:_.template(e("#invitedFbFriendLiTemplate").html()),noResultsLi:_.template(e("#noResultsLiTemplate").html()),clear:'<div class="clear" />'}},s=function(n){queryString=t.only_fb?"?only_fb=true":"",e.get("/fb_reg/friend_groups"+queryString,function(t){i=t,e(".loadingNotice").hide(),e("#fbInviteFriendSearch").show().find("input").focus(),e("#fbSearchIcon").show(),"function"==typeof n&&n()})},a=function(){var t=e("#noGenresContainer"),n=t.find("ul.left"),i=t.find("ul.right"),o="",r="",s=g("name");e.each(s,function(e,t){var n=v(t);e%2===0?o+=n:r+=n}),n.html(o),i.html(r),t.show()},l=function(){var t=e("#genresContainer"),o=0,r="";e.each(i,function(e,t){var i,s;return 0===t.length?!0:(i=o%2===0?"left":"right",s={position:i,friendsCount:t.length,genreName:e},genreSection=n.genreSection(s),r+=genreSection,"right"==i&&(r+=n.clear),void(o+=1))}),t.html(r),e("#genresContainer section").each(function(){c(e(this).find("ul"),"firstPage")}),t.show()},c=function(n,o){var r,s,a=n.parents("section"),l=a.find(".nextFriends"),c=a.find(".prevFriends"),u=a.data("genre"),h=n.data("page"),d=t.numFriendsPerPage,p="";if("firstPage"===o)r=i[u].slice(0,d),n.data("page",1);else if("nextPage"===o)s=h*d,r=i[u].slice(s,s+d),n.data("page",h+1);else{if("prevPage"!==o)return;s=(h-1)*d,r=i[u].slice(Math.max(s-d,0),s),n.data("page",h-1)}r.length<d&&"nextPage"===o?(l.hide(),c.fadeIn()):2==h&&"prevPage"===o?(l.fadeIn(),c.hide()):"firstPage"===o?(l.fadeIn(),c.hide()):(l.fadeIn(),c.fadeIn()),e(r).each(function(e,t){p+=v(t)}),n.html(p)},u=function(t){var n=e(t),i=n.data().fbId;$grfb.sendDialog({to:i,link:"http://www.goodreads.com/user/sign_up?from_fb_send_dialog=true"}).done(function(){y(function(e){e.fb_id===i&&(e.invited=!0)}),h(i),e.post("/facebook_users/record_invitation_sent",grViralTrackingParams)})},h=function(t){e(".inviteFriendsContainer li").each(function(i,o){var r=e(o),s=r.find(".button").data("fb-id");if(s===t){var a=r.children(".fbFriendName").text(),l={name:a,fbId:t},c=n.invitedFriendLi(l);r.replaceWith(c)}})},d=function(){e("#genresContainer").on("click",".nextFriends",function(){var t=e(this).siblings("ul");c(t,"nextPage")}),e("#genresContainer").on("click",".prevFriends",function(){var t=e(this).siblings("ul");c(t,"prevPage")}),e("#fbInviteFriendSearch input").on("blur",function(){e("#fbFriendSearchAutocomplete").delay(100).fadeOut(100)}),e("#fbInviteFriendSearch input").on("keyup",function(){p(e(this).val())}),e(".inviteFriendsContainer, #fbFriendSearchAutocomplete").on("click",".button",function(){u(this)}),e("#declineAutoAddLink").on("click",function(t){e("#auto_add_fb_friends_confirm").val(!1),e("#confirmAutoAddForm").submit(),t.preventDefault()}),e("#confirmAutoAddSubmit").on("click",function(){Lightbox.hideBox(),o({only_fb:!0})})},p=_.debounce(function(e){var t=f(e);m(t,e)},250),f=function(n,i){var o={},r=0,n=n.toLowerCase(),s={numResults:t.numSearchResults};return n.length<1?o:(i=e.extend({},s,i),y(function(e){var t,s;return r>=i.numResults?!1:(t=e.name.toLowerCase().indexOf(n)>=0,s=void 0===o[e.fb_id],void(t&&s&&(r+=1,o[e.fb_id]=e)))}),o)},m=function(t,i){var o,r=0,s=e("#fbFriendSearchAutocomplete");s.hide().html(""),e.each(t,function(e,t){var n=v(t);s.append(n),r+=1}),0===r&&i.length>0?(o=i.substring(0,50),o+=i.length>50?"...":"",s.append(n.noResultsLi({query:_.escape(o)})),s.show()):r>0?s.show():s.hide()},g=function(e){var t={},n=[];return y(function(e){e.fb_id in t||(t[e.fb_id]=!0,n.push(e))}),n.sort(function(t,n){return t[e]<n[e]?-1:t[e]>n[e]?1:0}),n},v=function(e){var t={name:e.name,fbId:e.fb_id};return e.invited?n.invitedFriendLi(t):n.friendLi(t)},y=function(t){e.each(i,function(n,i){e.each(i,function(e,i){t(i,n)})})},b=function(){e(".loadingNotice").show(),e("#fbInviteFriendSearch").hide(),e("#fbSearchIcon").hide(),e("#noGenresContainer").hide(),e("#genresContainer").hide()};return{init:o}}(jQuery);$j(document).ready(function(){$j.each($j(".fbFriendSelectorBox"),function(e,t){$j(t).click(function(){$j(this).is(":checked")?$j(this).parent().parent().addClass("selected"):$j(this).parent().parent().removeClass("selected")})}),$j("#auto_add_fb_friends.autosave").click(function(){$j.post("/user/toggle_auto_add_fb_friends_pref",{auto_add_fb_friends:$j("#auto_add_fb_friends").is(":checked")}).success(function(){$j("#pref_status").html("Preference saved.").effect("highlight",{},2e3)}).error(function(){$j("#pref_status").html("There was an error saving your preference.").effect("highlight",{},2e3)})}),$j("body").on("submit","#confirmAutoAddForm",function(e){var t=$j(e.target);$j("#user_auto_add_fb_friends").attr("checked","true"==t.find("#auto_add_fb_friends_confirm").val()),$j.post(t.attr("action"),t.serialize()).success(function(){Lightbox.hideBox(),"undefined"!=typeof updateGenreBoxes&&updateGenreBoxes()}).error(function(){alert("There was an error saving your preference. Please try again.")}),e.preventDefault()})});var loading_phrases=["Grouping your friends by what they've read","Searching for the history buffs","Tracking down the mystery addicts","Guess who's been reading romance novels","Your friends could read more classics","Analyzing your friends' books"];$j(document).ready(function(){$j(".js-choiceAdminPullDownNavigator").on("change",function(e){var t=e.target.value;$j.ajax({url:"/choiceawards/admin",type:"GET",dataType:"script",data:{slug:t}})})}),$gr.giveaway=function(){var e=function(){var e=$j("<label>",{"for":"giveaway_book_id"});$j("#giveaway_book_isbn").val(""),$j("#giveaway_isbn_container").hide(),$j("#giveaway_book_id_container").show(),e.text("Book ID").attr({id:"giveaway_book_id_label"}),$j("#giveaway_book_isbn_label").replaceWith(e)},t=function(){var e=$j("<label>",{"for":"giveaway_book_isbn"});$j("#giveaway_book_id").val(""),$j("#giveaway_book_id_container").hide(),$j("#giveaway_isbn_container").show(),e.text("ISBN/ISBN13").attr({id:"giveaway_book_isbn_label"}),$j("#giveaway_book_id_label").replaceWith(e)};return{change_to_book_id:e,change_to_isbn:t}}(),$j(document).ready(function(){$j("#giveaway_book_id_switch_link").click($gr.giveaway.change_to_book_id),$j("#giveaway_book_isbn_switch_link").click($gr.giveaway.change_to_isbn),""!==$j("#giveaway_book_id").val()?$gr.giveaway.change_to_book_id():$gr.giveaway.change_to_isbn()}),void 0==window.gr&&(window.gr={}),window.gr.toggleStatusLink=function(e,t){var t=t||{},n=t.target||$$($(e).getAttribute("rel")).first(),i=$(n).down(".status_form_contents");!$(n).visible()||i&&!i.visible()?(t.callback instanceof Function&&t.callback.apply(e,t),this.openStatusLink(e)):this.closeStatusLink(e)},window.gr.closeStatusLink=function(e,t){var t=t||{},n=t.target||$$($(e).getAttribute("rel")).first();$(n).hide(),$(e).removeClassName("open")},window.gr.openStatusLink=function(e,t){var t=t||{},n=t.target||$$($(e).getAttribute("rel")).first(),i=$(e).up(".status_editor");i&&i.select(".toggleLink.open").each(function(e){gr.closeStatusLink(e)}),$(n).show();var o=$(n).down(".status_form_contents");o&&o.show(),$(e).addClassName("open")},window.gr.install_count_chars=function(e,t){$j(document).on("keypress",e,function(e){window.countChars(e,t)})},window.gr.makeBigger=function(e){var t=$$(e)[0],n=parseInt(t.getStyle("height"));t.setStyle({height:n+200+"px"})},void 0==window.gr&&(window.gr={}),window.gr.RecommendedUIHelper=function(e){var t=this;return t.clear=function(){t.id_input().value="",t.name_input().value="",t.ui().hide(),t.autocomplete_wrapper().show(),t.name_input().focus()},t.clear_action=function(){return void 0===t._clear_action&&(t._clear_action=$$(".reviewForm .ui_recommended .clear_action").first()),t._clear_action},t.member=function(){return void 0===t._member&&(t._member=$$(".reviewForm .ui_recommended .member").first()),t._member},t.member_status=function(){return void 0===t._member_status&&(t._member_status=$$(".reviewForm .ui_recommended .member_status").first()),t._member_status},t.id_input=function(){return void 0===t._id_input&&(t._id_input=$$(".reviewForm #review_recommender_user_id1").first()),t._id_input},t.name_input=function(){return void 0===t._name_input&&(t._name_input=$$(".reviewForm #review_recommender_user_name1").first()),t._name_input},t.autocomplete_wrapper=function(){return void 0===t._ac&&(t._ac=$$(".reviewForm .autocomplete").first()),t._ac},t.ui=function(){return void 0===t._ui&&(t._ui=$$(".reviewForm .ui_recommended").first()),t._ui},t.after_update_element=function(e,n){t.id_input().value=n.id,t.id_input().setAttribute("id_for_name",n.innerHTML)},t.set_or_invalidate_id=function(){var e=!0;try{e=t.autocompleter.getCurrentEntry(),t.after_update_element(t.autocompleter.element,e)}catch(n){}t.id_input().getAttribute("id_for_name")!==t.name_input().value&&(t.id_input().value="")},t.non_member_entry=function(){t.autocomplete_wrapper().hide(),t.ui().show(),t.member().hide(),t.ui().select(".clear_action").first().show();var e=t.ui().select(".non_member").first();e.update(t.name_input().value),e.show(),t.id_input().value="",t.member_status().update("")},t.member_entry=function(){t.autocomplete_wrapper().hide(),t.ui().show(),t.ui().select(".non_member").first().hide(),t.ui().select(".clear_action").first().show(),t.member().update(t.name_input().value),t.member().setAttribute("href","/user/show/"+t.id_input().value),t.member().show(),t.member_status().update("(goodreads)")},t.on_focus_lost=function(){setTimeout(function(){0!=t.name_input().value&&(t.set_or_invalidate_id(),0==t.id_input().value?t.non_member_entry():t.member_entry())},100)},t.if_single_response_matches_name=function(e){if(t.autocompleter.hasFocus);else{var n=new Element("div").update(e.responseText);if(1===n.children[0].children.length){var i=n.children[0].children[0].id,o=n.children[0].children[0].innerHTML;t.name_input().value===o&&(t.id_input().value=i,t.member_entry())}}},!e.test==!0&&(t.autocompleter=new Ajax.Autocompleter("review_recommender_user_name1","review_recommender_user_name1_auto_complete",e.search_url,{indicator:"recommender_user_name1_indicator",afterUpdateElement:t.after_update_element,on200:t.if_single_response_matches_name}),Event.observe(t.name_input(),"blur",function(){t.on_focus_lost()}),Event.observe(t.clear_action(),"click",function(){t.clear()})),{clear_action:t.clear,no_member_found:t.non_member_entry,after_update_element:t.after_update_element,on_focus_lost:t.on_focus_lost}},$j(function(){$j("#showFlag").on("click",function(e){$j("#flagGroup").removeClass("initiallyHidden"),Lightbox.showBoxByID("flagGroup"),e.preventDefault()}),$j("#toggleFlagExplanation").on("click",function(e){$j("#flagExplanation").toggleClass("initiallyHidden"),e.preventDefault()})});var GroupJoiner=function(){var e={numGroupsShown:3,regpath:!1},t={},n=[],i=[],o="",r=!1,s=function(t,i,r){$j.extend(e,r),n=t,o=i,u().parent().addClass("groupsContainer").removeClass("initiallyHidden"),v(),m(),c(),a(),h()},a=function(){for(;i.length<e.numGroupsShown;){var t=n.pop();if(!t)break;i.push(t)}},l=function(e){var t=[];$j.each(i,function(n,i){i.status==e&&t.push(n)}),$j.each(t,function(e,t){var o=n.pop();o?i[t]=o:i.splice(t,1)})},c=function(){t={groupLi:_.template($j("#groupLiTemplate").html()),renderingGroupLi:_.template($j("#renderingGroupLiTemplate").html()),noResultsLi:_.template($j("#noResultsLiTemplate").html()),clear:'<div class="clear" />'}},u=function(){return $j("#"+o)},h=function(){var t=u();return 0===i.length?(t.html(g(null)),void(e.outOfGroupsCallback&&e.outOfGroupsCallback())):void $j.each(i,function(e,n){for(var i=$j(t.children("li")[e]);0!==i.length&&i.data("group-id")!==n.id;)i.remove(),i=$j(t.children("li")[e]);0===i.length?t.append(g(n)):n.invalidated&&(i.replaceWith(g(n)),n.invalidated=!1)})},d=function(e){$j.each(i,function(t,n){n.id===e&&(n.status="rendering",n.invalidated=!0)}),h(),r||(r=!0,window.setTimeout(function(){l("rendering"),h(),r=!1},1e3))},p=function(e){$j.post("/group/join/"+e,{user_subscription:{frequency:"D"}}),d(e)},f=function(t){e.regpath&&$j.post("/track_conversion_action",{event:"group_not_interested",options:{experiments:"join_groups",multiple:!0}}),d(t)},m=function(){u().on("click",".button",function(){p($j(this).data("group-id"))}),u().on("click",".groupNotInterested",function(){f($j(this).data("group-id"))})},g=function(e){return null===e?t.noResultsLi():"rendering"===e.status?t.renderingGroupLi(e):t.groupLi(e)},v=function(){u().empty()};return{init:s}},outOfGroupsCallback=function(){$j(".groupsContainer").addClass("initiallyHidden").removeClass("groupsContainer"),$j("#noMoreGroupsContainer").removeClass("initiallyHidden").addClass("groupsContainer")};$j(function(){var e="undefined"==typeof genreGroups||0==genreGroups.length,t="undefined"!=typeof featuredGroups;if(e&&t)GroupJoiner().init(featuredGroups,"midContainer",{numGroupsShown:4,outOfGroupsCallback:function(){$j.post("/track_conversion_action",{event:"featured_groups_only_exhausted",options:{experiments:"join_groups"}}),outOfGroupsCallback()},regpath:regpath});else if(t){var n=!1,i=!1;GroupJoiner().init(featuredGroups,"leftContainer",{regpath:regpath,outOfGroupsCallback:function(){$j.post("/track_conversion_action",{event:"featured_groups_exhausted",options:{experiments:"join_groups"}}),n=!0,n&&i&&outOfGroupsCallback()}}),GroupJoiner().init(genreGroups,"rightContainer",{regpath:regpath,outOfGroupsCallback:function(){$j.post("/track_conversion_action",{event:"genre_groups_exhausted",options:{experiments:"join_groups"}}),i=!0,n&&i&&outOfGroupsCallback()}})}}),Element.activateHideRatingsForRecs=function(e){e.observe("click",function(t){$(e).up("#ratingsForRecsBox").hide(),new Ajax.Request(e.href,{method:"GET"}),t.stop()})},Element.addMethods({activateHideRatingsForRecs:Element.activateHideRatingsForRecs}),document.observe("dom:loaded",function(){var e=$("hideRatingsForRecs");e&&e.activateHideRatingsForRecs()}),document.observe("dom:loaded",function(){$j("#signedOutHome .bookImgSimilar").reflect({height:15}),$j("#signedOutHome .bookImgDiscovered").reflect({height:15})});var selected_quote=0;document.observe("dom:loaded",function(){null!=$("signedOutHome")&&null!=$("quotes")&&setInterval("changeQuote()",1e4)}),$j(function(){$gr.components.stickyHeader.init(),$j(".hidePurchasesModule").click(function(e){e.preventDefault(),$j.post("/user/update_preferences",{user:{show_amazon_import_prompt:0}}),$j(".amazonPurchasesModule").fadeOut()})}),$gr.hostedImage=function(){var e=20,t=2500,n="hostedImg",i=function(i,o){return o=o||{},e=o.retryMax||e,t=o.retryDelay||t,this.img=i,this.$img=$j(i),this.$img.removeProp("onload").removeProp("onerror"),this.$img.removeClass(n),this.src=this.$img.data("src"),this.style=this.$img.attr("style"),this.$loading=this.$img.next(),this.errorMsg=this.$img.data("error"),this.retryCount=0,this.$img.removeClass(n),this},o=function(){var e=this.src.indexOf("?")<0?"?":"&";return this.src+e+"v="+(new Date).getTime()},r=function(){if(this.retryCount++<=e)$gr.hostedImage.imageLoaded(this.img)?(clearInterval(this.timer),this.$loading.remove(),this.$img.show()):(this.img=document.createElement("img"),this.img.className=n+" escapedImg",this.img.style.display="none",this.img.src=this.s3Url(),this.$img.replaceWith(this.img),this.$img=$j(this.img),this.$img.attr("style",this.style));else{clearInterval(this.timer),this.$loading.remove();var t=document.createElement("span");t.innerHTML=this.errorMsg,this.$img.replaceWith(t)}},s=function(e,n){var o=this;return i.call(o,e,n),o.timer=setInterval(function(){r.apply(o)},t),o};return{load:s,s3Url:o,tryLoading:r}},$gr.hostedImage.imageLoaded=function(e){var t=!1;return t="object"==typeof e&&e.hasOwnProperty("tagName")&&"img"!==e.tagName.toLowerCase()?!1:void 0!==e.naturalWidth?e.naturalWidth>0:e.complete},function(e){e.fn.loadHostedImage=function(){if(!this.data("loading")){this.data("loading",!0);var e=$gr.hostedImage();return e.load(this.get(0)),this}}}(jQuery),function(e){"undefined"!=typeof e&&Ajax.Responders.register({onCreate:function(e){var t,n=$$("meta[name=request-id]")[0];n&&(t=n.readAttribute("content"),e.options.requestHeaders||(e.options.requestHeaders={}),e.options.requestHeaders["Related-Request-Id"]=t)}})}(Prototype),function(e){"undefined"!=typeof e&&e.ajaxPrefilter(function(t,n,i){var o=e("meta[name=request-id]").attr("content");o&&i.setRequestHeader("Related-Request-Id",o)})}(jQuery),$j(function(){likeComponent.init()});var likeComponent=function(){var e={likeActionSelector:".jsLike",loadingHtml:'<span class="loadingAnimation" style="display: inline"></span>'},t={},n=function(t){$j.extend(e,t),i()},i=function(){$j(document).on({"ajax:beforeSend":s,"ajax:success":a,"ajax:error":l},e.likeActionSelector)},o=function(){$j(document).off({"ajax:beforeSend":s,"ajax:success":a,"ajax:error":l},e.likeActionSelector)},r=function(e,t){var n=e.match(/ref=(.*_u?lk)/);n&&(n=n[1],n.match(/_lk/)?n=n.replace(/_lk/,"_ulk"):n.match(/_ulk/)&&(n=n.replace(/_ulk/,"_lk")),t.attr("href",t.attr("href")+"&ref="+n))},s=function(n){var i,o=$j(n.target),r=o.data("like-container-id");"undefined"==typeof r&&(i=o.text(),""!==i&&(t.bodyText=i),o.html(e.loadingHtml))},a=function(e,t){if($j.isPlainObject(t)){var n,i,o,s=$j(e.target),a=s.attr("class"),l=s.data("like-container-id");"undefined"!=typeof l?(i=$j(t.container_html),n=$j("#"+l),n.replaceWith(i),o=i.find("a.jsLike")):(i=$j(t.html),s.replaceWith(i),i.addClass(a),o=i),r(s.attr("href"),o)}},l=function(e){var n=$j(e.target),i=n.data("like-container-id");"undefined"==typeof i&&(InlineFlash.showError("We had a problem while liking the resource."),n.text(t.bodyText))};return{init:n,teardown:o}}();$j(function(){window.top!==window.self&&window.location.href.match(/show_mini/)&&($j("a").attr("target","_top"),$j("a").attr("href",function(e,t){var n=$j(parent.document.getElementsByTagName("iframe")[0]).data("url1");return"undefined"!=typeof n?n+t:t}))}),$j(document).on("ajax:beforeSend",".loadingLinkSpan",function(){var e=$j(this),t=e.find(".loadingLink");if(t.data("recycleElementId")){var n=$j("#"+t.data("recycleElementId"));n&&n.size()>0&&($j("body").append(n[0].outerHTML),n.hide())}e.find(".loadingLink, .loadingError").hide(),e.find(".loadingAnimation").show()}).on("ajax:success",".loadingLinkSpan",function(){var e=$j(this),t=e.find(".loadingLink");t&&(t.data("keepOnSuccess")&&(t.show(),t.data("resetOnSuccess")&&t.html("&nbsp;")),t.data("removeClassOnSuccess")&&t.removeClass(t.data("removeClassOnSuccess")),t.data("removeOnSuccess")&&$j(document).find("#"+t.data("removeOnSuccess")).remove()),e.find(".loadingAnimation, .loadingError").hide()}).on("ajax:error",".loadingLinkSpan",function(){var e=$j(this);e.find(".loadingError").html('<span class="error">ERROR</span> try again'),e.find(".loadingLink, .loadingError").show(),e.find(".loadingAnimation").hide()}).on("ajax:complete",".loadingLinkSpan",function(){var e=$j(this),t=e.find(".loadingLink");if(t.data("recyclePlacementId")){var n=$j("#"+t.data("recycleElementId"));n&&n.size()>0&&$j("#"+t.data("recyclePlacementId")).prepend(n)}}),$j(function(){var e=function(){var e=$j("#sponsoredPoll");if(e.find("iframe").length>0){var t=$j("#sponsoredPoll [id*='div-gpt-ad'] iframe"),i=t.contents(),r=i.find("iframe");if(0===r.length)return o();var s=r.contents(),a=s.children().height();n(s.find("a")),e.height(a);var l=e.children("[id*='div-gpt-ad']");l.height(a);var c=l.children("[id*='google_ads']");c.height(a),t.height(a),r.height(a)}},t=function(){return $j(window.top.document).find("#sponsoredPoll").find("iframe").contents().find("iframe").data("url1")},n=function(e){trackingPrefix=t(),"undefined"==typeof trackingPrefix&&(trackingPrefix=""),e.attr("target","_top"),e.attr("href",function(e,t){return trackingPrefix+t})},i=function(e){var t={},i=$j(e);t.id=i.parents("#hpPoll").attr("data_poll_id"),t.answer=i.val(),t.featured=1,$j.post("/poll/vote",t).done(function(e){var t,i,o;o=window.top===window.self?window:window.top,o.Lightbox.showBoxString(e,700),o.$j("#homepagePoll").hide(),o.$j("#hpPollResults").show(),n(o.$j(".hpPollContainer a")),t=$j(e),t.find(".hpPollAd").remove(),i=o.$j("#hpPollResults"),i.html(""),i.append(t),o.$j("#hpPollResults .mediumLargeText").css("fontSize","14px"),o.FB.XFBML.parse()})},o=function(){var e={};e.poll=$j(this).attr("data_poll_id"),r(),$j.post("/poll/next_poll_ajax",e).done(function(e){var t=$j(e).attr("data_poll_id");$j("#homepagePoll").html(e),$j("#homepagePoll").show(),$j("#hpPollNextLink").attr("data_poll_id",t),$j("#hpPollResults").hide(),"true"!==$j("#hpPollContainer").attr("data_show_next")&&$j("#hpPollNextLink").hide()}),s()},r=function(){var e=$j("#featured_polls h2");"Sponsored Poll"===e.text()&&e.text("Featured Poll")},s=function(){$j("#homepagePoll iframe").length>0||0===$j("#featured_polls").length&&$j("#hpPollContainer").length>0?$j("#hpPollContainer").on("click","input",function(){i(this)}):$j("#homepagePoll").on("click","input",function(){i(this)})};s(),$j("#hpPollNextLink").on("click",o),$j("#hpPollNextLink").on("click",r),$j("#hpPollNextLink").on("click",function(){$j("#homepagePoll").on("click","input",function(){i(this)})}),$j(window).on("load",function(){if($j("#homepagePoll").length>0){var t=$j("#homepagePoll iframe"),n=$j("#homepagePoll .pollAnswers");t.length+n.length===0?o():e()}})}),"undefined"!=typeof Prototype&&Ajax.Responders.register({onCreate:function(e){var t=$$("meta[name=csrf-token]")[0];if(t){var n="X-CSRF-Token",i=t.readAttribute("content");e.options.requestHeaders||(e.options.requestHeaders={}),e.options.requestHeaders[n]=i}}}),$j(document).ready(function(){$j(".quizFriendInvite").live("ajax:success",function(){quizFriendInviteSuccess($j(this))})}),document.observe("dom:loaded",function(){activateRateBooksMoreGenreLnk()});var updateAmazonPurchaseImportUI=function(){$j(".js-amazonRateBooksHeader").fadeOut(),$j(".navRow a.actionLinkLite.selected").removeClass("selected"),$j(".js-amazonRateBooksStart").addClass("selected"),setGenre("amazon_purchase_import"),WantToRead.resetShelfMenuStored()};$j(function(){$j(".jsShowAdditionalGenres").on("click",function(e){var t=$j(this),n=$j(t.attr("href")),i=t.data("hide-text"),o=t.data("show-text");e.preventDefault(),n.hasClass("show")?(n.removeClass("show"),t.text(o)):(n.addClass("show"),t.text(i))}),$j(".jsBackToTop").on("click",function(e){e.preventDefault(),window.scroll(0,0)}),$j(".js-amazonRateBooksStart").on("click",function(){$j("#rateBooksList").html("<div class='loadingPageImage'></div>"),updateAmazonPurchaseImportUI()})});var updateAllStarsForBookID=function(e,t){var n=$j(".stars[data-resource-id='"+e+"']");n.each(function(e,n){$j(n).children().each(function(e,n){$j(n).removeClass("on"),$j(n).removeClass("off"),$j(n).addClass(e>=t?"off":"on")})})},colorStars=function(e,t){var n=e.find(".star");if(!e.hasClass("ignored"))for(var i=0;i<n.length;i++)t>=i?n[i].setAttribute("class","star on"):n[i].setAttribute("class","star off")},showRatingErrorMessage=function(e){e.parents(".wtrButtonContainer").find(".starsErrorTooltip").removeClass("hidden"),e.children("#starsSaving").remove(),e.children(".star").show()},showRelatedBooks=function(e){"undefined"!=typeof e.related_work_row&&$j("#"+e.row_id).after(e.related_work_row)},updateRateBooksHeaderAndFooter=function(e){var t=$j("#rateBooksHeader");t.find(".progress").length&&t.html(e.rate_books_header),$j("#rateBooksFooter").html(e.rate_books_footer)},updateWTRButton=function(e,t){var n=t.parents(".wtrButtonContainer");n.find(".wtrLeft").replaceWith(e.wtr_button_left);var i=n.find(".wtrRight");i.data("exclusive-shelf",e.review_read_status),WantToRead.setupShelfVisibilityInMenu(i),WantToRead.disablePrompts()},updateRatingStars=function(e,t){t.parents(".ratingStars").replaceWith(e.rating_stars)},submitStars=function(e,t,n){var i=$j("#reviewMessage"+e.data("resourceId")+"_"+n),o=$j("#successMessage"+e.data("resourceId")+"_"+n);if(!e||!e.hasClass("ignored")){var r="script",s={},a=$j(".regpathRateBooks").length>0,l=e.parents("#amazonPurchaseImport").length>0,c=e.parents(".secondaryWtrButton").length>0,u=a||l;u&&(s={format:"json",use_secondary_wtr:c},r="json");var h=e.find(".star").attr("ref"),d=e.parents(".wtrButtonContainer");$j.ajax({url:t,type:"POST",dataType:r,data:s,context:e,success:function(t){u&&$j.isPlainObject(t)&&(updateWTRButton(t,e),updateRatingStars(t,e),a&&(showRelatedBooks(t),updateRateBooksHeaderAndFooter(t))),$j(this).children("#starsSaving").remove(),d.find(".star").attr("ref",h),$j(this).children(".star").show(),i.hide(),o.show()},error:function(t){if(t&&403===t.status){var n=JSON.parse(t.responseText);n.redirect&&(location.href=n.redirect)}else c?showRatingErrorMessage(e):($j(this).addClass("error"),$j(this).html("So sorry, but there was a problem completing your request. Please reload the page and try again."))},beforeSend:function(){$j(this).append("<span id='starsSaving'>saving...</span>"),$j(this).children(".star").hide()}})}},enrichUrl=function(e,t,n){var i=e.match(/\?/)?e+"&":e+"?";return i=i+t+"="+n},clearRating=function(e){submitStars(e,enrichUrl(e.data("submitUrl"),"rating",0),e.data("userId")),e.data("rating",0),colorStars(e,0)};$j(document).on("click",".clearRating",function(){clearRating($j(this).siblings("div.stars"))}),$j(document).on("mouseenter",".wtrButtonContainer div.ratingStars",function(){$j(this).hasClass("hasRating")&&($j(this).find(".myRating").hide(),$j(this).find(".clearRating").show())}).on("mouseleave",".wtrButtonContainer div.ratingStars",function(){$j(this).find(".clearRating").hide(),$j(this).find(".myRating").show()}),$j(document).on("mouseover",".star",function(){var e=$j(this),t=e.parent();colorStars(t,t.children().index(e))}).on("click",".star",function(){var e=$j(this),t=e.parent(),n=t.children().index(e);return t.data("rating",n+1),url=enrichUrl(t.data("submitUrl"),"rating",n+1),submitStars(t,enrichUrl(url,"ref",e.attr("ref")),t.data("userId")),!1}).on("mouseleave","div.stars",function(){var e=$j(this);colorStars(e,e.data("rating")-1)}),$j(document).on("click",".recommendBook",function(e){recommendBookPopup($j(this).data()),e.preventDefault()});var recommendBookPopup=function(e,t){var n,i,o="/recommendations/book_popup/",r="/book/recommend_send/",s="/user/update_preferences",a="/friend/invite",l=6,c=!1,u="",h="",d=null,p=0,f='<div id="recommendBookPopup" style="display: none;">     <div class="mediumText"><div class="bigText"><div class="cover"><img width="50"></div></div><p><input id="friend_filter" name="friend_filter" placeholder="Search by name" results="" type="search"></p></div>     <div class="peopleContainer"><div class="people clearFix"></div></div>     <div class="paging clearFix"><a href="#" class="prev disabled">&larr; Previous</a>&nbsp;&nbsp;&nbsp;<a href="#" class="next disabled">Next &rarr;</a></div>     </div>',m='<div class="friend vcenteredLineOfBlocks">     <div class="pic"></div>     <div class="text">     <textarea class="message"></textarea>     <div class="name"></div>     <div class="reason"></div>     <a class="button">Recommend</a>     <span class="toggleMessage">add message</span>     <div class="banner"></div>     </div></div>',g='<div class="togglePref sansSerif">     <span class="explanation">We\'re asking you to recommend this book because you rated it 4 or 5 stars.</span>     <label id="togglePrefLabel">     <input id="recommendBookPopupPref" name="recommendBookPopupPref" type="checkbox">     <span>Don&rsquo;t show this again</span>     </label>     <span class="saved" style="display:none;">Preference saved!</span>     </div>',v='Visit your <a href="/user/edit?tab=settings" target="_blank">settings</a> to re-enable this later; just check<br> &ldquo;prompt me to recommend books to friends.&rdquo;',y='No friends! <a href="'+a+'">Invite a few</a> to Goodreads.',b='Oops, something went wrong!<br>Please wait a moment and <a href="#">try again</a>.',w=$j(f),C=w.find(".people"),S=w.find("#friend_filter"),x=w.find(".prev"),E=w.find(".next");
"object"==typeof t&&t.hasOwnProperty("afterReview")&&(c=t.afterReview);var k=function(){C.addClass("people loading"),$j.get(o+e.id,{after_review:c}).always(function(){C.removeClass("errorNotice loading")}).done(function(e){e.hasOwnProperty("friends")&&e.friends.length>0?(n=$j(e.friends).map(function(){return this.lowercaseName=this.name.toLocaleLowerCase(),this.containsUnicode=!/^[\000-\177]*$/.test(this.name),this.disabled=null!==this.readStatus||null!==this.recStatus,this}),S.on("keyup search",D),w.children(".paging").on("click",".prev, .next",O),C.on("click",".button",F),C.on("click","span.toggleMessage",L),""===S.val()||S.val()===S.attr("placeholder")?(j(),P()):S.keyup()):(C.removeClass("people").addClass("errorNotice"),C.html(y),c&&Lightbox.hideBox())}).fail(function(){C.removeClass("people").addClass("errorNotice"),C.html(b),C.children(".friend").click(function(e){C.empty(),k(),e.preventDefault()})})};k(),$j("body").append(w);var T;c?(T="Would any of your friends enjoy <em>"+e.title+"</em>?",w.append($j(g)),new Tip($("togglePrefLabel"),v,{style:"goodreads",stem:"topMiddle",hook:{tip:"topMiddle",target:"topMiddle"},offset:{x:5,y:15},hideOn:!1,hideAfter:.05}),$("togglePrefLabel").observe("prototip:shown",function(){$j(".prototip").css("z-index",100089)}),w.find("#recommendBookPopupPref").change(function(e){$j.post(s,{"user[prompt_to_recommend_books]":$j(e.target).prop("checked")?"0":"1"},function(){$j("#recommendBookPopup .saved").show().delay(1e3).fadeOut()})})):T="Recommend <em>"+e.title+"</em> to your friends",w.find(".bigText").append(T),w.find(".cover img").attr({src:e.image,alt:e.title}),$j(function(){Lightbox.showBoxByID("recommendBookPopup",715,300),Lightbox.center("box"),$j("#lightBoxRightClose").remove(),document.observe("Lightbox:hideBox",function(){document.stopObserving("Lightbox:hideBox"),$j("#recommendBookPopup").remove()})});var D=_.debounce(function(e){u=e.target.value,u===S.attr("placeholder")&&(u=""),u!==h&&(j(),P()),h=u},300),M=function(e,t){return t.score!==e.score?t.score-e.score:e.containsUnicode||t.containsUnicode?e.lowercaseName.localeCompare(t.lowercaseName):e.lowercaseName<t.lowercaseName?-1:e.lowercaseName>t.lowercaseName?1:0},j=function(){i=$j(jQuery.extend({},n)),u.length>0?(null===d&&(d=p),p=0,i.each(function(){this.score=this.name.score(u)}),i.sort(M)):(p=d||0,d=null),R()},R=function(){u.length>0&&(i=i.filter(function(){return this.score>0}))},A=function(e){if(!e.hasOwnProperty("html")){var t=$j(m);t.data("friend",e),t.toggleClass("disabled",e.hasOwnProperty("disabled")&&e.disabled),t.find(".name").html(e.name),t.find(".reason").html(e.reason),t.find(".banner").html(N(e.readStatus)),t.find(".message").attr("placeholder",e.name+" would like this book because..."),null!==e.imageUrl&&t.children(".pic").css("background-image",'url("'+e.imageUrl+'")'),e.html=t}return e.html},N=function(e){switch(e){case"read":return"Marked as Read";case"to-read":return"Marked as Want to Read";case"currently-reading":return"Marked as Currently Reading";default:return"Recommended"}},P=function(){C.children().detach();var e=l*p;i.length>0?(C.empty().addClass("people").removeClass("errorNotice"),i.slice(e,e+l).each(function(){C.append(A(this))})):(C.addClass("errorNotice").removeClass("people"),C.html("No matches found.")),I(i.length)},I=function(){var e=i.length>l,t=i.length/l-1<=p;x.toggleClass("disabled",!e||0===p),E.toggleClass("disabled",!e||t)},O=function(e){var t=$j(e.target),n=t.hasClass("prev")?-1:1;t.hasClass("disabled")||(p+=n,P()),e.preventDefault()},F=function(t){var o=$j(t.target).parents(".friend"),s=o.data("friend"),a=o.find(".message"),h=a.is(":visible");s.disabled=!0,o.addClass("disabled"),o.removeClass("messageVisible");var d={send:{}};if(d.send[s.id]=!0,d.source="recommend_book_popup",h&&(d.message=a.val()),d.context=c?"after_review":"not_after_review",$j.post(r+e.id,d,null,"script"),0===u.length){var p,f,m,g=$j.inArray(s,n),v=0;for(p=g+1;p<n.length;p++)if(!n[p].disabled&&(v++,v>=l)){f=n[p],m=p;break}n=f?n.slice(0,g).add(f).add(n.slice(g+1,m)).add(n.slice(m+1)).add(n[g]):n.slice(0,g).add(n.slice(g+1)).add(n[g]),i=$j(jQuery.extend({},n)),o.delay(2500).fadeOut(700,function(){P(),this.show()})}},L=function(e){var t=$j(e.target),n=t.parents(".friend"),i="clear message"!==t.html();n.toggleClass("messageVisible",i),t.html(i?"clear message":"add message"),i&&n.find(".message").focus()}};/*!
	reflection.js for jQuery v1.1
	(c) 2006-2011 Christophe Beyls <http://www.digitalia.be>
	MIT-style license.
*/
!function(e){e.fn.extend({reflect:function(t){return t=e.extend({height:1/3,opacity:.5},t),this.unreflect().each(function(){function n(){var n,o,r,s,a,l=i.width,c=i.height;if(o=Math.floor(t.height>1?Math.min(c,t.height):c*t.height),n=e("<canvas />")[0],n.getContext){s=n.getContext("2d");try{e(n).attr({width:l,height:o}),s.save(),s.translate(0,c-1),s.scale(1,-1),s.drawImage(i,0,0,l,c),s.restore(),s.globalCompositeOperation="destination-out",a=s.createLinearGradient(0,0,0,o),a.addColorStop(0,"rgba(255, 255, 255, "+(1-t.opacity)+")"),a.addColorStop(1,"rgba(255, 255, 255, 1.0)"),s.fillStyle=a,s.rect(0,0,l,o),s.fill()}catch(u){return}}else{if(!e.browser.msie)return;n=e("<img />").attr("src",i.src).css({width:l,height:c,marginBottom:o-c,filter:"FlipV progid:DXImageTransform.Microsoft.Alpha(Opacity="+100*t.opacity+", FinishOpacity=0, Style=1, StartX=0, StartY=0, FinishX=0, FinishY="+o/c*100+")"})[0]}e(n).css({display:"block",border:0}),r=e(/^a$/i.test(i.parentNode.tagName)?"<span />":"<div />").insertAfter(i).append([i,n])[0],r.className=i.className,e.data(i,"reflected",r.style.cssText=i.style.cssText),e(r).css({width:l,height:c+o,overflow:"hidden"}),i.style.cssText="display: block; border: 0px",i.className="reflected"}var i=this;/^img$/i.test(i.tagName)&&(i.complete?n():e(i).load(n))})},unreflect:function(){return this.unbind("load").each(function(){var t,n=this,i=e.data(this,"reflected");void 0!==i&&(t=n.parentNode,n.className=t.className,n.style.cssText=i,e.removeData(n,"reflected"),t.parentNode.replaceChild(n,t))})}})}(jQuery),jQuery(function(e){e("img.reflect").reflect({})}),SSLChecker={check:function(e){var t=new Image;t.onload=function(){var n=t.width;e(6==n?"TLSv1.2":5==n?"TLSv1.1":4==n?"TLSv1":3==n?"SSLv3":2==n?"SSLv2":"unknown")},t.onerror=function(){e("error")},t.src="https://p1.awstls.com/goodreads_web.gif?b=p&t="+ +new Date},display:function(e){window.ue&&ue.tag&&ue.tag("L6:"+e),("SSLv3"==e||"SSLv2"==e)&&(message="Please upgrade your browser. For security reasons, starting 2014/10/28 you will no longer be able to access Goodreads with this browser. For more information please <a href='https://www.goodreads.com/about/contact_us'>contact us</a>.",$j(".mainContentFloat").prepend("<div id='flashContainer'><div class='box noticeBox errorBox'>"+message+"</div><br></div>"))},load:function(){SSLChecker.check(SSLChecker.display)}},"complete"===document.readyState?SSLChecker.load():window.addEventListener?window.addEventListener("load",SSLChecker.load,!1):window.attachEvent?window.attachEvent("onload",SSLChecker.load):SSLChecker.load();/*
 * Tabs class
 * 
 * Copyright 2008 Goodreads, Inc.
 */
var Tabs=Class.create({selectedClassSuffix:"-selected",initialize:function(e){this.container=$(e),this.tabElts=this.container.select("ul.leftTabs li a"),this._setCurrentSelectedClass(),this.tabSelectedDelegate=this._tabSelected.bindAsEventListener(this),this.tabElts.each(function(e){Event.observe(e,"click",this.tabSelectedDelegate)}.bind(this))},destroy:function(){this.tabElts&&this.tabSelectedDelegate&&this.tabElts.each(function(e){Event.stopObserving(e,"click",this.tabSelectedDelegate)}.bind(this))},setSelected:function(e){var t=e+this.selectedClassSuffix;this.container&&this.currentClass&&t!=this.currentClass&&(this.container.removeClassName(this.currentClass),this.currentClass=t,this.container.addClassName(this.currentClass))},_tabSelected:function(e){var t=e.element();if(t){var n=t.readAttribute("title");n&&this.setSelected(n)}},_setCurrentSelectedClass:function(){if(this.container){var e=new RegExp("[a-zA-Z]+"+this.selectedClassSuffix);this.currentClass=this.container.classNames().find(function(t){return t.match(e)})}}});window.twttr=function(e,t,n){var i,o,r=e.getElementsByTagName(t)[0];if(!e.getElementById(n))return o=e.createElement(t),o.id=n,o.src="https://platform.twitter.com/widgets.js",r.parentNode.insertBefore(o,r),window.twttr||(i={_e:[],ready:function(e){i._e.push(e)}})}(document,"script","twitter-wjs"),$gr.user.user_name_edit=function(){var e={},t=function(){var t=$j("#user_full_name_source");e.first_name=$j("#user_first_name").val(),e.middle_name=$j("#user_middle_name").val(),e.last_name=$j("#user_last_name").val();var n={};n.FL=e.first_name+" "+e.last_name,n.FML=e.first_name+" "+e.middle_name+" "+e.last_name,n.LF=e.last_name+" "+e.first_name,t.find("option").each(function(e,t){t.text=n[$j(t).val()]})};return{sync_dropdown:t}}(),$j(document).on("keyup","#user_first_name, #user_middle_name, #user_last_name",function(){$gr.user.user_name_edit.sync_dropdown()}),$j(document).ready(function(){$j("#user_full_name_source").append($j("<option value='FL'></option>")),""!==$j("#user_middle_name").val()&&$j("#user_full_name_source").append($j("<option value='FML'></option>")),""!==$j("#user_last_name").val()&&$j("#user_full_name_source").append($j("<option value='LF'></option>")),$gr.user.user_name_edit.sync_dropdown()}),$gr.user.user_feed_preferences=function(){var e=function(e){var t=$j("#grok_"+e+"_en"),n=$j("#grok_"+e+"_dis"),i=$j("#gr_"+e+"_en"),o=$j("#gr_"+e+"_dis"),r=$j(".checkboxCorrespondingTo-"+e),s=r.length,a=r.filter(":checked").length;s==a?(t.css("display","block"),n.css("display","none")):(t.css("display","none"),n.css("display","block")),a>0?(i.css("display","block"),o.css("display","none")):(i.css("display","none"),o.css("display","block"))};$j(".checkboxCorrespondingTo-publish_book_activities").on("click",function(){e("publish_book_activities")}),$j(".checkboxCorrespondingTo-publish_review_activities").on("click",function(){e("publish_review_activities")}),$j(".checkboxCorrespondingTo-publish_additional_activities").on("click",function(){e("publish_additional_activities")})},$j(document).ready(function(){$gr.user.user_feed_preferences()}),Element.activateHideNewShelfForm=function(e){e.observe("click",function(t){var n=e.up("#createShelfTip");void 0!=n&&(n.previous().addClassName("lastRow"),n.hide()),new Ajax.Request(e.href),t.stop()})},Element.addMethods({activateHideNewShelfForm:Element.activateHideNewShelfForm}),document.observe("dom:loaded",function(){var e=$("hideNewShelfForm");e&&e.activateHideNewShelfForm(),$j("#shelfTable .userShelfName .renameUserShelfLnk").click(function(){return showRenameForm($j(this)),!1}),$j("#shelfTable .userShelfName .cancelRenameUserShelf").click(function(){return hideRenameForm($j(this)),!1}),$j("#shelfTable .userShelfName .submitRenameUserShelf").click(function(){return submitRenameShelf($j(this).closest("form")),!1})}),document.observe("dom:loaded",function(){activateExpandDetailsLinks()}),// Copyright 2009-2012 by contributors, MIT License
function(e){"function"==typeof define?define(e):"function"==typeof YUI?YUI.add("es5",e):e()}(function(){function e(){}function t(e){return e=+e,e!==e?e=0:0!==e&&e!==1/0&&e!==-(1/0)&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}function n(e){var t=typeof e;return null===e||"undefined"===t||"boolean"===t||"number"===t||"string"===t}function i(e){var t,i,o;if(n(e))return e;if(i=e.valueOf,"function"==typeof i&&(t=i.call(e),n(t)))return t;if(o=e.toString,"function"==typeof o&&(t=o.call(e),n(t)))return t;throw new TypeError}Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if("function"!=typeof n)throw new TypeError("Function.prototype.bind called on incompatible "+n);var i=d.call(arguments,1),o=function(){if(this instanceof o){var e=n.apply(this,i.concat(d.call(arguments)));return Object(e)===e?e:this}return n.apply(t,i.concat(d.call(arguments)))};return n.prototype&&(e.prototype=n.prototype,o.prototype=new e,e.prototype=null),o});var o,r,s,a,l,c=Function.prototype.call,u=Array.prototype,h=Object.prototype,d=u.slice,p=c.bind(h.toString),f=c.bind(h.hasOwnProperty);if((l=f(h,"__defineGetter__"))&&(o=c.bind(h.__defineGetter__),r=c.bind(h.__defineSetter__),s=c.bind(h.__lookupGetter__),a=c.bind(h.__lookupSetter__)),2!=[1,2].splice(0).length){var m=Array.prototype.splice;Array.prototype.splice=function(e,t){return arguments.length?m.apply(this,[void 0===e?0:e,void 0===t?this.length-e:t].concat(d.call(arguments,2))):[]}}if(1!=[].unshift(0)){var g=Array.prototype.unshift;Array.prototype.unshift=function(){return g.apply(this,arguments),this.length}}Array.isArray||(Array.isArray=function(e){return"[object Array]"==p(e)});var v=Object("a"),y="a"!=v[0]||!(0 in v);if(Array.prototype.forEach||(Array.prototype.forEach=function(e){var t=A(this),n=y&&"[object String]"==p(this)?this.split(""):t,i=arguments[1],o=-1,r=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError;for(;++o<r;)o in n&&e.call(i,n[o],o,t)}),Array.prototype.map||(Array.prototype.map=function(e){var t=A(this),n=y&&"[object String]"==p(this)?this.split(""):t,i=n.length>>>0,o=Array(i),r=arguments[1];if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var s=0;i>s;s++)s in n&&(o[s]=e.call(r,n[s],s,t));return o}),Array.prototype.filter||(Array.prototype.filter=function(e){var t,n=A(this),i=y&&"[object String]"==p(this)?this.split(""):n,o=i.length>>>0,r=[],s=arguments[1];if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var a=0;o>a;a++)a in i&&(t=i[a],e.call(s,t,a,n)&&r.push(t));return r}),Array.prototype.every||(Array.prototype.every=function(e){var t=A(this),n=y&&"[object String]"==p(this)?this.split(""):t,i=n.length>>>0,o=arguments[1];if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var r=0;i>r;r++)if(r in n&&!e.call(o,n[r],r,t))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e){var t=A(this),n=y&&"[object String]"==p(this)?this.split(""):t,i=n.length>>>0,o=arguments[1];if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var r=0;i>r;r++)if(r in n&&e.call(o,n[r],r,t))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=A(this),n=y&&"[object String]"==p(this)?this.split(""):t,i=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");if(!i&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var o,r=0;if(arguments.length>=2)o=arguments[1];else for(;;){if(r in n){o=n[r++];break}if(++r>=i)throw new TypeError("reduce of empty array with no initial value")}for(;i>r;r++)r in n&&(o=e.call(void 0,o,n[r],r,t));return o}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){var t=A(this),n=y&&"[object String]"==p(this)?this.split(""):t,i=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");if(!i&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var o,r=i-1;if(arguments.length>=2)o=arguments[1];else for(;;){if(r in n){o=n[r--];break}if(--r<0)throw new TypeError("reduceRight of empty array with no initial value")}do r in this&&(o=e.call(void 0,o,n[r],r,t));while(r--);return o}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(e){var n=y&&"[object String]"==p(this)?this.split(""):A(this),i=n.length>>>0;if(!i)return-1;var o=0;for(arguments.length>1&&(o=t(arguments[1])),o=o>=0?o:Math.max(0,i+o);i>o;o++)if(o in n&&n[o]===e)return o;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(e){var n=y&&"[object String]"==p(this)?this.split(""):A(this),i=n.length>>>0;if(!i)return-1;var o=i-1;for(arguments.length>1&&(o=Math.min(o,t(arguments[1]))),o=o>=0?o:i-Math.abs(o);o>=0;o--)if(o in n&&e===n[o])return o;return-1}),!Object.keys){var b=!0,w=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],_=w.length;for(var C in{toString:null})b=!1;Object.keys=function N(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var N=[];for(var t in e)f(e,t)&&N.push(t);if(b)for(var n=0,i=_;i>n;n++){var o=w[n];f(e,o)&&N.push(o)}return N}}var S=-621987552e5,x="-000001";Date.prototype.toISOString&&-1!==new Date(S).toISOString().indexOf(x)||(Date.prototype.toISOString=function(){var e,t,n,i,o;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(i=this.getUTCFullYear(),o=this.getUTCMonth(),i+=Math.floor(o/12),o=(o%12+12)%12,e=[o+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],i=(0>i?"-":i>9999?"+":"")+("00000"+Math.abs(i)).slice(i>=0&&9999>=i?-4:-6),t=e.length;t--;)n=e[t],10>n&&(e[t]="0"+n);return i+"-"+e.slice(0,2).join("-")+"T"+e.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"});var E=!1;try{E=Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(S).toJSON().indexOf(x)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(k){}if(E||(Date.prototype.toJSON=function(){var e,t=Object(this),n=i(t);if("number"==typeof n&&!isFinite(n))return null;if(e=t.toISOString,"function"!=typeof e)throw new TypeError("toISOString property is not callable");return e.call(t)}),Date=function(e){function t(n,i,o,r,s,a,l){var c=arguments.length;if(this instanceof e){var u=1==c&&String(n)===n?new e(t.parse(n)):c>=7?new e(n,i,o,r,s,a,l):c>=6?new e(n,i,o,r,s,a):c>=5?new e(n,i,o,r,s):c>=4?new e(n,i,o,r):c>=3?new e(n,i,o):c>=2?new e(n,i):c>=1?new e(n):new e;return u.constructor=t,u}return e.apply(this,arguments)}function n(e,t){var n=t>1?1:0;return o[t]+Math.floor((e-1969+n)/4)-Math.floor((e-1901+n)/100)+Math.floor((e-1601+n)/400)+365*(e-1970)}var i=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),o=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(var r in e)t[r]=e[r];return t.now=e.now,t.UTC=e.UTC,t.prototype=e.prototype,t.prototype.constructor=t,t.parse=function(t){var o=i.exec(t);if(o){var r,s=Number(o[1]),a=Number(o[2]||1)-1,l=Number(o[3]||1)-1,c=Number(o[4]||0),u=Number(o[5]||0),h=Number(o[6]||0),d=Number(o[7]||0),p=!o[4]||o[8]?0:Number(new e(1970,0)),f="-"===o[9]?1:-1,m=Number(o[10]||0),g=Number(o[11]||0);return(u>0||h>0||d>0?24:25)>c&&60>u&&60>h&&1e3>d&&a>-1&&12>a&&24>m&&60>g&&l>-1&&l<n(s,a+1)-n(s,a)&&(r=60*(24*(n(s,a)+l)+c+m*f),r=1e3*(60*(r+u+g*f)+h)+d+p,r>=-864e13&&864e13>=r)?r:0/0}return e.parse.apply(this,arguments)},t}(Date),Date.now||(Date.now=function(){return(new Date).getTime()}),"0".split(void 0,0).length){var T=String.prototype.split;String.prototype.split=function(e,t){return void 0===e&&0===t?[]:T.apply(this,arguments)}}if("".substr&&"b"!=="0b".substr(-1)){var D=String.prototype.substr;String.prototype.substr=function(e,t){return D.call(this,0>e&&(e=this.length+e)<0?0:e,t)}}var M="	\n\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff";if(!String.prototype.trim||M.trim()){M="["+M+"]";var j=new RegExp("^"+M+M+"*"),R=new RegExp(M+M+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(j,"").replace(R,"")}}var A=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)}}),// Copyright 2009-2012 by contributors, MIT License
function(e){"function"==typeof define?define(e):"function"==typeof YUI?YUI.add("es5-sham",e):e()}(function(){function e(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){}}var t,n,i,o,r,s=Function.prototype.call,a=Object.prototype,l=s.bind(a.hasOwnProperty);if((r=l(a,"__defineGetter__"))&&(t=s.bind(a.__defineGetter__),n=s.bind(a.__defineSetter__),i=s.bind(a.__lookupGetter__),o=s.bind(a.__lookupSetter__)),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__||(e.constructor?e.constructor.prototype:a)}),!Object.getOwnPropertyDescriptor){var c="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(e,t){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(c+e);if(l(e,t)){var n={enumerable:!0,configurable:!0};if(r){var s=e.__proto__;e.__proto__=a;var u=i(e,t),h=o(e,t);if(e.__proto__=s,u||h)return u&&(n.get=u),h&&(n.set=h),n}return n.value=e[t],n}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),!Object.create){var u,h=null===Object.prototype.__proto__;u=h||"undefined"==typeof document?function(){return{__proto__:null}}:function(){function e(){}var t=document.createElement("iframe"),n=document.body||document.documentElement;t.style.display="none",n.appendChild(t),t.src="javascript:";var i=t.contentWindow.Object.prototype;return n.removeChild(t),t=null,delete i.constructor,delete i.hasOwnProperty,delete i.propertyIsEnumerable,delete i.isPrototypeOf,delete i.toLocaleString,delete i.toString,delete i.valueOf,i.__proto__=null,e.prototype=i,function(){return new e}}(),Object.create=function(e,t){function n(){}var i;if(null===e)i=u();else{if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object or null");n.prototype=e,i=new n,i.__proto__=e}return void 0!==t&&Object.defineProperties(i,t),i}}if(Object.defineProperty){var d=e({}),p="undefined"==typeof document||e(document.createElement("div"));if(!d||!p)var f=Object.defineProperty,m=Object.defineProperties}if(!Object.defineProperty||f){var g="Property description must be an object: ",v="Object.defineProperty called on non-object: ",y="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(e,s,c){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(v+e);if("object"!=typeof c&&"function"!=typeof c||null===c)throw new TypeError(g+c);if(f)try{return f.call(Object,e,s,c)}catch(u){}if(l(c,"value"))if(r&&(i(e,s)||o(e,s))){var h=e.__proto__;e.__proto__=a,delete e[s],e[s]=c.value,e.__proto__=h}else e[s]=c.value;else{if(!r)throw new TypeError(y);l(c,"get")&&t(e,s,c.get),l(c,"set")&&n(e,s,c.set)}return e}}(!Object.defineProperties||m)&&(Object.defineProperties=function(e,t){if(m)try{return m.call(Object,e,t)}catch(n){}for(var i in t)l(t,i)&&"__proto__"!=i&&Object.defineProperty(e,i,t[i]);return e}),Object.seal||(Object.seal=function(e){return e}),Object.freeze||(Object.freeze=function(e){return e});try{Object.freeze(function(){})}catch(b){Object.freeze=function(e){return function(t){return"function"==typeof t?t:e(t)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(e){return e}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)!==e)throw new TypeError;for(var t="";l(e,t);)t+="?";e[t]=!0;var n=l(e,t);return delete e[t],n})}),/*! Flight v1.1.0 | (c) Twitter, Inc. | MIT License */
function(e){function t(){var e,t,n=Array.prototype.slice.call(arguments),o=[];"string"==typeof n[0]&&(e=n.shift()),r(n[0])&&(o=n.shift()),t=n.shift(),i[e]=[o,t]}function n(e){function t(t){var n=e.split("/"),i=t.split("/"),o=!1;for(n.pop();".."==i[0]&&n.length;)n.pop(),i.shift(),o=!0;return"."==i[0]&&(i.shift(),o=!0),o&&(i=n.concat(i)),i.join("/")}var r,a,l;return"undefined"==typeof o[e]&&(r=i[e],r&&(l=r[0],a=r[1],o[e]=a.apply(void 0,s(l,function(e){return n(t(e))})))),o[e]}var i={},o={},r=Array.isArray||function(e){return e.constructor==Array},s=Array.map||function(e,t,n){for(var i=0,o=e.length,r=[];o>i;i++)r.push(t.call(n,e[i]));return r};// Copyright 2013 Twitter, Inc
t("lib/utils",[],function(){var e=jQuery,t=[],n=100,i={isDomObj:function(e){return!(!e.nodeType&&e!==window)},toArray:function(e,n){return t.slice.call(e,n)},merge:function(){for(var t=arguments.length,n=0,i=new Array(t+1);t>n;n++)i[n+1]=arguments[n];return 0===t?{}:(i[0]={},i[i.length-1]===!0&&(i.pop(),i.unshift(!0)),e.extend.apply(void 0,i))},push:function(e,t,n){return e&&Object.keys(t||{}).forEach(function(i){if(e[i]&&n)throw Error("utils.push attempted to overwrite '"+i+"' while running in protected mode");"object"==typeof e[i]&&"object"==typeof t[i]?this.push(e[i],t[i]):e[i]=t[i]},this),e},isEnumerable:function(e,t){return Object.keys(e).indexOf(t)>-1},compose:function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},uniqueArray:function(e){for(var t={},n=[],i=0,o=e.length;o>i;++i)t.hasOwnProperty(e[i])||(n.push(e[i]),t[e[i]]=1);return n},debounce:function(e,t,i){"number"!=typeof t&&(t=n);var o,r;return function(){var n=this,s=arguments,a=function(){o=null,i||(r=e.apply(n,s))},l=i&&!o;return clearTimeout(o),o=setTimeout(a,t),l&&(r=e.apply(n,s)),r}},throttle:function(e,t){"number"!=typeof t&&(t=n);var i,o,r,s,a,l,c=this.debounce(function(){a=s=!1},t);return function(){i=this,o=arguments;var n=function(){r=null,a&&(l=e.apply(i,o)),c()};return r||(r=setTimeout(n,t)),s?a=!0:(s=!0,l=e.apply(i,o)),c(),l}},countThen:function(e,t){return function(){return--e?void 0:t.apply(this,arguments)}},delegate:function(t){return function(n,i){var o,r=e(n.target);Object.keys(t).forEach(function(e){return(o=r.closest(e)).length?(i=i||{},i.el=o[0],t[e].apply(this,[n,i])):void 0},this)}}};return i}),t("lib/debug",[],function(){function e(t,n,i){var i=i||{},o=i.obj||window,r=i.path||(o==window?"window":""),s=Object.keys(o);s.forEach(function(i){"[object Object]"==Object.prototype.toString.call(o[i])&&o[i]!=o&&-1==r.split(".").indexOf(i)&&e(t,n,{obj:o[i],path:[r,i].join(".")})})}function t(t,n,i,o){n&&typeof i!=n||e(t,i,o)}function n(e,n){t("name","string",e,n)}function i(e,n){t("nameContains","string",e,n)}function o(e,n){t("type","function",e,n)}function r(e,n){t("value",null,e,n)}function s(e,n){t("valueCoerced",null,e,n)}function a(t,n){e(t,null,n)}function l(){var e=[].slice.call(arguments);f.eventNames.length||(f.eventNames=m),f.actions=e.length?e:m,d()}function c(){var e=[].slice.call(arguments);f.actions.length||(f.actions=m),f.eventNames=e.length?e:m,d()}function u(){f.actions=[],f.eventNames=[],d()}function h(){f.actions=m,f.eventNames=m,d()}function d(){window.localStorage&&(localStorage.setItem("logFilter_eventNames",f.eventNames),localStorage.setItem("logFilter_actions",f.actions))}function p(){var e={eventNames:window.localStorage&&localStorage.getItem("logFilter_eventNames")||g,actions:window.localStorage&&localStorage.getItem("logFilter_actions")||v};return Object.keys(e).forEach(function(t){var n=e[t];"string"==typeof n&&n!==m&&(e[t]=n.split(","))}),e}var f,m="all",g=[],v=[],f=p();return{enable:function(e){this.enabled=!!e,e&&window.console,window.DEBUG=this},find:{byName:n,byNameContains:i,byType:o,byValue:r,byValueCoerced:s,custom:a},events:{logFilter:f,logByAction:l,logByName:c,logAll:h,logNone:u}}}),// Copyright 2013 Twitter, Inc
t("lib/compose",["./utils","./debug"],function(e,t){function n(e,t){if(r){var n=Object.create(null);Object.keys(e).forEach(function(i){if(s.indexOf(i)<0){var o=Object.getOwnPropertyDescriptor(e,i);o.writable=t,n[i]=o}}),Object.defineProperties(e,n)}}function i(e,t,n){var i;return r&&e.hasOwnProperty(t)?(i=Object.getOwnPropertyDescriptor(e,t).writable,Object.defineProperty(e,t,{writable:!0}),n.call(e),void Object.defineProperty(e,t,{writable:i})):void n.call(e)}function o(e,t){e.mixedIn=e.hasOwnProperty("mixedIn")?e.mixedIn:[],t.forEach(function(t){-1==e.mixedIn.indexOf(t)&&(n(e,!1),t.call(e),e.mixedIn.push(t))}),n(e,!0)}var r=t.enabled&&!e.isEnumerable(Object,"getOwnPropertyDescriptor"),s=["mixedIn"];if(r)try{Object.getOwnPropertyDescriptor(Object,"keys")}catch(a){r=!1}return{mixin:o,unlockProperty:i}}),// Copyright 2013 Twitter, Inc
t("lib/advice",["./utils","./compose"],function(e,t){var n={around:function(e,t){return function(){var n=0,i=arguments.length,o=new Array(i+1);for(o[0]=e.bind(this);i>n;n++)o[n+1]=arguments[n];return t.apply(this,o)}},before:function(e,t){var n="function"==typeof t?t:t.obj[t.fnName];return function(){return n.apply(this,arguments),e.apply(this,arguments)}},after:function(e,t){var n="function"==typeof t?t:t.obj[t.fnName];return function(){var t=(e.unbound||e).apply(this,arguments);return n.apply(this,arguments),t}},withAdvice:function(){["before","after","around"].forEach(function(e){this[e]=function(i,o){t.unlockProperty(this,i,function(){return this[i]="function"==typeof this[i]?n[e](this[i],o):o})}},this)}};return n}),// Copyright 2013 Twitter, Inc
t("lib/registry",["./utils"],function(){function e(e,t){var n,i,o,r=t.length;return"function"==typeof t[r-1]&&(r-=1,o=t[r]),"object"==typeof t[r-1]&&(r-=1),2==r?(n=t[0],i=t[1]):(n=e.node,i=t[0]),{element:n,type:i,callback:o}}function t(e,t){return e.element==t.element&&e.type==t.type&&(null==t.callback||e.callback==t.callback)}function n(){function n(e){this.component=e,this.attachedTo=[],this.instances={},this.addInstance=function(e){var t=new i(e);return this.instances[e.identity]=t,this.attachedTo.push(e.node),t},this.removeInstance=function(e){delete this.instances[e.identity];var t=this.attachedTo.indexOf(e.node);t>-1&&this.attachedTo.splice(t,1),Object.keys(this.instances).length||o.removeComponentInfo(this)},this.isAttachedTo=function(e){return this.attachedTo.indexOf(e)>-1}}function i(e){this.instance=e,this.events=[],this.addBind=function(e){this.events.push(e),o.events.push(e)},this.removeBind=function(e){for(var n,i=0;n=this.events[i];i++)t(n,e)&&this.events.splice(i,1)}}var o=this;(this.reset=function(){this.components=[],this.allInstances={},this.events=[]}).call(this),this.addInstance=function(e){var t=this.findComponentInfo(e);t||(t=new n(e.constructor),this.components.push(t));var i=t.addInstance(e);return this.allInstances[e.identity]=i,t},this.removeInstance=function(e){var t=(this.findInstanceInfo(e),this.findComponentInfo(e));t&&t.removeInstance(e),delete this.allInstances[e.identity]},this.removeComponentInfo=function(e){var t=this.components.indexOf(e);t>-1&&this.components.splice(t,1)},this.findComponentInfo=function(e){for(var t,n=e.attachTo?e:e.constructor,i=0;t=this.components[i];i++)if(t.component===n)return t;return null},this.findInstanceInfo=function(e){return this.allInstances[e.identity]||null},this.findInstanceInfoByNode=function(e){var t=[];return Object.keys(this.allInstances).forEach(function(n){var i=this.allInstances[n];i.instance.node===e&&t.push(i)},this),t},this.on=function(t){for(var n,i=o.findInstanceInfo(this),r=arguments.length,s=1,a=new Array(r-1);r>s;s++)a[s-1]=arguments[s];if(i){n=t.apply(null,a),n&&(a[a.length-1]=n);var l=e(this,a);i.addBind(l)}},this.off=function(){var n=e(this,arguments),i=o.findInstanceInfo(this);i&&i.removeBind(n);for(var r,s=0;r=o.events[s];s++)t(r,n)&&o.events.splice(s,1)},o.trigger=new Function,this.teardown=function(){o.removeInstance(this)},this.withRegistration=function(){this.after("initialize",function(){o.addInstance(this)}),this.around("on",o.on),this.after("off",o.off),window.DEBUG&&DEBUG.enabled&&this.after("trigger",o.trigger),this.after("teardown",{obj:o,fnName:"teardown"})}}return new n}),t("lib/base",["./utils","./registry","./debug"],function(e,t,n){function i(e){e.events.slice().forEach(function(e){var t=[e.type];e.element&&t.unshift(e.element),"function"==typeof e.callback&&t.push(e.callback),this.off.apply(this,t)},e.instance)}function o(e,t){try{window.postMessage(t,"*")}catch(n){throw new Error(["The event",e,"on component",this.toString(),"was triggered with non-serializable data"].join(" "))}}function r(){this.trigger=function(){var e,t,i,r,a,l=arguments.length-1,c=arguments[l];return"string"==typeof c||c&&c.defaultBehavior||(l--,i=c),1==l?(e=s(arguments[0]),r=arguments[1]):(e=this.$node,r=arguments[0]),r.defaultBehavior&&(a=r.defaultBehavior,r=s.Event(r.type)),t=r.type||r,n.enabled&&window.postMessage&&o.call(this,t,i),"object"==typeof this.attr.eventData&&(i=s.extend(!0,{},this.attr.eventData,i)),e.trigger(r||t,i),a&&!r.isDefaultPrevented()&&(this[a]||a).call(this),e},this.on=function(){var t,n,i,o,r=arguments.length-1,a=arguments[r];if(o="object"==typeof a?e.delegate(this.resolveDelegateRules(a)):a,2==r?(t=s(arguments[0]),n=arguments[1]):(t=this.$node,n=arguments[0]),"function"!=typeof o&&"object"!=typeof o)throw new Error("Unable to bind to '"+n+"' because the given callback is not a function or an object");return i=o.bind(this),i.target=o,o.guid&&(i.guid=o.guid),t.on(n,i),o.guid=i.guid,i},this.off=function(){var e,t,n,i=arguments.length-1;return"function"==typeof arguments[i]&&(n=arguments[i],i-=1),1==i?(e=s(arguments[0]),t=arguments[1]):(e=this.$node,t=arguments[0]),e.off(t,n)},this.resolveDelegateRules=function(e){var t={};return Object.keys(e).forEach(function(n){if(!(n in this.attr))throw new Error('Component "'+this.toString()+'" wants to listen on "'+n+'" but no such attribute was defined.');t[this.attr[n]]=e[n]},this),t},this.defaultAttrs=function(t){e.push(this.defaults,t,!0)||(this.defaults=t)},this.select=function(e){return this.$node.find(this.attr[e])},this.initialize=function(e,t){if(t=t||{},this.identity=a++,!e)throw new Error("Component needs a node");e.jquery?(this.node=e[0],this.$node=e):(this.node=e,this.$node=s(e));var n=Object.create(t);for(var i in this.defaults)t.hasOwnProperty(i)||(n[i]=this.defaults[i]);return this.attr=n,Object.keys(this.defaults||{}).forEach(function(e){if(null===this.defaults[e]&&null===this.attr[e])throw new Error('Required attribute "'+e+'" not specified in attachTo for component "'+this.toString()+'".')},this),this},this.teardown=function(){i(t.findInstanceInfo(this))}}var s=jQuery,a=0;return r}),// Copyright 2013 Twitter, Inc
t("lib/logger",["./compose","./utils"],function(e,t){function n(e){var t=e.tagName?e.tagName.toLowerCase():e.toString(),n=e.className?"."+e.className:"",i=t+n;return e.tagName?["'","'"].join(i):i}function i(e,t,i){var o,s,a,l,c,u,h;"function"==typeof i[i.length-1]&&(a=i.pop(),a=a.unbound||a),"object"==typeof i[i.length-1]&&i.pop(),2==i.length?(s=i[0],o=i[1]):(s=t.$node[0],o=i[0]),window.DEBUG&&window.DEBUG.enabled&&(l=DEBUG.events.logFilter,u="all"==l.actions||l.actions.indexOf(e)>-1,c=function(e){return e.test?e:new RegExp("^"+e.replace(/\*/g,".*")+"$")},h="all"==l.eventNames||l.eventNames.some(function(e){return c(e).test(o)}),u&&h&&console.info(r[e],e,"["+o+"]",n(s),t.constructor.describe.split(" ").slice(0,3).join(" ")))}function o(){this.before("trigger",function(){i("trigger",this,t.toArray(arguments))}),this.before("on",function(){i("on",this,t.toArray(arguments))}),this.before("off",function(){i("off",this,t.toArray(arguments))})}var r={on:"<-",trigger:"->",off:"x "};return o}),// Copyright 2013 Twitter, Inc
t("lib/component",["./advice","./utils","./compose","./base","./registry","./logger","./debug"],function(e,t,n,i,o,r,s){function a(){var e=o.findComponentInfo(this);e&&Object.keys(e.instances).forEach(function(t){var n=e.instances[t];n.instance.teardown()})}function l(e){for(var n=arguments.length,i=new Array(n-1),r=1;n>r;r++)i[r-1]=arguments[r];if(!e)throw new Error("Component needs to be attachTo'd a jQuery object, native node or selector string");var s=t.merge.apply(t,i);u(e).each(function(e,t){var n=t.jQuery?t[0]:t,i=o.findComponentInfo(this);i&&i.isAttachedTo(n)||(new this).initialize(t,s)}.bind(this))}function c(){for(var t=arguments.length,c=new Array(t+3),u=0;t>u;u++)c[u]=arguments[u];var d=function(){};return d.toString=d.prototype.toString=function(){var e=c.map(function(e){if(null==e.name){var t=e.toString().match(h);return t&&t[1]?t[1]:""}return"withBase"!=e.name?e.name:""}).filter(Boolean).join(", ");return e},s.enabled&&(d.describe=d.prototype.describe=d.toString()),d.attachTo=l,d.teardownAll=a,s.enabled&&c.unshift(r),c.unshift(i,e.withAdvice,o.withRegistration),n.mixin(d.prototype,c),d}var u=jQuery,h=/function (.*?)\s?\(/;return c.teardownAll=function(){o.components.slice().forEach(function(e){e.component.teardownAll()}),o.reset()},c}),// Copyright 2013 Twitter, Inc
t("lib/index",["./advice","./component","./compose","./logger","./registry","./utils"],function(e,t,n,i,o,r){return{advice:e,component:t,compose:n,logger:i,registry:o,utils:r}}),e.flight=n("lib/index")}(this);var MixinAuthRedirect=function(){this.authRedirect=function(e,t){if(e&&403===e.status){var n=JSON.parse(e.responseText);n.redirect&&(location.href=n.redirect)}else"function"==typeof t?t(e):alert("So sorry, but there was a problem completing your request. Please reload the page and try again.")}},MixinBackgoundMask=function(){var e="bgmask-";this.initializeBackgroundMask=function(e){this.backgroundMaskId||("string"!=typeof e&&(e=""),e+=" backgroundMask","string"==typeof this.attr.componentName&&(e+=" "+this.attr.componentName+"Mask"),this.backgroundMaskId=this.generateBackgroundMaskId(e),$j("#"+this.backgroundMaskId).length||this.trigger(document,"create.viewportOverlay",{overlayId:this.backgroundMaskId,attr:{className:e,disableDirectHide:!0}}))},this.hideBackgroundMask=function(){this.trigger(document,"hide.viewportOverlay",{overlayId:this.backgroundMaskId})},this.showBackgroundMask=function(){this.trigger(document,"show.viewportOverlay",{overlayId:this.backgroundMaskId})},this.generateBackgroundMaskId=function(t){var n=t.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0);return 0>n&&(n="0"+Math.abs(n).toString()),e+n}},dropdownMenu=function(){this.defaultAttrs({menuToggleSelector:".js-toggleDropdownMenu"}),this.after("initialize",function(){var e=this,t=this.getMenuToggleElement();t.click(function(t){t.preventDefault(),e.toggleDropdownMenu()})}),this.toggleDropdownMenu=function(){this.$node.toggle()},this.getMenuToggleElement=function(){var e,t;return e=this.$node,t=e.prevAll(this.attr.menuToggleSelector).first()}},withExpandableTextField=function(){flight.compose.mixin(this,[MixinEventUtils]),this.defaultAttrs({expandedClass:"expanded",loadingClass:"loading",showClass:"show",cancelActionSelector:".cancelAction",hiddenContentSelector:".hiddenContent",inputFieldSelector:".textInput",submitActionSelector:".submitAction"}),this.after("initialize",function(){this.$inputField=this.select("inputFieldSelector"),this.select("inputFieldSelector").on("focus",$j.proxy(this.uiExpandTextField,this)),this.select("cancelActionSelector").on("click",$j.proxy(this.uiResetForm,this))}),this.uiResetForm=function(){this.$inputField.val(""),this.uiHideLoading(),this.uiCollapseTextField()},this.uiExpandTextField=function(){this.$inputField.addClass(this.attr.expandedClass),this.uiShowHiddenContent()},this.uiCollapseTextField=function(){this.$inputField.removeClass(this.attr.expandedClass),this.$inputField.css({width:"",height:""}),this.uiHideContent()},this.uiShowHiddenContent=function(){this.select("hiddenContentSelector").addClass(this.attr.showClass)},this.uiHideContent=function(){this.select("hiddenContentSelector").removeClass(this.attr.showClass)},this.uiShowLoading=function(){this.select("submitActionSelector").addClass(this.attr.loadingClass)},this.uiHideLoading=function(){this.select("submitActionSelector").removeClass(this.attr.loadingClass)}},withFormSubmission=function(){this.after("initialize",function(){this.on("submit",this.submitForm)}),this.submitForm=function(e){var t=this.$node.serialize(),n=this.$node.attr("method"),i=this.$node.attr("action");this.$node.data("remote")&&($j.ajax({url:i,type:n,data:t,dataType:"json",context:this}).done(this.onFormSuccess).fail(this.onFormError),e.preventDefault(),e.stopPropagation())},this.onFormSuccess=function(e){this.broadcast("data-form-success",e)},this.onFormError=function(e,t,n){this.trigger("data-form-error",{status:t,error:n})}},withSlideUpMenu=function(){var e="transitionend webkitTransitionEnd oTransitionEnd otransitionend";flight.compose.mixin(this,[MixinEventUtils,MixinBackgoundMask]),this.defaultAttrs({slideUpMixinEventNamespace:"slideUpMenu",slideUpAnimPrepClass:"readyToShow",slideUpShowClass:"show",slideUpItemSelectedClass:"selected",slideUpCancelSelector:".cancel",slideUpItemSelector:".slideUpMenuItem:not(.cancel)",slideUpListSelector:".slideUpMenuList"}),this.after("initialize",function(){"undefined"==typeof this.attr.menuSelector&&this.broadcastError("'menuSelector' attribute is required",!0),this.$slideUpMenu=$j(this.attr.menuSelector).first(),this.$slideUpMenu.find(this.attr.slideUpCancelSelector).on("click",$j.proxy(this.hideSlideUpMenu,this));var e=this.getListItems();e.length&&e.on("click",$j.proxy(function(e){this.attr.slideUpListItemAllowDefaultAction||e.preventDefault(),this.triggerSlideUpEvent("listItemSelected",e.target)},this)),this.initializeBackgroundMask(),this.updateMenuHeight(),this.on(document,"beforeHide.viewportOverlay",$j.proxy(function(e,t){t&&t.overlayId===this.overlayId&&this.defer(function(){this.isSlideUpMenuVisible()&&this.hideSlideUpMenu()})},this))}),this.hideSlideUpMenu=function(t){"undefined"!=typeof t&&t.preventDefault(),this.triggerSlideUpEvent("beforeHide"),this.$slideUpMenu.removeClass(this.attr.slideUpShowClass),this.hideBackgroundMask();var n=$j.proxy(function(t){this.$slideUpMenu.off(e,n),this.onHideSlideUpAnimationDone(t)},this);this.$slideUpMenu.one(e,n)},this.onHideSlideUpAnimationDone=function(){this.$slideUpMenu.removeClass(this.attr.slideUpAnimPrepClass).select("slideUpListSelector").css("bottom",""),this.triggerSlideUpEvent("afterHide")},this.isSlideUpMenuVisible=function(){return this.$slideUpMenu.hasClass(this.attr.slideUpShowClass)},this.showSlideUpMenu=function(){/\biP(hone|ad|od)\b/i.test(navigator.userAgent)&&$j(document).trigger("hideBrowserAddressBar"),this.triggerSlideUpEvent("beforeShow"),this.$slideUpMenu.addClass(this.attr.slideUpAnimPrepClass),this.showBackgroundMask(),this.$slideUpMenu.addClass(this.attr.slideUpShowClass),this.triggerSlideUpEvent("afterShow")},this.toggleSlideUpMenuVisibility=function(e){e&&e.preventDefault(),this.isSlideUpMenuVisible()?this.hideSlideUpMenu():this.showSlideUpMenu()},this.updateMenuHeight=function(){var e=this.$slideUpMenu.find(this.attr.slideUpListSelector);if(e.length){if(this.menuHeight=e.outerHeight(),!(this.menuHeight>0))return this.broadcastError("cannot display menu list because it has no dimensions");e.css("bottom",0-this.menuHeight+"px")}},this.getSafeEventNameForSlideUpEvent=function(e){return this.getSafeEventName([e,this.attr.slideUpMixinEventNamespace].join("."))},this.onSlideUpEvent=function(e,t){this.on(this.getSafeEventNameForSlideUpEvent(e),$j.proxy(t,this))},this.triggerSlideUpEvent=function(e,t){this.trigger(this.getSafeEventNameForSlideUpEvent(e),t)},this.getListItems=function(){return this.$slideUpMenu.find(this.attr.slideUpItemSelector)}},MixinEventUtils=function(){this.broadcast=function(e,t){"undefined"==typeof t||$j.isPlainObject(t)||(t={data:t}),this.trigger(document,this.getSafeEventName(e),t)},this.broadcastError=function(e,t){if(!e||/^\s*$/.test(e))var e="unknown error";var n="unknown component",i={};if($j.each(["identifier","channel","componentName"],$j.proxy(function(e,t){var o=this.attr[t];o&&(i[t]=n=o)},this)),e=n+" : "+e,t===!0)throw new Error(e);this.trigger(document,"componentError",$j.extend({message:e},i))},this.defer=function(e,t){setTimeout($j.proxy(e,this),$j.isNumeric(t)?t:0)},this.forceBrowserReflow=function(){this.$node.offset()},this.getSafeEventName=function(e){if("string"==typeof e){var t=".";this.attr.channel&&(e+=t+this.attr.channel),this.attr.identifier&&(e+=t+this.attr.identifier)}return e},this.listen=function(e,t){this.on(document,this.getSafeEventName(e),t)}},withFormAjax=function(){this.defaultAttrs({}),this.after("initialize",function(){this.on("ajax:before",this.onBefore),this.on("ajax:error",this.onError)}),this.onBefore=function(){this.uiDismissNotification(),this.uiShowLoading()},this.onError=function(e,t){var n;try{n=$j.parseJSON(t.responseText)}catch(i){n={type:"error",message:"There was an unknown error. Please retry."}}this.uiShowNotification(n),this.uiHideLoading()}},withNotification=function(){flight.compose.mixin(this,[MixinEventUtils]);var e="info",t=["info","error","success"];this.defaultAttrs({notificationType:e,showNotificationClass:"notificationShow",dismissActionSelector:".js-notificationDismissAction",messageSelector:".js-notificationMessage"}),this.after("initialize",function(){this.$notificationNode=this.$node.find(".js-notification");var e=this.$notificationNode.find(this.attr.dismissActionSelector);e.on("click",$j.proxy(function(e){this.onDismiss(e)},this))}),this.onDismiss=function(e){this.uiDismissNotification(e),this.recordNotificationDismissal()},this.uiDismissNotification=function(){this.$notificationNode.removeClass(this.attr.showNotificationClass)},this.uiShowNotification=function(t){if($j.isPlainObject(t)){this.uiResetNotification(),this.attr.notificationType=t.type&&this.isValidNotificationType(t.type)?t.type:e,this.$notificationNode.addClass(this.notificationTypeToClassName(this.attr.notificationType));var n=this.$notificationNode.find(this.attr.messageSelector).first(),i=t.message;if("error"===t.type&&$j.isArray(i)&&i.length>1){var o=$j("<ul>");$j.each(i,function(e,t){o.append($j("<li>").html(t))}),n.html(o)}else n.html(i);this.$notificationNode.addClass(this.attr.showNotificationClass)}},this.uiResetNotification=function(){this.$notificationNode.removeClass(this.notificationTypeToClassName(this.attr.notificationType))},this.recordNotificationDismissal=function(){var e=this.$notificationNode.find(this.attr.dismissActionSelector).data("user-preference");if(e){var t={};t[e]=0,$j.post("/user/update_preferences",{user:t})}},this.isValidNotificationType=function(e){return $j.inArray(e,t)>-1},this.notificationTypeToClassName=function(e){return"notification"+e.charAt(0).toUpperCase()+e.slice(1)}},withTooltips=function(){this.defaultAttrs({tooltipTriggerSelector:".js-withTooltips-tooltipTrigger",tooltipSelector:".js-withTooltips-tooltip"}),this.after("initialize",function(){this.attr.titleText=this.select("tooltipTriggerSelector").attr("title"),this.on("mouseenter",{tooltipTriggerSelector:this.intendToShow,tooltipSelector:this.intendToShow}),this.on("mouseleave",{tooltipTriggerSelector:this.intendToHide,tooltipSelector:this.intendToHide})}),this.hideTooltip=function(){grPopup.hide(this.select("tooltipSelector"),function(){this.hide()})},this.intendToShow=function(){HoverIntent.onEnterIntent(this,this.showTooltip)},this.intendToHide=function(){HoverIntent.onLeaveIntent(this,this.hideTooltip)},this.showTooltip=function(){var e=this.select("tooltipSelector"),t=this.select("tooltipTriggerSelector"),n=t.attr("title");void 0!==n&&""!==n&&(t.attr("title",""),""===e.html()&&e.text(this.attr.titleText)),grPopup.show(e,function(){this.show()})}},Accordion=flight.component(function(){var e=$j(document),t="accordionComponent";this.defaultAttrs({channel:t,componentName:t,catalystSelector:".accordionHeading",contentSelector:".accordionContent",openClass:"sectionOpen",outsideCatalystSelectors:"",outsideCatalystsCloseSection:!1}),this.after("initialize",function(){var e=this.select("catalystSelector"),t="";e.on("click",$j.proxy(this.toggleState,this)),""!==this.attr.outsideCatalystSelectors&&(t=this.attr.outsideCatalystsCloseSection===!1?"openState":"toggleState",$j(this.attr.outsideCatalystSelectors).on("click",$j.proxy(this[t],this)))}),this.toggleState=function(e){this.isVisible()?this.closedState(e):this.openState(e)},this.isVisible=function(){return this.$node.hasClass(this.attr.openClass)},this.openState=function(t){this.$node.addClass(this.attr.openClass),"true"===$j(t.target).data("scroll-to-section")&&e.scrollTop(this.$node.offset().top)},this.closedState=function(){this.$node.removeClass(this.attr.openClass)}});$gr.shared.amazonPurchasesBanner=flight.component(function(){var e="amazonPurchasesBannerComponent";this.defaultAttrs({channel:e,componentName:e,dismissButtonSelector:".dismissButton",rateBooksContainerSelector:".rateBooks"}),this.after("initialize",function(){this.on("click",{dismissButtonSelector:this.hideBanner}),this.$node.parents(this.attr.rateBooksContainerSelector).length&&this.hideDismissButton()}),this.hideBanner=function(e){this.$node.fadeOut(),this.updateHideBannerPreference(),e.preventDefault(),this.teardown()},this.hideDismissButton=function(){this.select("dismissButtonSelector").hide()},this.updateHideBannerPreference=function(){$j.post("/user/update_preferences",{user:{show_amazon_import_prompt:0}})}}),$gr.shared.audibleExperiments=flight.component(function(){this.defaultAttrs({controlPreviewButton:".kcrPreviewButtonShown",audibleStylePreviewButtonBlack:".audibleSampleStyleKcrPreviewButton",audibleStylePreviewButtonGreen:".audibleSampleStyleKcrPreviewButtonGreen"});var e="#audibleSample";this.after("initialize",function(){$j(this.attr.controlPreviewButton).on("click.audibleExperiment",function(){t("audible_usa_control_preview",this)}),$j(this.attr.audibleStylePreviewButtonBlack).on("click.audibleExperiment",function(){$j(e).length?t("audible_usa_D_preview",this):t("audible_usa_B_preview",this)}),$j(this.attr.audibleStylePreviewButtonGreen).on("click.audibleExperiment",function(){t("audible_usa_C_preview",this)})});var t=function(e,t){$j.post("/track_conversion_action",{event:e,options:{experiments:"audible",multiple:!0}}).done(function(){$j(t).off("click.audibleExperiment")})}}),$gr.shared.audibleSampleButton=flight.component(function(){this.audibleIframeLocation="https://www.audible.com",this.not_tracked_yet=!0,this.defaultAttrs({audibleSampleContainer:"#audibleSample",audibleFlyoutFrame:"#audibleSampleFlyoutFrame"}),this.after("initialize",function(){this.on("message onmessage",this.receiveMessage)}),this.receiveMessage=function(e){if(e=e.originalEvent,e.origin===this.audibleIframeLocation){var t=e.data;if("function"==typeof this[t.func]){if("showAudibleSampleFlyout"===t.func&&this.not_tracked_yet){var n=this,i=$j.Deferred();i=$j("#kindleCloudReader").length?$j.post("/track_conversion_action",{event:"audible_usa_D_audible_button",options:{experiments:"audible",multiple:!0}}):$j.post("/track_conversion_action",{event:"audible_non_usa_audible_button",options:{experiments:"audible_non_usa",multiple:!0}}),i.done(function(){n.not_tracked_yet=!1})}$j.proxy(this[t.func],this).call()}}},this.showAudibleButton=function(){$j(this.attr.audibleSampleContainer).css("display","inline-block")},this.showAudibleSampleFlyout=function(){$j(this.attr.audibleFlyoutFrame).show()},this.hideAudibleSampleFlyout=function(){$j(this.attr.audibleFlyoutFrame).hide()},this.showAudibleSampleFlyoutLarge=function(){$j(this.attr.audibleFlyoutFrame).height(270)},this.showAudibleSampleFlyoutMedium=function(){$j(this.attr.audibleFlyoutFrame).height(190)}}),$gr.shared.authorDashboardQA=flight.component(function(){var e="authorDashboardQA";this.defaultAttrs({channel:e,componentName:e,digestSettingsSelector:".js-authorDigestSettings",errorMessageSelector:".errorMessage",loadingQuestionsSelector:".js-questions-loading",optedInActionSelector:".js-optIntoAuthorQA",optedInFormMessageSelector:".js-optedInMessage",optedInNotificationSelector:".js-optedInNotification",optedInSettingsSelector:".js-optedInSettings",optedOutActionSelector:".js-optOutofAuthorQA",optedOutFormMessageSelector:".js-optedOutMessage",pendingQuestionsCountSelector:".js-pending-questions-count",skipQuestionSelector:".js-skipQuestionAction",starterQuestionSelector:".starterQuestion",unansweredQuestionsContainerSelector:".unansweredQuestionsContainer",unansweredQuestionSelector:".unansweredQuestion"}),this.after("initialize",function(){this.optInUrl=this.select("optedInActionSelector").data("url"),this.optOutUrl=this.select("optedOutActionSelector").data("url"),this.currentQuestionsCount=parseInt(this.select("pendingQuestionsCountSelector").data("count")),this.attr.optIntoQaActionSelectors=[this.attr.optedInActionSelector,this.attr.optedOutActionSelector].join(","),this.on("change",{optIntoQaActionSelectors:this.updateOptInState,digestSettingsSelector:this.updateDigestSettings}),this.on("ajax:success",{skipQuestionSelector:this.uiHideSkippedQuestion}),this.listen("answerFormSubmitted",this.uiDecrementQuestionsCount)}),this.uiShowOptedOutState=function(){this.select("optedInNotificationSelector").hide(),this.select("starterQuestionSelector").show(),this.select("optedInFormMessageSelector").hide(),this.select("optedOutFormMessageSelector").show(),this.select("optedInSettingsSelector").hide()},this.uiShowOptedInState=function(e){this.select("optedInNotificationSelector").show(),this.select("starterQuestionSelector").hide(),this.select("optedInFormMessageSelector").show(),this.select("optedOutFormMessageSelector").hide(),this.select("optedInSettingsSelector").show(),$j.isPlainObject(e)&&e.content_html&&(this.select("unansweredQuestionsContainerSelector").html(e.content_html),this.select("pendingQuestionsCountSelector").text(e.questions_count),this.currentQuestionsCount=e.questions_count),this.select("loadingQuestionsSelector").hide()},this.uiShowError=function(){this.select("errorMessageSelector").show()},this.uiHideSkippedQuestion=function(e){$j(e.target).parents(this.attr.unansweredQuestionSelector).fadeOut(),this.uiDecrementQuestionsCount()},this.uiDecrementQuestionsCount=function(){this.currentQuestionsCount-=1,this.currentQuestionsCount=Math.max(0,this.currentQuestionsCount),this.select("pendingQuestionsCountSelector").text(this.currentQuestionsCount)},this.updateOptInState=function(){var e=this.select("optedInActionSelector").is(":checked");e&&this.select("optedInActionSelector").data("neverOpted")&&this.select("loadingQuestionsSelector").show(),$j.ajax({url:e?this.optInUrl:this.optOutUrl,type:"post",data:{format:"json"},context:this,success:e?this.uiShowOptedInState:this.uiShowOptedOutState,error:this.uiShowError})},this.updateDigestSettings=function(){var e=this.select("digestSettingsSelector").data("url"),t=this.select("digestSettingsSelector").find("input:checked").val();$j.ajax({url:e,type:"post",data:{format:"json",digest_frequency:t},context:this,error:this.uiShowError})}},MixinEventUtils);var Autocomplete=flight.component(function(){var e="autocomplete";this.defaultAttrs({channel:e,componentName:e,menuListParentSelector:"body",menuListSelector:".resultsList",menuListItemSelector:".resultsListItem",menuListItemLinkSelector:".resultsListItemLink",menuBaseClass:e,menuShowClass:"show",$queryAjaxSettings:null,queryParamName:null,queryLengthMin:3,queryLengthMax:50,queryDebounceDuration:500,selectToFillIn:!1}),this.after("initialize",function(){this.initializeMenu(),this.on("keyup",flight.utils.debounce($j.proxy(this.onKeystroke,this),this.attr.queryDebounceDuration)),this.on(this.getSafeEventName("reset"),this.onReset),this.on(this.getSafeEventName("clearMenu"),this.onClearMenu)}),this.initializeMenu=function(){this.$menuRoot||(this.$menuRoot=$("<div/>").addClass(this.attr.menuBaseClass).appendTo(this.attr.menuListParentSelector),this.attr.identifier&&this.$menuRoot.data(this.attr.componentName+"-id",this.attr.identifier),this.$menuRoot.on("click",this.attr.menuListItemSelector,$j.proxy(this.onSelectMenuItem,this)))},this.clearMenu=function(){this.$menuRoot.empty()},this.hideMenu=function(){this.isMenuVisible()&&(this.$menuRoot.removeClass(this.attr.menuShowClass),this.trigger(this.getSafeEventName("hideMenu")))},this.isMenuVisible=function(){return this.$menuRoot.hasClass(this.attr.menuShowClass)},this.reset=function(){this.hideMenu(),this.clearMenu(),this.$node.val("")},this.showMenu=function(){this.isMenuVisible()||(this.$menuRoot.addClass(this.attr.menuShowClass),this.trigger(this.getSafeEventName("showMenu")))},this.updateMenu=function(e){this.$menuRoot.html(e),this.trigger(this.getSafeEventName("updateMenu"))},this.submitQuery=function(e){if("string"!=typeof e&&(e=this.$node.val()),e.length>=this.attr.queryLengthMin&&e.length<=this.attr.queryLengthMax){this.cachedAjaxSettings||(this.cachedAjaxSettings=$j.extend({},this.attr.$queryAjaxSettings,{context:this,success:this.onSubmitQuerySuccess,error:function(){this.onSubmitQueryError(e)},complete:function(){this.trigger(this.getSafeEventName("submitQueryEnd")),this.$activeAjaxRequest=null},beforeSend:function(){this.trigger(this.getSafeEventName("submitQueryStart"))}}));var t=$j.extend({},this.cachedAjaxSettings);$j.isPlainObject(t.data)?t.data[this.attr.queryParamName]=e:t.url+=(t.url.indexOf("?")>=0?"&":"?")+this.attr.queryParamName+"="+encodeURIComponent(e),this.$activeAjaxRequest&&this.$activeAjaxRequest.abort(),this.$activeAjaxRequest=$j.ajax(t)}else this.clearMenu()},this.onClearMenu=function(){this.clearMenu()},this.onKeystroke=function(e){13===e.charCode&&e.preventDefault(),this.submitQuery()},this.onReset=function(){this.reset()},this.onSelectMenuItem=function(e){e.preventDefault();var t=$j(e.target).closest(this.attr.menuListItemSelector),n=t.find(this.attr.menuListItemLinkSelector);if(n.length)if(this.attr.selectToFillIn===!0){var i=n[0].innerText,o=t.data("bookId");i&&(this.$node.val(i),this.$node.data("bookId",o),this.hideMenu())}else{var r=n.attr("href");r&&(this.reset(),location.href=r)}},this.onSubmitQuerySuccess=function(e){var t=e;$j.isPlainObject(e)&&e.html&&(e=e.html),this.updateMenu(e),this.showMenu(),t.attachLoadMore&&LoadMore.attachTo(".jsLoadMore")},this.onSubmitQueryError=function(e){var t="bad response from query";"string"==typeof e&&(t+=' : "'+e+'"'),this.trigger(this.getSafeEventName("submitQueryError")),this.broadcastError(t),this.hideMenu()}},MixinEventUtils),BackToTopButton=flight.component(function(){var e="backToTopButton";this.defaultAttrs({hideOnFocusSelectors:"input[type='text'], input[type='password'],                                  select, textarea",showClass:"show",buttonVisibilityThresholdBottom:150,buttonVisibilityThresholdTop:150,scrollDebounceDuration:15,channel:e,componentName:e}),this.after("initialize",function(){this.isFieldFocused=!1,this.on("click",this.onScrollToTop),this.on(window,"scroll",flight.utils.debounce(this.onUpdateDisplay,this.attr.scrollDebounceDuration));var e=[this.getSafeEventName("focus"),this.getSafeEventName("blur")].join(" ");$j(document.body).on(e,this.attr.hideOnFocusSelectors,$j.proxy(function(e){$j(e.target).is(":visible")&&(e.type.indexOf("focusin")>=0?this.onFieldFocus():this.onFieldBlur())},this))}),this.hide=function(){this.isVisible()&&this.$node.removeClass(this.attr.showClass)},this.isVisible=function(){return this.$node.hasClass(this.attr.showClass)},this.scrollToTop=function(){$j(document).scrollTop(0)},this.show=function(){this.isVisible()||this.$node.addClass(this.attr.showClass)},this.updateDisplay=function(){var e=window.scrollY,t=$j(document).height()-$j(window).height()-this.attr.buttonVisibilityThresholdBottom;this.isFieldFocused||e<this.attr.buttonVisibilityThresholdTop||e>t?this.hide():this.show()},this.onFieldBlur=function(){this.isFieldFocused=!1,this.updateDisplay()},this.onFieldFocus=function(){this.isFieldFocused=!0,this.hide()},this.onScrollToTop=function(e){e.preventDefault(),this.scrollToTop()},this.onUpdateDisplay=function(){this.updateDisplay()}},MixinEventUtils);$gr.shared.bookCarousel=flight.component(function(){var e=($j(document),"bookCarouselComponent");this.maxLeft=0,this.minLeft=0,this.defaultAttrs({channel:e,componentName:e,bookCover:".cover",carouselRow:".carouselRow",carouselNav:".navButton",navBackgroundClass:"highlightedNavButton",nextButtonClass:"navButtonNext",prevButtonClass:"navButtonPrev",rightArrowPadding:30,slideDelay:500}),this.after("initialize",function(){this.containerWidth=this.$node.width(),this.setBoundsOfCarousel(),this.setNavVisibility(),this.toggleBackground(!1),this.on("click",{carouselNav:this.moveCarousel}),this.on("mouseenter",this.highlightNavigation),this.on("mouseleave",this.removeHighlightInNavigation)}),this.setBoundsOfCarousel=function(){var e=0;this.select("carouselRow").find(this.attr.bookCover).each(function(){e+=$j(this).outerWidth()}),this.minLeft=Math.min(this.containerWidth-e-this.attr.rightArrowPadding,this.maxLeft)},this.moveCarousel=function(e){var t,n=$j(e.target).parent();n.hasClass(this.attr.nextButtonClass)?t="next":n.hasClass(this.attr.prevButtonClass)&&(t="prev"),this.singleSlide(t)},this.highlightNavigation=function(){this.toggleBackground(!0),this.setNavVisibility()},this.removeHighlightInNavigation=function(){this.toggleBackground(!1),this.setNavVisibility()},this.singleSlide=function(e){var t;this.select("carouselRow").stop(),"prev"===e?t=this.select("carouselRow").position().left+4*this.containerWidth/5:"next"===e&&(t=this.select("carouselRow").position().left-4*this.containerWidth/5),t=Math.min(t,this.maxLeft),t=Math.max(t,this.minLeft),this.setNavVisibility(t),this.select("carouselRow").animate({left:t},this.attr.slideDelay)},this.setNavVisibility=function(e){"undefined"==typeof e&&this.select("carouselRow").length&&(e=this.select("carouselRow").position().left),e>this.minLeft?this.$node.find("."+this.attr.nextButtonClass).show():this.$node.find("."+this.attr.nextButtonClass).hide(),e<this.maxLeft?this.$node.find("."+this.attr.prevButtonClass).show():this.$node.find("."+this.attr.prevButtonClass).hide()},this.toggleBackground=function(e){this.select("carouselNav").toggleClass(this.attr.navBackgroundClass,e)}});var BookProgressUpdate=flight.component(function(){var e="bookProgressUpdate";this.defaultAttrs({bookSelectorPrefix:"#book_list_item_",cancelSelector:".actionFormControls .cancel",catalystButtonSelector:".startUpdate",distractionSelector:".reviewList",fieldSelector:".field",fieldToggleSelector:".swap",finishedSelector:".finished",formSelector:".actionForm",progressSelector:".bookProgress",fieldToggleClass:"showPages",meterClass:"meter",showFormClass:"active",channel:e,componentName:e,enableCollapseDistractions:!0}),this.after("initialize",function(){this.on("click",{cancelSelector:this.onHideForm,fieldToggleSelector:this.onFieldsToggle});var e=this.$node.data("bookid");this.$bookNode=$j(this.attr.bookSelectorPrefix+e).first(),this.on(this.$bookNode.find(this.attr.catalystButtonSelector),"click",this.showForm),this.after("hideForm",function(){this.select("formSelector").get(0).reset()});var t=this.select("fieldSelector");t.on("focus",function(){$j(this).val("")}),t.each(function(){var e=$j(this),t=e.val(),n=new RegExp(e.attr("pattern"));n&&n.test(t)&&!/^\s*$/.test(t)&&e.data("default-value",t)}),this.on("submit",{formSelector:function(e){this.validateFields()||(e.preventDefault(),e.stopPropagation(),this.showMessage("Your progress was not updated. Please enter a valid number.",!0))}}),this.on("ajax:success",{formSelector:this.onFormSubmitSuccess}),this.on("ajax:error",{formSelector:this.onFormSubmitError})}),this.hideForm=function(){this.$node.removeClass(this.attr.showFormClass),this.toggleDistractionlessMode(!1)},this.showForm=function(){this.$node.addClass(this.attr.showFormClass),this.toggleDistractionlessMode(!0)},this.showMessage=function(e,t){if("string"==typeof e&&!/^\s*$/.test(e)){var n=$j("#flashMessages");t?alert(e):n.trigger("addFlashMessage",[e])}},this.toggleFields=function(){this.select("formSelector").toggleClass(this.attr.fieldToggleClass),this.select("fieldSelector").each(function(){this.disabled=!this.disabled})},this.toggleDistractionlessMode=function(e){var t=$j(this.attr.distractionSelector);this.attr.enableCollapseDistractions===!0?t[e?"hide":"show"]():t.css("visibility",e?"hidden":"")},this.onFieldsToggle=function(e){e.preventDefault(),this.toggleFields();var t=$j(e.target),n=t.text(),i=t.data("swap-text");t.text(i).data("swap-text",n)},this.onHideForm=function(e){e.preventDefault(),this.hideForm()},this.onFormSubmitError=function(e,t){this.defer(function(){this.authRedirect(t,$j.proxy(function(){var e="Unknown XHR failure when trying to update book progress.";t.status&&(e+=" , status code "+t.status),this.broadcastError(e)},this))},500)},this.onFormSubmitSuccess=function(e,t){if($j.isPlainObject(t)){if(t.html_meter&&!/^\s*$/.test(t.html_meter)){var n=this.$bookNode.find("."+this.attr.meterClass);if(n.length)n.html(t.html_meter);else{var i=this.$bookNode.find(this.attr.progressSelector);$j(t.html_meter).wrap("<div/>").addClass(this.attr.meterClass).prependTo(i)}}this.isBookFinished()&&this.$bookNode.hide(),t.message&&this.showMessage(t.message),this.hideForm()}else this.broadcastError("Malformed JSON response when trying to update book progress.")},this.isBookFinished=function(){return this.select("finishedSelector").prop("checked")},this.getVisibleField=function(){return this.select("fieldSelector").filter(":visible").first()},this.validateFields=function(){if(this.isBookFinished())return!0;var e=this.getVisibleField();if(e.length){var t=/^\d+$/,n=e.data("default-value"),i=e.val();return t.test(n)?t.test(i)&&i!==n:t.test(i)}return!1}},MixinEventUtils,MixinAuthRedirect),BrowseButton=flight.component(function(){this.after("initialize",function(){this.on(document,"topBrowseMenuOpened",this.openMenu),this.on(document,"topBrowseMenuClosed",this.closeMenu),this.on($gr.touch,function(e){e.preventDefault(),"block"===$j("#browseMenu").css("display")?this.trigger(document,"topBrowseMenuClosed"):this.trigger(document,"topBrowseMenuOpened")})}),this.openMenu=function(){this.$node.addClass("selectedLinkBarItem")},this.closeMenu=function(){this.$node.removeClass("selectedLinkBarItem")}}),BrowseMenu=flight.component(function(){this.after("initialize",function(){this.on(document,"topBrowseMenuOpened",this.openMenu),this.on(document,"topBrowseMenuClosed",this.closeMenu)}),this.openMenu=function(){this.$node.css("display","block")},this.closeMenu=function(){this.$node.css("display","none")}}),ReCaptcha=flight.component(function(){this.defaultAttrs({site_key:null,theme:"light"});var e=function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)};this.after("initialize",function(){if(this.on("reset",function(){this.reset()}),"undefined"==typeof grecaptcha){if("undefined"==typeof _recaptchaLoadedCallback){var t=this;window._recaptchaLoadedCallback=function(){t.render()}}return e("https://www.google.com/recaptcha/api.js?render=explicit&onload=_recaptchaLoadedCallback"),!0}this.render()}),this.render=function(){"undefined"!=typeof grecaptcha&&(this.widget_id=grecaptcha.render(this.node,{sitekey:this.attr.site_key,theme:this.attr.theme}))},this.reset=function(){"undefined"!=typeof grecaptcha&&grecaptcha.reset(this.widget_id);try{div=jQuery("tr.gc-reset").closest("table.pls-container").parent("div"),ins=div.next("ins"),div.remove(),ins.remove()}catch(e){}this.$node.empty()}}),Carousel=flight.component(function(){var e,t,n;this.defaultAttrs({itemSelector:".carouselItem"}),this.after("initialize",function(){var e=Hammer(this.$node,{drag_block_horizontal:!0});e.on("dragstart",$j.proxy(this.initializeCarousel,this)),e.on("drag",$j.proxy(this.moveCarousel,this))}),this.initializeCarousel=function(){var i=this.$node.parent(),o=i.innerWidth(),r=i.parent().innerWidth(),s=this.select("itemSelector");t=0,$j.each(s,function(e,n){t+=$j(n).outerWidth(!0)}),r>o&&(o-=r-o),o>t&&this.off("drag"),e=parseInt(this.$node.css("left"),10),n=-Math.abs(t-o)},this.moveCarousel=function(t){var i=e+t.gesture.deltaX;0>i?n>i?this.$node.css("left",n):this.$node.css("left",i):this.$node.css("left","0")}});$gr.shared.challenge=flight.component(function(){var e="challengeComponent";this.defaultAttrs({channel:e,componentName:e}),this.after("initialize",function(){_.each($j("li.step"),function(e){e.on("click",t)})});var t=function(){this.className+=" doneStep"}}),$gr.shared.checkBoxForm=flight.component(function(){this.defaultAttrs({continueMessageSelector:".js-continueMessage",checkedClass:"",checkBoxContainerSelector:"",saveActionSelector:".js-saveAction",mobile:!1}),this.after("initialize",function(){this.uiSetupForm(),this.on("click",{checkBoxContainerSelector:this.uiUpdateCheckbox}),this.on("click",{saveActionSelector:this.submitFormAndHide})}),this.submitFormAndHide=function(e){e.preventDefault(),e.stopPropagation(),this.$node.submit(),this.trigger("hideModal")},this.uiSetupForm=function(){var e=this.$node.find(":checkbox"),t=this;e.each(function(){var e=$j(this),n=e.closest(t.attr.checkBoxContainerSelector);e.prop("checked")?n.addClass(t.attr.checkedClass):n.removeClass(t.attr.checkedClass)}),this.uiUpdateFormSaveButton()},this.uiUpdateCheckbox=function(e){var t=$j(e.target).closest(this.attr.checkBoxContainerSelector),n=t.find(":checkbox");return $j(e.target)!==n&&(n.prop("checked")?t.addClass(this.attr.checkedClass):t.removeClass(this.attr.checkedClass)),this.uiUpdateFormSaveButton(),!1},this.uiUpdateFormSaveButton=function(){if(this.$node.data("forceSelection")){var e=this.$node.find("input:checked").length>0;this.attr.mobile?e?(this.select("saveActionSelector").addClass("enabled"),this.select("saveActionSelector").removeAttr("disabled")):(this.select("saveActionSelector").removeClass("enabled"),this.select("saveActionSelector").attr("disabled","disabled")):(this.select("continueMessageSelector").toggle(!e),this.select("saveActionSelector").toggle(e))
}else this.select("continueMessageSelector").hide(),this.select("saveActionSelector").show()}},MixinEventUtils,withFormSubmission);var CommentComposer=flight.component(function(){var e="commentComposer";this.defaultAttrs({channel:e,componentName:e,commentCountContainerSelector:".commentsCount",formSelector:"form",submitButtonSelector:".jsCommentComposerSubmitButton",textAreaContainerSelector:".expandingArea",textAreaMirrorSelector:".expandingArea span",textAreaSelector:".jsCommentComposerTextArea",commentCountHideClass:"hide"}),this.after("initialize",function(){return this.$commentList=$j(this.$node.data("comment-list")).first(),this.$commentList.length<1?this.broadcastError("No comment list selector found."):(this.commentCountSelector=this.$node.data("comment-counter"),this.select("textAreaContainerSelector").addClass("active"),this.toggleSubmitButton(),this.select("textAreaMirrorSelector").text(this.select("textAreaSelector").val()),this.on("input",this.resizeTextArea),this.on("input",this.toggleSubmitButton),this.$form=this.select("formSelector").first(),this.$form.on("ajax:success",$j.proxy(this.onFormSubmitSuccess,this)),void this.$form.on("ajax:error",$j.proxy(this.onFormSubmitError,this)))}),this.resizeTextArea=function(){this.select("textAreaMirrorSelector").text(this.select("textAreaSelector").val())},this.toggleSubmitButton=function(){this.select("textAreaSelector").val().length>0?(this.select("submitButtonSelector").show(),this.select("textAreaContainerSelector").addClass("jsCommentComposerTextAreaFilled")):(this.select("submitButtonSelector").hide(),this.select("textAreaContainerSelector").removeClass("jsCommentComposerTextAreaFilled"))},this.onFormSubmitError=function(e,t){this.defer(function(){this.authRedirect(t,$j.proxy(function(){var e="Unknown XHR failure when trying to add new comment";t.status&&(e+=" , status code "+t.status),this.broadcastError(e)},this))},500)},this.onFormSubmitSuccess=function(e,t){this.insertComment(t.html),this.updateCommentCount(t.count),this.clearCommentField()},this.clearCommentField=function(){this.select("textAreaSelector").val("")},this.insertComment=function(e){this.$commentList.is(":visible")||this.$commentList.show().removeClass("empty"),this.$commentList.append(e)},this.updateCommentCount=function(e){$j(this.commentCountSelector).html(e);var t=$j(this.commentCountSelector).closest(this.attr.commentCountContainerSelector);e>0&&t.hasClass(this.attr.commentCountHideClass)&&t.removeClass(this.attr.commentCountHideClass)}},MixinEventUtils,MixinAuthRedirect);$gr.shared.confirmModal=flight.component(function(){var e="confirmModal";this.defaultAttrs({channel:e,componentName:e,cancelActionSelector:".js-cancelAction",closeModalSelector:".js-closeModalIcon",confirmActionSelector:".js-confirmAction",confirmHeadingSeletor:".js-confirmationHeading",confirmMessageSelector:".js-confirmationMessage",componentsToInitialize:[],confirmActionText:"Yes",confirmModalId:"confirmationModal",modalHeading:"Are you sure?",modalMessage:"",modalHeight:150,modalWidth:500}),this.after("initialize",function(){this.$modal=this.uiBuildModal(),this.on("click, ajax:before",this.onClick),this.on(document,"ui.modal.hideComplete",this.teardownModal),this.listen("hideConfirmModal",this.uiHideModal)}),this.onConfirmSuccess=function(){this.uiHideModal(),"undefined"!=typeof this.redirectPath?window.location.href=this.redirectPath:window.location.reload(!0)},this.onConfirmError=function(){this.uiHideModal()},this.onClick=function(){return this.uiShowModal(),!1},this.uiSetupModal=function(){var e=this.$modal.find(this.attr.confirmActionSelector),t=this.$modal.find(this.attr.cancelActionSelector),n=this.$node.attr("href"),i=this.$node.data(),o=i.confirmationHeading,r=i.confirmationMessage,s=i.method,a=i.remote;this.redirectPath=i.redirectPath,"undefined"==typeof r&&(r=this.attr.modalMessage),"undefined"==typeof o&&(o=this.attr.modalHeading),this.$modal.find(this.attr.confirmMessageSelector).html(r),this.$modal.find(this.attr.confirmHeadingSeletor).text(o),e.attr("data-method",s),e.attr("data-remote",a),e.attr("href",n),e.on("ajax:success",$j.proxy(function(){this.onConfirmSuccess()},this)),e.on("ajax:error",$j.proxy(function(){this.onConfirmError()},this)),t.click(this.uiHideModal)},this.uiShowModal=function(){this.uiSetupModal(),this.uiAttachModal(),this.attr.componentsToInitialize.forEach(this.attachComponent.bind(this)),Lightbox.showBoxByID(this.attr.confirmModalId,this.attr.modalWidth,this.attr.modalHeight)},this.uiHideModal=function(){Lightbox.hideBox("dropout")},this.uiAttachModal=function(){var e=$j("#"+this.attr.confirmModalId);e.length?e.replaceWith(this.$modal):this.$modal.appendTo("body")},this.uiBuildModal=function(){var e,t,n;return t={confirmModalId:this.attr.confirmModalId,confirmActionText:this.attr.confirmActionText},e='<div id="{{confirmModalId}}" style="display: none">',e+='<h2 class="confirmationHeading js-confirmationHeading"></h2>',e+='<div class="confirmationMessage js-confirmationMessage"></div>',e+='<div class="confirmationActions js-confirmationActions">',e+='<a class="button confirmAction js-confirmAction">{{confirmActionText}}</a>',e+='<div class="cancelWrapper"><a class="cancelAction js-cancelAction" href="#">Cancel</a></div>',e+="</div>",e+="</div>",n=_.template(e),$j(n(t))},this.attachComponent=function(e){$gr.shared[e.componentName].attachTo(e.selector,e.params)},this.teardownModal=function(){$j("#"+this.attr.confirmModalId).remove()}},MixinEventUtils),$gr.shared.dataStoreUserPreferences=flight.component(function(){this.after("initialize",function(){this.on("ui-user-preference-changed",this.updateUserPreferences)}),this.updateUserPreferences=function(e,t){$j.post("/user/update_preferences",{user:t.prefData})}}),$gr.shared.dataTooltip=flight.component(function(){var e="dataTooltip",t=50,n=100;this.defaultAttrs({channel:e,componentName:e,tooltipTriggerSelector:".js-tooltipTrigger"}),this.after("initialize",function(){this.getTooltipContent(this.$node),this.listen("success.loadMore",this.handleLoadMore)}),this.handleLoadMore=function(e,t){"undefined"!=typeof t.content_html&&this.getTooltipContent($j(t.content_html))},this.getTooltipContent=function(e){var i={},o=this,r=o.$node.data("batchSize");r>0&&n>r||(r=t),e.find(this.attr.tooltipTriggerSelector).each(function(e,t){var n={},s=$j(t).data("resource-type"),a=$j(t).data("resource-id"),l=s+"."+a;n.type=s,n.id=a,n.extra=$j(t).data("extra"),i[l]=n,Object.keys(i).length>=r&&(o.getBatchOfTooltipContent(i),i={})}),o.getBatchOfTooltipContent(i)},this.getBatchOfTooltipContent=function(e){var t=this.$node.data("ref-tag");$j.ajax({url:"/tooltips",type:"GET",data:{resources:e,ref_tag:t,use_wtr_tooltip:this.$node.data("use-wtr-tooltip"),current_user_id:this.$node.data("current-user-id")},context:this,success:function(e){this.broadcast("tooltipHtmlRetrieved",e)}})}},MixinEventUtils),$gr.shared.dismissModuleUI=flight.component(function(){this.defaultAttrs({newPrefValue:"1"}),this.after("initialize",function(){this.on("click",{dismissButtonSelector:this.hideModule})}),this.hideModule=function(e){this.$node.fadeOut(),this.attr.userPrefName&&this.triggerUserPrefChanged(),e.preventDefault()},this.triggerUserPrefChanged=function(){var e={};e[this.attr.userPrefName]=this.attr.newPrefValue,this.trigger("ui-user-preference-changed",{prefData:e})}}),$gr.shared.editInPlace=flight.component(function(){var e="editInPlace";this.defaultAttrs({channel:e,componentName:e,cancelActionSelector:".cancelAction",controllerComponentSelector:".js-editInPlace",editableElementSelector:".editInPlaceContent",inputFieldSelector:".editInPlaceInputField",formContainerSelector:".editInPlaceContainer",submitActionSelector:".submitAction",inputFieldClass:"editInPlaceInputField",loadingClass:"loading",originalText:null,submitButton:!0}),this.after("initialize",function(){this.formHtml=this.uiBuildForm(),this.$editInPlaceController=this.$node.closest(this.attr.controllerComponentSelector),this.$node.append(this.formHtml),this.on("click",{cancelActionSelector:this.onCancel,submitActionSelector:this.onSubmit}),this.on("saveSuccess",this.onSaveSuccess),this.on("saveError",this.uiHideLoading)}),this.onCancel=function(){this.uiRemoveForm(),this.teardown(),this.trigger(this.$editInPlaceController,"ui.editInPlace.cancel")},this.onSaveSuccess=function(){this.uiHideLoading(),this.uiRemoveForm(),this.teardown()},this.onSubmit=function(){var e=this.select("inputFieldSelector").val();this.uiShowLoading(),this.trigger(this.$editInPlaceController,"ui.editInPlace.submit",{text:e})},this.uiBuildForm=function(){var e,t,n,i=this.$node.data("field-name");return e={inputFieldClass:this.attr.inputFieldClass,inputFieldName:i,originalText:this.attr.originalText},t='<div class="editInPlaceContainer">',t+='<textarea class="{{inputFieldClass}}" name="{{inputFieldName}}">',t+="{{originalText}}",t+="</textarea>",t+='<div class="formAction">',t+=1==this.attr.submitButton?'<button class="submitAction primaryAction button" type="submit">Submit</button>':'<a class="submitAction primaryAction">Submit</a>',t+='<span class="cancelAction secondaryAction">Cancel</span>',t+="</div>",t+='<div class="editInPlaceError"></div>',t+="</div>",(n=_.template(t))(e)},this.uiHideLoading=function(){this.select("submitActionSelector").removeClass(this.attr.loadingClass)},this.uiRemoveForm=function(){this.select("formContainerSelector").hide().remove()},this.uiShowLoading=function(){this.select("submitActionSelector").addClass(this.attr.loadingClass)}}),$gr.shared.editInPlaceController=flight.component(function(){var e="editInPlaceController";this.defaultAttrs({channel:e,componentName:e,containerSelector:".js-editInPlaceForm",editableElementSelector:".textBody",enableLinkSelector:".js-editInPlaceEnableAction",errorSelector:".editInPlaceError",highlightElementSelector:".js-editInPlaceHighlight",highlightClass:"highlight",enableLinkClass:"js-editInPlaceEnableAction",elementsToHideSelectors:""}),this.after("initialize",function(){this.attr.rawText=this.$node.data("raw-text-for-editing"),this.attr.editableBecauseAdmin=!!this.$node.data("editable-because-admin"),this.isNotAdminEditor()&&this.enableHighlight(),this.on("mouseup",{highlightElementSelector:this.onMouseUp}),this.on("click",{enableLinkSelector:this.onActivate}),this.on("ui.editInPlace.cancel",this.uiReset),this.on("ui.editInPlace.submit",this.onSubmit)}),this.onMouseUp=function(e){this.isNotAdminEditor()&&this.onActivate(e)},this.disableHighlight=function(){this.off("mouseover mouseout"),this.uiRemoveHighlight()},this.enableHighlight=function(){this.on("mouseover",{highlightElementSelector:this.uiAddHighlight}),this.on("mouseout",{highlightElementSelector:this.uiRemoveHighlight})},this.onActivate=function(e){var t=$j(e.target);e.preventDefault(),(!this.isTextSelected()||t.hasClass(this.attr.enableLinkClass))&&(this.disableHighlight(),this.uiHideElements(),$gr.shared.editInPlace.attachTo(this.select("containerSelector"),{originalText:this.$node.data("raw-text-for-editing"),submitButton:this.$node.data("submit-button")}))},this.onSaveError=function(e){var t=$j.parseJSON(e.responseText);$j.isPlainObject(t)&&this.select("errorSelector").html(t.errors.join("<br>")),this.trigger(this.attr.containerSelector,"saveError")},this.onSaveSuccess=function(e){$j.isPlainObject(e)&&this.uiUpdateText(e.answer_text_filtered),this.uiReset(),this.trigger(this.attr.containerSelector,"saveSuccess")},this.onSubmit=function(e,t){this.uiClearErrors(),this.attr.rawText=t.text,$j.isPlainObject(t)&&this.save(t)},this.save=function(e){var t=this.$node.data("update-url"),n=this.$node.data("field-name"),i={};i[n]=e.text,$j.ajax({url:t,type:"put",data:i,dataType:"json",context:this,timeout:3e3}).done(this.onSaveSuccess).fail(this.onSaveError)},this.uiAddHighlight=function(){this.select("highlightElementSelector").addClass(this.attr.highlightClass)},this.uiClearErrors=function(){this.select("errorSelector").text("")},this.uiHideElements=function(){this.select("editableElementSelector").hide(),this.select("elementsToHideSelectors").hide()},this.uiRemoveHighlight=function(){this.select("highlightElementSelector").removeClass(this.attr.highlightClass)},this.uiReset=function(){this.uiClearErrors(),this.uiShowElements(),this.isNotAdminEditor()&&this.enableHighlight()},this.uiShowElements=function(){this.select("editableElementSelector").show(),this.select("elementsToHideSelectors").show()},this.uiUpdateText=function(e){this.select("editableElementSelector").html(e)},this.isTextSelected=function(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),""!==e},this.isNotAdminEditor=function(){return!this.attr.editableBecauseAdmin}}),$gr.communityQA.editQAMessageForm=flight.component(function(){var e="editQAMessageForm";this.defaultAttrs({channel:e}),this.after("initialize",function(){this.on("ajax:success",this.uiUpdateFormField)}),this.uiUpdateFormField=function(e,t){t.message&&(this.uiResetForm(),this.select("inputFieldSelector").attr("placeholder",t.message))}},MixinEventUtils,withExpandableTextField,withNotification,withFormAjax),$gr.shared.editorialStoryForm=flight.component(function(){this.defaultAttrs({storyTypeMenuSelector:".js-storyTypeMenu",featuredInputSelector:".js-featuredBookInput",resourceInputSelector:".js-resourceIdInput"}),this.after("initialize",function(){this.uiUpdateFormFields(),this.on("change",{storyTypeMenuSelector:this.uiUpdateFormFields})}),this.uiUpdateFormFields=function(){var e=this.select("storyTypeMenuSelector").val();if("best_books_of_the_month"===e?this.select("featuredInputSelector").show():this.select("featuredInputSelector").hide(),""===e)this.select("resourceInputSelector").hide();else{this.select("resourceInputSelector").show();var t=this.getResourceType(e)+" ID: ";this.select("resourceInputSelector").find("label").text(t)}},this.getResourceType=function(e){switch(e){case"author_interview":return"Interview";case"good_minds_suggest":return"Interview";case"goodreads_blog":return"Blog";case"best_books_of_the_month":return"FeaturedList";default:return""}}});var ExpandableContent=flight.component(function(){this.defaultAttrs({showSelector:".jsShow",hideSelector:".jsHide",containerSelector:".expandableContainer"}),this.after("initialize",function(){this.on($gr.touch,{showSelector:this.uiShowHideToggle,hideSelector:this.uiShowHideToggle})}),this.uiShowHideToggle=function(e){var t=$j(e.target),n=t.parent(),i=t.closest(this.attr.containerSelector);e.preventDefault(),n.hide(),n.hasClass("fullContent")?i.find(".truncatedContent").show():i.find(".fullContent").show()}});$gr.communityQA.facebookTimelinePoster=flight.component(function(){var e="facebookTimelinePosterComponent";this.defaultAttrs({channel:e,componentName:e}),this.after("initialize",function(){this.on("click",this.shareToFacebook)}),this.shareToFacebook=function(){var e=this.$node.data("fb_options");$grfb.feedDialog(e)}});var Fanship=flight.component(function(){var e="Fanship";this.defaultAttrs({channel:e,componentName:e,activeClass:"btnActivated",inactiveClass:"btnSecondary",fanCountSelector:".authorFans .authorFanCount",activeStateMethod:"post",inactiveStateMethod:"delete"}),this.after("initialize",function(){this.$fanCount=$j(this.attr.fanCountSelector).first(),this.$node.data("active-button-text")&&(this.activeStateText=this.$node.data("active-button-text")),this.$node.data("inactive-button-text")&&(this.inactiveStateText=this.$node.data("inactive-button-text")),this.on("click",this.updateFanship)}),this.createUrl=function(){var e="";if("delete"===this.methodType)e="/fanships/"+this.fanshipId;else if("post"===this.methodType)e="/fanships/?",e+=encodeURIComponent("fanship[author_id]"),e+="=",e+=encodeURIComponent(this.authorId);else{var t="There was an error setting up the Fan button.";$j("#flashMessages").trigger("addFlashMessage",[t,"error"]),this.broadcastError(t,!0)}this.url=e},this.decreaseFanCount=function(){var e=this.getFanCountNumber();e--,this.$fanCount.data("fan-count",e),this.updateFanCount()},this.getFanCountNumber=function(){return parseInt(this.$fanCount.data("fan-count"),10)},this.increaseFanCount=function(){var e=this.getFanCountNumber();e++,this.$fanCount.data("fan-count",e),this.updateFanCount()},this.updateFanCount=function(){var e=this.getFanCountNumber(),t="";t=1===e?e+" Fan":e+" Fans",this.$fanCount.text(t)},this.updateFanship=function(){this.methodType=this.$node.attr("method"),this.authorId=this.$node.data("author-id"),this.fanshipId=this.$node.data("fanship-id"),this.toggleState(),this.createUrl(),this.disabledState(),$j.ajax({url:this.url,type:this.methodType,data:{format:"json"},context:this,success:this.onButtonSuccess,error:this.onButtonError,complete:this.onButtonComplete})},this.onButtonSuccess=function(e){$j.isPlainObject(e)&&this.$node.data("fanship-id",e.fanship_id)},this.onButtonComplete=function(){this.enabledState(),this.updateFanCount()},this.onButtonError=function(e){403===e.status?this.defer(function(){this.authRedirect(e,$j.proxy(function(){var t="Unknown XHR failure when trying to fan author.";e.status&&(t+=" , status code "+e.status),this.broadcastError(t)},this))},500):$j("#flashMessages").trigger("addFlashMessage",["There was an unknown error when trying to fan/unfan an author.","error"])},this.toggleState=function(){this.$node.hasClass(this.attr.activeClass)?this.inactiveState():this.activeState()},this.activeState=function(){this.$node.addClass(this.attr.activeClass),this.$node.removeClass(this.attr.inactiveClass),this.$node.attr("method",this.attr.inactiveStateMethod),this.$node.text(this.activeStateText),this.increaseFanCount(),this.enabledState()},this.inactiveState=function(){this.$node.addClass(this.attr.inactiveClass),this.$node.removeClass(this.attr.activeClass),this.$node.attr("method",this.attr.activeStateMethod),this.$node.text(this.inactiveStateText),this.decreaseFanCount(),this.enabledState()},this.disabledState=function(){this.$node.attr("disabled","disabled")},this.enabledState=function(){this.$node.removeAttr("disabled")}},MixinEventUtils,MixinAuthRedirect);$gr.shared.favoriteGenre=flight.component(function(){var e="FavoriteGenre";this.defaultAttrs({componentName:e,activeClass:"btnActivated",inactiveClass:"btnSecondary",activeStateMethod:"post",inactiveStateMethod:"delete",dataAttrUrlActivate:"async-url-activate-url",dataAttrUrlInactivate:"async-url-inactivate_url"}),this.after("initialize",function(){var e=this.$node.data("active-button-text"),t=this.$node.data("active-button-hover-text"),n=this.$node.data("inactive-button-text");e&&(this.attr.activeStateText=e),t&&(this.attr.activeButtonHoverText=t),n&&(this.attr.inactiveStateText=n),this.on("ajax:success",this.onFavoriteSuccess),this.on("ajax:error",this.onFavoriteError),this.on("hover",this.handleHover),this.on("mouseleave",this.handleMouseLeave)}),this.onFavoriteSuccess=function(e,t){$j.isPlainObject(t)&&("success"===t.status?this.toggleState():"error"===t.status&&this.showErrorMessage(t.message))},this.onFavoriteError=function(){var e="Sorry, there was an unknown error favoriting this genre. Please reload the page and try again.";this.showErrorMessage(e)},this.toggleState=function(){this.$node.hasClass(this.attr.activeClass)?this.inactiveState():this.activeState()},this.activeState=function(){this.$node.addClass(this.attr.activeClass),this.$node.removeClass(this.attr.inactiveClass),this.$node.data("method",this.attr.inactiveStateMethod),this.$node.text(this.attr.activeStateText),this.updateURL()},this.inactiveState=function(){this.$node.addClass(this.attr.inactiveClass),this.$node.removeClass(this.attr.activeClass),this.$node.data("method",this.attr.activeStateMethod),this.$node.text(this.attr.inactiveStateText),this.updateURL()},this.showErrorMessage=function(e){$j("#flashMessages").trigger("addFlashMessage",[e,"error"]),this.broadcastError(e)},this.handleHover=function(){this.attr.activeButtonHoverText&&this.$node.hasClass(this.attr.activeClass)&&this.$node.text(this.attr.activeButtonHoverText)},this.handleMouseLeave=function(){this.$node.hasClass(this.attr.activeClass)?this.activeState():this.inactiveState()},this.updateURL=function(){var e="",t=this.$node.data("method");t===this.attr.activeStateMethod?e=this.$node.data(this.attr.dataAttrUrlActivate):t===this.attr.inactiveStateMethod&&(e=this.$node.data(this.attr.dataAttrUrlInactivate)),this.$node.attr("href",e)}},MixinEventUtils);var FlashMessages=flight.component(function(){var e="flashMessages";this.defaultAttrs({channel:e,componentName:e,hideClass:"hide",errorClass:"error",noticeClass:"notice",containerIdSelector:"#flashMessages",flashMessageSelector:".flashMessage",siteHeaderSelector:"#siteHeader",hideDelay:5e3,scrollDebounceDuration:150}),this.after("initialize",function(){var e=this.select("flashMessageSelector"),t=$j(this.attr.siteHeaderSelector);this.isSiteHeader=!1,this.siteHeaderHeight=0,this.updateMessageCount(),t.length&&(this.isSiteHeader=!0,this.siteHeaderHeight=t.outerHeight()),e.length&&this.isSiteHeader&&e.css("top",this.siteHeaderHeight),this.on(document,"scrollstart",this.prepareForUpdate),this.on(document,"scroll",flight.utils.debounce(this.updatePosition,this.attr.scrollDebounceDuration)),this.on("addFlashMessage",this.add),this.on("addFlashError",function(e,t){this.add(e,t,this.attr.errorClass)}),this.on("clearFlashError",this.onClearFlashError),this.messageCount>0&&this.next()}),this.add=function(e,t,n){var i=$j("<div/>").addClass("flashMessage");i.addClass("string"==typeof n?n:this.attr.noticeClass).text(t).appendTo(this.attr.containerIdSelector),i.css({opacity:0,top:-100}),window.getComputedStyle(i[0]).opacity,i.css({opacity:"",top:""}),this.updateMessageCount(),this.next(),this.updatePosition(!0)},this.hide=function(){var e=this.first();e.addClass(this.attr.hideClass),e.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend",$j.proxy(this.remove,this))},this.prepareForUpdate=function(){var e=this.select("flashMessageSelector");e.length&&(e.addClass("notransition hide"),this.forceBrowserReflow())},this.remove=function(){return 0===this.messageCount?!1:(this.broadcast("beforeRemove"),this.first().remove(),this.updateMessageCount(),this.broadcast("afterRemove"),void this.next())},this.onClearFlashError=function(){this.first().hasClass(this.attr.errorClass)&&this.hide()},this.updatePosition=function(e){var t=this.select("flashMessageSelector"),n=0,i=$j(document).scrollTop();0!==t.length&&(e="undefined"!=typeof e?e:!1,n=this.isSiteHeader&&i<=this.siteHeaderHeight?this.siteHeaderHeight:i,(this.currentTop!==n||e===!0)&&t.css("top",n),this.forceBrowserReflow(),t.removeClass("notransition hide"),this.currentTop=n)},this.first=function(){return this.select("flashMessageSelector").first()},this.next=function(){var e=this.first();this.messageCount>0&&!e.hasClass(this.attr.errorClass)&&this.defer(this.hide,this.attr.hideDelay)},this.updateMessageCount=function(){this.messageCount=this.select("flashMessageSelector").length}},MixinEventUtils),Follow=flight.component(function(){var e="follow";this.defaultAttrs({channel:e,componentName:e,activeClass:"btnActivated",inactiveClass:"btnSecondary",loadingClass:"btnLoading",activeStateMethod:"post",inactiveStateMethod:"delete",dataAttrUrlAdd:"async-url-add",dataAttrUrlDelete:"async-url-delete",defautlActiveStateText:"Unfollow",defautlInactiveStateText:"Follow"}),this.after("initialize",function(){var e=this.$node.data("active-button-text"),t=this.$node.data("inactive-button-text");this.userId=this.$node.data("user-id"),this.validateUserId(),e&&(this.attr.activeStateText=e),t&&(this.attr.inactiveStateText=t),this.on("ajax:success",this.onFollowSuccess),this.on("ajax:error",this.onFollowError)}),this.onFollowSuccess=function(e,t){$j.isPlainObject(t)&&("success"===t.status?this.toggleState():"error"===t.status&&this.showErrorMessage(t.message))},this.onFollowError=function(e,t){this.defer(function(){this.authRedirect(t,$j.proxy(function(){var e="Unknown XHR failure when trying to follow the user.",n="Sorry, there was an unknown error following this user. Please reload the page and try again.";t.status&&(e+=" (status code "+t.status+")"),this.broadcastError(e),this.showErrorMessage(n)},this))},500)},this.toggleState=function(){this.$node.hasClass(this.attr.activeClass)?this.inactiveState():this.activeState()},this.activeState=function(){this.$node.addClass(this.attr.activeClass),this.$node.removeClass(this.attr.inactiveClass),this.$node.data("method",this.attr.inactiveStateMethod),this.$node.text(this.attr.activeStateText),this.updateURL()},this.inactiveState=function(){this.$node.addClass(this.attr.inactiveClass),this.$node.removeClass(this.attr.activeClass),this.$node.data("method",this.attr.activeStateMethod),this.$node.text(this.attr.inactiveStateText),this.updateURL()},this.updateURL=function(){var e="",t=this.$node.data("method");if(t===this.attr.activeStateMethod)e=this.$node.data(this.attr.dataAttrUrlAdd);else if(t===this.attr.inactiveStateMethod)e=this.$node.data(this.attr.dataAttrUrlDelete);else{var n="Sorry, there was an invalid method type for the Follow button.";this.showErrorMessage(n)}this.$node.attr("href",e)},this.showErrorMessage=function(e){$j("#flashMessages").trigger("addFlashMessage",[e,"error"]),this.broadcastError(e)},this.validateUserId=function(){var e=/[0-9]+/;e.test(this.userId)||(this.showErrorMessage("Invalid user ID for follow component."),this.teardown())}},MixinEventUtils,MixinAuthRedirect);$gr.shared.followSuggestedAuthor=flight.component(function(){this.defaultAttrs({defaultActiveStateText:"Unfollow",defaultInactiveStateText:"Follow",followButtonSelector:".button"}),this.after("initialize",function(){this.on("click",{followButtonSelector:this.onFollow})}),this.onFollow=function(){var e=this.$node.data("follow-path"),t=this.$node.data("ref-tag");$j.ajax({url:e,type:"post",data:{format:"json",follow_author_from_newsfeed:!0,ref:t},context:this,success:this.onSuccess,error:this.onError})},this.onSuccess=function(e,t,n){var i=e;"success"==i.status?($j(".authorFollowingSuggestion.update").after(i.last_activity_html),this.$node.find(".followedMessage").show(),this.$node.find(".notFollowedMessage").hide(),this.$node.find(".button").hide(),this.$node.find(".authorFollowingSuggestionMessaging").hide()):this.onError(n,t)},this.onError=function(e,t,n){var i;try{i=$j.parseJSON(e.responseText)}catch(o){i={type:"error",message:"There was an unknown error. Please retry.  (errorThrown: "+n+")"}}this.$node.find(".notFollowedMessage").html(i.message),this.$node.find(".notFollowedMessage").show(),this.$node.find(".followedMessage").hide(),this.$node.find(".authorFollowingSuggestionMessaging").hide()}},MixinEventUtils),$gr.shared.formBoxChecker=flight.component(function(){this.defaultAttrs({checkBoxesSelector:".js-formBoxChecker-checkBox",massCheckAll:!1,massCheckControlSelector:"#js-formBoxChecker-checkAllControl"}),this.after("initialize",function(){this.on("allBoxesCleared",this.changeToCheckAll),this.on("allBoxesChecked",this.changeToUncheckAll),this.on("click",{massCheckControlSelector:this.handleMassCheckClick}),this.on("change",{checkBoxesSelector:this.handleCheckboxChange})}),this.changeToCheckAll=function(){this.attr.massCheckAll=!0,this.select("massCheckControlSelector").text("Check all")},this.changeToUncheckAll=function(){this.attr.massCheckAll=!1,this.select("massCheckControlSelector").text("Uncheck all")},this.checkAll=function(){this.select("checkBoxesSelector").prop("checked",!0),this.trigger("allBoxesChecked")},this.handleCheckboxChange=function(){$checkBoxes=this.select("checkBoxesSelector"),0===$checkBoxes.filter(":checked").length?this.trigger("allBoxesCleared"):0===$checkBoxes.not(":checked").length&&this.trigger("allBoxesChecked")},this.handleMassCheckClick=function(e){e.preventDefault(),this.attr.massCheckAll===!0?this.checkAll():this.uncheckAll()},this.uncheckAll=function(){this.select("checkBoxesSelector").prop("checked",!1),this.trigger("allBoxesCleared")}});var FriendRequest=flight.component(function(){var e="FriendRequest";this.defaultAttrs({channel:e,componentName:e,showClass:"show",approveButtonSelector:".btnApprove",ignoreButtonSelector:".btnIgnore",buttonContainerSelector:".friendRequestActions",statusMessageSelector:".friendRequestStatusMessage",confirmResponseType:"confirm",ignoreResponseType:"ignore",confirmRequestMessage:"You are now friends",ignoreRequestMessage:"You\u2019ve ignored this invitation"}),this.after("initialize",function(){var e=this.$node.data("confirm-request-message"),t=this.$node.data("ignore-request-message");e&&!/^\s*$/.test(e)&&(this.attr.confirmRequestMessage=e),t&&!/^\s*$/.test(t)&&(this.attr.ignoreRequestMessage=t),this.on("ajax:success",this.onFriendRequestSuccess),this.on("ajax:error",this.onFriendRequestError)}),this.onApprove=function(){this.hide("buttonContainerSelector"),this.updateMessage(this.attr.confirmRequestMessage),this.show("statusMessageSelector")},this.onIgnore=function(){this.hide("buttonContainerSelector"),this.updateMessage(this.attr.ignoreRequestMessage),this.show("statusMessageSelector")},this.onFriendRequestSuccess=function(e,t){var n=[this.attr.confirmResponseType,this.attr.ignoreResponseType];$j.isPlainObject(t)?t.response_type&&$j.inArray(t.response_type,n)>=0?t.response_type===this.attr.confirmResponseType?this.onApprove():t.response_type===this.attr.ignoreResponseType&&this.onIgnore():this.broadcastError("Undefined or invalid response type in friend request response.",!0):this.broadcastError("Malformed JSON response when trying to confirm/ignore friend request.",!0)},this.onFriendRequestError=function(e,t){this.defer(function(){404===t.status&&(t.status=403,t.responseText='{"redirect":"/user/sign_in"}'),this.authRedirect(t,$j.proxy(function(){var e="Unknown XHR failure while trying to confirm/ignore a friend request";t.status&&(e+=", status code: "+t.status),this.broadcastError(e,!0)},this))},500)},this.hide=function(e){var t=this.select(e);t.removeClass(this.attr.showClass)},this.show=function(e){var t=this.select(e);t.addClass(this.attr.showClass)},this.updateMessage=function(e){if("string"==typeof e&&!/^\s*$/.test(e)){var t=this.select("statusMessageSelector");t.text(e)}}},MixinEventUtils,MixinAuthRedirect),LikeResource=flight.component(function(){var e="likeResource";this.defaultAttrs({channel:e,componentName:e,catalystSelector:".jsLike",likesCountContainerSelector:".ratingsCount",likesCountSelector:".likesCount",likesIconSelector:".likesIndicator",likesHideClass:"hide",likesIconActiveClass:"userHasRating"}),this.after("initialize",function(){this.on("ajax:success",{catalystSelector:this.onLikeSuccess}),this.on("ajax:error",{catalystSelector:this.onLikeError})}),this.swapLikeUnlikeLink=function(e,t){var n=e.parent(),i=e.attr("href").match(/.*&ref=(.*_u?lk)/);if(e.replaceWith(t.html),i){var o=n.find("a");t.is_liked_by_current_user?o.attr("href",o.attr("href")+"&ref="+t.ref.replace(/_lk/,"_ulk")):o.attr("href",o.attr("href")+"&ref="+t.ref.replace(/_ulk/,"_lk"))}},this.onLikeError=function(e,t){this.defer(function(){this.authRedirect(t,$j.proxy(function(){var e="Unknown XHR failure when trying to like resource.";t.status&&(e+=" , status code "+t.status),this.broadcastError(e)},this))},500)},this.onLikeSuccess=function(e,t){if($j.isPlainObject(t)){var n=$j(e.target),i=n.data("like-count-id");if(i){var o=$j("#"+i);if($j.isNumeric(t.count)){o.find(this.attr.likesCountSelector).text(t.count>0?t.count:0).toggleClass(this.attr.likesIconActiveClass,t.is_liked_by_current_user);var r=o.closest(this.attr.likesCountContainerSelector);t.count>0&&r.hasClass(this.attr.likesHideClass)?r.removeClass(this.attr.likesHideClass):t.count<=0&&!r.hasClass(this.attr.likesHideClass)&&r.addClass(this.attr.likesHideClass)}o.find(this.attr.likesIconSelector).toggleClass(this.attr.likesIconActiveClass,t.is_liked_by_current_user)}this.swapLikeUnlikeLink(n,t)}else this.broadcastError("Malformed JSON response when trying to like resource.")}},MixinEventUtils,MixinAuthRedirect),LoadMore=flight.component(function(){var e="loadMore",t=/page=([0-9]+)/;this.defaultAttrs({channel:e,componentName:e,loadMoreContainerSelector:"#loadMoreContainer",loadMoreActionSelector:".loadMoreAction",loadMoreSelector:".jsLoadMore",loadingClass:"loading"}),this.after("initialize",function(){this.nextPage=this.getPageNumberFromURL(),this.on("click",this.uiShowLoading),this.on("ajax:success",this.onLoadMoreSuccess),this.on("ajax:error",this.onLoadMoreError)}),this.onLoadMoreSuccess=function(e,t){var n=this.$node.data("content-container");t.content_html&&!/^\s*$/.test(t.content_html)?$j(n).append(t.content_html):this.teardownLoadMore(),t.page&&t.total_pages&&t.total_pages<=t.page&&this.teardownLoadMore(),this.nextPage+=1,t.load_more_html?($j(this.attr.loadMoreContainerSelector).replaceWith(t.load_more_html),LoadMore.attachTo(this.attr.loadMoreSelector,{loadMoreContainerSelector:this.attr.loadMoreContainerSelector,loadMoreActionSelector:this.attr.loadMoreActionSelector,loadMoreSelector:this.attr.loadMoreSelector})):this.updateLoadMoreAction(),this.broadcastSuccessfulLoadMore(t),this.uiHideLoading()
},this.broadcastSuccessfulLoadMore=function(e){this.broadcast("success",e);var t=this.$node.data("success-event");"undefined"!=typeof t&&this.broadcast(t)},this.onLoadMoreError=function(e,t,n){if("timeout"===n){var i=$j("#flashMessages"),o="The request timed out. Please try again.";i.trigger("addFlashMessage",[o])}this.uiHideLoading(),this.defer(function(){this.authRedirect(t,$j.proxy(function(){var e="Unknown XHR failure while trying to load more content";t.status&&(e+=", status code: "+t.status),this.broadcastError(e)},this))},500)},this.uiShowLoading=function(){$j(this.attr.loadMoreActionSelector).addClass(this.attr.loadingClass)},this.uiHideLoading=function(){$j(this.attr.loadMoreActionSelector).removeClass(this.attr.loadingClass)},this.getPageNumberFromURL=function(){var e=this.$node.attr("href"),n=t.exec(e);return null!==n?parseInt(n[1],10):1},this.updateLoadMoreAction=function(){var e=this.$node.attr("href");t.test(e)?e=e.replace(t,"page="+this.nextPage):this.broadcastError("There is no page query to replace in the load more button",!0),this.$node.attr("href",e)},this.teardownLoadMore=function(){$j(this.attr.loadMoreContainerSelector).remove(),this.teardown()}},MixinEventUtils,MixinAuthRedirect),LoadingFeedback=flight.component(function(){this.defaultAttrs({loadingClass:"btnLoading",submitElementClass:"btnSubmit"}),this.after("initialize",function(){this.on(document,"ajax:beforeSend submit",this.enableLoadingState),this.on(document,"ajax:complete unload",this.disableLoadingState)}),this.enableLoadingState=function(e){var t=$j(e.target),n=this.getSubmitElement(t);n.length&&(n.prop("disabled",!0),n.addClass(this.attr.loadingClass))},this.disableLoadingState=function(e){var t=$j(e.target),n=this.getSubmitElement(t);n.length&&(n.prop("disabled",!1),n.removeClass(this.attr.loadingClass))},this.getSubmitElement=function(e){var t=null;return t=e.hasClass(this.attr.submitElementClass)?e:e.find("."+this.attr.submitElementClass)}});$gr.shared.modal=flight.component(function(){this.defaultAttrs({closeIconSelector:".js-closeModalIcon",lightBoxContainerSelector:"#box"}),this.after("initialize",function(){this.modalId=this.$node.attr("id"),this.hideCloseIcon=this.$node.data("hide-close-icon"),this.listen("modalTriggered",this.onModalTrigger),this.listen("hideModal",this.uiHideModal),this.$node.data("auto-show")&&this.uiShowModal()}),this.onModalTrigger=function(e,t){t["modal-id"]===this.modalId&&this.uiShowModal()},this.uiShowModal=function(){Lightbox.showBoxByID(this.$node.attr("id")),this.hideCloseIcon&&$j(this.attr.lightBoxContainerSelector).find(this.attr.closeIconSelector).remove()},this.uiHideModal=function(){Lightbox.hideBox("dropout")}},MixinEventUtils),$gr.shared.modalTrigger=flight.component(function(){this.defaultAttrs({}),this.after("initialize",function(){this.on("click",this.broadcastTriggerEvent)}),this.broadcastTriggerEvent=function(){return this.broadcast("modalTriggered",{"modal-id":this.$node.data("modal-id")}),!1}},MixinEventUtils),$gr.shared.newsfeedMenu=flight.component(function(){this.defaultAttrs({notInterestedButtonSelector:".js-newsfeedNotInterestedButton",notInterestedFormSelector:".js-newsfeedNotInterested",notInterestedMessageSelector:".js-wtrNotInterestedMessage",undoNotInterestedButtonSelector:".js-undoNotInterestedButton",dismissNotInterestedMessageButtonSelector:".js-dismissNotInterestedMessage"}),this.after("initialize",function(){var e,t,n,i,o=this;this.on("click",{notInterestedButtonSelector:this.markNotInterested}),e=this.getUpdateRow(),t=this.getNotInterestedMessageRow(),n=t.find(this.attr.undoNotInterestedButtonSelector),n.click(function(e){o.undoNotInterested(e)}),i=t.find(this.attr.dismissNotInterestedMessageButtonSelector),i.click(function(e){o.dismissNotInterested(e)})}),this.markNotInterested=function(e){var t;e.preventDefault(),e.stopPropagation(),this.select("notInterestedButtonSelector").parent().submit(),t=this.getNewsfeedStoryClass(),$j(t).hide(),this.getNotInterestedMessageRow().show()},this.undoNotInterested=function(e){var t,n;e.preventDefault(),t=this.getAssociatedBookID(),n=e.target.href,$j.ajax({url:n,type:"delete",data:{format:"json",user_not_interested_work:{book_id:t}},context:this,success:this.showBookInspiration,error:this.uiShowError})},this.showBookInspiration=function(){var e;e=this.getNewsfeedStoryClass(),$j(e).show(),this.toggleDropdownMenu(),this.getNotInterestedMessageRow().hide()},this.dismissNotInterested=function(e){e.preventDefault(),$j(this.attr.notInterestedMessageSelector).hide()},this.getUpdateRow=function(){return this.$node.closest("tr.update")},this.getNotInterestedMessageRow=function(){var e,t,n;return e=this.getUpdateRow(),t=e.nextAll("tr.bookInspiration").first(),n=t.nextAll(".notInterestedRowContainer").first()},this.getNewsfeedStoryClass=function(){var e,t;return e=this.getAssociatedWorkID(),t=".newsfeedBookInspiration"+e},this.getAssociatedWorkID=function(){var e,t=this.select("notInterestedButtonSelector").closest(this.attr.notInterestedFormSelector);return e=t.data("work_id")},this.getAssociatedBookID=function(){var e,t=this.select("notInterestedButtonSelector").closest(this.attr.notInterestedFormSelector);return e=t.data("book_id")}},dropdownMenu),$gr.shared.newsfeedNav=flight.component(function(){this.defaultAttrs({updateFilterToggleSelector:".js-updateToggle",updateFiltersSelector:".js-updateTypeFilters",loadingSelector:".js-loading"}),this.after("initialize",function(){this.on("click",{updateFilterToggleSelector:this.toggleUpdateFilterForm}),this.listen("dataUpdatesLoading",this.showLoading),this.listen("dataUpdatesLoadingFinished",this.hideLoading),this.listen("dataFiltersUpdated",this.hideUpdateFilterForm),this.listen("hideConfirmModal",this.hideUpdateFilterForm)}),this.toggleUpdateFilterForm=function(){this.select("updateFiltersSelector").toggle()},this.hideUpdateFilterForm=function(){this.select("updateFiltersSelector").hide()},this.showLoading=function(){this.select("loadingSelector").show()},this.hideLoading=function(){this.select("loadingSelector").hide()}},MixinEventUtils),$gr.shared.newsfeedTracking=flight.component(function(){this.defaultAttrs({trackingContainerSelector:".newsfeed"}),this.after("initialize",function(){$j(document).on("click",this.attr.trackingContainerSelector+" .csct",this.setCookie)}),this.setCookie=function(){var e=new Date;e.setTime(e.getTime()+3e4),document.cookie="csct=true; expires="+e.toGMTString()+"; path=/"}}),$gr.shared.newsfeedUpdateUI=flight.component(function(){this.defaultAttrs({errorMessageSelector:".newsfeedErrorMessage",existingUpdatesSelector:"tr.update[data-timestamp]",loadingSpinnerSelector:".js-loading",loadMoreContainerSelector:"#loadMoreContainerUpdates",updatesContainerSelector:"#updates",updatesFiltersSelector:".js-updateTypeFilters"}),this.after("initialize",function(){this.listen("data-form-success",this.updateNewsfeed),this.listen("newsfeedUpdates.loadMore",this.reattachComponents)}),this.reattachComponents=function(){$gr.shared.attachNewsfeedComponents()},this.updateNewsfeed=function(e,t){"undefined"!=typeof t.newsfeed_html?this.reloadNewsfeed(t.newsfeed_html):"undefined"!=typeof t.reload_newsfeed&&$j.ajax({url:"/home/index_ajax",type:"get",data:{format:"json"},context:this,beforeSend:this.showLoadingIcon,success:function(e){this.reloadNewsfeed(e.newsfeed_html)},error:this.showNewsfeedError})},this.reloadNewsfeed=function(e){this.$node.html(e),this.reattachComponents(),this.broadcast("dataUpdatesLoadingFinished")},this.showLoadingIcon=function(){$j("html, body").animate({scrollTop:0},"slow"),this.select("updatesFiltersSelector").hide(),this.select("updatesContainerSelector").hide(),this.select("loadMoreContainerSelector").hide(),this.select("loadingSpinnerSelector").show()},this.showNewsfeedError=function(){this.select("errorMessageSelector").show()}},MixinEventUtils),$gr.shared.notification=flight.component(function(){},withNotification),$gr.shared.openGlidePopup=flight.component(function(){var e="openGlidePopup";this.defaultAttrs({channel:e,componentName:e}),this.after("initialize",function(){this.on("click",this.openPopup)}),this.openPopup=function(e){var t=this.$node,n=t.data("asin"),i=t.data("url"),o=t.data("kuEligible"),r=t.data("refTag"),s="";1==o&&(s="KU"),window.open("https://www.amazon.com/gp/product/"+n+"/ref="+r+"?v=mini-glance&caller=Goodreads&callerLink="+i+"&preference="+s+"&tag="+r+"-20","1402010176686","width=950,height=500,toolbar=0,menubar=0,location=0,status=1,scrollbars=1,resizable=1,left=0,top=0").focus(),e.preventDefault()}}),$gr.shared.pollClearVoteButton=flight.component(function(){this.defaultAttrs({paneSelector:".votedOnPane",voteButtonSelector:".pollVoteButton",writeInSelector:".writeIn",bookCoverSelector:".bookcover"}),this.after("initialize",function(){this.on("click",this.clearVote)}),this.clearVote=function(e){var t=$j(e.target),n=t.data("pollVoteId"),i=t.data("answer"),o=t.data("pollId");return $j.ajax({url:"/poll/clear_vote",type:"POST",dataType:"JSON",context:this,data:{id:o,poll_vote_id:n,gca_2014:!0},success:function(){this.hideVotedOnPane(),this.showVoteButtons(i)}}),!1},this.hideVotedOnPane=function(){$j(this.attr.paneSelector).hide()},this.removeOverlayAndCheckMark=function(){$j(this.attr.bookCoverSelector).removeClass("votedCoverOverlay"),$j("div").remove(".votedForCoverCheckSlim")},this.showVoteButtons=function(e){$j(this.attr.voteButtonSelector).removeClass("hidden"),this.removeOverlayAndCheckMark(),$j(this.attr.voteButtonSelector).show(),$j("#pollVoteButton_"+e).html("VOTE"),$j(this.attr.writeInSelector).show()}}),$gr.shared.pollVoteButton=flight.component(function(){this.defaultAttrs({bookCoverSelector:".bookcover",voteButtonSelector:".pollVoteButton",autoCompleteSelector:".searchFieldInput",votedOnPaneSelector:".votedOnPane",writeInVoteBtnSelector:".writeInButton",writeInSelector:".writeIn",writeInErrorSelector:".writeInError"}),this.bookID=-1,this.after("initialize",function(){this.on("click",this.voteForPoll)}),this.voteForPoll=function(e){var t=$j(e.target),n=t.data("answer"),i=t.data("pollId");return this.bookID=t.data("bookId"),t.innerHTML="voting","undefined"==typeof n&&(n=$j(this.attr.autoCompleteSelector)[0].value,this.bookID=$j(this.attr.autoCompleteSelector).data("bookId")),"undefined"!=typeof n&&""!=n?$j.ajax({url:"/poll/vote",type:"POST",dataType:"JSON",context:this,data:{id:i,answer:n,book_id:this.bookID,gca_2014:!0},statusCode:{200:this.displayVotedOnPanel,400:this.displayError,401:this.displayError}}):t.innerHTML="VOTE",!1},this.displayVotedOnPanel=function(e){var t=e.body;this.addOverlayAndCheckMark(),$j(this.attr.votedOnPaneSelector).html(t),$j(this.attr.votedOnPaneSelector).show(),$j(this.attr.voteButtonSelector).hide(),$j(this.attr.writeInErrorSelector).hide(),$j(this.attr.writeInSelector).hide(),$gr.shared.pollClearVoteButton.attachTo(".clearVoteButton"),window.scrollTo(0,0)},this.addOverlayAndCheckMark=function(){$j(this.attr.bookCoverSelector).addClass("votedCoverOverlay"),$j("#bookcover_"+this.bookID).removeClass("votedCoverOverlay"),$j("#bookcover_"+this.bookID).before("<div class='votedForCoverCheckSlim'></div>")},this.displayError=function(e){var t="<b>That book is ineligible. Please try again! </b>"+e.responseJSON.body;$j(this.attr.writeInErrorSelector).show(),$j(this.attr.writeInErrorSelector).html(t),$j(this.attr.writeInVoteBtnSelector).html("VOTE")}}),$gr.shared.previewableNewsfeedStoryForm=flight.component(function(){this.defaultAttrs({inputSelector:":input",imageFieldSelector:".js-imageField",previewContainerSelector:".js-previewContainer",previewErrorSelector:".js-previewError",previewImageSelector:".js-previewImage"}),this.after("initialize",function(){this.on("change",{inputSelector:this.getPreviewHtml})}),this.getPreviewHtml=function(){$j.ajax(this.$node.data("preview-url"),{data:this.$node.serialize(),context:this,success:this.showPreview,error:this.showPreviewError})},this.showPreview=function(e){this.select("previewErrorSelector").hide(),this.select("previewContainerSelector").html(e.preview_html),this.showPreviewImage()},this.showPreviewError=function(){this.select("previewContainerSelector").hide(),this.select("previewErrorSelector").show()},this.showPreviewImage=function(){var e=this.select("imageFieldSelector");if(0!==e.length&&0!==e[0].files.length){var t=e[0].files[0],n=this.select("previewImageSelector"),i=new FileReader;i.onload=function(e){var t=e.target.result,i=$j("<img>").attr("src",t);n.html(i)},i.readAsDataURL(t)}}}),$gr.shared.pulldownNavigator=flight.component(function(){var e="pulldownNavigator";this.defaultAttrs({channel:e,componentName:e,pullDownSelector:".pulldownNavigator"}),this.after("initialize",function(){this.on("change",t)});var t=function(e){var t=e.target.value;window.location=t}});var RatingComponent=flight.component(function(){var e=$j(document),t=$j("html"),n=t.hasClass("touch"),i="ratingComponent",o=!1;this.defaultAttrs({channel:i,componentName:i,tapEvent:n?"touchstart":"click",tapStartEvent:n?"touchstart":"mousedown",tapEndEvent:n?"touchend":"mouseup",animPrepClass:"readyToShow",showClass:"show",itemActiveClass:"active",itemInactiveClass:"inactive",cancelSelector:".cancel",itemSelector:".ratingItem:not(.cancel)",listSelector:".ratingList",isDevicePhone:t.hasClass("mobile"),isDeviceTablet:t.hasClass("tablet"),currentRating:-1,minRating:0,maxRating:5}),this.after("initialize",function(){this.elCache={},this.$bookContainer=this.$node.parent().parent();var e=this.$node.data("submit-url");if(!e)return this.broadcastError("could not retrieve 'saveUrl'");if(this.$node.removeAttr("data-submit-url"),this.attr.saveUrl=e,this.attr.currentRating<this.attr.minRating){var t=this.$node.data("user-rating");this.$node.removeAttr("data-user-rating"),this.attr.currentRating="undefined"!=typeof t&&this.validateRating(t)?parseInt(t,10):this.attr.minRating}var n=this.$node.data("disable-star-update");if(this.$node.on([this.attr.tapStartEvent,this.attr.tapEndEvent].join(" "),this.attr.itemSelector,$j.proxy(function(e){var t=$(e.target),n=this.attr.itemActiveClass;e.type===this.attr.tapStartEvent?t.prevAll().addClass(n):(t.prevAll().removeClass(n),this.save(t.data("rating")))},this)),this.attr.isDevicePhone)this.initializeForPhone();else{if(!this.attr.isDeviceTablet)return this.broadcastError("initialization failed, user agent is not mobile/tablet.");this.initializeForTablet()}this.$bookContainer.find(this.attr.resetSelector).on(this.attr.tapEvent,$j.proxy(this.resetRating,this)),this.listen("saveSuccess",function(e,t){if($j.isPlainObject(t)&&this.validateRating(t.rating)){if(this.$node.attr("id")!==t.domId)return;t.rating===this.attr.minRating&&this.broadcast("reset"),n||this.defer(function(){this.updateStaticStars(t.rating)})}})}),this.initializeForPhone=function(){return this.elCache.$catalyst&&this.elCache.$catalyst.length||(this.elCache.$catalyst=this.$node.find(".catalyst"),this.elCache.$catalyst.length)?(this.elCache.$catalyst.on(this.attr.tapEvent,$j.proxy(this.toggleVisibility,this)),this.select("cancelSelector").on(this.attr.tapEvent,$j.proxy(this.hide,this)),this.overlayId=[this.attr.componentName,Math.floor(1000000001*Math.random())].join("_"),o||(e.trigger("create.viewportOverlay",{overlayId:this.overlayId}),o=!0),this.listen("beforeShow",function(){var t=this.select("listSelector");if(t.length){var n=t.outerHeight();if(!(n>0))return this.broadcastError("cannot display options list because it has no dimensions");t.css("bottom",0-n+"px")}this.$node.addClass(this.attr.animPrepClass),e.trigger("show.viewportOverlay",{overlayId:this.overlayId})}),this.listen("afterHide",function(){this.defer(function(){e.trigger("hide.viewportOverlay",{overlayId:this.overlayId})}),this.defer(function(){this.$node.removeClass(this.attr.animPrepClass).select("listSelector").css("bottom","")},350)}),e.on("beforeHide.viewportOverlay",$j.proxy(function(e,t){t&&t.overlayId===this.overlayId&&this.defer(function(){this.isVisible()&&this.hide()})},this)),this.listen("saveSuccess",function(e,t){$j.isPlainObject(t)&&this.validateRating(t.rating)&&this.attr.hideCatalystClass&&this.elCache.$catalyst.toggleClass(this.attr.hideCatalystClass,this.attr.currentRating>this.attr.minRating)}),void this.listen("saveComplete",$j.proxy(this.hide,this))):this.broadcastError("could not find catalyst element")},this.initializeForTablet=function(){this.listen("saveSuccess",function(e,t){if($j.isPlainObject(t)&&this.validateRating(t.rating)){var n=t.rating;this.defer(function(){this.$node.find(this.attr.itemSelector).each($j.proxy(function(e,t){var i=$j(t);i.toggleClass(this.attr.itemInactiveClass,n<parseInt(i.data("rating"),10))},this))})}})},this.hide=function(){this.broadcast("beforeHide"),this.$node.removeClass(this.attr.showClass),this.broadcast("afterHide")},this.isVisible=function(){return this.$node.hasClass(this.attr.showClass)},this.show=function(){this.broadcast("beforeShow"),this.$node.addClass(this.attr.showClass),this.broadcast("afterShow")},this.toggleVisibility=function(e){e.preventDefault(),this.isVisible()?this.hide():this.show()},this.updateStaticStars=function(e){var t=this.$bookContainer.find(".bookUserRatingCurrent");if(t.length){var n=e>this.attr.minRating&&e<=this.attr.maxRating,i=/(^|\s+stars_)\d($|\s+)/;t.find(".stars").removeAttr("title").html("").each(function(t,n){n.className=n.className.replace(i,"$1"+e+"$2")}).end().toggleClass("show",n)}},this.resetRating=function(e){e.preventDefault(),this.save(this.attr.minRating)},this.save=function(e){this.validateRating(e)&&$j.ajax({url:this.attr.saveUrl,type:"post",data:{format:"js",rating:e},context:this,success:function(){this.attr.currentRating=e,this.broadcast("saveSuccess",{rating:e,domId:this.$node.attr("id")})},error:function(e){this.broadcast("saveError",e),this.defer(function(){this.authRedirect(e,$j.proxy(function(){var t="Unknown XHR failure when trying to save rating";e.status&&(t+=" , status code "+e.status),this.broadcastError(t)},this))},500)},complete:function(e){this.broadcast("saveComplete",e)}})},this.validateRating=function(e){var t=new RegExp("^["+this.attr.minRating+"-"+this.attr.maxRating+"]$");return t.test(e)}},MixinEventUtils,MixinAuthRedirect);$gr.shared.ratingDistTooltip=flight.component(function(){var e="RatingDistTooltip";this.defaultAttrs({channel:e,componentName:e}),this.after("initialize",function(){this.userId=this.$node.data("user-id"),this.graph=$j("#ratingDistribution"+this.userId),this.graphHtml,this.on("click",this.getRatingDistribution)}),this.getRatingDistribution=function(){return void 0===this.graphHtml?$j.ajax({url:"/user/rating_distribution/"+this.userId,type:this.methodType,data:{format:"json"},context:this,success:this.showRatingDistGraph}):this.graph.toggle(),!1},this.showRatingDistGraph=function(e){this.graphHtml=e.body,this.graph.append(this.graphHtml),this.graph.toggle()}},MixinEventUtils),$gr.communityQA.readerQAForm=flight.component(function(){var e="readerQAForm";this.defaultAttrs({channel:e,formSuccessEventName:"qaFormSuccess",containerSelector:".js-communityAnswersList",emptyMessageSelector:".communityAnswerEmptyMessage",formContainerSelector:".readerQAFormContainer",formUserImageSelector:".js-ReaderQAForm-formUserImage",notificationSelector:".js-notification",rateLimitMessageSelector:".js-ReaderQAForm-rateLimitMessage",unansweredQuestionsContainer:".js-unansweredQuestionsContainer",unansweredQuestionsList:"#communityQuestionsWithoutAnswers",unansweredQuestionSelector:".unansweredQuestion"}),this.after("initialize",function(){this.on("ajax:success",this.uiAddResponseToPage),this.$formNode=this.$node.find("form")}),this.displayRateLimitMessage=function(){$j(this.attr.rateLimitMessageSelector).show()},this.hideFormUserImage=function(){$j(this.attr.formUserImageSelector).hide()},this.uiAddQuestionToPage=function(e){$j(this.attr.unansweredQuestionsList).prepend(e.html);var t=$j(this.attr.unansweredQuestionsContainer);t.is(":visible")||t.show()},this.uiAddAnswerToPage=function(e){var t=$j(e.html).prependTo(this.attr.containerSelector);this.attachComponentsToNewAnswers(t),$j(this.attr.emptyMessageSelector).hide()},this.uiAddResponseToPage=function(e,t){this.uiResetForm();var n=!1,i=this.$formNode.data("formType");t.html&&("question"===i?this.uiAddQuestionToPage(t):"answer"===i&&this.uiAddAnswerToPage(t)),t.message&&this.uiShowNotification(t),t.limit_reached&&(n=!0),("answer"===this.$formNode.data("formType")||n)&&(this.uiHideForm(),this.trigger("answerFormSubmitted.authorDashboardQA")),n&&(this.hideFormUserImage(),this.displayRateLimitMessage());var o=this.$formNode.parents(this.attr.unansweredQuestionSelector);o.length&&o.find(".questionHeaderAndActions").fadeOut()},this.attachComponentsToNewAnswers=function(e){$gr.shared.editInPlaceController.attachTo(e,{editableElementSelector:".communityAnswerText",highlightElementSelector:".communityAnswerText",elementsToHideSelectors:".communityAnswererName, .communityAnswerText, .communityAnswerFooter"}),$gr.shared.confirmModal.attachTo(".js-confirmModal")},this.uiHideForm=function(){this.$node.children().not(this.attr.notificationSelector).fadeOut(),this.teardown()}},MixinEventUtils,withExpandableTextField,withNotification,withFormAjax),$gr.shared.relatedWorks=flight.component(function(){this.defaultAttrs({relatedWorksContainerSelector:".js-relatedWorksContainer",wtrButtonSelector:".wtrButtonContainer"}),this.after("initialize",function(){this.on("wtrShelvingCompleted",{wtrButtonSelector:this.uiInsertRelatedWorks})}),this.uiInsertRelatedWorks=function(e,t){this.$node.next(this.attr.relatedWorksContainerSelector).find("td").html(t.html_content),$gr.shared.dismissModuleUI.attachTo(".js-dismissModuleContainer",{dismissButtonSelector:".js-dismissTrigger"})}}),$gr.shared.reviewDraftDataCollection=flight.component(function(){this.after("initialize",function(){var e=this;this.on("change.reviewDraftDataCollection",function(){$j.post("/track/track",{tid:"track_text_written_in_review_text_box"}).done(function(){e.off("change.reviewDraftDataCollection")})})})});var SearchInline=flight.component(function(){var e="searchInline";this.defaultAttrs({channel:e,componentName:e,searchResultsSelector:null,searchFieldSelector:".field",searchFieldClearSelector:".clearIcon",distractionSelector:"",searchFieldActiveClass:"active",searchResultsLoadingClass:"loading",searchResultsShowClass:"show",$queryAjaxSettings:null,queryParamName:"q",queryLengthMin:2,enableCollapseDistractions:!1}),this.after("initialize",function(){return this.isActive=!1,this.$searchField=this.$node.is("input")?this.$node:this.select("searchFieldSelector").first(),this.$searchField.length<1||!this.$searchField.is("input")?this.broadcastError("search field element is required"):(this.on(this.$searchField,"focus",this.activate),this.select("searchFieldClearSelector").on("click",$j.proxy(this.deactivate,this)),this.$searchResultsContainer||(this.$searchResultsContainer=$j(this.attr.searchResultsSelector)),void this.initializeSearchFieldAutocomplete())}),this.initializeSearchFieldAutocomplete=function(){this.on(this.$searchField,"showMenu.autocomplete",this.showSearchResults),this.on(this.$searchField,"submitQueryStart.autocomplete",function(){this.trigger(this.$searchField,"clearMenu.autocomplete"),this.$searchResultsContainer.addClass(this.attr.searchResultsLoadingClass)}),this.on(this.$searchField,"submitQueryEnd.autocomplete",function(){this.$searchResultsContainer.removeClass(this.attr.searchResultsLoadingClass)}),Autocomplete.attachTo(this.$searchField,{menuListParentSelector:this.attr.searchResultsSelector,queryLengthMin:this.attr.queryLengthMin,queryParamName:this.attr.queryParamName,$queryAjaxSettings:this.attr.$queryAjaxSettings})},this.activate=function(){this.isActive||(this.isActive=!0,this.$node.addClass(this.attr.searchFieldActiveClass),this.toggleDistractionlessMode(!0),this.showSearchResults(),this.trigger(document,"hideBrowserAddressBar"))},this.deactivate=function(){this.isActive&&(this.isActive=!1,this.$node.removeClass(this.attr.searchFieldActiveClass),this.hideSearchResults(),this.toggleDistractionlessMode(!1),this.resetSearchResults())},this.hideSearchResults=function(){this.$searchResultsContainer.removeClass(this.attr.searchResultsShowClass)},this.resetSearchResults=function(){this.trigger(this.$searchField,"reset.autocomplete")},this.showSearchResults=function(){this.isActive&&this.$searchResultsContainer.addClass(this.attr.searchResultsShowClass)},this.toggleDistractionlessMode=function(e){var t=$j(this.attr.distractionSelector);this.attr.enableCollapseDistractions===!0?t[e?"hide":"show"]():t.css("visibility",e?"hidden":"")}},MixinEventUtils),ShareBookButton=flight.component(function(){this.after("initialize",function(){this.on($gr.touch,function(){alert("Sharing is caring.")})})});$gr.communityQA.shareToggle=flight.component(function(){var e="shareToggleComponent";this.defaultAttrs({channel:e,componentName:e,selectedClass:"selected"}),this.after("initialize",function(){this.$parent=this.$node.parent(),this.on("click",this.toggleShareOption)}),this.toggleShareOption=function(){var e=this,t=function(){e.uiToggle(),e.dataToggle()};"facebook"===this.$node.data("share-service")?$grfb.ensurePublishPermission().done(t):"twitter"===this.$node.data("share-service")?"connected"===this.$node.data("service-connected")?t():GR_Twitter.askToConnect(function(){e.$node.data("service-connected","connected"),t()}):t()},this.uiToggle=function(){this.$parent.toggleClass(this.attr.selectedClass)},this.dataToggle=function(){var e=this.$node.closest("form"),t=this.$node.data("share-service"),n="share-service-"+t;this.$parent.hasClass(this.attr.selectedClass)?$j("<input>").attr({type:"hidden",name:n,value:!0}).appendTo(e):$j('input[name="'+n+'"]').remove()}},withTooltips);var SiteBanner=flight.component(function(){var e="siteBanner";this.defaultAttrs({rootSelector:"#siteBanner",closeSelector:".closeIcon",showClass:"show",channel:e}),this.after("initialize",function(){this.listen("requestHide",this.onRequestHide),this.listen("requestShow",this.onRequestShow),this.$rootNode=$j(this.attr.rootSelector).first(),this.on(this.$rootNode.find(this.attr.closeSelector),"click",this.hide),this.listen("addClass",function(e,t){this.$rootNode.addClass(t)})}),this.hide=function(){this.isVisible()&&(this.broadcast("beforeHide"),this.$rootNode.removeClass(this.attr.showClass),this.broadcast("afterHide"))},this.isVisible=function(){return this.$rootNode.hasClass(this.attr.showClass)},this.show=function(){this.isVisible()||(this.broadcast("beforeShow"),this.$rootNode.addClass(this.attr.showClass),this.broadcast("afterShow"))},this.onRequestHide=function(){this.isVisible()?this.hide():this.broadcast("afterHide")},this.onRequestShow=function(){this.isVisible()?this.broadcast("afterShow"):this.show()}},MixinEventUtils),SiteNavSecondary=flight.component(function(){var e="siteNavSecondary";this.defaultAttrs({navRootSelector:"#siteNavSecondary",catalystSelector:".jsSecondaryNavToggle",activeClass:"showSiteNavSecondary",channel:e,componentName:e}),this.after("initialize",function(){this.on("click",{catalystSelector:this.onToggleNavVisibility}),this.listen("requestHide",this.hideNav),this.listen("requestShow",this.showNav),this.on(window,"orientationchange",this.hideNav)}),this.hideNav=function(){this.isNavVisible()&&($j(document).trigger("disableScrollLock"),$j(document.body).removeClass(this.attr.activeClass),this.broadcast("beforeHide"),this.defer(function(){this.broadcast("requestReset.tabCluster"),this.disableTouchScrollingAssist(),this.broadcast("hide"),this.broadcast("afterHide")},500))},this.isNavVisible=function(){return $j(document.body).hasClass(this.attr.activeClass)},this.showNav=function(){this.isNavVisible()||(this.broadcast("beforeShow"),$j(document.body).addClass(this.attr.activeClass),this.enableTouchScrollingAssist(),$j(document).trigger("hideBrowserAddressBar",!0),$j(document).trigger("enableScrollLock","x"),this.broadcast("show"),this.broadcast("afterShow"))},this.onToggleNavVisibility=function(e){e.preventDefault(),this.isNavVisible()?this.hideNav():this.showNav()},this.disableTouchScrollingAssist=function(){$j(this.attr.navRootSelector).css("height","")},this.enableTouchScrollingAssist=function(){var e=$j(document).height(),t=$j(window).height();$j(this.attr.navRootSelector).height(e>t?e:t)}},MixinEventUtils),SiteSearch=flight.component(function(){var e="siteSearch";this.defaultAttrs({channel:e,componentName:e,searchButtonSelector:"#siteSearchButton",searchFieldClearSelector:".clearIcon",searchFieldSelector:".field",searchFormSelector:".searchForm",searchResultsSelector:".searchResults",buttonSelectedClass:"selected",searchFormActiveClass:"active",clearIconShowClass:"show",searchPanelShowClass:"show",searchResultsShowClass:"show",autocomplete:!0,sticky:!1,queryDebounceDuration:500}),this.after("initialize",function(){this.isActive=!1,this.$searchButton||(this.$searchButton=$j(this.attr.searchButtonSelector)),this.$searchField||(this.$searchField=this.select("searchFieldSelector")),this.$searchForm||(this.$searchForm=this.select("searchFormSelector")),this.$searchResultsContainer||(this.$searchResultsContainer=this.select("searchResultsSelector")),this.$searchFieldClear||(this.$searchFieldClear=this.select("searchFieldClearSelector")),this.on(this.$searchButton,"click",this.toggleSearchPanel),this.attr.autocomplete===!0&&this.initializeSearchFieldAutocomplete(),this.on(this.$searchField,"focus",this.activate),this.on(this.$searchFieldClear,"click",this.deactivate),this.on(document,"beforeShow.siteNavSecondary",function(){this.toggleSearchPanel(null,!1)}),this.attr.sticky===!1&&(this.on(document,"click",function(){this.isSearchPanelVisible()&&this.hideSearchPanel()}),this.on("click",function(e){e.stopPropagation()})),this.on(this.$searchField,"keyup input",this.onKeystroke),this.listen("showSearch",this.showSearchPanel)}),this.initializeSearchFieldAutocomplete=function(){this.on(this.$searchField,"showMenu.autocomplete",this.showSearchResults),this.after("hideSearchPanel",function(){this.trigger(this.$searchField,"reset.autocomplete")}),Autocomplete.attachTo(this.$searchField,{menuListParentSelector:this.attr.searchResultsSelector,queryParamName:"q",$queryAjaxSettings:{type:"POST",url:"/book/auto_complete",data:{book_origin:"header_search"}}})},this.activate=function(){this.isActive||(this.isActive=!0,this.$searchForm.addClass(this.attr.searchFormActiveClass),this.setSearchFieldClearState(),this.trigger(document,"hideBrowserAddressBar"))},this.deactivate=function(){this.isActive&&(this.isActive=!1,this.$searchField.val(""),this.setSearchFieldClearState(),this.resetSearchResults(),this.$searchField.focus())},this.hideSearchPanel=function(){this.hideSearchResults(),this.$node.removeClass(this.attr.searchPanelShowClass),this.$searchButton.removeClass(this.attr.buttonSelectedClass),this.broadcast("hide")},this.hideSearchResults=function(){this.$searchResultsContainer.removeClass(this.attr.searchResultsShowClass)},this.isSearchPanelVisible=function(){return this.$node.hasClass(this.attr.searchPanelShowClass)},this.onKeystroke=function(){this.setSearchFieldClearState()},this.setSearchFieldClearState=function(){""===this.$searchField.val()?this.$searchFieldClear.removeClass(this.attr.clearIconShowClass):this.$searchFieldClear.addClass(this.attr.clearIconShowClass)},this.resetSearchResults=function(){this.trigger(this.$searchField,"reset.autocomplete")},this.showSearchPanel=function(){this.$searchButton.addClass(this.attr.buttonSelectedClass),this.trigger(document,"hideBrowserAddressBar",!0),this.defer(function(){this.$node.addClass(this.attr.searchPanelShowClass),this.broadcast("show")})},this.showSearchResults=function(){this.isSearchPanelVisible()&&this.$searchResultsContainer.addClass(this.attr.searchResultsShowClass)},this.toggleSearchPanel=function(e,t){e&&e.preventDefault();var n="boolean"==typeof t?t:!this.isSearchPanelVisible();n?(this.showSearchPanel(),this.trigger(document,"requestHide.siteNavSecondary")):this.hideSearchPanel()}},MixinEventUtils),SortMenuButton=flight.component(function(){var e="sortMenuButton";this.defaultAttrs({activeClass:"selected",menuSelector:"#sortMenu",slideUpListItemAllowDefaultAction:!0,channel:e,componentName:e}),this.after("initialize",function(){this.on("click",function(e){this.$node.hasClass(this.attr.activeClass)?this.$node.removeClass(this.attr.activeClass):this.$node.addClass(this.attr.activeClass),this.toggleSlideUpMenuVisibility(e)})})},withSlideUpMenu),Spoilers=flight.component(function(){var e="spoilers";this.defaultAttrs({channel:e,componentName:e,showSpoilerSelector:".jsShowSpoiler",hideSpoilerSelector:".jsHideSpoiler",spoilerContainerSelector:".spoilerContainer"}),this.after("initialize",function(){this.on($gr.touch,{showSpoilerSelector:this.onShowSpoiler,hideSpoilerSelector:this.onHideSpoiler})
}),this.onHideSpoiler=function(e){var t=$j(e.target);e.preventDefault(),t.parent().siblings(this.attr.showSpoilerSelector).show(),t.parent(this.attr.spoilerContainerSelector).hide()},this.onShowSpoiler=function(e){var t=$j(e.target);e.preventDefault(),t.siblings(this.attr.spoilerContainerSelector).show(),t.hide()}}),TabCluster=flight.component(function(){var e,t="tab-id",n="tabCluster";this.defaultAttrs({channel:n,componentName:n,sectionRoot:null,sectionSelector:".tabSection",tabSelector:".tab",hideSectionClass:"hide",tabSelectedClass:"selected",tabLinkAttrName:t,sectionLinkAttrName:t}),this.after("initialize",function(){e=$j(this.attr.sectionRoot),e.length<1||(this.attr.defaultTabSelected=$j(this.attr.defaultTabSelected).first(),this.attr.defaultTabSelected.length<1&&(this.attr.defaultTabSelected=this.select("tabSelector").filter("."+this.attr.tabSelectedClass).first()),this.on("click",{tabSelector:this.onTabSelect}),this.listen("requestReset",this.reset))}),this.isTabSelected=function(e){return e.hasClass(this.attr.tabSelectedClass)},this.reset=function(){var e=this.attr.defaultTabSelected,t=e.data(this.attr.tabLinkAttrName);this.switchTab(t),this.broadcast("reset")},this.switchTab=function(t){e.find(this.attr.sectionSelector).each($.proxy(function(e,n){var i=$(n);i.toggleClass(this.attr.hideSectionClass,i.data(this.attr.sectionLinkAttrName)!==t)},this)),this.select("tabSelector").each($.proxy(function(e,n){var i=$(n);i.toggleClass(this.attr.tabSelectedClass,i.data(this.attr.tabLinkAttrName)===t)},this)),this.broadcast("switch")},this.onTabSelect=function(e){e.preventDefault();var t=$j(e.target).closest(this.attr.tabSelector),n=t.data(this.attr.tabLinkAttrName);"string"!=typeof n||this.isTabSelected(t)||this.switchTab(n)}},MixinEventUtils);$gr.shared.toggleQaForm=flight.component(function(){this.defaultAttrs({answerFormSelector:".answerForm",answerActionSelector:".answerQuestionAction",unansweredQuestionSelector:".unansweredQuestion"}),this.after("initialize",function(){this.on("click",{answerActionSelector:this.uiShowForm})}),this.uiShowForm=function(e){var t=$j(e.target);e.preventDefault(),$j.ajax({url:t.data("get-form-url"),type:"get",data:{format:"json"},context:this,success:function(e){t.parents(this.attr.unansweredQuestionSelector).find(this.attr.answerFormSelector).html(e.content_html),$gr.communityQA.readerQAForm.attachTo(".js-readerQAForm"),$gr.shared.notification.attachTo(".js-notification"),$gr.communityQA.shareToggle.attachTo(".js-shareToggle")}})}},MixinEventUtils);var ToggleVisibility=flight.component(function(){var e=($j(document),"toggleVisibilityComponent");this.defaultAttrs({channel:e,componentName:e,$togglableContent:{},actionTextWhenVisible:"Hide",actionTextWhenHidden:"Show"}),this.after("initialize",function(){this.attr.$togglableContent=$j(this.$node.attr("href")),this.attr.$togglableContent.length?Hammer(this.$node).on("tap",$j.proxy(this.toggleContent,this)):this.broadcastError("could not find togglable content.",!0)}),this.toggleContent=function(e){e.preventDefault(),this.attr.$togglableContent.is(":hidden")?this.visibleState():this.hiddenState()},this.hiddenState=function(){this.$node.text(this.attr.actionTextWhenHidden),this.attr.$togglableContent.hide()},this.visibleState=function(){this.$node.text(this.attr.actionTextWhenVisible),this.attr.$togglableContent.show()}},MixinEventUtils);$gr.shared.tooltip=flight.component(function(){this.defaultAttrs({tooltipCaretSelector:".tooltipCaret",tooltipSelector:".js-tooltip",defaultTooltipClass:"tooltipDefault"}),this.after("initialize",function(){this.tooltipHtml=null,this.listen("tooltipHtmlRetrieved.dataTooltip",this.attachTooltipHoverEvents)}),this.attachTooltipHoverEvents=function(e,t){var n=this.$node.data("resource-type")+"."+this.$node.data("resource-id");null===this.tooltipHtml&&"undefined"!=typeof t.tooltips[n]&&(this.$node.find("a, img").removeAttr("title").removeAttr("alt"),this.$node.removeAttr("title"),this.tooltipHtml=t.tooltips[n],this.$node.hover($j.proxy(this.showTooltip,this),$j.proxy(this.hideTooltip,this)))},this.showTooltip=function(){HoverIntent.onEnterIntent(this,function(){var e=this.select("tooltipSelector");e.length?e.show():this.constructTooltip()},this,750)},this.hideTooltip=function(){HoverIntent.onLeaveIntent(this,function(){this.select("tooltipSelector").hide()})},this.constructTooltip=function(){this.$node.append(this.tooltipHtml);var e=10,t=this.select("tooltipSelector");if("top"===this.$node.data("caret-placement")){t.find(this.attr.tooltipCaretSelector).addClass("tooltipCaretTop");var n=(this.$node.height()+e).toString();t.css("left","0px"),t.css("top",n+"px")}else{t.find(this.attr.tooltipCaretSelector).addClass("tooltipCaretLeft");var i=(this.$node.width()+e).toString();t.css("left",i+"px"),t.css("top","0px")}}},MixinEventUtils),$gr.shared.twitterCallbacks=flight.component(function(){var e="twitterCallbacksComponent";this.defaultAttrs({channel:e,componentName:e}),this.after("initialize",function(){twttr.ready(function(e){e.events.bind("tweet",t)})});var t=function(e){var t="twitter_update_pushed",n=$j("#tracker").data("track_tweet");"undefined"==typeof n&&(n=e.target.parentElement.getAttribute("data-gr_tracker_id")),"undefined"!=typeof n&&(t=[t,n]),$j.ajax({url:"/track/track",type:"GET",data:{tid:t}})}}),$gr.shared.twitterDialog=flight.component(function(){this.defaultAttrs({counterSelector:".characterCounter",textareaSelector:".characterCountArea",tweetViaGrSelector:".tweetViaGr",shareButtonSelector:".button",warningClass:"warning",keystrokeDebounceDuration:100,maxUrlLengthAfterShortening:23,tweetMaxLength:140}),this.after("initialize",function(){var e=this.select("textareaSelector");this.tweetUrlLength=e.data("append-url")?this.attr.maxUrlLengthAfterShortening:0,this.tweetViaLength="true"===this.select("tweetViaGrSelector").val()?" via @goodreads".length:0,this.on("keyup",flight.utils.debounce(this.uiUpdateCounter,this.attr.keystrokeDebounceDuration)),this.uiUpdateCounter()}),this.uiUpdateCounter=function(){var e=this.getNumCharsRemaining(),t=this.select("counterSelector");0>e?(t.addClass(this.attr.warningClass),this.uiEnableButton(!1)):(t.removeClass(this.attr.warningClass),this.uiEnableButton(!0)),0===this.select("textareaSelector").val().length&&this.uiEnableButton(!1),t.html(e+" characters left")},this.uiEnableButton=function(e){this.select("shareButtonSelector").attr("disabled",!e)},this.getNumCharsRemaining=function(){var e=this.select("textareaSelector").val(),t=e.replace(/[\s]?(https?:\/\/[^\s]+)/g,"").replace(" via @goodreads","").length;return this.attr.tweetMaxLength-t-this.tweetUrlLength-1-this.tweetViaLength}}),$gr.shared.updateFiltersForm=flight.component(function(){this.defaultAttrs({updateFiltersFormSelector:".js-updateFiltersForm",updateTypeFiltersSelector:".js-updateTypeFilters",updateItemSelector:"input[name=update_item]:checked",updateScopeSelector:"input[name=update_scope]:checked",authorBlogPostsSelector:"input[name=author_blog_posts][type=checkbox]",authorBlogPostsHiddenSelector:"input[name=author_blog_posts][type=hidden]",hpUpdateFilterSelector:"#hp_update_filter"}),this.after("initialize",function(){this.on("submit",this.handleSubmit)}),this.handleSubmit=function(){this.setUpdateFilterType(),this.setAuthorBlogPostsFlag(),this.broadcast("dataFiltersUpdated"),this.broadcast("dataUpdatesLoading")},this.setUpdateFilterType=function(){var e=this.select("updateScopeSelector").val();e.blank()&&(e="friends");var t=this.select("updateItemSelector").val(),n=e;t.blank()||(n=n+"-"+t),this.select("hpUpdateFilterSelector").val(n)},this.setAuthorBlogPostsFlag=function(){this.select("authorBlogPostsHiddenSelector").val(this.select("authorBlogPostsSelector").prop("checked")?"1":"0")}},MixinEventUtils,withFormSubmission);var ViewportOverlay=flight.component(function(){var e,t=$gr&&$gr.touch?$gr.touch:"click",n="viewportOverlay",i="overlayId",o="overlay-scroll-lock",r={};this.defaultAttrs({channel:n,componentName:n,showClass:"show",disableDirectHide:!1}),this.after("initialize",function(){e||(e=$j("<div/>").addClass(n)),this.listen("show",this.onShow),this.listen("hide",this.onHide),this.listen("create",this.onCreate),this.listen("afterShow",function(e,t){this.toggleOverlayScrollSuppression(t.overlayId,!0)}),this.listen("beforeHide",function(e,t){this.toggleOverlayScrollSuppression(t.overlayId,!1)})}),this.hide=function(e){var t=this.getOverlayById(e);t&&(this.broadcast("beforeHide",{overlayId:e}),t.removeClass(this.attr.showClass),this.broadcast("afterHide",{overlayId:e}))},this.show=function(e){var t=this.getOverlayById(e);t&&(this.broadcast("beforeShow",{overlayId:e}),t.addClass(this.attr.showClass),this.broadcast("afterShow",{overlayId:e}))},this.onCreate=function(e,t){if(t&&t[i]){var n=t[i];n?this.getOverlayById(n)?this.broadcastError("overlay already exists for id: "+n):this.createOverlay(n,t.attr||null):this.broadcastError("could not create overlay, no id specified")}},this.onHide=function(e,t){t&&t[i]&&this.hide(t[i])},this.onShow=function(e,t){t&&t[i]&&this.show(t[i])},this.createOverlay=function(n,i){var s=i||{},a=e.clone();a.attr("id",n),"string"==typeof s.className&&a.addClass(s.className),s.disableDirectHide||a.on(t,$j.proxy(function(e){e.preventDefault(),this.hide()},this)),s.disableScrollLock||a.data(o,!0),a.appendTo(document.body),r[n]=a},this.getOverlayById=function(e){return r[e]||null},this.toggleOverlayScrollSuppression=function(e,t){var n=this.getOverlayById(e);n&&n.data(o)&&this.trigger(document,t?"enableScrollLock":"disableScrollLock")}},MixinEventUtils),ViewportServices=flight.component(function(){var e="viewportServices";this.defaultAttrs({channel:e}),this.after("initialize",function(){return Modernizr.touch?(this.initializeScrollLockMode(),void this.on("hideBrowserAddressBar",function(e,t){var n=t===!0;if(n&&/\bAndroid\s+2\.(2|3)/.test(navigator.userAgent))window.scrollTo(0,0);else{var i=n?0:window.scrollY;window.scrollTo(0,i+1),setTimeout(function(){window.scrollTo(0,i-1)},0)}})):this.teardown()}),/**
   *  Initialize "scroll lock mode" service.
   *  This mode, when enabled, temporarily prevents user scrolling within the
   *  browser viewport. This can be useful for overlays that cover a portion or
   *  all of the browser viewport, in which case viewport scrolling can be
   *  detrimental to the UX.
   *  Note: USE WITH EXTREME CAUTION!
   *  @method initializeScrollLockMode
   */
this.initializeScrollLockMode=function(){this.on(document,"enableScrollLock",this.onEnableScrollLock),this.on(document,"disableScrollLock",this.onDisableScrollLock)},this.onDisableScrollLock=function(){this.toggleScrollLockMode(!1)},this.onEnableScrollLock=function(e,t){this.toggleScrollLockMode(!0,t)},this.toggleScrollLockMode=function(e,t){var n,i={};"string"==typeof t?(t=t.toLowerCase(),"x"===t?i={drag_block_horizontal:!0}:"y"===t&&(i={drag_block_vertical:!0}),n=$j.noop):n=function(e){e.preventDefault()};var o=$j(document.body).hammer(i),r=this.getSafeEventName("touchmove");e===!0?o.on(r,n):o.off(r)}},MixinEventUtils),WantToReadButton=flight.component(function(){var e="wtrButton",t=/^\s*$/;this.defaultAttrs({buttonSelector:".jsWTR",buttonActiveSelector:".jsWTR.wtrSelected",buttonInactiveSelector:".jsWTR:not(.wtrSelected)",menuCatalystSelector:".areaSecondary",buttonLoadingClass:"wtrLoading",buttonSelectedClass:"wtrSelected",dataAttrParamShelf:"async-param-shelf",dataAttrUrlAdd:"async-url-add",dataAttrUrlDelete:"async-url-delete",dataAttrUrlMore:"url-more",dataAttrCurrentShelf:"current-shelf",dataAttrReftag:"ref",eventAttrAction:"actionType",eventAttrButtonId:"buttonId",eventAttrIsBookShelved:"isBookShelved",eventAttrShelfName:"shelfName",eventAttrSeeMoreUrl:"moreUrl",eventAttrReftag:"ref",channel:e,componentName:e}),this.after("initialize",function(){var e=[this.attr.buttonInactiveSelector+" "+this.attr.menuCatalystSelector,this.attr.buttonActiveSelector].join(",");this.$node.on("click",e,$j.proxy(function(e){var t=$j(e.target).closest(this.attr.buttonSelector);this.requestMenuShow(t)},this)),this.on(document,"listItemSelected.wtrButtonMenu",this.onMenuItemSelected),// dynamic! It's a Rails async form/link. We need to listen at the
this.$node.on("ajax:success",this.attr.buttonSelector,$j.proxy(function(e,t){this.onSaveSuccess(t)},this)),this.$node.on("ajax:error",this.attr.buttonSelector,$j.proxy(function(e,t){var n=$j(e.target).closest(this.attr.buttonSelector);this.toggleButtonLoadingState(n,!1),this.onSaveError(t)},this)),this.$node.on("ajax:beforeSend",this.attr.buttonSelector,$j.proxy(function(e){var t=$j(e.target).closest(this.attr.buttonSelector);this.toggleButtonLoadingState(t,!0)},this))}),this.requestMenuShow=function(e){e.length&&this.trigger(document,"requestShow.wtrButtonMenu",this.createEventPayload(e))},this.toggleButtonLoadingState=function(e,t){e&&e.length&&e.toggleClass(this.attr.buttonLoadingClass,t)},this.addToShelf=function(e,n){if(e&&e.length){var i=e.data(this.attr.dataAttrUrlAdd);if(i&&!t.test(i)){var o={},r=e.data(this.attr.dataAttrParamShelf);o[r]=n[this.attr.eventAttrShelfName];var s={ref:n[this.attr.eventAttrReftag]};this.save(this.addUrlParams(i,o),e,s)}}},this.removeFromShelves=function(e,n){var i=e.data(this.attr.dataAttrUrlDelete);if(i&&!t.test(i)){var o=n[this.attr.eventAttrReftag],r={ref:o.replace(/_wtres/,"_wtruns")};this.save(i,e,r)}},this.save=function(e,n,i){e&&!t.test(e)&&(this.toggleButtonLoadingState(n,!0),$j.ajax({url:e,type:"post",dataType:"json",context:this,timeout:15e3,success:this.onSaveSuccess,error:this.onSaveError,data:i,complete:function(){this.toggleButtonLoadingState(n,!1)}}))},this.onMenuItemSelected=function(e,t){var n=this.attr.eventAttrButtonId;if($j.isPlainObject(t)&&t[n]){var i=$j("#"+t[n]);if(i.length){var o=t[this.attr.eventAttrAction];switch(o){case"add":this.addToShelf(i,t);break;case"delete":this.removeFromShelves(i,t);break;default:this.broadcastError("unknown action '"+o+"'")}}}},this.onSaveError=function(e){this.defer(function(){this.authRedirect(e,$j.proxy(function(){var t="Unknown XHR failure when trying to save book to shelf.";e.status&&(t+=" , status code "+e.status),this.broadcastError(t)},this))},500)},this.onSaveSuccess=function(e){var n=!1;if($j.isPlainObject(e))if(e.ok&&"string"==typeof e.html&&!t.test(e.html)){var i=$j(e.html),o=this.getButtonId(i),r=$j("#"+o);i.length&&r.length&&r.replaceWith(i)}else{n=!0;var s=e.error||"unknown error when attempting to save";this.broadcastError(s)}else this.broadcastError("malformed JSON response when trying to save book to shelf");n&&$j("#flashMessages").trigger("addFlashMessage",["Your change has not been saved. Please refresh the page any try again.","error"])},this.addUrlParams=function(e,n){if(!e||t.test(e))this.broadcastError("baseUrl is null or empty",!0);else if($j.isPlainObject(n)){var i=$j.param(n);if(!t.test(i)){var o=e.indexOf("?")<0?"?":"&";return e+o+i}}else this.broadcastError("paramPairs is not an object",!0)},this.createEventPayload=function(e){if(e.length){var t={};return t[this.attr.eventAttrButtonId]=this.getButtonId(e),t[this.attr.eventAttrSeeMoreUrl]=e.data(this.attr.dataAttrUrlMore),t[this.attr.eventAttrIsBookShelved]=e.hasClass(this.attr.buttonSelectedClass),t[this.attr.eventAttrShelfName]=e.data(this.attr.dataAttrCurrentShelf),t[this.attr.eventAttrReftag]=e.data(this.attr.dataAttrReftag),t}},this.getButtonId=function(e){return e&&e.length?e.first().attr("id"):void 0}},MixinEventUtils,MixinAuthRedirect),WantToReadButtonMenu=flight.component(function(){var e="wtrButtonMenu",t=/^\s*$/;this.defaultAttrs({menuSelector:"#wtrButtonMenu",moreSelector:".more",showDeleteOptionClass:"showDeleteOption",dataAttrActionType:"action",dataAttrShelfName:"shelf",dataAttrReftag:"ref",channel:e,componentName:e}),this.after("initialize",function(){this.listen("requestShow",this.onRequestMenuShow),this.onSlideUpEvent("afterHide",this.onHideMenu),this.onSlideUpEvent("listItemSelected",this.onMenuItemSelected),this.on("click",{moreSelector:function(e){e.preventDefault();var t=$j(e.target).attr("href");this.hideSlideUpMenu(),this.defer(function(){location.href=t})}})}),this.onHideMenu=function(){this.clearButtonId(),this.manageShelfVisualSelection(),this.updateMoreLink()},this.onMenuItemSelected=function(e,t){var n=$j(t).first();n.length&&n.data(this.attr.dataAttrActionType)&&this.broadcast("listItemSelected",{buttonId:this.getButtonId(),actionType:n.data(this.attr.dataAttrActionType),shelfName:n.data(this.attr.dataAttrShelfName),ref:n.data(this.attr.dataAttrReftag)}),this.hideSlideUpMenu()},this.onRequestMenuShow=function(e,n){var i;$j.isPlainObject(n)&&n.buttonId?i=n.buttonId:"string"==typeof n&&(i=n),i&&!t.test(i)?(this.setButtonId(i),this.manageShelfVisualSelection(n.shelfName),this.updateMoreLink(n.moreUrl),$j(this.attr.menuSelector).toggleClass(this.attr.showDeleteOptionClass,n.isBookShelved),this.updateReftags(n.ref),this.showSlideUpMenu()):this.broadcastError("cannot show, no button id specified")},this.clearButtonId=function(){this.buttonId=null},this.getButtonId=function(){return this.buttonId},this.manageShelfVisualSelection=function(e){var t=this.getListItems();if(t&&t.length){var n='[data-shelf="'+e+'"]';t.each($j.proxy(function(e,t){var i=$j(t);i.toggleClass(this.attr.slideUpItemSelectedClass,i.is(n))},this))}},this.setButtonId=function(e){this.buttonId=e},this.updateMoreLink=function(e){var n="#";("string"!=typeof e||t.test(e))&&(e=n),this.select("moreSelector").attr("href",e).css("visibility",e===n?"":"visible")},this.updateReftags=function(e){this.getListItems().each(function(t,n){var i=$j(n);i.attr("data-ref",e+"_wtres")})}},MixinEventUtils,withSlideUpMenu);